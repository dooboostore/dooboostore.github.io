<div class="player-container" dr-attr="{class: 'player-container' + (@this@.isSwapped ? ' swapped' : '')}">
    <div class="dictionary-section">
        <!-- Dictionary Loading -->
        <div class="loading-container" dr-if="@this@.isLoadingDictionaries">
            <div class="loading-spinner"></div>
            <div class="loading-text">Loading dictionary...</div>
        </div>
        <!-- <button dr-event-click="@this@.test()">zzzzzzzzzzzzzzz</button> -->
        <div class="dictionary-content" dr-if="@this@.dictionaries && !@this@.isLoadingDictionaries">
            <div class="dictionary-item" dr-for-of="@this@.dictionaries" dr-option-item-variable-name="dict"
                dr-attr="{'data-original-word': #dict#.originalWord, 'data-match-type': #dict#?.items?.[0].matchType}">
                <div dr-if="#dict#" class="word-items" dr-for-of="#dict#.items" dr-option-item-variable-name="item">
                    <div dr-if="#item#" class="word-entry">
                        <div class="entry-header">
                            <h3 class="entry-title clickable-title"
                                dr-event-click="@this@.onEntryTitleClick($element, $event)">
                                ${#item#.entry}$</h3>
                            <label class="favorite-checkbox-label" title="즐겨찾기에 추가/제거" dr-if="#item#.entry">
                                <input type="checkbox" class="favorite-checkbox"
                                    dr-attr="{checked: @this@.checkWordFavorite(#item#?.entry || '') ? 'checked' : null}"
                                    dr-event-change="@this@?.toggleFavorite(#item#?.entry || '', #item#?.pos?.[0]?.meanings?.[0]?.meaning || #item#?.entry || '')">
                                <i class="fas fa-star favorite-icon"></i>
                            </label>
                        </div>
                        <div class="pos-list" dr-for-of="#item#.pos" dr-option-item-variable-name="pos">
                            <div class="pos-type" dr-attr="{class: 'pos-type' + (#pos#.type ? '' : ' pos-type-null')}">
                                ${#pos#.type || '기타'}$</div>
                            <div class="meanings" dr-for-of="#pos#.meanings" dr-option-item-variable-name="meaning">
                                <div class="meaning-item">
                                    <div class="meaning-text">${#meaning#?.meaning}$</div>
                                    <div class="examples" dr-if="#meaning#.examples.length > 0"
                                        dr-for-of="#meaning#.examples" dr-option-item-variable-name="example">
                                        <div class="example-item">
                                            <div class="example-text clickable-example"
                                                dr-event-click="@this@.onExampleClick($element, $event)">
                                                #{#example#?.text}#</div>
                                            <div class="example-translation">#{#example#?.translatedText}#</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Dictionary Examples Section -->
                    <details class="examples-section" dr-if="#dict#?.examples && #dict#?.examples?.length > 0">
                        <summary class="examples-summary">
                            <i class="fas fa-book-open"></i>
                            예문 보기 (${#dict#?.examples.length}$개)
                        </summary>
                        <div class="examples-content">
                            <div class="example-item" dr-for-of="#dict#?.examples"
                                dr-option-item-variable-name="example">
                                <div class="example-text clickable-example"
                                    dr-event-click="@this@.onExampleClick($element, $event)">
                                    #{#example#?.text}#</div>
                                <div class="example-translation">#{#example#?.translatedText}#</div>
                            </div>
                        </div>
                    </details>
                </div>
                <div>
                    <iframe dr-if="!#dict#" src="https://lazycollect.com/assets/dooboostore/adfit/320x50.html" style="width: 100%; height: 50px;" frameborder="0"></iframe>
                </div>
            </div>
        </div>
    </div>

    <div class="scripts-section">
        <!-- Scripts Loading -->
        <div class="loading-container" dr-if="@this@.isLoadingScripts">
            <div class="loading-spinner"></div>
            <div class="loading-text">Loading scripts...</div>
        </div>

        <!-- YouTube Video Section (only for YouTube content) -->
        <div class="youtube-section" dr-if="@this@.currentItem?.type === 'youtube'">
            <div id="youtube-player-container">
                <!-- YouTube iframe will be inserted here -->
            </div>
        </div>

        <!-- Translation Items Section (YouTube only) -->
        <div class="translation-items-section" dr-if="@this@.currentItem?.type === 'youtube'">
            <div class="translation-content" dr-if="@this@.translations">
                <div class="translation-item" dr-for-of="@this@.translations" dr-option-item-variable-name="item"
                    dr-option-item-index-variable-name="index"
                    dr-attr="{'data-index': #index#, 'data-start-ms': #item#.startMs, 'data-end-ms': #item#.endMs, 'data-type': #item#.type}"
                    dr-event-click="#item#.type === 'en' && @this@.onTranslationItemClick(#index#, #item#.startMs, #item#.endMs, $event)">
                    <div class="translation-text" dr-attr="{class: 'translation-text ' + (#item#.type === 'en' ? 'english-text' : 'korean-text')}">${#item#?.text}$</div>
                </div>
            </div>
        </div>
        
        <!-- Fallback for non-YouTube content -->
        <div class="no-content" dr-if="@this@.currentItem?.type !== 'youtube'">
            <div class="no-content-message">Only YouTube content is supported</div>
        </div>
    </div>
</div>

<!-- Floating Controller -->
<div class="floating-controller">
    <button class="control-btn hide-words-btn" 
        dr-event-click="@this@.toggleHideWords()"
        dr-attr="{class: 'control-btn hide-words-btn' + (@this@.hideWordsEnabled ? ' active' : '')}"
        title="Hide random words">
        <i class="fas fa-eye-slash"></i>
    </button>
    
    <button class="control-btn auto-play-btn" 
        dr-event-click="@this@.toggleAutoPlay()"
        dr-attr="{class: 'control-btn auto-play-btn' + (@this@.autoPlayEnabled ? ' active' : '')}"
        title="Toggle auto play">
        <i class="fas fa-circle-play"></i>
    </button>
    
    <button class="control-btn replay-btn" 
        dr-event-click="@this@.replayCurrentCue()"
        title="Replay current subtitle">
        <i class="fas fa-rotate-right"></i>
    </button>
    
    <button class="nav-btn prev-btn" 
        dr-event-click="@this@.previousCue()"
        title="Previous subtitle">
        <i class="fas fa-chevron-left"></i>
    </button>
    
    <div class="slider-container">
        <input type="range" 
            class="global-word-slider" 
            min="-1" 
            dr-attr="{max: @this@.maxGlobalWordIndex, value: @this@.globalWordIndex}"
            dr-event-input="@this@.onGlobalWordSliderChange(parseInt($event.target.value))"
            title="Navigate through all words">
        <div class="slider-label-container">
            <button class="word-nav-btn" 
                dr-event-click="@this@.previousWord()"
                title="Previous word">
                <i class="fas fa-chevron-left"></i>
            </button>
            <div class="slider-label" dr-if="@this@.globalWordIndex >= 0">${@this@.globalWordIndex + 1}$ / ${@this@.maxGlobalWordIndex + 1}$</div>
            <div class="slider-label" dr-if="@this@.globalWordIndex < 0">Select word</div>
            <button class="word-nav-btn" 
                dr-event-click="@this@.nextWord()"
                title="Next word">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
    </div>
    
    <button class="nav-btn next-btn" 
        dr-event-click="@this@.nextCue()"
        title="Next subtitle">
        <i class="fas fa-chevron-right"></i>
    </button>
    
    <button class="control-btn korean-translation-btn" 
        dr-event-click="@this@.toggleKoreanTranslation()"
        dr-attr="{class: 'control-btn korean-translation-btn' + (@this@.showKoreanTranslation ? ' active' : '')}"
        title="Toggle Korean translation">
        <i class="fas fa-language"></i>
    </button>
</div>


/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "../../node_modules/.pnpm/reflect-metadata@0.2.2/node_modules/reflect-metadata/Reflect.js":
/*!************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/reflect-metadata@0.2.2/node_modules/reflect-metadata/Reflect.js ***!
  \************************************************************************************************/
/***/ ((__unused_webpack_module, __unused_webpack_exports, __webpack_require__) => {

/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var Reflect;
(function (Reflect) {
    // Metadata Proposal
    // https://rbuckton.github.io/reflect-metadata/
    (function (factory) {
        var root = typeof globalThis === "object" ? globalThis :
            typeof __webpack_require__.g === "object" ? __webpack_require__.g :
                typeof self === "object" ? self :
                    typeof this === "object" ? this :
                        sloppyModeThis();
        var exporter = makeExporter(Reflect);
        if (typeof root.Reflect !== "undefined") {
            exporter = makeExporter(root.Reflect, exporter);
        }
        factory(exporter, root);
        if (typeof root.Reflect === "undefined") {
            root.Reflect = Reflect;
        }
        function makeExporter(target, previous) {
            return function (key, value) {
                Object.defineProperty(target, key, { configurable: true, writable: true, value: value });
                if (previous)
                    previous(key, value);
            };
        }
        function functionThis() {
            try {
                return Function("return this;")();
            }
            catch (_) { }
        }
        function indirectEvalThis() {
            try {
                return (void 0, eval)("(function() { return this; })()");
            }
            catch (_) { }
        }
        function sloppyModeThis() {
            return functionThis() || indirectEvalThis();
        }
    })(function (exporter, root) {
        var hasOwn = Object.prototype.hasOwnProperty;
        // feature test for Symbol support
        var supportsSymbol = typeof Symbol === "function";
        var toPrimitiveSymbol = supportsSymbol && typeof Symbol.toPrimitive !== "undefined" ? Symbol.toPrimitive : "@@toPrimitive";
        var iteratorSymbol = supportsSymbol && typeof Symbol.iterator !== "undefined" ? Symbol.iterator : "@@iterator";
        var supportsCreate = typeof Object.create === "function"; // feature test for Object.create support
        var supportsProto = { __proto__: [] } instanceof Array; // feature test for __proto__ support
        var downLevel = !supportsCreate && !supportsProto;
        var HashMap = {
            // create an object in dictionary mode (a.k.a. "slow" mode in v8)
            create: supportsCreate
                ? function () { return MakeDictionary(Object.create(null)); }
                : supportsProto
                    ? function () { return MakeDictionary({ __proto__: null }); }
                    : function () { return MakeDictionary({}); },
            has: downLevel
                ? function (map, key) { return hasOwn.call(map, key); }
                : function (map, key) { return key in map; },
            get: downLevel
                ? function (map, key) { return hasOwn.call(map, key) ? map[key] : undefined; }
                : function (map, key) { return map[key]; },
        };
        // Load global or shim versions of Map, Set, and WeakMap
        var functionPrototype = Object.getPrototypeOf(Function);
        var _Map = typeof Map === "function" && typeof Map.prototype.entries === "function" ? Map : CreateMapPolyfill();
        var _Set = typeof Set === "function" && typeof Set.prototype.entries === "function" ? Set : CreateSetPolyfill();
        var _WeakMap = typeof WeakMap === "function" ? WeakMap : CreateWeakMapPolyfill();
        var registrySymbol = supportsSymbol ? Symbol.for("@reflect-metadata:registry") : undefined;
        var metadataRegistry = GetOrCreateMetadataRegistry();
        var metadataProvider = CreateMetadataProvider(metadataRegistry);
        /**
         * Applies a set of decorators to a property of a target object.
         * @param decorators An array of decorators.
         * @param target The target object.
         * @param propertyKey (Optional) The property key to decorate.
         * @param attributes (Optional) The property descriptor for the target key.
         * @remarks Decorators are applied in reverse order.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     Example = Reflect.decorate(decoratorsArray, Example);
         *
         *     // property (on constructor)
         *     Reflect.decorate(decoratorsArray, Example, "staticProperty");
         *
         *     // property (on prototype)
         *     Reflect.decorate(decoratorsArray, Example.prototype, "property");
         *
         *     // method (on constructor)
         *     Object.defineProperty(Example, "staticMethod",
         *         Reflect.decorate(decoratorsArray, Example, "staticMethod",
         *             Object.getOwnPropertyDescriptor(Example, "staticMethod")));
         *
         *     // method (on prototype)
         *     Object.defineProperty(Example.prototype, "method",
         *         Reflect.decorate(decoratorsArray, Example.prototype, "method",
         *             Object.getOwnPropertyDescriptor(Example.prototype, "method")));
         *
         */
        function decorate(decorators, target, propertyKey, attributes) {
            if (!IsUndefined(propertyKey)) {
                if (!IsArray(decorators))
                    throw new TypeError();
                if (!IsObject(target))
                    throw new TypeError();
                if (!IsObject(attributes) && !IsUndefined(attributes) && !IsNull(attributes))
                    throw new TypeError();
                if (IsNull(attributes))
                    attributes = undefined;
                propertyKey = ToPropertyKey(propertyKey);
                return DecorateProperty(decorators, target, propertyKey, attributes);
            }
            else {
                if (!IsArray(decorators))
                    throw new TypeError();
                if (!IsConstructor(target))
                    throw new TypeError();
                return DecorateConstructor(decorators, target);
            }
        }
        exporter("decorate", decorate);
        // 4.1.2 Reflect.metadata(metadataKey, metadataValue)
        // https://rbuckton.github.io/reflect-metadata/#reflect.metadata
        /**
         * A default metadata decorator factory that can be used on a class, class member, or parameter.
         * @param metadataKey The key for the metadata entry.
         * @param metadataValue The value for the metadata entry.
         * @returns A decorator function.
         * @remarks
         * If `metadataKey` is already defined for the target and target key, the
         * metadataValue for that key will be overwritten.
         * @example
         *
         *     // constructor
         *     @Reflect.metadata(key, value)
         *     class Example {
         *     }
         *
         *     // property (on constructor, TypeScript only)
         *     class Example {
         *         @Reflect.metadata(key, value)
         *         static staticProperty;
         *     }
         *
         *     // property (on prototype, TypeScript only)
         *     class Example {
         *         @Reflect.metadata(key, value)
         *         property;
         *     }
         *
         *     // method (on constructor)
         *     class Example {
         *         @Reflect.metadata(key, value)
         *         static staticMethod() { }
         *     }
         *
         *     // method (on prototype)
         *     class Example {
         *         @Reflect.metadata(key, value)
         *         method() { }
         *     }
         *
         */
        function metadata(metadataKey, metadataValue) {
            function decorator(target, propertyKey) {
                if (!IsObject(target))
                    throw new TypeError();
                if (!IsUndefined(propertyKey) && !IsPropertyKey(propertyKey))
                    throw new TypeError();
                OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);
            }
            return decorator;
        }
        exporter("metadata", metadata);
        /**
         * Define a unique metadata entry on the target.
         * @param metadataKey A key used to store and retrieve metadata.
         * @param metadataValue A value that contains attached metadata.
         * @param target The target object on which to define metadata.
         * @param propertyKey (Optional) The property key for the target.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     Reflect.defineMetadata("custom:annotation", options, Example);
         *
         *     // property (on constructor)
         *     Reflect.defineMetadata("custom:annotation", options, Example, "staticProperty");
         *
         *     // property (on prototype)
         *     Reflect.defineMetadata("custom:annotation", options, Example.prototype, "property");
         *
         *     // method (on constructor)
         *     Reflect.defineMetadata("custom:annotation", options, Example, "staticMethod");
         *
         *     // method (on prototype)
         *     Reflect.defineMetadata("custom:annotation", options, Example.prototype, "method");
         *
         *     // decorator factory as metadata-producing annotation.
         *     function MyAnnotation(options): Decorator {
         *         return (target, key?) => Reflect.defineMetadata("custom:annotation", options, target, key);
         *     }
         *
         */
        function defineMetadata(metadataKey, metadataValue, target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            return OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);
        }
        exporter("defineMetadata", defineMetadata);
        /**
         * Gets a value indicating whether the target object or its prototype chain has the provided metadata key defined.
         * @param metadataKey A key used to store and retrieve metadata.
         * @param target The target object on which the metadata is defined.
         * @param propertyKey (Optional) The property key for the target.
         * @returns `true` if the metadata key was defined on the target object or its prototype chain; otherwise, `false`.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     result = Reflect.hasMetadata("custom:annotation", Example);
         *
         *     // property (on constructor)
         *     result = Reflect.hasMetadata("custom:annotation", Example, "staticProperty");
         *
         *     // property (on prototype)
         *     result = Reflect.hasMetadata("custom:annotation", Example.prototype, "property");
         *
         *     // method (on constructor)
         *     result = Reflect.hasMetadata("custom:annotation", Example, "staticMethod");
         *
         *     // method (on prototype)
         *     result = Reflect.hasMetadata("custom:annotation", Example.prototype, "method");
         *
         */
        function hasMetadata(metadataKey, target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            return OrdinaryHasMetadata(metadataKey, target, propertyKey);
        }
        exporter("hasMetadata", hasMetadata);
        /**
         * Gets a value indicating whether the target object has the provided metadata key defined.
         * @param metadataKey A key used to store and retrieve metadata.
         * @param target The target object on which the metadata is defined.
         * @param propertyKey (Optional) The property key for the target.
         * @returns `true` if the metadata key was defined on the target object; otherwise, `false`.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     result = Reflect.hasOwnMetadata("custom:annotation", Example);
         *
         *     // property (on constructor)
         *     result = Reflect.hasOwnMetadata("custom:annotation", Example, "staticProperty");
         *
         *     // property (on prototype)
         *     result = Reflect.hasOwnMetadata("custom:annotation", Example.prototype, "property");
         *
         *     // method (on constructor)
         *     result = Reflect.hasOwnMetadata("custom:annotation", Example, "staticMethod");
         *
         *     // method (on prototype)
         *     result = Reflect.hasOwnMetadata("custom:annotation", Example.prototype, "method");
         *
         */
        function hasOwnMetadata(metadataKey, target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            return OrdinaryHasOwnMetadata(metadataKey, target, propertyKey);
        }
        exporter("hasOwnMetadata", hasOwnMetadata);
        /**
         * Gets the metadata value for the provided metadata key on the target object or its prototype chain.
         * @param metadataKey A key used to store and retrieve metadata.
         * @param target The target object on which the metadata is defined.
         * @param propertyKey (Optional) The property key for the target.
         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     result = Reflect.getMetadata("custom:annotation", Example);
         *
         *     // property (on constructor)
         *     result = Reflect.getMetadata("custom:annotation", Example, "staticProperty");
         *
         *     // property (on prototype)
         *     result = Reflect.getMetadata("custom:annotation", Example.prototype, "property");
         *
         *     // method (on constructor)
         *     result = Reflect.getMetadata("custom:annotation", Example, "staticMethod");
         *
         *     // method (on prototype)
         *     result = Reflect.getMetadata("custom:annotation", Example.prototype, "method");
         *
         */
        function getMetadata(metadataKey, target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            return OrdinaryGetMetadata(metadataKey, target, propertyKey);
        }
        exporter("getMetadata", getMetadata);
        /**
         * Gets the metadata value for the provided metadata key on the target object.
         * @param metadataKey A key used to store and retrieve metadata.
         * @param target The target object on which the metadata is defined.
         * @param propertyKey (Optional) The property key for the target.
         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     result = Reflect.getOwnMetadata("custom:annotation", Example);
         *
         *     // property (on constructor)
         *     result = Reflect.getOwnMetadata("custom:annotation", Example, "staticProperty");
         *
         *     // property (on prototype)
         *     result = Reflect.getOwnMetadata("custom:annotation", Example.prototype, "property");
         *
         *     // method (on constructor)
         *     result = Reflect.getOwnMetadata("custom:annotation", Example, "staticMethod");
         *
         *     // method (on prototype)
         *     result = Reflect.getOwnMetadata("custom:annotation", Example.prototype, "method");
         *
         */
        function getOwnMetadata(metadataKey, target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            return OrdinaryGetOwnMetadata(metadataKey, target, propertyKey);
        }
        exporter("getOwnMetadata", getOwnMetadata);
        /**
         * Gets the metadata keys defined on the target object or its prototype chain.
         * @param target The target object on which the metadata is defined.
         * @param propertyKey (Optional) The property key for the target.
         * @returns An array of unique metadata keys.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     result = Reflect.getMetadataKeys(Example);
         *
         *     // property (on constructor)
         *     result = Reflect.getMetadataKeys(Example, "staticProperty");
         *
         *     // property (on prototype)
         *     result = Reflect.getMetadataKeys(Example.prototype, "property");
         *
         *     // method (on constructor)
         *     result = Reflect.getMetadataKeys(Example, "staticMethod");
         *
         *     // method (on prototype)
         *     result = Reflect.getMetadataKeys(Example.prototype, "method");
         *
         */
        function getMetadataKeys(target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            return OrdinaryMetadataKeys(target, propertyKey);
        }
        exporter("getMetadataKeys", getMetadataKeys);
        /**
         * Gets the unique metadata keys defined on the target object.
         * @param target The target object on which the metadata is defined.
         * @param propertyKey (Optional) The property key for the target.
         * @returns An array of unique metadata keys.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     result = Reflect.getOwnMetadataKeys(Example);
         *
         *     // property (on constructor)
         *     result = Reflect.getOwnMetadataKeys(Example, "staticProperty");
         *
         *     // property (on prototype)
         *     result = Reflect.getOwnMetadataKeys(Example.prototype, "property");
         *
         *     // method (on constructor)
         *     result = Reflect.getOwnMetadataKeys(Example, "staticMethod");
         *
         *     // method (on prototype)
         *     result = Reflect.getOwnMetadataKeys(Example.prototype, "method");
         *
         */
        function getOwnMetadataKeys(target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            return OrdinaryOwnMetadataKeys(target, propertyKey);
        }
        exporter("getOwnMetadataKeys", getOwnMetadataKeys);
        /**
         * Deletes the metadata entry from the target object with the provided key.
         * @param metadataKey A key used to store and retrieve metadata.
         * @param target The target object on which the metadata is defined.
         * @param propertyKey (Optional) The property key for the target.
         * @returns `true` if the metadata entry was found and deleted; otherwise, false.
         * @example
         *
         *     class Example {
         *         // property declarations are not part of ES6, though they are valid in TypeScript:
         *         // static staticProperty;
         *         // property;
         *
         *         constructor(p) { }
         *         static staticMethod(p) { }
         *         method(p) { }
         *     }
         *
         *     // constructor
         *     result = Reflect.deleteMetadata("custom:annotation", Example);
         *
         *     // property (on constructor)
         *     result = Reflect.deleteMetadata("custom:annotation", Example, "staticProperty");
         *
         *     // property (on prototype)
         *     result = Reflect.deleteMetadata("custom:annotation", Example.prototype, "property");
         *
         *     // method (on constructor)
         *     result = Reflect.deleteMetadata("custom:annotation", Example, "staticMethod");
         *
         *     // method (on prototype)
         *     result = Reflect.deleteMetadata("custom:annotation", Example.prototype, "method");
         *
         */
        function deleteMetadata(metadataKey, target, propertyKey) {
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            if (!IsObject(target))
                throw new TypeError();
            if (!IsUndefined(propertyKey))
                propertyKey = ToPropertyKey(propertyKey);
            var provider = GetMetadataProvider(target, propertyKey, /*Create*/ false);
            if (IsUndefined(provider))
                return false;
            return provider.OrdinaryDeleteMetadata(metadataKey, target, propertyKey);
        }
        exporter("deleteMetadata", deleteMetadata);
        function DecorateConstructor(decorators, target) {
            for (var i = decorators.length - 1; i >= 0; --i) {
                var decorator = decorators[i];
                var decorated = decorator(target);
                if (!IsUndefined(decorated) && !IsNull(decorated)) {
                    if (!IsConstructor(decorated))
                        throw new TypeError();
                    target = decorated;
                }
            }
            return target;
        }
        function DecorateProperty(decorators, target, propertyKey, descriptor) {
            for (var i = decorators.length - 1; i >= 0; --i) {
                var decorator = decorators[i];
                var decorated = decorator(target, propertyKey, descriptor);
                if (!IsUndefined(decorated) && !IsNull(decorated)) {
                    if (!IsObject(decorated))
                        throw new TypeError();
                    descriptor = decorated;
                }
            }
            return descriptor;
        }
        // 3.1.1.1 OrdinaryHasMetadata(MetadataKey, O, P)
        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasmetadata
        function OrdinaryHasMetadata(MetadataKey, O, P) {
            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);
            if (hasOwn)
                return true;
            var parent = OrdinaryGetPrototypeOf(O);
            if (!IsNull(parent))
                return OrdinaryHasMetadata(MetadataKey, parent, P);
            return false;
        }
        // 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)
        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata
        function OrdinaryHasOwnMetadata(MetadataKey, O, P) {
            var provider = GetMetadataProvider(O, P, /*Create*/ false);
            if (IsUndefined(provider))
                return false;
            return ToBoolean(provider.OrdinaryHasOwnMetadata(MetadataKey, O, P));
        }
        // 3.1.3.1 OrdinaryGetMetadata(MetadataKey, O, P)
        // https://rbuckton.github.io/reflect-metadata/#ordinarygetmetadata
        function OrdinaryGetMetadata(MetadataKey, O, P) {
            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);
            if (hasOwn)
                return OrdinaryGetOwnMetadata(MetadataKey, O, P);
            var parent = OrdinaryGetPrototypeOf(O);
            if (!IsNull(parent))
                return OrdinaryGetMetadata(MetadataKey, parent, P);
            return undefined;
        }
        // 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)
        // https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata
        function OrdinaryGetOwnMetadata(MetadataKey, O, P) {
            var provider = GetMetadataProvider(O, P, /*Create*/ false);
            if (IsUndefined(provider))
                return;
            return provider.OrdinaryGetOwnMetadata(MetadataKey, O, P);
        }
        // 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)
        // https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata
        function OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {
            var provider = GetMetadataProvider(O, P, /*Create*/ true);
            provider.OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P);
        }
        // 3.1.6.1 OrdinaryMetadataKeys(O, P)
        // https://rbuckton.github.io/reflect-metadata/#ordinarymetadatakeys
        function OrdinaryMetadataKeys(O, P) {
            var ownKeys = OrdinaryOwnMetadataKeys(O, P);
            var parent = OrdinaryGetPrototypeOf(O);
            if (parent === null)
                return ownKeys;
            var parentKeys = OrdinaryMetadataKeys(parent, P);
            if (parentKeys.length <= 0)
                return ownKeys;
            if (ownKeys.length <= 0)
                return parentKeys;
            var set = new _Set();
            var keys = [];
            for (var _i = 0, ownKeys_1 = ownKeys; _i < ownKeys_1.length; _i++) {
                var key = ownKeys_1[_i];
                var hasKey = set.has(key);
                if (!hasKey) {
                    set.add(key);
                    keys.push(key);
                }
            }
            for (var _a = 0, parentKeys_1 = parentKeys; _a < parentKeys_1.length; _a++) {
                var key = parentKeys_1[_a];
                var hasKey = set.has(key);
                if (!hasKey) {
                    set.add(key);
                    keys.push(key);
                }
            }
            return keys;
        }
        // 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)
        // https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys
        function OrdinaryOwnMetadataKeys(O, P) {
            var provider = GetMetadataProvider(O, P, /*create*/ false);
            if (!provider) {
                return [];
            }
            return provider.OrdinaryOwnMetadataKeys(O, P);
        }
        // 6 ECMAScript Data Types and Values
        // https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values
        function Type(x) {
            if (x === null)
                return 1 /* Null */;
            switch (typeof x) {
                case "undefined": return 0 /* Undefined */;
                case "boolean": return 2 /* Boolean */;
                case "string": return 3 /* String */;
                case "symbol": return 4 /* Symbol */;
                case "number": return 5 /* Number */;
                case "object": return x === null ? 1 /* Null */ : 6 /* Object */;
                default: return 6 /* Object */;
            }
        }
        // 6.1.1 The Undefined Type
        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-undefined-type
        function IsUndefined(x) {
            return x === undefined;
        }
        // 6.1.2 The Null Type
        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-null-type
        function IsNull(x) {
            return x === null;
        }
        // 6.1.5 The Symbol Type
        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-symbol-type
        function IsSymbol(x) {
            return typeof x === "symbol";
        }
        // 6.1.7 The Object Type
        // https://tc39.github.io/ecma262/#sec-object-type
        function IsObject(x) {
            return typeof x === "object" ? x !== null : typeof x === "function";
        }
        // 7.1 Type Conversion
        // https://tc39.github.io/ecma262/#sec-type-conversion
        // 7.1.1 ToPrimitive(input [, PreferredType])
        // https://tc39.github.io/ecma262/#sec-toprimitive
        function ToPrimitive(input, PreferredType) {
            switch (Type(input)) {
                case 0 /* Undefined */: return input;
                case 1 /* Null */: return input;
                case 2 /* Boolean */: return input;
                case 3 /* String */: return input;
                case 4 /* Symbol */: return input;
                case 5 /* Number */: return input;
            }
            var hint = PreferredType === 3 /* String */ ? "string" : PreferredType === 5 /* Number */ ? "number" : "default";
            var exoticToPrim = GetMethod(input, toPrimitiveSymbol);
            if (exoticToPrim !== undefined) {
                var result = exoticToPrim.call(input, hint);
                if (IsObject(result))
                    throw new TypeError();
                return result;
            }
            return OrdinaryToPrimitive(input, hint === "default" ? "number" : hint);
        }
        // 7.1.1.1 OrdinaryToPrimitive(O, hint)
        // https://tc39.github.io/ecma262/#sec-ordinarytoprimitive
        function OrdinaryToPrimitive(O, hint) {
            if (hint === "string") {
                var toString_1 = O.toString;
                if (IsCallable(toString_1)) {
                    var result = toString_1.call(O);
                    if (!IsObject(result))
                        return result;
                }
                var valueOf = O.valueOf;
                if (IsCallable(valueOf)) {
                    var result = valueOf.call(O);
                    if (!IsObject(result))
                        return result;
                }
            }
            else {
                var valueOf = O.valueOf;
                if (IsCallable(valueOf)) {
                    var result = valueOf.call(O);
                    if (!IsObject(result))
                        return result;
                }
                var toString_2 = O.toString;
                if (IsCallable(toString_2)) {
                    var result = toString_2.call(O);
                    if (!IsObject(result))
                        return result;
                }
            }
            throw new TypeError();
        }
        // 7.1.2 ToBoolean(argument)
        // https://tc39.github.io/ecma262/2016/#sec-toboolean
        function ToBoolean(argument) {
            return !!argument;
        }
        // 7.1.12 ToString(argument)
        // https://tc39.github.io/ecma262/#sec-tostring
        function ToString(argument) {
            return "" + argument;
        }
        // 7.1.14 ToPropertyKey(argument)
        // https://tc39.github.io/ecma262/#sec-topropertykey
        function ToPropertyKey(argument) {
            var key = ToPrimitive(argument, 3 /* String */);
            if (IsSymbol(key))
                return key;
            return ToString(key);
        }
        // 7.2 Testing and Comparison Operations
        // https://tc39.github.io/ecma262/#sec-testing-and-comparison-operations
        // 7.2.2 IsArray(argument)
        // https://tc39.github.io/ecma262/#sec-isarray
        function IsArray(argument) {
            return Array.isArray
                ? Array.isArray(argument)
                : argument instanceof Object
                    ? argument instanceof Array
                    : Object.prototype.toString.call(argument) === "[object Array]";
        }
        // 7.2.3 IsCallable(argument)
        // https://tc39.github.io/ecma262/#sec-iscallable
        function IsCallable(argument) {
            // NOTE: This is an approximation as we cannot check for [[Call]] internal method.
            return typeof argument === "function";
        }
        // 7.2.4 IsConstructor(argument)
        // https://tc39.github.io/ecma262/#sec-isconstructor
        function IsConstructor(argument) {
            // NOTE: This is an approximation as we cannot check for [[Construct]] internal method.
            return typeof argument === "function";
        }
        // 7.2.7 IsPropertyKey(argument)
        // https://tc39.github.io/ecma262/#sec-ispropertykey
        function IsPropertyKey(argument) {
            switch (Type(argument)) {
                case 3 /* String */: return true;
                case 4 /* Symbol */: return true;
                default: return false;
            }
        }
        function SameValueZero(x, y) {
            return x === y || x !== x && y !== y;
        }
        // 7.3 Operations on Objects
        // https://tc39.github.io/ecma262/#sec-operations-on-objects
        // 7.3.9 GetMethod(V, P)
        // https://tc39.github.io/ecma262/#sec-getmethod
        function GetMethod(V, P) {
            var func = V[P];
            if (func === undefined || func === null)
                return undefined;
            if (!IsCallable(func))
                throw new TypeError();
            return func;
        }
        // 7.4 Operations on Iterator Objects
        // https://tc39.github.io/ecma262/#sec-operations-on-iterator-objects
        function GetIterator(obj) {
            var method = GetMethod(obj, iteratorSymbol);
            if (!IsCallable(method))
                throw new TypeError(); // from Call
            var iterator = method.call(obj);
            if (!IsObject(iterator))
                throw new TypeError();
            return iterator;
        }
        // 7.4.4 IteratorValue(iterResult)
        // https://tc39.github.io/ecma262/2016/#sec-iteratorvalue
        function IteratorValue(iterResult) {
            return iterResult.value;
        }
        // 7.4.5 IteratorStep(iterator)
        // https://tc39.github.io/ecma262/#sec-iteratorstep
        function IteratorStep(iterator) {
            var result = iterator.next();
            return result.done ? false : result;
        }
        // 7.4.6 IteratorClose(iterator, completion)
        // https://tc39.github.io/ecma262/#sec-iteratorclose
        function IteratorClose(iterator) {
            var f = iterator["return"];
            if (f)
                f.call(iterator);
        }
        // 9.1 Ordinary Object Internal Methods and Internal Slots
        // https://tc39.github.io/ecma262/#sec-ordinary-object-internal-methods-and-internal-slots
        // 9.1.1.1 OrdinaryGetPrototypeOf(O)
        // https://tc39.github.io/ecma262/#sec-ordinarygetprototypeof
        function OrdinaryGetPrototypeOf(O) {
            var proto = Object.getPrototypeOf(O);
            if (typeof O !== "function" || O === functionPrototype)
                return proto;
            // TypeScript doesn't set __proto__ in ES5, as it's non-standard.
            // Try to determine the superclass constructor. Compatible implementations
            // must either set __proto__ on a subclass constructor to the superclass constructor,
            // or ensure each class has a valid `constructor` property on its prototype that
            // points back to the constructor.
            // If this is not the same as Function.[[Prototype]], then this is definately inherited.
            // This is the case when in ES6 or when using __proto__ in a compatible browser.
            if (proto !== functionPrototype)
                return proto;
            // If the super prototype is Object.prototype, null, or undefined, then we cannot determine the heritage.
            var prototype = O.prototype;
            var prototypeProto = prototype && Object.getPrototypeOf(prototype);
            if (prototypeProto == null || prototypeProto === Object.prototype)
                return proto;
            // If the constructor was not a function, then we cannot determine the heritage.
            var constructor = prototypeProto.constructor;
            if (typeof constructor !== "function")
                return proto;
            // If we have some kind of self-reference, then we cannot determine the heritage.
            if (constructor === O)
                return proto;
            // we have a pretty good guess at the heritage.
            return constructor;
        }
        // Global metadata registry
        // - Allows `import "reflect-metadata"` and `import "reflect-metadata/no-conflict"` to interoperate.
        // - Uses isolated metadata if `Reflect` is frozen before the registry can be installed.
        /**
         * Creates a registry used to allow multiple `reflect-metadata` providers.
         */
        function CreateMetadataRegistry() {
            var fallback;
            if (!IsUndefined(registrySymbol) &&
                typeof root.Reflect !== "undefined" &&
                !(registrySymbol in root.Reflect) &&
                typeof root.Reflect.defineMetadata === "function") {
                // interoperate with older version of `reflect-metadata` that did not support a registry.
                fallback = CreateFallbackProvider(root.Reflect);
            }
            var first;
            var second;
            var rest;
            var targetProviderMap = new _WeakMap();
            var registry = {
                registerProvider: registerProvider,
                getProvider: getProvider,
                setProvider: setProvider,
            };
            return registry;
            function registerProvider(provider) {
                if (!Object.isExtensible(registry)) {
                    throw new Error("Cannot add provider to a frozen registry.");
                }
                switch (true) {
                    case fallback === provider: break;
                    case IsUndefined(first):
                        first = provider;
                        break;
                    case first === provider: break;
                    case IsUndefined(second):
                        second = provider;
                        break;
                    case second === provider: break;
                    default:
                        if (rest === undefined)
                            rest = new _Set();
                        rest.add(provider);
                        break;
                }
            }
            function getProviderNoCache(O, P) {
                if (!IsUndefined(first)) {
                    if (first.isProviderFor(O, P))
                        return first;
                    if (!IsUndefined(second)) {
                        if (second.isProviderFor(O, P))
                            return first;
                        if (!IsUndefined(rest)) {
                            var iterator = GetIterator(rest);
                            while (true) {
                                var next = IteratorStep(iterator);
                                if (!next) {
                                    return undefined;
                                }
                                var provider = IteratorValue(next);
                                if (provider.isProviderFor(O, P)) {
                                    IteratorClose(iterator);
                                    return provider;
                                }
                            }
                        }
                    }
                }
                if (!IsUndefined(fallback) && fallback.isProviderFor(O, P)) {
                    return fallback;
                }
                return undefined;
            }
            function getProvider(O, P) {
                var providerMap = targetProviderMap.get(O);
                var provider;
                if (!IsUndefined(providerMap)) {
                    provider = providerMap.get(P);
                }
                if (!IsUndefined(provider)) {
                    return provider;
                }
                provider = getProviderNoCache(O, P);
                if (!IsUndefined(provider)) {
                    if (IsUndefined(providerMap)) {
                        providerMap = new _Map();
                        targetProviderMap.set(O, providerMap);
                    }
                    providerMap.set(P, provider);
                }
                return provider;
            }
            function hasProvider(provider) {
                if (IsUndefined(provider))
                    throw new TypeError();
                return first === provider || second === provider || !IsUndefined(rest) && rest.has(provider);
            }
            function setProvider(O, P, provider) {
                if (!hasProvider(provider)) {
                    throw new Error("Metadata provider not registered.");
                }
                var existingProvider = getProvider(O, P);
                if (existingProvider !== provider) {
                    if (!IsUndefined(existingProvider)) {
                        return false;
                    }
                    var providerMap = targetProviderMap.get(O);
                    if (IsUndefined(providerMap)) {
                        providerMap = new _Map();
                        targetProviderMap.set(O, providerMap);
                    }
                    providerMap.set(P, provider);
                }
                return true;
            }
        }
        /**
         * Gets or creates the shared registry of metadata providers.
         */
        function GetOrCreateMetadataRegistry() {
            var metadataRegistry;
            if (!IsUndefined(registrySymbol) && IsObject(root.Reflect) && Object.isExtensible(root.Reflect)) {
                metadataRegistry = root.Reflect[registrySymbol];
            }
            if (IsUndefined(metadataRegistry)) {
                metadataRegistry = CreateMetadataRegistry();
            }
            if (!IsUndefined(registrySymbol) && IsObject(root.Reflect) && Object.isExtensible(root.Reflect)) {
                Object.defineProperty(root.Reflect, registrySymbol, {
                    enumerable: false,
                    configurable: false,
                    writable: false,
                    value: metadataRegistry
                });
            }
            return metadataRegistry;
        }
        function CreateMetadataProvider(registry) {
            // [[Metadata]] internal slot
            // https://rbuckton.github.io/reflect-metadata/#ordinary-object-internal-methods-and-internal-slots
            var metadata = new _WeakMap();
            var provider = {
                isProviderFor: function (O, P) {
                    var targetMetadata = metadata.get(O);
                    if (IsUndefined(targetMetadata))
                        return false;
                    return targetMetadata.has(P);
                },
                OrdinaryDefineOwnMetadata: OrdinaryDefineOwnMetadata,
                OrdinaryHasOwnMetadata: OrdinaryHasOwnMetadata,
                OrdinaryGetOwnMetadata: OrdinaryGetOwnMetadata,
                OrdinaryOwnMetadataKeys: OrdinaryOwnMetadataKeys,
                OrdinaryDeleteMetadata: OrdinaryDeleteMetadata,
            };
            metadataRegistry.registerProvider(provider);
            return provider;
            function GetOrCreateMetadataMap(O, P, Create) {
                var targetMetadata = metadata.get(O);
                var createdTargetMetadata = false;
                if (IsUndefined(targetMetadata)) {
                    if (!Create)
                        return undefined;
                    targetMetadata = new _Map();
                    metadata.set(O, targetMetadata);
                    createdTargetMetadata = true;
                }
                var metadataMap = targetMetadata.get(P);
                if (IsUndefined(metadataMap)) {
                    if (!Create)
                        return undefined;
                    metadataMap = new _Map();
                    targetMetadata.set(P, metadataMap);
                    if (!registry.setProvider(O, P, provider)) {
                        targetMetadata.delete(P);
                        if (createdTargetMetadata) {
                            metadata.delete(O);
                        }
                        throw new Error("Wrong provider for target.");
                    }
                }
                return metadataMap;
            }
            // 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)
            // https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata
            function OrdinaryHasOwnMetadata(MetadataKey, O, P) {
                var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);
                if (IsUndefined(metadataMap))
                    return false;
                return ToBoolean(metadataMap.has(MetadataKey));
            }
            // 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)
            // https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata
            function OrdinaryGetOwnMetadata(MetadataKey, O, P) {
                var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);
                if (IsUndefined(metadataMap))
                    return undefined;
                return metadataMap.get(MetadataKey);
            }
            // 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)
            // https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata
            function OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {
                var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ true);
                metadataMap.set(MetadataKey, MetadataValue);
            }
            // 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)
            // https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys
            function OrdinaryOwnMetadataKeys(O, P) {
                var keys = [];
                var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);
                if (IsUndefined(metadataMap))
                    return keys;
                var keysObj = metadataMap.keys();
                var iterator = GetIterator(keysObj);
                var k = 0;
                while (true) {
                    var next = IteratorStep(iterator);
                    if (!next) {
                        keys.length = k;
                        return keys;
                    }
                    var nextValue = IteratorValue(next);
                    try {
                        keys[k] = nextValue;
                    }
                    catch (e) {
                        try {
                            IteratorClose(iterator);
                        }
                        finally {
                            throw e;
                        }
                    }
                    k++;
                }
            }
            function OrdinaryDeleteMetadata(MetadataKey, O, P) {
                var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);
                if (IsUndefined(metadataMap))
                    return false;
                if (!metadataMap.delete(MetadataKey))
                    return false;
                if (metadataMap.size === 0) {
                    var targetMetadata = metadata.get(O);
                    if (!IsUndefined(targetMetadata)) {
                        targetMetadata.delete(P);
                        if (targetMetadata.size === 0) {
                            metadata.delete(targetMetadata);
                        }
                    }
                }
                return true;
            }
        }
        function CreateFallbackProvider(reflect) {
            var defineMetadata = reflect.defineMetadata, hasOwnMetadata = reflect.hasOwnMetadata, getOwnMetadata = reflect.getOwnMetadata, getOwnMetadataKeys = reflect.getOwnMetadataKeys, deleteMetadata = reflect.deleteMetadata;
            var metadataOwner = new _WeakMap();
            var provider = {
                isProviderFor: function (O, P) {
                    var metadataPropertySet = metadataOwner.get(O);
                    if (!IsUndefined(metadataPropertySet) && metadataPropertySet.has(P)) {
                        return true;
                    }
                    if (getOwnMetadataKeys(O, P).length) {
                        if (IsUndefined(metadataPropertySet)) {
                            metadataPropertySet = new _Set();
                            metadataOwner.set(O, metadataPropertySet);
                        }
                        metadataPropertySet.add(P);
                        return true;
                    }
                    return false;
                },
                OrdinaryDefineOwnMetadata: defineMetadata,
                OrdinaryHasOwnMetadata: hasOwnMetadata,
                OrdinaryGetOwnMetadata: getOwnMetadata,
                OrdinaryOwnMetadataKeys: getOwnMetadataKeys,
                OrdinaryDeleteMetadata: deleteMetadata,
            };
            return provider;
        }
        /**
         * Gets the metadata provider for an object. If the object has no metadata provider and this is for a create operation,
         * then this module's metadata provider is assigned to the object.
         */
        function GetMetadataProvider(O, P, Create) {
            var registeredProvider = metadataRegistry.getProvider(O, P);
            if (!IsUndefined(registeredProvider)) {
                return registeredProvider;
            }
            if (Create) {
                if (metadataRegistry.setProvider(O, P, metadataProvider)) {
                    return metadataProvider;
                }
                throw new Error("Illegal state.");
            }
            return undefined;
        }
        // naive Map shim
        function CreateMapPolyfill() {
            var cacheSentinel = {};
            var arraySentinel = [];
            var MapIterator = /** @class */ (function () {
                function MapIterator(keys, values, selector) {
                    this._index = 0;
                    this._keys = keys;
                    this._values = values;
                    this._selector = selector;
                }
                MapIterator.prototype["@@iterator"] = function () { return this; };
                MapIterator.prototype[iteratorSymbol] = function () { return this; };
                MapIterator.prototype.next = function () {
                    var index = this._index;
                    if (index >= 0 && index < this._keys.length) {
                        var result = this._selector(this._keys[index], this._values[index]);
                        if (index + 1 >= this._keys.length) {
                            this._index = -1;
                            this._keys = arraySentinel;
                            this._values = arraySentinel;
                        }
                        else {
                            this._index++;
                        }
                        return { value: result, done: false };
                    }
                    return { value: undefined, done: true };
                };
                MapIterator.prototype.throw = function (error) {
                    if (this._index >= 0) {
                        this._index = -1;
                        this._keys = arraySentinel;
                        this._values = arraySentinel;
                    }
                    throw error;
                };
                MapIterator.prototype.return = function (value) {
                    if (this._index >= 0) {
                        this._index = -1;
                        this._keys = arraySentinel;
                        this._values = arraySentinel;
                    }
                    return { value: value, done: true };
                };
                return MapIterator;
            }());
            var Map = /** @class */ (function () {
                function Map() {
                    this._keys = [];
                    this._values = [];
                    this._cacheKey = cacheSentinel;
                    this._cacheIndex = -2;
                }
                Object.defineProperty(Map.prototype, "size", {
                    get: function () { return this._keys.length; },
                    enumerable: true,
                    configurable: true
                });
                Map.prototype.has = function (key) { return this._find(key, /*insert*/ false) >= 0; };
                Map.prototype.get = function (key) {
                    var index = this._find(key, /*insert*/ false);
                    return index >= 0 ? this._values[index] : undefined;
                };
                Map.prototype.set = function (key, value) {
                    var index = this._find(key, /*insert*/ true);
                    this._values[index] = value;
                    return this;
                };
                Map.prototype.delete = function (key) {
                    var index = this._find(key, /*insert*/ false);
                    if (index >= 0) {
                        var size = this._keys.length;
                        for (var i = index + 1; i < size; i++) {
                            this._keys[i - 1] = this._keys[i];
                            this._values[i - 1] = this._values[i];
                        }
                        this._keys.length--;
                        this._values.length--;
                        if (SameValueZero(key, this._cacheKey)) {
                            this._cacheKey = cacheSentinel;
                            this._cacheIndex = -2;
                        }
                        return true;
                    }
                    return false;
                };
                Map.prototype.clear = function () {
                    this._keys.length = 0;
                    this._values.length = 0;
                    this._cacheKey = cacheSentinel;
                    this._cacheIndex = -2;
                };
                Map.prototype.keys = function () { return new MapIterator(this._keys, this._values, getKey); };
                Map.prototype.values = function () { return new MapIterator(this._keys, this._values, getValue); };
                Map.prototype.entries = function () { return new MapIterator(this._keys, this._values, getEntry); };
                Map.prototype["@@iterator"] = function () { return this.entries(); };
                Map.prototype[iteratorSymbol] = function () { return this.entries(); };
                Map.prototype._find = function (key, insert) {
                    if (!SameValueZero(this._cacheKey, key)) {
                        this._cacheIndex = -1;
                        for (var i = 0; i < this._keys.length; i++) {
                            if (SameValueZero(this._keys[i], key)) {
                                this._cacheIndex = i;
                                break;
                            }
                        }
                    }
                    if (this._cacheIndex < 0 && insert) {
                        this._cacheIndex = this._keys.length;
                        this._keys.push(key);
                        this._values.push(undefined);
                    }
                    return this._cacheIndex;
                };
                return Map;
            }());
            return Map;
            function getKey(key, _) {
                return key;
            }
            function getValue(_, value) {
                return value;
            }
            function getEntry(key, value) {
                return [key, value];
            }
        }
        // naive Set shim
        function CreateSetPolyfill() {
            var Set = /** @class */ (function () {
                function Set() {
                    this._map = new _Map();
                }
                Object.defineProperty(Set.prototype, "size", {
                    get: function () { return this._map.size; },
                    enumerable: true,
                    configurable: true
                });
                Set.prototype.has = function (value) { return this._map.has(value); };
                Set.prototype.add = function (value) { return this._map.set(value, value), this; };
                Set.prototype.delete = function (value) { return this._map.delete(value); };
                Set.prototype.clear = function () { this._map.clear(); };
                Set.prototype.keys = function () { return this._map.keys(); };
                Set.prototype.values = function () { return this._map.keys(); };
                Set.prototype.entries = function () { return this._map.entries(); };
                Set.prototype["@@iterator"] = function () { return this.keys(); };
                Set.prototype[iteratorSymbol] = function () { return this.keys(); };
                return Set;
            }());
            return Set;
        }
        // naive WeakMap shim
        function CreateWeakMapPolyfill() {
            var UUID_SIZE = 16;
            var keys = HashMap.create();
            var rootKey = CreateUniqueKey();
            return /** @class */ (function () {
                function WeakMap() {
                    this._key = CreateUniqueKey();
                }
                WeakMap.prototype.has = function (target) {
                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);
                    return table !== undefined ? HashMap.has(table, this._key) : false;
                };
                WeakMap.prototype.get = function (target) {
                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);
                    return table !== undefined ? HashMap.get(table, this._key) : undefined;
                };
                WeakMap.prototype.set = function (target, value) {
                    var table = GetOrCreateWeakMapTable(target, /*create*/ true);
                    table[this._key] = value;
                    return this;
                };
                WeakMap.prototype.delete = function (target) {
                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);
                    return table !== undefined ? delete table[this._key] : false;
                };
                WeakMap.prototype.clear = function () {
                    // NOTE: not a real clear, just makes the previous data unreachable
                    this._key = CreateUniqueKey();
                };
                return WeakMap;
            }());
            function CreateUniqueKey() {
                var key;
                do
                    key = "@@WeakMap@@" + CreateUUID();
                while (HashMap.has(keys, key));
                keys[key] = true;
                return key;
            }
            function GetOrCreateWeakMapTable(target, create) {
                if (!hasOwn.call(target, rootKey)) {
                    if (!create)
                        return undefined;
                    Object.defineProperty(target, rootKey, { value: HashMap.create() });
                }
                return target[rootKey];
            }
            function FillRandomBytes(buffer, size) {
                for (var i = 0; i < size; ++i)
                    buffer[i] = Math.random() * 0xff | 0;
                return buffer;
            }
            function GenRandomBytes(size) {
                if (typeof Uint8Array === "function") {
                    var array = new Uint8Array(size);
                    if (typeof crypto !== "undefined") {
                        crypto.getRandomValues(array);
                    }
                    else if (typeof msCrypto !== "undefined") {
                        msCrypto.getRandomValues(array);
                    }
                    else {
                        FillRandomBytes(array, size);
                    }
                    return array;
                }
                return FillRandomBytes(new Array(size), size);
            }
            function CreateUUID() {
                var data = GenRandomBytes(UUID_SIZE);
                // mark as random - RFC 4122  4.4
                data[6] = data[6] & 0x4f | 0x40;
                data[8] = data[8] & 0xbf | 0x80;
                var result = "";
                for (var offset = 0; offset < UUID_SIZE; ++offset) {
                    var byte = data[offset];
                    if (offset === 4 || offset === 6 || offset === 8)
                        result += "-";
                    if (byte < 16)
                        result += "0";
                    result += byte.toString(16).toLowerCase();
                }
                return result;
            }
        }
        // uses a heuristic used by v8 and chakra to force an object into dictionary mode.
        function MakeDictionary(obj) {
            obj.__ = undefined;
            delete obj.__;
            return obj;
        }
    });
})(Reflect || (Reflect = {}));


/***/ }),

/***/ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/NotificationFactories.js":
/*!*********************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/NotificationFactories.js ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   COMPLETE_NOTIFICATION: () => (/* binding */ COMPLETE_NOTIFICATION),
/* harmony export */   createNotification: () => (/* binding */ createNotification),
/* harmony export */   errorNotification: () => (/* binding */ errorNotification),
/* harmony export */   nextNotification: () => (/* binding */ nextNotification)
/* harmony export */ });
var COMPLETE_NOTIFICATION = (function () { return createNotification('C', undefined, undefined); })();
function errorNotification(error) {
    return createNotification('E', undefined, error);
}
function nextNotification(value) {
    return createNotification('N', value, undefined);
}
function createNotification(kind, value, error) {
    return {
        kind: kind,
        value: value,
        error: error,
    };
}
//# sourceMappingURL=NotificationFactories.js.map

/***/ }),

/***/ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/Observable.js":
/*!**********************************************************************************************!*\
  !*** ../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/Observable.js ***!
  \**********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Observable: () => (/* binding */ Observable)
/* harmony export */ });
/* harmony import */ var _Subscriber__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Subscriber */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/Subscriber.js");
/* harmony import */ var _Subscription__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Subscription */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/Subscription.js");
/* harmony import */ var _symbol_observable__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./symbol/observable */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/symbol/observable.js");
/* harmony import */ var _util_pipe__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./util/pipe */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/pipe.js");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./config */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/config.js");
/* harmony import */ var _util_isFunction__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./util/isFunction */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/isFunction.js");
/* harmony import */ var _util_errorContext__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./util/errorContext */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/errorContext.js");







var Observable = (function () {
    function Observable(subscribe) {
        if (subscribe) {
            this._subscribe = subscribe;
        }
    }
    Observable.prototype.lift = function (operator) {
        var observable = new Observable();
        observable.source = this;
        observable.operator = operator;
        return observable;
    };
    Observable.prototype.subscribe = function (observerOrNext, error, complete) {
        var _this = this;
        var subscriber = isSubscriber(observerOrNext) ? observerOrNext : new _Subscriber__WEBPACK_IMPORTED_MODULE_0__.SafeSubscriber(observerOrNext, error, complete);
        (0,_util_errorContext__WEBPACK_IMPORTED_MODULE_6__.errorContext)(function () {
            var _a = _this, operator = _a.operator, source = _a.source;
            subscriber.add(operator
                ?
                    operator.call(subscriber, source)
                : source
                    ?
                        _this._subscribe(subscriber)
                    :
                        _this._trySubscribe(subscriber));
        });
        return subscriber;
    };
    Observable.prototype._trySubscribe = function (sink) {
        try {
            return this._subscribe(sink);
        }
        catch (err) {
            sink.error(err);
        }
    };
    Observable.prototype.forEach = function (next, promiseCtor) {
        var _this = this;
        promiseCtor = getPromiseCtor(promiseCtor);
        return new promiseCtor(function (resolve, reject) {
            var subscriber = new _Subscriber__WEBPACK_IMPORTED_MODULE_0__.SafeSubscriber({
                next: function (value) {
                    try {
                        next(value);
                    }
                    catch (err) {
                        reject(err);
                        subscriber.unsubscribe();
                    }
                },
                error: reject,
                complete: resolve,
            });
            _this.subscribe(subscriber);
        });
    };
    Observable.prototype._subscribe = function (subscriber) {
        var _a;
        return (_a = this.source) === null || _a === void 0 ? void 0 : _a.subscribe(subscriber);
    };
    Observable.prototype[_symbol_observable__WEBPACK_IMPORTED_MODULE_2__.observable] = function () {
        return this;
    };
    Observable.prototype.pipe = function () {
        var operations = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            operations[_i] = arguments[_i];
        }
        return (0,_util_pipe__WEBPACK_IMPORTED_MODULE_3__.pipeFromArray)(operations)(this);
    };
    Observable.prototype.toPromise = function (promiseCtor) {
        var _this = this;
        promiseCtor = getPromiseCtor(promiseCtor);
        return new promiseCtor(function (resolve, reject) {
            var value;
            _this.subscribe(function (x) { return (value = x); }, function (err) { return reject(err); }, function () { return resolve(value); });
        });
    };
    Observable.create = function (subscribe) {
        return new Observable(subscribe);
    };
    return Observable;
}());

function getPromiseCtor(promiseCtor) {
    var _a;
    return (_a = promiseCtor !== null && promiseCtor !== void 0 ? promiseCtor : _config__WEBPACK_IMPORTED_MODULE_4__.config.Promise) !== null && _a !== void 0 ? _a : Promise;
}
function isObserver(value) {
    return value && (0,_util_isFunction__WEBPACK_IMPORTED_MODULE_5__.isFunction)(value.next) && (0,_util_isFunction__WEBPACK_IMPORTED_MODULE_5__.isFunction)(value.error) && (0,_util_isFunction__WEBPACK_IMPORTED_MODULE_5__.isFunction)(value.complete);
}
function isSubscriber(value) {
    return (value && value instanceof _Subscriber__WEBPACK_IMPORTED_MODULE_0__.Subscriber) || (isObserver(value) && (0,_Subscription__WEBPACK_IMPORTED_MODULE_1__.isSubscription)(value));
}
//# sourceMappingURL=Observable.js.map

/***/ }),

/***/ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/Subject.js":
/*!*******************************************************************************************!*\
  !*** ../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/Subject.js ***!
  \*******************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AnonymousSubject: () => (/* binding */ AnonymousSubject),
/* harmony export */   Subject: () => (/* binding */ Subject)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Observable */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/Observable.js");
/* harmony import */ var _Subscription__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Subscription */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/Subscription.js");
/* harmony import */ var _util_ObjectUnsubscribedError__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./util/ObjectUnsubscribedError */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/ObjectUnsubscribedError.js");
/* harmony import */ var _util_arrRemove__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./util/arrRemove */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/arrRemove.js");
/* harmony import */ var _util_errorContext__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./util/errorContext */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/errorContext.js");






var Subject = (function (_super) {
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__extends)(Subject, _super);
    function Subject() {
        var _this = _super.call(this) || this;
        _this.closed = false;
        _this.currentObservers = null;
        _this.observers = [];
        _this.isStopped = false;
        _this.hasError = false;
        _this.thrownError = null;
        return _this;
    }
    Subject.prototype.lift = function (operator) {
        var subject = new AnonymousSubject(this, this);
        subject.operator = operator;
        return subject;
    };
    Subject.prototype._throwIfClosed = function () {
        if (this.closed) {
            throw new _util_ObjectUnsubscribedError__WEBPACK_IMPORTED_MODULE_3__.ObjectUnsubscribedError();
        }
    };
    Subject.prototype.next = function (value) {
        var _this = this;
        (0,_util_errorContext__WEBPACK_IMPORTED_MODULE_5__.errorContext)(function () {
            var e_1, _a;
            _this._throwIfClosed();
            if (!_this.isStopped) {
                if (!_this.currentObservers) {
                    _this.currentObservers = Array.from(_this.observers);
                }
                try {
                    for (var _b = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__values)(_this.currentObservers), _c = _b.next(); !_c.done; _c = _b.next()) {
                        var observer = _c.value;
                        observer.next(value);
                    }
                }
                catch (e_1_1) { e_1 = { error: e_1_1 }; }
                finally {
                    try {
                        if (_c && !_c.done && (_a = _b.return)) _a.call(_b);
                    }
                    finally { if (e_1) throw e_1.error; }
                }
            }
        });
    };
    Subject.prototype.error = function (err) {
        var _this = this;
        (0,_util_errorContext__WEBPACK_IMPORTED_MODULE_5__.errorContext)(function () {
            _this._throwIfClosed();
            if (!_this.isStopped) {
                _this.hasError = _this.isStopped = true;
                _this.thrownError = err;
                var observers = _this.observers;
                while (observers.length) {
                    observers.shift().error(err);
                }
            }
        });
    };
    Subject.prototype.complete = function () {
        var _this = this;
        (0,_util_errorContext__WEBPACK_IMPORTED_MODULE_5__.errorContext)(function () {
            _this._throwIfClosed();
            if (!_this.isStopped) {
                _this.isStopped = true;
                var observers = _this.observers;
                while (observers.length) {
                    observers.shift().complete();
                }
            }
        });
    };
    Subject.prototype.unsubscribe = function () {
        this.isStopped = this.closed = true;
        this.observers = this.currentObservers = null;
    };
    Object.defineProperty(Subject.prototype, "observed", {
        get: function () {
            var _a;
            return ((_a = this.observers) === null || _a === void 0 ? void 0 : _a.length) > 0;
        },
        enumerable: false,
        configurable: true
    });
    Subject.prototype._trySubscribe = function (subscriber) {
        this._throwIfClosed();
        return _super.prototype._trySubscribe.call(this, subscriber);
    };
    Subject.prototype._subscribe = function (subscriber) {
        this._throwIfClosed();
        this._checkFinalizedStatuses(subscriber);
        return this._innerSubscribe(subscriber);
    };
    Subject.prototype._innerSubscribe = function (subscriber) {
        var _this = this;
        var _a = this, hasError = _a.hasError, isStopped = _a.isStopped, observers = _a.observers;
        if (hasError || isStopped) {
            return _Subscription__WEBPACK_IMPORTED_MODULE_2__.EMPTY_SUBSCRIPTION;
        }
        this.currentObservers = null;
        observers.push(subscriber);
        return new _Subscription__WEBPACK_IMPORTED_MODULE_2__.Subscription(function () {
            _this.currentObservers = null;
            (0,_util_arrRemove__WEBPACK_IMPORTED_MODULE_4__.arrRemove)(observers, subscriber);
        });
    };
    Subject.prototype._checkFinalizedStatuses = function (subscriber) {
        var _a = this, hasError = _a.hasError, thrownError = _a.thrownError, isStopped = _a.isStopped;
        if (hasError) {
            subscriber.error(thrownError);
        }
        else if (isStopped) {
            subscriber.complete();
        }
    };
    Subject.prototype.asObservable = function () {
        var observable = new _Observable__WEBPACK_IMPORTED_MODULE_1__.Observable();
        observable.source = this;
        return observable;
    };
    Subject.create = function (destination, source) {
        return new AnonymousSubject(destination, source);
    };
    return Subject;
}(_Observable__WEBPACK_IMPORTED_MODULE_1__.Observable));

var AnonymousSubject = (function (_super) {
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__extends)(AnonymousSubject, _super);
    function AnonymousSubject(destination, source) {
        var _this = _super.call(this) || this;
        _this.destination = destination;
        _this.source = source;
        return _this;
    }
    AnonymousSubject.prototype.next = function (value) {
        var _a, _b;
        (_b = (_a = this.destination) === null || _a === void 0 ? void 0 : _a.next) === null || _b === void 0 ? void 0 : _b.call(_a, value);
    };
    AnonymousSubject.prototype.error = function (err) {
        var _a, _b;
        (_b = (_a = this.destination) === null || _a === void 0 ? void 0 : _a.error) === null || _b === void 0 ? void 0 : _b.call(_a, err);
    };
    AnonymousSubject.prototype.complete = function () {
        var _a, _b;
        (_b = (_a = this.destination) === null || _a === void 0 ? void 0 : _a.complete) === null || _b === void 0 ? void 0 : _b.call(_a);
    };
    AnonymousSubject.prototype._subscribe = function (subscriber) {
        var _a, _b;
        return (_b = (_a = this.source) === null || _a === void 0 ? void 0 : _a.subscribe(subscriber)) !== null && _b !== void 0 ? _b : _Subscription__WEBPACK_IMPORTED_MODULE_2__.EMPTY_SUBSCRIPTION;
    };
    return AnonymousSubject;
}(Subject));

//# sourceMappingURL=Subject.js.map

/***/ }),

/***/ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/Subscriber.js":
/*!**********************************************************************************************!*\
  !*** ../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/Subscriber.js ***!
  \**********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   EMPTY_OBSERVER: () => (/* binding */ EMPTY_OBSERVER),
/* harmony export */   SafeSubscriber: () => (/* binding */ SafeSubscriber),
/* harmony export */   Subscriber: () => (/* binding */ Subscriber)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _util_isFunction__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./util/isFunction */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/isFunction.js");
/* harmony import */ var _Subscription__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Subscription */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/Subscription.js");
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./config */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/config.js");
/* harmony import */ var _util_reportUnhandledError__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./util/reportUnhandledError */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/reportUnhandledError.js");
/* harmony import */ var _util_noop__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./util/noop */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/noop.js");
/* harmony import */ var _NotificationFactories__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./NotificationFactories */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/NotificationFactories.js");
/* harmony import */ var _scheduler_timeoutProvider__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./scheduler/timeoutProvider */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/scheduler/timeoutProvider.js");
/* harmony import */ var _util_errorContext__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./util/errorContext */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/errorContext.js");









var Subscriber = (function (_super) {
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__extends)(Subscriber, _super);
    function Subscriber(destination) {
        var _this = _super.call(this) || this;
        _this.isStopped = false;
        if (destination) {
            _this.destination = destination;
            if ((0,_Subscription__WEBPACK_IMPORTED_MODULE_2__.isSubscription)(destination)) {
                destination.add(_this);
            }
        }
        else {
            _this.destination = EMPTY_OBSERVER;
        }
        return _this;
    }
    Subscriber.create = function (next, error, complete) {
        return new SafeSubscriber(next, error, complete);
    };
    Subscriber.prototype.next = function (value) {
        if (this.isStopped) {
            handleStoppedNotification((0,_NotificationFactories__WEBPACK_IMPORTED_MODULE_6__.nextNotification)(value), this);
        }
        else {
            this._next(value);
        }
    };
    Subscriber.prototype.error = function (err) {
        if (this.isStopped) {
            handleStoppedNotification((0,_NotificationFactories__WEBPACK_IMPORTED_MODULE_6__.errorNotification)(err), this);
        }
        else {
            this.isStopped = true;
            this._error(err);
        }
    };
    Subscriber.prototype.complete = function () {
        if (this.isStopped) {
            handleStoppedNotification(_NotificationFactories__WEBPACK_IMPORTED_MODULE_6__.COMPLETE_NOTIFICATION, this);
        }
        else {
            this.isStopped = true;
            this._complete();
        }
    };
    Subscriber.prototype.unsubscribe = function () {
        if (!this.closed) {
            this.isStopped = true;
            _super.prototype.unsubscribe.call(this);
            this.destination = null;
        }
    };
    Subscriber.prototype._next = function (value) {
        this.destination.next(value);
    };
    Subscriber.prototype._error = function (err) {
        try {
            this.destination.error(err);
        }
        finally {
            this.unsubscribe();
        }
    };
    Subscriber.prototype._complete = function () {
        try {
            this.destination.complete();
        }
        finally {
            this.unsubscribe();
        }
    };
    return Subscriber;
}(_Subscription__WEBPACK_IMPORTED_MODULE_2__.Subscription));

var _bind = Function.prototype.bind;
function bind(fn, thisArg) {
    return _bind.call(fn, thisArg);
}
var ConsumerObserver = (function () {
    function ConsumerObserver(partialObserver) {
        this.partialObserver = partialObserver;
    }
    ConsumerObserver.prototype.next = function (value) {
        var partialObserver = this.partialObserver;
        if (partialObserver.next) {
            try {
                partialObserver.next(value);
            }
            catch (error) {
                handleUnhandledError(error);
            }
        }
    };
    ConsumerObserver.prototype.error = function (err) {
        var partialObserver = this.partialObserver;
        if (partialObserver.error) {
            try {
                partialObserver.error(err);
            }
            catch (error) {
                handleUnhandledError(error);
            }
        }
        else {
            handleUnhandledError(err);
        }
    };
    ConsumerObserver.prototype.complete = function () {
        var partialObserver = this.partialObserver;
        if (partialObserver.complete) {
            try {
                partialObserver.complete();
            }
            catch (error) {
                handleUnhandledError(error);
            }
        }
    };
    return ConsumerObserver;
}());
var SafeSubscriber = (function (_super) {
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__extends)(SafeSubscriber, _super);
    function SafeSubscriber(observerOrNext, error, complete) {
        var _this = _super.call(this) || this;
        var partialObserver;
        if ((0,_util_isFunction__WEBPACK_IMPORTED_MODULE_1__.isFunction)(observerOrNext) || !observerOrNext) {
            partialObserver = {
                next: (observerOrNext !== null && observerOrNext !== void 0 ? observerOrNext : undefined),
                error: error !== null && error !== void 0 ? error : undefined,
                complete: complete !== null && complete !== void 0 ? complete : undefined,
            };
        }
        else {
            var context_1;
            if (_this && _config__WEBPACK_IMPORTED_MODULE_3__.config.useDeprecatedNextContext) {
                context_1 = Object.create(observerOrNext);
                context_1.unsubscribe = function () { return _this.unsubscribe(); };
                partialObserver = {
                    next: observerOrNext.next && bind(observerOrNext.next, context_1),
                    error: observerOrNext.error && bind(observerOrNext.error, context_1),
                    complete: observerOrNext.complete && bind(observerOrNext.complete, context_1),
                };
            }
            else {
                partialObserver = observerOrNext;
            }
        }
        _this.destination = new ConsumerObserver(partialObserver);
        return _this;
    }
    return SafeSubscriber;
}(Subscriber));

function handleUnhandledError(error) {
    if (_config__WEBPACK_IMPORTED_MODULE_3__.config.useDeprecatedSynchronousErrorHandling) {
        (0,_util_errorContext__WEBPACK_IMPORTED_MODULE_8__.captureError)(error);
    }
    else {
        (0,_util_reportUnhandledError__WEBPACK_IMPORTED_MODULE_4__.reportUnhandledError)(error);
    }
}
function defaultErrorHandler(err) {
    throw err;
}
function handleStoppedNotification(notification, subscriber) {
    var onStoppedNotification = _config__WEBPACK_IMPORTED_MODULE_3__.config.onStoppedNotification;
    onStoppedNotification && _scheduler_timeoutProvider__WEBPACK_IMPORTED_MODULE_7__.timeoutProvider.setTimeout(function () { return onStoppedNotification(notification, subscriber); });
}
var EMPTY_OBSERVER = {
    closed: true,
    next: _util_noop__WEBPACK_IMPORTED_MODULE_5__.noop,
    error: defaultErrorHandler,
    complete: _util_noop__WEBPACK_IMPORTED_MODULE_5__.noop,
};
//# sourceMappingURL=Subscriber.js.map

/***/ }),

/***/ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/Subscription.js":
/*!************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/Subscription.js ***!
  \************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   EMPTY_SUBSCRIPTION: () => (/* binding */ EMPTY_SUBSCRIPTION),
/* harmony export */   Subscription: () => (/* binding */ Subscription),
/* harmony export */   isSubscription: () => (/* binding */ isSubscription)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _util_isFunction__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./util/isFunction */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/isFunction.js");
/* harmony import */ var _util_UnsubscriptionError__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./util/UnsubscriptionError */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/UnsubscriptionError.js");
/* harmony import */ var _util_arrRemove__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./util/arrRemove */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/arrRemove.js");




var Subscription = (function () {
    function Subscription(initialTeardown) {
        this.initialTeardown = initialTeardown;
        this.closed = false;
        this._parentage = null;
        this._finalizers = null;
    }
    Subscription.prototype.unsubscribe = function () {
        var e_1, _a, e_2, _b;
        var errors;
        if (!this.closed) {
            this.closed = true;
            var _parentage = this._parentage;
            if (_parentage) {
                this._parentage = null;
                if (Array.isArray(_parentage)) {
                    try {
                        for (var _parentage_1 = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__values)(_parentage), _parentage_1_1 = _parentage_1.next(); !_parentage_1_1.done; _parentage_1_1 = _parentage_1.next()) {
                            var parent_1 = _parentage_1_1.value;
                            parent_1.remove(this);
                        }
                    }
                    catch (e_1_1) { e_1 = { error: e_1_1 }; }
                    finally {
                        try {
                            if (_parentage_1_1 && !_parentage_1_1.done && (_a = _parentage_1.return)) _a.call(_parentage_1);
                        }
                        finally { if (e_1) throw e_1.error; }
                    }
                }
                else {
                    _parentage.remove(this);
                }
            }
            var initialFinalizer = this.initialTeardown;
            if ((0,_util_isFunction__WEBPACK_IMPORTED_MODULE_1__.isFunction)(initialFinalizer)) {
                try {
                    initialFinalizer();
                }
                catch (e) {
                    errors = e instanceof _util_UnsubscriptionError__WEBPACK_IMPORTED_MODULE_2__.UnsubscriptionError ? e.errors : [e];
                }
            }
            var _finalizers = this._finalizers;
            if (_finalizers) {
                this._finalizers = null;
                try {
                    for (var _finalizers_1 = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__values)(_finalizers), _finalizers_1_1 = _finalizers_1.next(); !_finalizers_1_1.done; _finalizers_1_1 = _finalizers_1.next()) {
                        var finalizer = _finalizers_1_1.value;
                        try {
                            execFinalizer(finalizer);
                        }
                        catch (err) {
                            errors = errors !== null && errors !== void 0 ? errors : [];
                            if (err instanceof _util_UnsubscriptionError__WEBPACK_IMPORTED_MODULE_2__.UnsubscriptionError) {
                                errors = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__spreadArray)((0,tslib__WEBPACK_IMPORTED_MODULE_0__.__spreadArray)([], (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(errors)), (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(err.errors));
                            }
                            else {
                                errors.push(err);
                            }
                        }
                    }
                }
                catch (e_2_1) { e_2 = { error: e_2_1 }; }
                finally {
                    try {
                        if (_finalizers_1_1 && !_finalizers_1_1.done && (_b = _finalizers_1.return)) _b.call(_finalizers_1);
                    }
                    finally { if (e_2) throw e_2.error; }
                }
            }
            if (errors) {
                throw new _util_UnsubscriptionError__WEBPACK_IMPORTED_MODULE_2__.UnsubscriptionError(errors);
            }
        }
    };
    Subscription.prototype.add = function (teardown) {
        var _a;
        if (teardown && teardown !== this) {
            if (this.closed) {
                execFinalizer(teardown);
            }
            else {
                if (teardown instanceof Subscription) {
                    if (teardown.closed || teardown._hasParent(this)) {
                        return;
                    }
                    teardown._addParent(this);
                }
                (this._finalizers = (_a = this._finalizers) !== null && _a !== void 0 ? _a : []).push(teardown);
            }
        }
    };
    Subscription.prototype._hasParent = function (parent) {
        var _parentage = this._parentage;
        return _parentage === parent || (Array.isArray(_parentage) && _parentage.includes(parent));
    };
    Subscription.prototype._addParent = function (parent) {
        var _parentage = this._parentage;
        this._parentage = Array.isArray(_parentage) ? (_parentage.push(parent), _parentage) : _parentage ? [_parentage, parent] : parent;
    };
    Subscription.prototype._removeParent = function (parent) {
        var _parentage = this._parentage;
        if (_parentage === parent) {
            this._parentage = null;
        }
        else if (Array.isArray(_parentage)) {
            (0,_util_arrRemove__WEBPACK_IMPORTED_MODULE_3__.arrRemove)(_parentage, parent);
        }
    };
    Subscription.prototype.remove = function (teardown) {
        var _finalizers = this._finalizers;
        _finalizers && (0,_util_arrRemove__WEBPACK_IMPORTED_MODULE_3__.arrRemove)(_finalizers, teardown);
        if (teardown instanceof Subscription) {
            teardown._removeParent(this);
        }
    };
    Subscription.EMPTY = (function () {
        var empty = new Subscription();
        empty.closed = true;
        return empty;
    })();
    return Subscription;
}());

var EMPTY_SUBSCRIPTION = Subscription.EMPTY;
function isSubscription(value) {
    return (value instanceof Subscription ||
        (value && 'closed' in value && (0,_util_isFunction__WEBPACK_IMPORTED_MODULE_1__.isFunction)(value.remove) && (0,_util_isFunction__WEBPACK_IMPORTED_MODULE_1__.isFunction)(value.add) && (0,_util_isFunction__WEBPACK_IMPORTED_MODULE_1__.isFunction)(value.unsubscribe)));
}
function execFinalizer(finalizer) {
    if ((0,_util_isFunction__WEBPACK_IMPORTED_MODULE_1__.isFunction)(finalizer)) {
        finalizer();
    }
    else {
        finalizer.unsubscribe();
    }
}
//# sourceMappingURL=Subscription.js.map

/***/ }),

/***/ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/config.js":
/*!******************************************************************************************!*\
  !*** ../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/config.js ***!
  \******************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   config: () => (/* binding */ config)
/* harmony export */ });
var config = {
    onUnhandledError: null,
    onStoppedNotification: null,
    Promise: undefined,
    useDeprecatedSynchronousErrorHandling: false,
    useDeprecatedNextContext: false,
};
//# sourceMappingURL=config.js.map

/***/ }),

/***/ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/scheduler/timeoutProvider.js":
/*!*************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/scheduler/timeoutProvider.js ***!
  \*************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   timeoutProvider: () => (/* binding */ timeoutProvider)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");

var timeoutProvider = {
    setTimeout: function (handler, timeout) {
        var args = [];
        for (var _i = 2; _i < arguments.length; _i++) {
            args[_i - 2] = arguments[_i];
        }
        var delegate = timeoutProvider.delegate;
        if (delegate === null || delegate === void 0 ? void 0 : delegate.setTimeout) {
            return delegate.setTimeout.apply(delegate, (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__spreadArray)([handler, timeout], (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(args)));
        }
        return setTimeout.apply(void 0, (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__spreadArray)([handler, timeout], (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__read)(args)));
    },
    clearTimeout: function (handle) {
        var delegate = timeoutProvider.delegate;
        return ((delegate === null || delegate === void 0 ? void 0 : delegate.clearTimeout) || clearTimeout)(handle);
    },
    delegate: undefined,
};
//# sourceMappingURL=timeoutProvider.js.map

/***/ }),

/***/ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/symbol/observable.js":
/*!*****************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/symbol/observable.js ***!
  \*****************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   observable: () => (/* binding */ observable)
/* harmony export */ });
var observable = (function () { return (typeof Symbol === 'function' && Symbol.observable) || '@@observable'; })();
//# sourceMappingURL=observable.js.map

/***/ }),

/***/ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/ObjectUnsubscribedError.js":
/*!****************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/ObjectUnsubscribedError.js ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ObjectUnsubscribedError: () => (/* binding */ ObjectUnsubscribedError)
/* harmony export */ });
/* harmony import */ var _createErrorClass__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./createErrorClass */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/createErrorClass.js");

var ObjectUnsubscribedError = (0,_createErrorClass__WEBPACK_IMPORTED_MODULE_0__.createErrorClass)(function (_super) {
    return function ObjectUnsubscribedErrorImpl() {
        _super(this);
        this.name = 'ObjectUnsubscribedError';
        this.message = 'object unsubscribed';
    };
});
//# sourceMappingURL=ObjectUnsubscribedError.js.map

/***/ }),

/***/ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/UnsubscriptionError.js":
/*!************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/UnsubscriptionError.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   UnsubscriptionError: () => (/* binding */ UnsubscriptionError)
/* harmony export */ });
/* harmony import */ var _createErrorClass__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./createErrorClass */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/createErrorClass.js");

var UnsubscriptionError = (0,_createErrorClass__WEBPACK_IMPORTED_MODULE_0__.createErrorClass)(function (_super) {
    return function UnsubscriptionErrorImpl(errors) {
        _super(this);
        this.message = errors
            ? errors.length + " errors occurred during unsubscription:\n" + errors.map(function (err, i) { return i + 1 + ") " + err.toString(); }).join('\n  ')
            : '';
        this.name = 'UnsubscriptionError';
        this.errors = errors;
    };
});
//# sourceMappingURL=UnsubscriptionError.js.map

/***/ }),

/***/ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/arrRemove.js":
/*!**************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/arrRemove.js ***!
  \**************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arrRemove: () => (/* binding */ arrRemove)
/* harmony export */ });
function arrRemove(arr, item) {
    if (arr) {
        var index = arr.indexOf(item);
        0 <= index && arr.splice(index, 1);
    }
}
//# sourceMappingURL=arrRemove.js.map

/***/ }),

/***/ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/createErrorClass.js":
/*!*********************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/createErrorClass.js ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   createErrorClass: () => (/* binding */ createErrorClass)
/* harmony export */ });
function createErrorClass(createImpl) {
    var _super = function (instance) {
        Error.call(instance);
        instance.stack = new Error().stack;
    };
    var ctorFunc = createImpl(_super);
    ctorFunc.prototype = Object.create(Error.prototype);
    ctorFunc.prototype.constructor = ctorFunc;
    return ctorFunc;
}
//# sourceMappingURL=createErrorClass.js.map

/***/ }),

/***/ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/errorContext.js":
/*!*****************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/errorContext.js ***!
  \*****************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   captureError: () => (/* binding */ captureError),
/* harmony export */   errorContext: () => (/* binding */ errorContext)
/* harmony export */ });
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../config */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/config.js");

var context = null;
function errorContext(cb) {
    if (_config__WEBPACK_IMPORTED_MODULE_0__.config.useDeprecatedSynchronousErrorHandling) {
        var isRoot = !context;
        if (isRoot) {
            context = { errorThrown: false, error: null };
        }
        cb();
        if (isRoot) {
            var _a = context, errorThrown = _a.errorThrown, error = _a.error;
            context = null;
            if (errorThrown) {
                throw error;
            }
        }
    }
    else {
        cb();
    }
}
function captureError(err) {
    if (_config__WEBPACK_IMPORTED_MODULE_0__.config.useDeprecatedSynchronousErrorHandling && context) {
        context.errorThrown = true;
        context.error = err;
    }
}
//# sourceMappingURL=errorContext.js.map

/***/ }),

/***/ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/identity.js":
/*!*************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/identity.js ***!
  \*************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   identity: () => (/* binding */ identity)
/* harmony export */ });
function identity(x) {
    return x;
}
//# sourceMappingURL=identity.js.map

/***/ }),

/***/ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/isFunction.js":
/*!***************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/isFunction.js ***!
  \***************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isFunction: () => (/* binding */ isFunction)
/* harmony export */ });
function isFunction(value) {
    return typeof value === 'function';
}
//# sourceMappingURL=isFunction.js.map

/***/ }),

/***/ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/noop.js":
/*!*********************************************************************************************!*\
  !*** ../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/noop.js ***!
  \*********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   noop: () => (/* binding */ noop)
/* harmony export */ });
function noop() { }
//# sourceMappingURL=noop.js.map

/***/ }),

/***/ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/pipe.js":
/*!*********************************************************************************************!*\
  !*** ../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/pipe.js ***!
  \*********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   pipe: () => (/* binding */ pipe),
/* harmony export */   pipeFromArray: () => (/* binding */ pipeFromArray)
/* harmony export */ });
/* harmony import */ var _identity__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./identity */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/identity.js");

function pipe() {
    var fns = [];
    for (var _i = 0; _i < arguments.length; _i++) {
        fns[_i] = arguments[_i];
    }
    return pipeFromArray(fns);
}
function pipeFromArray(fns) {
    if (fns.length === 0) {
        return _identity__WEBPACK_IMPORTED_MODULE_0__.identity;
    }
    if (fns.length === 1) {
        return fns[0];
    }
    return function piped(input) {
        return fns.reduce(function (prev, fn) { return fn(prev); }, input);
    };
}
//# sourceMappingURL=pipe.js.map

/***/ }),

/***/ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/reportUnhandledError.js":
/*!*************************************************************************************************************!*\
  !*** ../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/util/reportUnhandledError.js ***!
  \*************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   reportUnhandledError: () => (/* binding */ reportUnhandledError)
/* harmony export */ });
/* harmony import */ var _config__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../config */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/config.js");
/* harmony import */ var _scheduler_timeoutProvider__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../scheduler/timeoutProvider */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/scheduler/timeoutProvider.js");


function reportUnhandledError(err) {
    _scheduler_timeoutProvider__WEBPACK_IMPORTED_MODULE_1__.timeoutProvider.setTimeout(function () {
        var onUnhandledError = _config__WEBPACK_IMPORTED_MODULE_0__.config.onUnhandledError;
        if (onUnhandledError) {
            onUnhandledError(err);
        }
        else {
            throw err;
        }
    });
}
//# sourceMappingURL=reportUnhandledError.js.map

/***/ }),

/***/ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs":
/*!*****************************************************************************!*\
  !*** ../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs ***!
  \*****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   __addDisposableResource: () => (/* binding */ __addDisposableResource),
/* harmony export */   __assign: () => (/* binding */ __assign),
/* harmony export */   __asyncDelegator: () => (/* binding */ __asyncDelegator),
/* harmony export */   __asyncGenerator: () => (/* binding */ __asyncGenerator),
/* harmony export */   __asyncValues: () => (/* binding */ __asyncValues),
/* harmony export */   __await: () => (/* binding */ __await),
/* harmony export */   __awaiter: () => (/* binding */ __awaiter),
/* harmony export */   __classPrivateFieldGet: () => (/* binding */ __classPrivateFieldGet),
/* harmony export */   __classPrivateFieldIn: () => (/* binding */ __classPrivateFieldIn),
/* harmony export */   __classPrivateFieldSet: () => (/* binding */ __classPrivateFieldSet),
/* harmony export */   __createBinding: () => (/* binding */ __createBinding),
/* harmony export */   __decorate: () => (/* binding */ __decorate),
/* harmony export */   __disposeResources: () => (/* binding */ __disposeResources),
/* harmony export */   __esDecorate: () => (/* binding */ __esDecorate),
/* harmony export */   __exportStar: () => (/* binding */ __exportStar),
/* harmony export */   __extends: () => (/* binding */ __extends),
/* harmony export */   __generator: () => (/* binding */ __generator),
/* harmony export */   __importDefault: () => (/* binding */ __importDefault),
/* harmony export */   __importStar: () => (/* binding */ __importStar),
/* harmony export */   __makeTemplateObject: () => (/* binding */ __makeTemplateObject),
/* harmony export */   __metadata: () => (/* binding */ __metadata),
/* harmony export */   __param: () => (/* binding */ __param),
/* harmony export */   __propKey: () => (/* binding */ __propKey),
/* harmony export */   __read: () => (/* binding */ __read),
/* harmony export */   __rest: () => (/* binding */ __rest),
/* harmony export */   __rewriteRelativeImportExtension: () => (/* binding */ __rewriteRelativeImportExtension),
/* harmony export */   __runInitializers: () => (/* binding */ __runInitializers),
/* harmony export */   __setFunctionName: () => (/* binding */ __setFunctionName),
/* harmony export */   __spread: () => (/* binding */ __spread),
/* harmony export */   __spreadArray: () => (/* binding */ __spreadArray),
/* harmony export */   __spreadArrays: () => (/* binding */ __spreadArrays),
/* harmony export */   __values: () => (/* binding */ __values),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/******************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
/* global Reflect, Promise, SuppressedError, Symbol, Iterator */

var extendStatics = function(d, b) {
  extendStatics = Object.setPrototypeOf ||
      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };
  return extendStatics(d, b);
};

function __extends(d, b) {
  if (typeof b !== "function" && b !== null)
      throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
  extendStatics(d, b);
  function __() { this.constructor = d; }
  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
}

var __assign = function() {
  __assign = Object.assign || function __assign(t) {
      for (var s, i = 1, n = arguments.length; i < n; i++) {
          s = arguments[i];
          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
      }
      return t;
  }
  return __assign.apply(this, arguments);
}

function __rest(s, e) {
  var t = {};
  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
      t[p] = s[p];
  if (s != null && typeof Object.getOwnPropertySymbols === "function")
      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
              t[p[i]] = s[p[i]];
      }
  return t;
}

function __decorate(decorators, target, key, desc) {
  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
  return c > 3 && r && Object.defineProperty(target, key, r), r;
}

function __param(paramIndex, decorator) {
  return function (target, key) { decorator(target, key, paramIndex); }
}

function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {
  function accept(f) { if (f !== void 0 && typeof f !== "function") throw new TypeError("Function expected"); return f; }
  var kind = contextIn.kind, key = kind === "getter" ? "get" : kind === "setter" ? "set" : "value";
  var target = !descriptorIn && ctor ? contextIn["static"] ? ctor : ctor.prototype : null;
  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});
  var _, done = false;
  for (var i = decorators.length - 1; i >= 0; i--) {
      var context = {};
      for (var p in contextIn) context[p] = p === "access" ? {} : contextIn[p];
      for (var p in contextIn.access) context.access[p] = contextIn.access[p];
      context.addInitializer = function (f) { if (done) throw new TypeError("Cannot add initializers after decoration has completed"); extraInitializers.push(accept(f || null)); };
      var result = (0, decorators[i])(kind === "accessor" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);
      if (kind === "accessor") {
          if (result === void 0) continue;
          if (result === null || typeof result !== "object") throw new TypeError("Object expected");
          if (_ = accept(result.get)) descriptor.get = _;
          if (_ = accept(result.set)) descriptor.set = _;
          if (_ = accept(result.init)) initializers.unshift(_);
      }
      else if (_ = accept(result)) {
          if (kind === "field") initializers.unshift(_);
          else descriptor[key] = _;
      }
  }
  if (target) Object.defineProperty(target, contextIn.name, descriptor);
  done = true;
};

function __runInitializers(thisArg, initializers, value) {
  var useValue = arguments.length > 2;
  for (var i = 0; i < initializers.length; i++) {
      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);
  }
  return useValue ? value : void 0;
};

function __propKey(x) {
  return typeof x === "symbol" ? x : "".concat(x);
};

function __setFunctionName(f, name, prefix) {
  if (typeof name === "symbol") name = name.description ? "[".concat(name.description, "]") : "";
  return Object.defineProperty(f, "name", { configurable: true, value: prefix ? "".concat(prefix, " ", name) : name });
};

function __metadata(metadataKey, metadataValue) {
  if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(metadataKey, metadataValue);
}

function __awaiter(thisArg, _arguments, P, generator) {
  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
  return new (P || (P = Promise))(function (resolve, reject) {
      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
      function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
      step((generator = generator.apply(thisArg, _arguments || [])).next());
  });
}

function __generator(thisArg, body) {
  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === "function" ? Iterator : Object).prototype);
  return g.next = verb(0), g["throw"] = verb(1), g["return"] = verb(2), typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
  function verb(n) { return function (v) { return step([n, v]); }; }
  function step(op) {
      if (f) throw new TypeError("Generator is already executing.");
      while (g && (g = 0, op[0] && (_ = 0)), _) try {
          if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
          if (y = 0, t) op = [op[0] & 2, t.value];
          switch (op[0]) {
              case 0: case 1: t = op; break;
              case 4: _.label++; return { value: op[1], done: false };
              case 5: _.label++; y = op[1]; op = [0]; continue;
              case 7: op = _.ops.pop(); _.trys.pop(); continue;
              default:
                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                  if (t[2]) _.ops.pop();
                  _.trys.pop(); continue;
          }
          op = body.call(thisArg, _);
      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
  }
}

var __createBinding = Object.create ? (function(o, m, k, k2) {
  if (k2 === undefined) k2 = k;
  var desc = Object.getOwnPropertyDescriptor(m, k);
  if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
  }
  Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
  if (k2 === undefined) k2 = k;
  o[k2] = m[k];
});

function __exportStar(m, o) {
  for (var p in m) if (p !== "default" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);
}

function __values(o) {
  var s = typeof Symbol === "function" && Symbol.iterator, m = s && o[s], i = 0;
  if (m) return m.call(o);
  if (o && typeof o.length === "number") return {
      next: function () {
          if (o && i >= o.length) o = void 0;
          return { value: o && o[i++], done: !o };
      }
  };
  throw new TypeError(s ? "Object is not iterable." : "Symbol.iterator is not defined.");
}

function __read(o, n) {
  var m = typeof Symbol === "function" && o[Symbol.iterator];
  if (!m) return o;
  var i = m.call(o), r, ar = [], e;
  try {
      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);
  }
  catch (error) { e = { error: error }; }
  finally {
      try {
          if (r && !r.done && (m = i["return"])) m.call(i);
      }
      finally { if (e) throw e.error; }
  }
  return ar;
}

/** @deprecated */
function __spread() {
  for (var ar = [], i = 0; i < arguments.length; i++)
      ar = ar.concat(__read(arguments[i]));
  return ar;
}

/** @deprecated */
function __spreadArrays() {
  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;
  for (var r = Array(s), k = 0, i = 0; i < il; i++)
      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)
          r[k] = a[j];
  return r;
}

function __spreadArray(to, from, pack) {
  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
      if (ar || !(i in from)) {
          if (!ar) ar = Array.prototype.slice.call(from, 0, i);
          ar[i] = from[i];
      }
  }
  return to.concat(ar || Array.prototype.slice.call(from));
}

function __await(v) {
  return this instanceof __await ? (this.v = v, this) : new __await(v);
}

function __asyncGenerator(thisArg, _arguments, generator) {
  if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
  var g = generator.apply(thisArg, _arguments || []), i, q = [];
  return i = Object.create((typeof AsyncIterator === "function" ? AsyncIterator : Object).prototype), verb("next"), verb("throw"), verb("return", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;
  function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }
  function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }
  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }
  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }
  function fulfill(value) { resume("next", value); }
  function reject(value) { resume("throw", value); }
  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }
}

function __asyncDelegator(o) {
  var i, p;
  return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;
  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }
}

function __asyncValues(o) {
  if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");
  var m = o[Symbol.asyncIterator], i;
  return m ? m.call(o) : (o = typeof __values === "function" ? __values(o) : o[Symbol.iterator](), i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i);
  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }
  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }
}

function __makeTemplateObject(cooked, raw) {
  if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
  return cooked;
};

var __setModuleDefault = Object.create ? (function(o, v) {
  Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
  o["default"] = v;
};

var ownKeys = function(o) {
  ownKeys = Object.getOwnPropertyNames || function (o) {
    var ar = [];
    for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
    return ar;
  };
  return ownKeys(o);
};

function __importStar(mod) {
  if (mod && mod.__esModule) return mod;
  var result = {};
  if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
  __setModuleDefault(result, mod);
  return result;
}

function __importDefault(mod) {
  return (mod && mod.__esModule) ? mod : { default: mod };
}

function __classPrivateFieldGet(receiver, state, kind, f) {
  if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
  if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
  return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
}

function __classPrivateFieldSet(receiver, state, value, kind, f) {
  if (kind === "m") throw new TypeError("Private method is not writable");
  if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
  if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
  return (kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;
}

function __classPrivateFieldIn(state, receiver) {
  if (receiver === null || (typeof receiver !== "object" && typeof receiver !== "function")) throw new TypeError("Cannot use 'in' operator on non-object");
  return typeof state === "function" ? receiver === state : state.has(receiver);
}

function __addDisposableResource(env, value, async) {
  if (value !== null && value !== void 0) {
    if (typeof value !== "object" && typeof value !== "function") throw new TypeError("Object expected.");
    var dispose, inner;
    if (async) {
      if (!Symbol.asyncDispose) throw new TypeError("Symbol.asyncDispose is not defined.");
      dispose = value[Symbol.asyncDispose];
    }
    if (dispose === void 0) {
      if (!Symbol.dispose) throw new TypeError("Symbol.dispose is not defined.");
      dispose = value[Symbol.dispose];
      if (async) inner = dispose;
    }
    if (typeof dispose !== "function") throw new TypeError("Object not disposable.");
    if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };
    env.stack.push({ value: value, dispose: dispose, async: async });
  }
  else if (async) {
    env.stack.push({ async: true });
  }
  return value;
}

var _SuppressedError = typeof SuppressedError === "function" ? SuppressedError : function (error, suppressed, message) {
  var e = new Error(message);
  return e.name = "SuppressedError", e.error = error, e.suppressed = suppressed, e;
};

function __disposeResources(env) {
  function fail(e) {
    env.error = env.hasError ? new _SuppressedError(e, env.error, "An error was suppressed during disposal.") : e;
    env.hasError = true;
  }
  var r, s = 0;
  function next() {
    while (r = env.stack.pop()) {
      try {
        if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);
        if (r.dispose) {
          var result = r.dispose.call(r.value);
          if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });
        }
        else s |= 1;
      }
      catch (e) {
        fail(e);
      }
    }
    if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();
    if (env.hasError) throw env.error;
  }
  return next();
}

function __rewriteRelativeImportExtension(path, preserveJsx) {
  if (typeof path === "string" && /^\.\.?\//.test(path)) {
      return path.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {
          return tsx ? preserveJsx ? ".jsx" : ".js" : d && (!ext || !cm) ? m : (d + ext + "." + cm.toLowerCase() + "js");
      });
  }
  return path;
}

/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
  __extends,
  __assign,
  __rest,
  __decorate,
  __param,
  __esDecorate,
  __runInitializers,
  __propKey,
  __setFunctionName,
  __metadata,
  __awaiter,
  __generator,
  __createBinding,
  __exportStar,
  __values,
  __read,
  __spread,
  __spreadArrays,
  __spreadArray,
  __await,
  __asyncGenerator,
  __asyncDelegator,
  __asyncValues,
  __makeTemplateObject,
  __importStar,
  __importDefault,
  __classPrivateFieldGet,
  __classPrivateFieldSet,
  __classPrivateFieldIn,
  __addDisposableResource,
  __disposeResources,
  __rewriteRelativeImportExtension,
});


/***/ }),

/***/ "../../packages/@dooboostore/core-web/src/clipboard/ClipBoardUtils.ts":
/*!****************************************************************************!*\
  !*** ../../packages/@dooboostore/core-web/src/clipboard/ClipBoardUtils.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ClipBoardUtils: () => (/* binding */ ClipBoardUtils)
/* harmony export */ });
var ClipBoardUtils;
(function (ClipBoardUtils) {
    ClipBoardUtils.readText = (window) => {
        return window.navigator.clipboard.readText();
    };
    ClipBoardUtils.read = (window) => {
        return window.navigator.clipboard.read();
    };
    ClipBoardUtils.writeText = (data, window) => {
        if (window.navigator.clipboard) {
            return window.navigator.clipboard
                .writeText(data);
        }
        else {
            // console.log('copy exec command use');
            return new Promise((resolve, reject) => {
                try {
                    const textarea = document.createElement('textarea');
                    textarea.value = data;
                    textarea.style.position = 'fixed'; // Prevent scrolling to bottom of page in MS Edge.
                    textarea.style.opacity = '0'; // Hide the textarea
                    document.body.appendChild(textarea);
                    textarea.focus();
                    textarea.select();
                    const copyExec = document.execCommand('copy');
                    document.body.removeChild(textarea);
                    if (copyExec) {
                        resolve();
                        // alert('copied!');
                    }
                    else {
                        reject(new Error('copy failed'));
                    }
                }
                catch (err) {
                    reject(err);
                }
            });
        }
    };
    ClipBoardUtils.write = (data, clipboard = navigator.clipboard) => {
        return clipboard.write(data);
    };
})(ClipBoardUtils || (ClipBoardUtils = {}));


/***/ }),

/***/ "../../packages/@dooboostore/core-web/src/document/DocumentUtils.ts":
/*!**************************************************************************!*\
  !*** ../../packages/@dooboostore/core-web/src/document/DocumentUtils.ts ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DocumentUtils: () => (/* binding */ DocumentUtils)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_message_Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/message/Observable */ "../../packages/@dooboostore/core/src/message/Observable.ts");

var DocumentUtils;
(function (DocumentUtils) {
    DocumentUtils.querySelectorAllByAttributeName = (document, attributeName) => {
        const elements = [];
        document.querySelectorAll(`[${attributeName}]`)?.forEach((element) => {
            elements.push({ element: element, value: element.getAttribute(attributeName) });
        });
        return elements;
    };
    DocumentUtils.eventObservable = (document, type, options) => {
        return new _dooboostore_core_message_Observable__WEBPACK_IMPORTED_MODULE_0__.Observable((subscriber) => {
            const handler = (event) => subscriber.next(event);
            window.addEventListener(type, handler, options);
            return () => {
                window.removeEventListener(type, handler, options);
            };
        });
    };
})(DocumentUtils || (DocumentUtils = {}));


/***/ }),

/***/ "../../packages/@dooboostore/core-web/src/element/ElementUtils.ts":
/*!************************************************************************!*\
  !*** ../../packages/@dooboostore/core-web/src/element/ElementUtils.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ElementUtils: () => (/* binding */ ElementUtils)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_promise_Promises__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/promise/Promises */ "../../packages/@dooboostore/core/src/promise/Promises.ts");

var ElementUtils;
(function (ElementUtils) {
    function loadImage(src, callback) {
        let targetCallback;
        let promise = undefined;
        if (callback) {
            targetCallback = callback.onload;
        }
        else {
            const r = _dooboostore_core_promise_Promises__WEBPACK_IMPORTED_MODULE_0__.Promises.withResolvers();
            promise = r.promise;
            targetCallback = r.resolve;
        }
        const img = new Image();
        // img.crossOrigin = 'Anonymous';
        img.onload = () => {
            targetCallback(img);
        };
        if (callback && callback.onerror) {
            img.onerror = callback.onerror;
        }
        img.src = src;
        return promise;
    }
    ElementUtils.loadImage = loadImage;
    function loadAudio(src, callback) {
        let targetCallback;
        let error;
        let promise = undefined;
        if (callback) {
            targetCallback = callback.onload;
            error = callback.onerror;
        }
        else {
            const r = _dooboostore_core_promise_Promises__WEBPACK_IMPORTED_MODULE_0__.Promises.withResolvers();
            promise = r.promise;
            error = r.reject;
            targetCallback = r.resolve;
        }
        const audio = new Audio('path/to/audio1.mp3');
        audio.addEventListener('canplay', () => {
            targetCallback?.(audio);
        });
        audio.addEventListener('error', (e) => {
            callback?.onerror(e);
        });
        audio.load();
        return promise;
    }
    ElementUtils.loadAudio = loadAudio;
    ElementUtils.toInnerHTML = (documentFragment, config) => {
        // if (documentFragment) {
        const tempDiv = config.document.createElement('div');
        tempDiv.appendChild(documentFragment.cloneNode(true));
        // console.log('DocumentFragment innerHTML:', tempDiv.innerHTML);
        return tempDiv.innerHTML;
        // }
    };
    // export const fragmentToHTML = (fragment: DocumentFragment, config: { document: Document } = { document }): string => {
    //    const tempDiv = config.document.createElement('div');
    //    tempDiv.appendChild(fragment.cloneNode(true));
    //    return tempDiv.innerHTML;
    //  }
    ElementUtils.htmlToFragment = (html, config = { document }) => {
        const tempDiv = config.document.createElement('div');
        tempDiv.innerHTML = html;
        const fragment = config.document.createDocumentFragment();
        while (tempDiv.firstChild) {
            fragment.appendChild(tempDiv.firstChild);
        }
        return fragment;
    };
    /*
       17 // originalDiv   , childSpan  .
       18 const shallowCopy = originalDiv.cloneNode(false);
       19 shallowCopy.id = 'shallowCopyDiv'; // ID  ( )
       20 console.log('\n---   ---');
       21 console.log(shallowCopy.outerHTML);
       22 //  : <div id="shallowCopyDiv" data-custom=" "></div>
       23
       24 // 2.   (deep: true)
       25 // originalDiv   childSpan  .
       26 const deepCopy = originalDiv.cloneNode(true);
       27 deepCopy.id = 'deepCopyDiv'; // ID  ( )
       28 console.log('\n---   ---');
       29 console.log(deepCopy.outerHTML);
     */
    ElementUtils.replaceWith = (targetElement, replaceElement) => {
        targetElement.replaceWith(replaceElement);
    };
    ElementUtils.nodeList = (documentFragment) => {
        return Array.from(documentFragment.childNodes);
    };
    ElementUtils.cloneNodeList = (documentFragment) => {
        return Array.from(documentFragment.childNodes).map(node => node.cloneNode(true));
    };
    ElementUtils.querySelector = (e, selector) => {
        const elements = ElementUtils.querySelectorAll(e, selector);
        if (elements.length > 0) {
            return elements[0];
        }
        else {
            return null;
        }
    };
    ElementUtils.querySelectorAll = (e, selector) => {
        if (e instanceof Element) {
            return Array.from(e.querySelectorAll(selector));
        }
        else {
            const startNode = e.start;
            const endNode = e.end;
            if (startNode && endNode && startNode.parentNode === endNode.parentNode) {
                const elements = [];
                let currentNode = startNode.nextSibling;
                while (currentNode && currentNode !== endNode) {
                    if (currentNode.nodeType === Node.ELEMENT_NODE) {
                        const currentElement = currentNode;
                        if (currentElement.matches(selector)) {
                            elements.push(currentElement);
                        }
                        elements.push(...Array.from(currentElement.querySelectorAll(selector)));
                    }
                    currentNode = currentNode.nextSibling;
                }
                return elements;
            }
        }
        return [];
    };
    ElementUtils.selectorElements = (selector, element = document) => {
        return Array.prototype.slice.call(element.querySelectorAll(selector));
    };
    ElementUtils.selectorNodes = (selector, element = document) => {
        return element.querySelectorAll(selector);
    };
    ElementUtils.removeAttribute = (result, attrs) => {
        attrs.forEach(it => {
            result.removeAttribute(it);
        });
    };
    ElementUtils.setAttribute = (result, attrs) => {
        attrs.forEach(it => {
            result.setAttribute(it, '');
        });
    };
    ElementUtils.setAttributeAttr = (result, attrs) => {
        attrs.forEach(it => {
            result.setAttribute(it.name, it.value);
        });
    };
    ElementUtils.getAttributeToObject = (input) => {
        const attribute = {};
        input.getAttributeNames().forEach(ait => {
            attribute[ait] = input.getAttribute(ait);
        });
        return attribute;
    };
    ElementUtils.getStyleToObject = (input) => {
        const style = {};
        for (let i = 0; i < input.style.length; i++) {
            const key = input.style[i];
            style[key] = input.style[key];
        }
        return style;
    };
})(ElementUtils || (ElementUtils = {}));


/***/ }),

/***/ "../../packages/@dooboostore/core-web/src/event/EventUtils.ts":
/*!********************************************************************!*\
  !*** ../../packages/@dooboostore/core-web/src/event/EventUtils.ts ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   EventUtils: () => (/* binding */ EventUtils)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_message_Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/message/Observable */ "../../packages/@dooboostore/core/src/message/Observable.ts");

var EventUtils;
(function (EventUtils) {
    EventUtils.htmlElementEventObservable = (element, type, options) => {
        return new _dooboostore_core_message_Observable__WEBPACK_IMPORTED_MODULE_0__.Observable((subscriber) => {
            const handler = (event) => subscriber.next(event);
            element.addEventListener(type, handler, options);
            return () => {
                element.removeEventListener(type, handler, options);
            };
        });
    };
})(EventUtils || (EventUtils = {}));


/***/ }),

/***/ "../../packages/@dooboostore/core-web/src/location/LocationUtils.ts":
/*!**************************************************************************!*\
  !*** ../../packages/@dooboostore/core-web/src/location/LocationUtils.ts ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   LocationUtils: () => (/* binding */ LocationUtils)
/* harmony export */ });
var LocationUtils;
(function (LocationUtils) {
    LocationUtils.hash = (window) => {
        return window.location.hash.replace('#', '');
    };
    LocationUtils.hashPath = (window) => {
        return window.location.hash.replace('#', '').split('?')[0];
    };
    // search  ?   location.search
    LocationUtils.hashSearch = (window) => {
        const string = window.location.hash.replace('#', '').split('?')[1];
        return string ? `?${string}` : '';
    };
    LocationUtils.hashQueryParams = (window) => {
        const s = window.location.hash.replace('#', '').split('?')[1] || '';
        return LocationUtils.queryStringToMap(s);
    };
    LocationUtils.path = (window) => {
        return window.location.pathname;
    };
    LocationUtils.search = (window) => {
        return window.location.search || '';
    };
    LocationUtils.pathQueryParamsObject = (window) => {
        return LocationUtils.queryStringToObject(window.location.search.substring(1));
    };
    LocationUtils.hashQueryParamsObject = (window) => {
        const s = window.location.hash.split('?').pop() ?? '';
        if (s.startsWith('#')) {
            return {};
        }
        else {
            return LocationUtils.queryStringToObject(s);
        }
    };
    LocationUtils.pathQueryParams = (window) => {
        return LocationUtils.queryStringToMap(window.location.search.substring(1));
    };
    LocationUtils.queryStringToMap = (s) => {
        const params = new Map();
        const vars = s.split('&') || [];
        vars.forEach(it => {
            const kv = it.split('=') || [];
            if (kv[0] && kv[0].length > 0) {
                params.set(kv[0], kv[1]);
            }
        });
        return params;
    };
    LocationUtils.queryStringToObject = (s) => {
        const params = {};
        const vars = s.split('&') || [];
        vars.forEach(it => {
            const kv = it.split('=') || [];
            if (kv[0] && kv[0].length > 0) {
                params[kv[0]] = kv[1];
            }
        });
        return params;
    };
})(LocationUtils || (LocationUtils = {}));


/***/ }),

/***/ "../../packages/@dooboostore/core-web/src/node/NodeUtils.ts":
/*!******************************************************************!*\
  !*** ../../packages/@dooboostore/core-web/src/node/NodeUtils.ts ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   NodeUtils: () => (/* binding */ NodeUtils)
/* harmony export */ });
var NodeUtils;
(function (NodeUtils) {
    let FindNodesFilterResult;
    (function (FindNodesFilterResult) {
        FindNodesFilterResult["MATCH_AND_CONTINUE"] = "MATCH_AND_CONTINUE";
        FindNodesFilterResult["MATCH_AND_SKIP_CHILDREN"] = "MATCH_AND_SKIP_CHILDREN";
        FindNodesFilterResult["NO_MATCH_AND_CONTINUE"] = "NO_MATCH_AND_CONTINUE";
        FindNodesFilterResult["NO_MATCH_AND_SKIP_CHILDREN"] = "NO_MATCH_AND_SKIP_CHILDREN"; // Don't match the node, and also skip its children
    })(FindNodesFilterResult = NodeUtils.FindNodesFilterResult || (NodeUtils.FindNodesFilterResult = {}));
    // https://stackoverflow.com/questions/3955229/remove-all-child-elements-of-a-dom-node-in-javascript
    NodeUtils.removeAllChildNode = (node) => {
        while (node?.firstChild) {
            node.firstChild.remove();
        }
    };
    NodeUtils.appendChild = (parentNode, childNode) => {
        return parentNode.appendChild(childNode);
    };
    NodeUtils.replaceNode = (targetNode, newNode) => {
        // console.log('repalceNode', targetNode, newNode, targetNode.parentNode)
        return targetNode.parentNode?.replaceChild(newNode, targetNode);
    };
    NodeUtils.insertAfter = (targetNode, newNode) => {
        return targetNode.parentNode?.insertBefore(newNode, targetNode.nextSibling);
    };
    NodeUtils.cloneNode = (element, deep) => {
        return element.cloneNode(deep ?? false);
    };
    NodeUtils.findNodes = (rootNode, filter) => {
        const foundNodes = [];
        function traverse(node) {
            if (!node) {
                return;
            }
            // console.log('----------',node.childNodes)
            node.childNodes.forEach(child => {
                const result = filter(child);
                if (result === FindNodesFilterResult.MATCH_AND_CONTINUE ||
                    result === FindNodesFilterResult.MATCH_AND_SKIP_CHILDREN) {
                    foundNodes.push(child);
                }
                if (result === FindNodesFilterResult.MATCH_AND_CONTINUE ||
                    result === FindNodesFilterResult.NO_MATCH_AND_CONTINUE) {
                    traverse(child);
                }
            });
        }
        traverse(rootNode);
        return foundNodes;
    };
})(NodeUtils || (NodeUtils = {}));


/***/ }),

/***/ "../../packages/@dooboostore/core-web/src/script/ScriptUtils.ts":
/*!**********************************************************************!*\
  !*** ../../packages/@dooboostore/core-web/src/script/ScriptUtils.ts ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ScriptUtils: () => (/* binding */ ScriptUtils)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");

class ScriptUtils {
    /**
     * @deprecated Use ObjectUtils.Script.evalReturn instead
     */
    static evaluateReturn(script, thisTarget = {}) {
        return _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_0__.ObjectUtils.Script.evaluateReturn(script, thisTarget);
    }
    /**
     * @deprecated Use ObjectUtils.Script.eval instead
     */
    static evaluate(script, thisTarget = {}) {
        return _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_0__.ObjectUtils.Script.evaluate(script, thisTarget); // Changed from eval to runScript
    }
    /**
     * @deprecated Use ObjectUtils.Script.eval instead
     */
    // public static getVariablePaths(script: string): Set<string> {
    //   const usingVars = new Set<string>();
    //
    //   class GetDetectProxy implements ProxyHandler<any> {
    //     public usingVars = usingVars;
    //
    //     constructor(public prefix?: string) {}
    //
    //     set(target: any, p: string | symbol, value: any, receiver: any): boolean {
    //       return true;
    //     }
    //
    //     get(target: any, p: string | symbol, receiver: any): any {
    //       let items;
    //       if (typeof p === 'string' && isNaN(Number(p))) {
    //         items = this.prefix ? this.prefix + '.' + p : p;
    //         this.usingVars.add(items);
    //       } else if (typeof p === 'string' && !isNaN(Number(p))) {
    //         items = this.prefix ? this.prefix + '[' + p + ']' : p;
    //         this.usingVars.add(items);
    //       }
    //       return new Proxy(() => {}, new GetDetectProxy(items));
    //     }
    //   }
    //
    //   const destUser = new Proxy(() => {}, new GetDetectProxy());
    //
    //   try {
    //     //     bind
    //     // const boundFunc = new Function("return this.value").bind(obj);
    //     // console.log(boundFunc()); // 42
    //
    //     // eslint-disable-next-line no-new-func,no-unused-expressions
    //     Function(`"use strict"; ${script}; `).bind(destUser)();
    //   } catch (e) {
    //     console.error(e);
    //   }
    //   console.log('-------usingV', usingVars)
    //   return usingVars;
    // }
    static loadElement(document, name, option) {
        return new Promise((resolve, reject) => {
            const tag = document.createElement(name);
            if (option?.body) {
                tag.innerHTML = option.body;
            }
            else {
                tag.onload = resolve;
            }
            tag.onerror = reject;
            if (option?.attribute) {
                for (const [key, value] of Object.entries(option.attribute)) {
                    tag.setAttribute(key, value);
                }
            }
            option.created(tag);
            if (option?.body && tag.parentNode) {
                resolve(tag);
            }
            // document.head.append(tag);
        });
    }
    static loadStyleSheet(document, href, attribute = {}) {
        // const tag = document.createElement('link');
        // tag.type = 'text/css';
        // tag.setAttribute('rel', 'stylesheet');
        // tag.href = href;
        // for (const [key, value] of Object.entries(attribute)) {
        //     tag.setAttribute(key, value);
        // }
        // target.append(tag)
        attribute.type = 'text/css';
        attribute.rel = 'stylesheet';
        attribute.href = href;
        return ScriptUtils.loadElement(document, 'link', {
            attribute,
            created: e => {
                document.head.append(e);
            }
        });
    }
    static loadScript(document, src, attribute = {}) {
        attribute.type = attribute?.type ?? 'text/javascript';
        attribute.src = src;
        return ScriptUtils.loadElement(document, 'script', { attribute, created: e => document.head.append(e) });
    }
    static loadScriptBody(document, body, attribute = {}) {
        attribute.type = attribute?.type ?? 'text/javascript';
        return ScriptUtils.loadElement(document, 'script', { body, attribute, created: e => document.head.append(e) });
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/core-web/src/valid/ValidUtils.ts":
/*!********************************************************************!*\
  !*** ../../packages/@dooboostore/core-web/src/valid/ValidUtils.ts ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ValidUtils: () => (/* binding */ ValidUtils)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/valid/ValidUtils */ "../../packages/@dooboostore/core/src/valid/ValidUtils.ts");

var ValidUtils;
(function (ValidUtils) {
    ValidUtils.coreValidUtils = _dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_0__.ValidUtils;
    ValidUtils.isBrowser = (callBack) => {
        const boolean = (typeof window !== 'undefined') && (typeof Window !== 'undefined');
        if (boolean && callBack) {
            callBack(window);
        }
        return boolean;
    };
    ValidUtils.hasParentWindow = (win) => ValidUtils.isBrowser() && win.parent && win !== win.parent;
    //////////////
    /**
     *  SNS Inapp Browser Check
     *   /  /  /  
     */
    ValidUtils.isSocialNetworkServiceInappBrowser = () => {
        const userAgent = ValidUtils.isBrowser() ? window.navigator.userAgent.toLowerCase() : 'none';
        return /kakaotalk|naver|facebook|insta|FBAN|FBAV/.test(userAgent);
    };
    /**
     *  IOS Webview  
     */
    ValidUtils.isWkWebview = () => ValidUtils.isBrowser() &&
        window['webkit'] != null &&
        window['webkit'].messageHandlers != null &&
        window['webkit'].messageHandlers['System'] != null;
    function isiPhone() {
        return ValidUtils.isBrowser() && /iphone|ipad|ipod/i.test(navigator.userAgent.toLowerCase());
    }
    ValidUtils.isiPhone = isiPhone;
    /**
     *  Android Webview  
     */
    ValidUtils.isAndroidWebview = () => {
        return ValidUtils.isBrowser() && window['System'] != null;
    };
    ValidUtils.isMobile = (win) => {
        const targetWindow = win ?? (ValidUtils.isBrowser() ? window : undefined);
        if (!targetWindow) {
            return false;
        }
        return /Mobi/i.test(targetWindow.navigator.userAgent);
    };
})(ValidUtils || (ValidUtils = {}));


/***/ }),

/***/ "../../packages/@dooboostore/core-web/src/window/WindowUtils.ts":
/*!**********************************************************************!*\
  !*** ../../packages/@dooboostore/core-web/src/window/WindowUtils.ts ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   WindowUtils: () => (/* binding */ WindowUtils)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_message_Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/message/Observable */ "../../packages/@dooboostore/core/src/message/Observable.ts");

var WindowUtils;
(function (WindowUtils) {
    WindowUtils.eventObservable = (window, type, options) => {
        return new _dooboostore_core_message_Observable__WEBPACK_IMPORTED_MODULE_0__.Observable((subscriber) => {
            const handler = (event) => subscriber.next(event);
            window.addEventListener(type, handler, options);
            return () => {
                window.removeEventListener(type, handler, options);
            };
        });
    };
})(WindowUtils || (WindowUtils = {}));


/***/ }),

/***/ "../../packages/@dooboostore/core/src/convert/ConvertUtils.ts":
/*!********************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/convert/ConvertUtils.ts ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ConvertUtils: () => (/* binding */ ConvertUtils)
/* harmony export */ });
/* harmony import */ var _valid_ValidUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../valid/ValidUtils */ "../../packages/@dooboostore/core/src/valid/ValidUtils.ts");
/* harmony import */ var _entity_Point2D__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../entity/Point2D */ "../../packages/@dooboostore/core/src/entity/Point2D.ts");
/* harmony import */ var _entity_Point3D__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../entity/Point3D */ "../../packages/@dooboostore/core/src/entity/Point3D.ts");
/* harmony import */ var _entity_Rect__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../entity/Rect */ "../../packages/@dooboostore/core/src/entity/Rect.ts");
/* harmony import */ var _object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");





var ConvertUtils;
(function (ConvertUtils) {
    ConvertUtils.objToGetURL = (obj) => {
        return Object.keys(obj).reduce((prev, key, i) => (`${prev}${i !== 0 ? '&' : ''}${key}=${obj[key]}`), '');
    };
    ConvertUtils.mapToJson = (map) => {
        return JSON.stringify(Array.from(map.entries()).reduce((o, [key, value]) => {
            o[key] = value;
            return o;
        }, {}));
    };
    // export const fixed = (num: number, fractionDigits: number): number => {
    //   const factor = Math.pow(10, fractionDigits);
    // }
    ConvertUtils.jsonToMap = (jsonStr) => {
        return new Map(JSON.parse(jsonStr));
    };
    ConvertUtils.toUrl = (data) => {
        try {
            return new URL(data);
        }
        catch (e) {
            throw new Error(`Invalid URL string: ${data}`);
        }
    };
    ConvertUtils.decodeURIString = (data) => {
        return decodeURIComponent(data);
    };
    ConvertUtils.encodeURIString = (data) => {
        return encodeURIComponent(data);
    };
    ConvertUtils.objToStrMap = (obj) => {
        const strMap = new Map();
        for (const k of Object.keys(obj)) {
            strMap.set(k, obj[k]);
        }
        return strMap;
    };
    ConvertUtils.jsonToStrMap = (jsonStr) => {
        return ConvertUtils.objToStrMap(JSON.parse(jsonStr));
    };
    ConvertUtils.strToObject = (message) => {
        return JSON.parse(message);
    };
    ConvertUtils.objToJson = (obj) => {
        return JSON.stringify(obj);
    };
    ConvertUtils.objToMap = (obj) => {
        const mp = new Map();
        Object.keys(obj).forEach((k) => {
            mp.set(k, obj[k]);
        });
        return mp;
    };
    ConvertUtils.mapToObj = (map) => {
        const obj = {};
        map.forEach((v, k) => {
            obj[k] = v;
        });
        return obj;
    };
    ConvertUtils.snakeToCamelCase = (str) => {
        return str.replace(/_([a-z])/g, (_, letter) => letter.toUpperCase());
    };
    ConvertUtils.camelToSnakeCase = (str) => {
        return str.replace(/([a-z])([A-Z])/g, '$1_$2').toLowerCase();
    };
    function toFormData(obj) {
        const formData = new FormData();
        for (const key in obj)
            formData.append(key, obj[key]);
        return formData;
    }
    ConvertUtils.toFormData = toFormData;
    function toObject(obj, config) {
        if (obj instanceof URLSearchParams) {
            const robj = {};
            obj.forEach((v, k) => {
                if (config?.firstValue && robj[k] === undefined) {
                    robj[k] = v;
                }
                else if (!config?.firstValue) {
                    if (robj[k]) {
                        if (Array.isArray(robj[k])) {
                            robj[k].push(v);
                        }
                        else {
                            robj[k] = [robj[k], v];
                        }
                    }
                    else {
                        robj[k] = v;
                    }
                }
            });
            return robj;
        }
        else if (obj instanceof FormData) {
            // new Map().entries()
            // Object.entries({})
            // obj = Object.fromEntries(obj.entries());
            const formDataToObject = (formData) => {
                const obj = {};
                // FormData   
                for (const key of formData.keys()) {
                    const values = formData.getAll(key); //     
                    //    ,    
                    obj[key] = values.length > 1 ? values : values[0];
                }
                return obj;
            };
            return formDataToObject(obj);
        }
        else if (obj && typeof obj[Symbol.iterator] === 'function') {
            return Object.fromEntries(obj);
        }
        else if (Array.isArray(obj)) {
            return Object.fromEntries(obj);
        }
        else {
            // console.log(Object.prototype.toString.call(obj));
            if (_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_0__.ValidUtils.isMap(obj)) {
                const map = obj;
                obj = ConvertUtils.mapToObj(map);
            }
            if (_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_0__.ValidUtils.isArray(obj)) {
                const arr = obj;
                for (let i = 0; i < arr.length; i++) {
                    arr[i] = ConvertUtils.toObject(arr[i]);
                }
            }
            if (_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_0__.ValidUtils.isObject(obj)) {
                for (const property in obj) {
                    obj[property] = ConvertUtils.toObject(obj[property]);
                }
            }
            return obj;
        }
    }
    ConvertUtils.toObject = toObject;
    ;
    ConvertUtils.toArray = (data) => {
        if (data instanceof Set) {
            return Array.from(data.values());
        }
        const datas = (Array.isArray(data) ? data : (data ? [data] : []));
        return datas;
    };
    ConvertUtils.flatArray = (...data) => {
        const datas = data.flatMap((item) => (item instanceof Object && Symbol.iterator in item ? Array.from(item) : [item]));
        return datas;
    };
    ConvertUtils.iteratorToArray = (it) => {
        return Array.from(it);
    };
    ConvertUtils.toJson = (obj) => {
        const at = ConvertUtils.toObject(obj);
        return JSON.stringify(at);
    };
    ConvertUtils.concatenateToAttribute = (object_o) => {
        return ConvertUtils.concatenateToString(object_o, '=', ' ', '\'');
    };
    ConvertUtils.concatenateToParameter = (object_o) => {
        return ConvertUtils.concatenateToString(object_o, '=', '&', '');
    };
    ConvertUtils.concatenateToString = (object_o, unionString_s = '=', spilString_s = ' ', pairString_s = '') => {
        const results = [];
        for (const property in object_o) {
            const value = object_o[property];
            if (value) {
                results.push(property.toString() + unionString_s + pairString_s + value + pairString_s);
            }
        }
        return results.join(spilString_s);
    };
    ConvertUtils.specialCharsToEscape = (data) => {
        return data.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    };
    ConvertUtils.decodeHTMLEscape = (data) => {
        // HTML   .
        return data.replace(/&amp;/g, '&')
            .replace(/&lt;/g, '<')
            .replace(/&gt;/g, '>')
            .replace(/&quot;/g, '"')
            .replace(/&#39;/g, "'")
            .replace(/&#x2F;/g, '/');
    };
    function escapeHTML(htmlString, option) {
        if (!htmlString)
            return '';
        // HTML escape map -  : &    
        // https://dev-handbook.tistory.com/23
        const escapeMap = {
            '&': '&amp;', //   
            '<': '&lt;',
            '>': '&gt;',
            '"': '&quot;',
            "'": '&#39;', // or &apos; ( HTML4 &#39; )
            '/': '&#x2F;',
            '`': '&#x60;',
            '=': '&#x3D;',
            '{': '&#123;',
            '}': '&#125;',
            '#': '&#35;',
            '$': '&#36;',
            '\n': '&#10;', // newline
            '\r': '&#13;', // carriage return
            '\t': '&#9;', // tab
            '\u00A0': '&nbsp;', // non-breaking space
            '': '&cent;',
            '': '&pound;',
            '': '&yen;',
            '': '&euro;',
            '': '&copy;',
            '': '&reg;',
            '': '&trade;',
            '': '&deg;',
            '': '&plusmn;',
            '': '&times;',
            '': '&divide;',
            '': '&minus;',
            '': '&bull;',
            '': '&hellip;',
            '': '&larr;',
            '': '&rarr;',
            '': '&uarr;',
            '': '&darr;',
            '': '&harr;',
        };
        // targets     
        const targetsSet = option?.targets ? new Set(option.targets) : null;
        const filteredEscapeMap = targetsSet
            ? Object.fromEntries(Object.entries(escapeMap).filter(([key]) => targetsSet.has(key)))
            : escapeMap;
        // &  targets   targets  &   
        const shouldEscapeAmpersand = !targetsSet || targetsSet.has('&');
        //     
        const charsToEscape = Object.keys(filteredEscapeMap).filter(char => char !== '&');
        if (charsToEscape.length === 0 && !shouldEscapeAmpersand) {
            return htmlString; //     
        }
        //   (   )
        const escapedChars = charsToEscape.map(char => {
            //      
            return char.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        }).join('');
        let result = htmlString;
        // &    (  )
        if (shouldEscapeAmpersand) {
            result = result.replace(/&/g, '&amp;');
        }
        //   
        if (escapedChars.length > 0) {
            const regex = new RegExp(`[${escapedChars}]`, 'g');
            result = result.replace(regex, (match) => {
                return filteredEscapeMap[match] || match;
            });
        }
        return result;
    }
    ConvertUtils.escapeHTML = escapeHTML;
    ConvertUtils.copyObject = (obj, update = {}) => {
        return { ...obj, ...update };
    };
    ConvertUtils.copyArrayWithAddition = (arr, update) => {
        return [...arr, ...(update || [])];
    };
    ConvertUtils.hexToInt = (hex) => {
        if (hex.startsWith('#')) {
            hex = hex.slice(1);
        }
        if (hex.length === 3) {
            hex = hex.split('').map((c) => c + c).join('');
        }
        return parseInt(hex, 16);
    };
    // export const toHex = (val: number): string => {
    //   const hex = Math.floor(val).toString(16).toUpperCase();
    //   return (hex.length === 1 ? '0' + hex : hex);
    // };
    ConvertUtils.toHex = (num) => {
        if (num < 0) {
            num = 0xFFFFFFFF + num + 1;
        }
        num = Number(num.toFixed(0));
        return num.toString(16).padStart(2, '0').toUpperCase();
    };
    ConvertUtils.toHexColor = (rgba) => {
        const r = ConvertUtils.toHex(rgba.r ?? 0);
        const g = ConvertUtils.toHex(rgba.g ?? 0);
        const b = ConvertUtils.toHex(rgba.b ?? 0);
        const a = ConvertUtils.toHex(rgba.a ?? 255);
        return `#${r}${g}${b}${a}`;
    };
    ConvertUtils.avgColor = (color) => {
        const sum = color.reduce((acc, c) => {
            acc.r += c.r ?? 0;
            acc.g += c.g ?? 0;
            acc.b += c.b ?? 0;
            acc.a += c.a ?? 0;
            return acc;
        }, { r: 0, g: 0, b: 0, a: 0 });
        const avg = { r: Math.floor(sum.r / color.length), g: Math.floor(sum.g / color.length), b: Math.floor(sum.b / color.length), a: Math.floor(sum.a / color.length) };
        return avg;
    };
    ConvertUtils.toRGBA = (hex) => {
        hex ??= '#000000FF';
        const hexColor = hex.replace('#', '');
        const r = parseInt(hexColor.slice(0, 2) || '0', 16);
        const g = parseInt(hexColor.slice(2, 4) || '0', 16);
        const b = parseInt(hexColor.slice(4, 6) || '0', 16);
        const a = hexColor.length > 6 ? parseInt(hexColor.slice(6, 8) || '0', 16) : 255;
        return { r, g, b, a };
    };
    ConvertUtils.minMaxCenterAvg = (obj) => {
        const result = {};
        const allKeys = _object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.uniqueKeys(obj);
        for (const key of allKeys) {
            const values = obj.map(item => item[key]);
            const min = Math.min(...values);
            const max = Math.max(...values);
            const center = (min + max) / 2;
            const avg = values.reduce((sum, val) => sum + val, 0) / values.length;
            result[key] = { min, max, center, avg, diff: max - min };
        }
        return result;
    };
    ConvertUtils.minMaxCenterRectAvg2D = (point2Ds) => {
        const min = new _entity_Point2D__WEBPACK_IMPORTED_MODULE_1__.Point2D(Number.MAX_SAFE_INTEGER, Number.MAX_SAFE_INTEGER);
        const max = new _entity_Point2D__WEBPACK_IMPORTED_MODULE_1__.Point2D(Number.MIN_SAFE_INTEGER, Number.MIN_SAFE_INTEGER);
        let sum = new _entity_Point2D__WEBPACK_IMPORTED_MODULE_1__.Point2D(0, 0);
        point2Ds.forEach((p) => {
            min.x = Math.min(min.x, p.x);
            min.y = Math.min(min.y, p.y);
            max.x = Math.max(max.x, p.x);
            max.y = Math.max(max.y, p.y);
            sum.x += p.x;
            sum.y += p.y;
        });
        const center = new _entity_Point2D__WEBPACK_IMPORTED_MODULE_1__.Point2D((min.x + max.x) / 2, (min.y + max.y) / 2);
        const avg = new _entity_Point2D__WEBPACK_IMPORTED_MODULE_1__.Point2D(sum.x / point2Ds.length, sum.y / point2Ds.length);
        const minMaxRect = new _entity_Rect__WEBPACK_IMPORTED_MODULE_3__.Rect(min.x, min.y, max.x - min.x, max.y - min.y);
        return { min, max, center, avg, minMaxRect };
    };
    ConvertUtils.minMaxCenterAvg3D = (point3Ds) => {
        const min = new _entity_Point3D__WEBPACK_IMPORTED_MODULE_2__.Point3D(Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE);
        const max = new _entity_Point3D__WEBPACK_IMPORTED_MODULE_2__.Point3D(Number.MIN_VALUE, Number.MIN_VALUE, Number.MIN_VALUE);
        let sum = new _entity_Point3D__WEBPACK_IMPORTED_MODULE_2__.Point3D(0, 0, 0);
        point3Ds.forEach((p) => {
            min.x = Math.min(min.x, p.x);
            min.y = Math.min(min.y, p.y);
            min.z = Math.max(min.z, p.z);
            max.x = Math.max(max.x, p.x);
            max.y = Math.max(max.y, p.y);
            max.z = Math.max(max.z, p.y);
            sum.x += p.x;
            sum.y += p.y;
            sum.z += p.z;
        });
        const center = new _entity_Point3D__WEBPACK_IMPORTED_MODULE_2__.Point3D((min.x + max.x) / 2, (min.y + max.y) / 2, (min.z + max.z) / 2);
        const avg = new _entity_Point3D__WEBPACK_IMPORTED_MODULE_2__.Point3D(sum.x / point3Ds.length, sum.y / point3Ds.length, sum.z / point3Ds.length);
        return { min, max, center, avg };
    };
    ConvertUtils.roundRectRadiiToFullRadii = (radii) => {
        if (!radii) {
            return [0, 0, 0, 0];
        }
        if (radii.length === 1) {
            return [radii[0] ?? 0, radii[0] ?? 0, radii[0] ?? 0, radii[0] ?? 0];
        }
        else if (radii.length === 2) {
            return [radii[0] ?? 0, radii[1] ?? 0, radii[0] ?? 0, radii[1] ?? 0];
        }
        else if (radii.length === 3) {
            return [radii[0] ?? 0, radii[1] ?? 0, radii[2] ?? 0, radii[1] ?? 0];
        }
        else {
            return radii;
        }
    };
    ConvertUtils.toArrayDirectionChange = (array) => {
        //          
        if (!array || array.length === 0 || !array[0] || array[0].length === 0) {
            return [];
        }
        const result = [];
        const numCols = array[0].length; //    (  )
        const numRows = array.length; //  
        for (let i = 0; i < numCols; i++) {
            const newRow = [];
            for (let j = 0; j < numRows; j++) {
                //  jagged array     array[j].length > i   
                //  T[][]    rectangular array 
                newRow.push(array[j][i]);
            }
            result.push(newRow);
        }
        return result;
    };
    // groupBy  
    ConvertUtils.groupByMap = (array, keySelector) => {
        return array.reduce((map, item) => {
            const key = keySelector(item);
            const group = map.get(key) || [];
            group.push(item);
            map.set(key, group);
            return map;
        }, new Map());
    };
    ConvertUtils.groupByObject = (array, keySelector) => {
        // groupByMap 
        const map = ConvertUtils.groupByMap(array, keySelector);
        // Map Record 
        return Object.fromEntries(map);
    };
    ConvertUtils.toURLSearchParams = (data) => {
        const searchParams = new URLSearchParams();
        if (typeof data === 'string') {
            new URLSearchParams(data).forEach((value, key) => {
                searchParams.append(key, value);
            });
        }
        else if (typeof data === 'object') {
            const forTarget = data instanceof URLSearchParams ? data.entries() : (Array.isArray(data) ? data : Object.entries(data));
            for (const [k, v] of Array.from(forTarget)) {
                if (Array.isArray(v)) {
                    v.forEach(it => searchParams.append(k, it));
                }
                else {
                    searchParams.append(k, v);
                }
            }
        }
        return searchParams;
    };
    ConvertUtils.toRawQueryString = (data, option) => {
        const params = ConvertUtils.toURLSearchParams(data);
        const dataStr = Array.from(params.entries())
            .map(([k, v]) => {
            const j = `${k}=${option?.valueEncodeURIComponent ? encodeURIComponent(v) : v}`;
            return j;
        })
            .join('&');
        return dataStr;
    };
    // export const RelativeHumanReadableTimeLabels = {
    //   [IOS3166_1_Code.KOR]: {
    //     justNow: ' ',
    //     minutesAgo: ' ',
    //     hoursAgo: ' ',
    //     daysAgo: ' ',
    //   }
    //
    // }
    // export type RelativeHumanReadableTimeLabel = {
    //   justNow: string,
    //   minutesAgo: string,
    //   hoursAgo: string,
    //   daysAgo: string,
    // };
    // export type RelativeHumanReadableTimeConfig = {
    //   label:  RelativeHumanReadableTimeLabel;
    // }
    // export const formatRelativeHumanReadableTime = (date: Date | string | number, config: RelativeHumanReadableTimeConfig): string => {
    //   if (!(date instanceof Date)) {
    //     date = new Date(date);
    //   }
    //   const now = new Date();
    //   const diffMs = now.getTime() - date.getTime();
    //   const diffMinutes = Math.floor(diffMs / (1000 * 60));
    //   const diffHours = Math.floor(diffMinutes / 60);
    //
    //   if (diffMinutes < 1) return config.label.justNow;
    //   if (diffMinutes < 60) return `${diffMinutes}${config.label.minutesAgo}`;
    //   if (diffHours < 24) return `${diffHours}${}`;
    //   return `${Math.floor(diffHours / 24)} `;
    // }
    /**
     *  JSON -   .
     *
     * @param {string} stringJson - JSON   (: "{value: this.child.obj.name}")
     * @return {Array<{ key: string, value: string }>} -  
     */
    ConvertUtils.stringJsonToKeyPairs = (stringJson) => {
        return Array.from(stringJson.matchAll(/(\w+):\s*([^,}]+)/g)).map(match => ({ key: match[1], value: match[2] }));
    };
    ConvertUtils.stringToBase64 = (str) => {
        return btoa(str);
    };
    ConvertUtils.uint8ArrayToBase64 = (bytes) => {
        let binary = '';
        const len = bytes.byteLength;
        for (let i = 0; i < len; i++) {
            binary += String.fromCharCode(bytes[i]);
        }
        return btoa(binary);
    };
    ConvertUtils.base64ToString = (base64) => {
        return atob(base64);
    };
    ConvertUtils.base64ToUint8Array = (base64) => {
        const binaryString = atob(base64);
        const len = binaryString.length;
        const bytes = new Uint8Array(len);
        for (let i = 0; i < len; i++) {
            bytes[i] = binaryString.charCodeAt(i);
        }
        return bytes;
    };
    // const formDataToFormDataEntryValueObj = <T = { [key: string]: FormDataEntryValue | FormDataEntryValue[] }>(
    //   data: FormData | HTMLFormElement
    // ): T => {
    //     if (typeof HTMLFormElement !== 'undefined' && data instanceof HTMLFormElement) {
    //         data = new FormData(data);
    //     }
    //     const obj: any = {};
    //     data.forEach((value, key) => {
    //         if (Array.isArray(obj[key])) {
    //             obj[key].push(value);
    //         } else if (obj[key] !== undefined || !isNaN(obj[key])) {
    //             obj[key] = [obj[key], value];
    //         } else {
    //             obj[key] = value;
    //         }
    //     });
    //     return obj;
    // }
})(ConvertUtils || (ConvertUtils = {}));


/***/ }),

/***/ "../../packages/@dooboostore/core/src/date/DateUtils.ts":
/*!**************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/date/DateUtils.ts ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DateUtils: () => (/* binding */ DateUtils)
/* harmony export */ });
var DateUtils;
(function (DateUtils) {
    DateUtils.create = (data) => new Date(data);
    DateUtils.dayZeroTime = (data) => {
        const date = data ? new Date(data) : new Date();
        date.setHours(0, 0, 0, 0);
        return date;
    };
    DateUtils.fullMilliSecond = () => new Date().getTime();
    DateUtils.fullSecond = () => new Date().getTime() / 1000;
    DateUtils.milliSecond = () => new Date().getMilliseconds();
    DateUtils.format = (date, format = 'yyyy-MM-dd HH:mm:ss') => {
        const pad = (num) => String(num).padStart(2, '0');
        const year = date.getFullYear();
        const month = pad(date.getMonth() + 1);
        const day = pad(date.getDate());
        const hours = pad(date.getHours());
        const minutes = pad(date.getMinutes());
        const seconds = pad(date.getSeconds());
        return format
            .replace('yyyy', String(year))
            .replace('MM', month)
            .replace('dd', day)
            .replace('HH', hours)
            .replace('mm', minutes)
            .replace('ss', seconds);
    };
    DateUtils.isSameDate = (date1, date2) => date1.getFullYear() === date2.getFullYear() &&
        date1.getMonth() === date2.getMonth() &&
        date1.getDate() === date2.getDate();
    DateUtils.compare = (date1, date2) => date1.getTime() < date2.getTime() ? -1 : date1.getTime() > date2.getTime() ? 1 : 0;
    DateUtils.weekCountOfYear = (date) => {
        // Copy date so it's not modified
        const currentDate = new Date(date.getTime());
        // Set to nearest Thursday: current date + 4 - current day number (from 0 to 6)
        // Make Sunday's day number 7
        currentDate.setDate(currentDate.getDate() + 4 - (currentDate.getDay() || 7));
        // January 1st of the year
        const yearStart = new Date(currentDate.getFullYear(), 0, 1);
        // Calculate full weeks to nearest Thursday
        const weekNo = Math.ceil(((currentDate.getTime() - yearStart.getTime()) / 86400000 + 1) / 7);
        return weekNo;
    };
    DateUtils.age = (dateOfBirth, until = new Date()) => {
        let age = until.getFullYear() - dateOfBirth.getFullYear();
        const m = until.getMonth() - dateOfBirth.getMonth();
        if (m < 0 || (m === 0 && until.getDate() < dateOfBirth.getDate())) {
            age--;
        }
        return Math.max(age, 0);
    };
    DateUtils.countingAge = (dateOfBirth, until = new Date()) => {
        return Math.max(until.getFullYear() - dateOfBirth.getFullYear(), 0) + 1;
    };
    DateUtils.add = ({ years = 0, months = 0, days = 0, minutes = 0, seconds = 0, milliSecond = 0 }, date) => {
        const result = date ? new Date(date) : new Date();
        if (years)
            result.setFullYear(result.getFullYear() + years);
        if (months)
            result.setMonth(result.getMonth() + months);
        if (days)
            result.setDate(result.getDate() + days);
        if (minutes)
            result.setMinutes(result.getMinutes() + minutes);
        if (seconds)
            result.setSeconds(result.getSeconds() + seconds);
        if (milliSecond)
            result.setMilliseconds(result.getMilliseconds() + milliSecond);
        return result;
    };
    DateUtils.toDate = (date) => {
        if (date instanceof Date) {
            return date;
        }
        else if (typeof date === 'string' || typeof date === 'number') {
            return new Date(date);
        }
        else {
            throw new Error('Invalid date type. Expected Date, string, or number.');
        }
    };
    DateUtils.sinceSeconds = (date) => Math.floor((Date.now() - date.getTime()) / 1000);
    DateUtils.toSeconds = (date = new Date()) => Math.floor(date.getTime() / 1000);
    DateUtils.toMilliseconds = (date = new Date()) => date.getTime();
    DateUtils.fromSeconds = (seconds) => new Date(seconds * 1000);
    DateUtils.fromMilliseconds = (milliseconds) => new Date(milliseconds);
    DateUtils.toISOString = (date = new Date()) => date.toISOString();
    DateUtils.fromISOString = (isoString) => new Date(isoString);
    DateUtils.formatDuration = (timeSecond, locale = DateUtils.getDefaultLocale()) => {
        const rtf = new Intl.RelativeTimeFormat(locale, { numeric: 'always', style: 'long' });
        let remaining = timeSecond;
        const days = Math.floor(remaining / 86400);
        remaining -= days * 86400;
        const hours = Math.floor(remaining / 3600);
        remaining -= hours * 3600;
        const minutes = Math.floor(remaining / 60);
        remaining -= minutes * 60;
        const seconds = remaining;
        const result = [];
        if (days > 0) {
            result.push(rtf.format(days, 'day').replace('', '').replace('in ', '').replace('dans ', ''));
        }
        if (hours > 0) {
            result.push(rtf.format(hours, 'hour').replace('', '').replace('in ', '').replace('dans ', ''));
        }
        if (minutes > 0) {
            result.push(rtf.format(minutes, 'minute').replace('', '').replace('in ', '').replace('dans ', ''));
        }
        if (seconds > 0 || result.length === 0) {
            result.push(rtf.format(seconds, 'second').replace('', '').replace('in ', '').replace('dans ', ''));
        }
        return result.join(' ');
    };
    DateUtils.relativeTime = (date, config) => {
        const rtf = new Intl.RelativeTimeFormat(config?.locales, config?.options);
        let targetDate;
        if (!(date instanceof Date)) {
            targetDate = new Date(date);
        }
        else {
            targetDate = date;
        }
        const now = new Date();
        const diffMs = targetDate.getTime() - now.getTime(); //   -  
        // , ,     
        const absDiffMinutes = Math.floor(Math.abs(diffMs) / (1000 * 60));
        const absDiffHours = Math.floor(Math.abs(diffMs) / (1000 * 60 * 60));
        const absDiffDays = Math.floor(Math.abs(diffMs) / (1000 * 60 * 60 * 24));
        if (diffMs === 0) {
            return rtf.format(0, 'seconds'); // ""  "0 /" (  )
        }
        if (diffMs < 0) { //  (   )
            if (absDiffMinutes < 1) { // 1  
                return rtf.format(-Math.floor(Math.abs(diffMs) / 1000), 'seconds'); // "  "
            }
            else if (absDiffMinutes < 60) { // 60  
                return rtf.format(-absDiffMinutes, 'minutes'); // "  "
            }
            else if (absDiffHours < 24) { // 24  
                return rtf.format(-absDiffHours, 'hours'); // "  "
            }
            else { //   
                return rtf.format(-absDiffDays, 'days'); // "  "
            }
        }
        else { //  (   )
            if (absDiffMinutes < 1) { // 1  
                return rtf.format(Math.floor(diffMs / 1000), 'seconds'); // "  "
            }
            else if (absDiffMinutes < 60) { // 60  
                return rtf.format(absDiffMinutes, 'minutes'); // "  "
            }
            else if (absDiffHours < 24) { // 24  
                return rtf.format(absDiffHours, 'hours'); // "  "
            }
            else { //   
                return rtf.format(absDiffDays, 'days'); // "  "
            }
        }
    };
    DateUtils.getDefaultLocale = () => Intl.DateTimeFormat().resolvedOptions().locale;
})(DateUtils || (DateUtils = {}));


/***/ }),

/***/ "../../packages/@dooboostore/core/src/entity/Point2D.ts":
/*!**************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/entity/Point2D.ts ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Point2D: () => (/* binding */ Point2D)
/* harmony export */ });
class Point2D {
    x;
    y;
    constructor(x, y) {
        if (typeof x === 'object') {
            this.x = x.x ?? 0;
            this.y = x.y ?? 0;
        }
        else {
            this.x = x ?? 0;
            this.y = y ?? 0;
        }
    }
    copy() {
        return new Point2D(this.x, this.y);
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/entity/Point3D.ts":
/*!**************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/entity/Point3D.ts ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Point3D: () => (/* binding */ Point3D)
/* harmony export */ });
/* harmony import */ var _Vector__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Vector */ "../../packages/@dooboostore/core/src/entity/Vector.ts");
/* harmony import */ var _Point2D__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Point2D */ "../../packages/@dooboostore/core/src/entity/Point2D.ts");


class Point3D extends _Point2D__WEBPACK_IMPORTED_MODULE_1__.Point2D {
    z;
    constructor(x, y, z) {
        if (x instanceof _Vector__WEBPACK_IMPORTED_MODULE_0__.Vector) {
            super(x.x, x.y);
            this.z = x.z;
        }
        else if (typeof x === 'object') {
            super({ x: x.x ?? 0, y: x.y ?? 0 });
            this.z = x.z ?? 0;
        }
        else {
            super(x, y);
            this.z = z ?? 0;
        }
    }
    copy() {
        return new Point3D(this.x, this.y, this.z);
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/entity/Rect.ts":
/*!***********************************************************!*\
  !*** ../../packages/@dooboostore/core/src/entity/Rect.ts ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Rect: () => (/* binding */ Rect)
/* harmony export */ });
/* harmony import */ var _Point2D__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Point2D */ "../../packages/@dooboostore/core/src/entity/Point2D.ts");
/* harmony import */ var _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../math/MathUtil */ "../../packages/@dooboostore/core/src/math/MathUtil.ts");
/* harmony import */ var _SizeType__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./SizeType */ "../../packages/@dooboostore/core/src/entity/SizeType.ts");



const isValueLinkControl = (data) => {
    return typeof data === 'object' && 'value' in data && 'noLink' in data;
    // return data.value !== undefined && data.noLink !== undefined && typeof data.value === 'object' && typeof data.noLink === 'boolean';
};
class Rect {
    _start;
    _width;
    _height;
    linkRects;
    constructor(xOrPoint, yOrPointOrWidth, widthOrHeight = 0, heightOrUndefined = 0) {
        if ((0,_SizeType__WEBPACK_IMPORTED_MODULE_2__.isSizeType)(xOrPoint)) {
            this._start = new _Point2D__WEBPACK_IMPORTED_MODULE_0__.Point2D(0, 0);
            this._width = xOrPoint.width;
            this._height = xOrPoint.height;
        }
        else if (typeof xOrPoint === 'object' && typeof yOrPointOrWidth === 'object') {
            this._start = xOrPoint instanceof _Point2D__WEBPACK_IMPORTED_MODULE_0__.Point2D ? xOrPoint : new _Point2D__WEBPACK_IMPORTED_MODULE_0__.Point2D(xOrPoint.x, xOrPoint.y);
            this.end = yOrPointOrWidth instanceof _Point2D__WEBPACK_IMPORTED_MODULE_0__.Point2D ? yOrPointOrWidth : new _Point2D__WEBPACK_IMPORTED_MODULE_0__.Point2D(yOrPointOrWidth.x, yOrPointOrWidth.y);
        }
        else if (typeof xOrPoint === 'object' && typeof yOrPointOrWidth === 'number') {
            this._start = xOrPoint instanceof _Point2D__WEBPACK_IMPORTED_MODULE_0__.Point2D ? xOrPoint : new _Point2D__WEBPACK_IMPORTED_MODULE_0__.Point2D(xOrPoint.x, xOrPoint.y);
            this._width = yOrPointOrWidth;
            this._height = widthOrHeight;
        }
        else if (typeof xOrPoint === 'number' && typeof yOrPointOrWidth === 'number') {
            this._start = new _Point2D__WEBPACK_IMPORTED_MODULE_0__.Point2D(xOrPoint, yOrPointOrWidth);
            this._width = widthOrHeight;
            this._height = heightOrUndefined;
        }
    }
    valueLinkControl(value) {
        let v;
        let noLink = false;
        if (isValueLinkControl(value)) {
            v = value.value;
            noLink = value.noLink;
        }
        else {
            v = value;
        }
        return { value: v, noLink };
    }
    get width() {
        return this._width;
    }
    get height() {
        return this._height;
    }
    get start() {
        return this._start.copy();
    }
    ////////////////////
    set width(width) {
        this.setWidth(width);
    }
    setWidth(width) {
        let { value, noLink } = this.valueLinkControl(width);
        const percentDiff = _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getPercentByTotal(this._width, value);
        this._width = value;
        this.applyWidthPercentLinks({ value: percentDiff, noLink });
    }
    set height(height) {
        this.setHeight(height);
    }
    setHeight(height) {
        let { value, noLink } = this.valueLinkControl(height);
        const percentDiff = _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getPercentByTotal(this._height, value);
        this._height = value;
        this.applyHeightPercentLinks({ value: percentDiff, noLink });
    }
    set start(inputValue) {
        let { value, noLink } = this.valueLinkControl(inputValue);
        const percentDiff = new _Point2D__WEBPACK_IMPORTED_MODULE_0__.Point2D({ x: _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getPercentByTotal(this._start.x, value.x), y: _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getPercentByTotal(this._start.y, value.y) });
        this._start = value;
        this.applyStartPercentLinks({ value: percentDiff, noLink });
    }
    //  ?
    setWidthFromEnd(inputValue) {
        let { value, noLink } = this.valueLinkControl(inputValue);
        const percentDiff = _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getPercentByTotal(this.start.x, value);
        this._start.x = this.end.x - value;
        this.applyStartXPercentLinks({ value: percentDiff, noLink });
    }
    set widthFromEnd(inputValue) {
        this.setWidthFromEnd(inputValue);
    }
    //  ?
    setHeightFromEnd(inputValue) {
        let { value, noLink } = this.valueLinkControl(inputValue);
        const diff = this.end.y - value;
        const percentDiff = _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getPercentByTotal(this.start.y, diff);
        this._start.y = diff;
        this.applyStartYPercentLinks({ value: percentDiff, noLink });
    }
    set heightFromEnd(inputValue) {
        this.setHeightFromEnd(inputValue);
    }
    setWidthFromCenter(inputValue) {
        let { value, noLink } = this.valueLinkControl(inputValue);
        const diff = this.center.x - (value / 2);
        const percentDiff = _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getPercentByTotal(this.start.x, diff);
        this._start.x = diff;
        this.applyStartXPercentLinks(percentDiff);
    }
    set widthFromCenter(inputValue) {
        this.setWidthFromCenter(inputValue);
    }
    setHeightFromCenter(inputValue) {
        let { value, noLink } = this.valueLinkControl(inputValue);
        const diff = this.center.y - (value / 2);
        const percentDiff = _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getPercentByTotal(this.start.y, diff);
        this._start.y = diff;
        this.applyStartYPercentLinks(percentDiff);
    }
    set heightFromCenter(inputValue) {
        let { value, noLink } = this.valueLinkControl(inputValue);
        const diff = this.center.y - (value / 2);
        const percentDiff = _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getPercentByTotal(this.start.y, diff);
        this._start.y = diff;
        this.applyStartYPercentLinks(percentDiff);
    }
    set x(inputValue) {
        this.setX(inputValue);
    }
    setX(inputValue) {
        let { value, noLink } = this.valueLinkControl(inputValue);
        const diff = value - this._start.x;
        const percentDiff = _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getPercentByTotal(this.width, diff);
        this._start.x = value;
        this.applyStartXPercentLinks({ value: percentDiff, noLink });
    }
    set y(inputValue) {
        this.setY(inputValue);
    }
    setY(inputValue) {
        let { value, noLink } = this.valueLinkControl(inputValue);
        const diff = value - this._start.y;
        const percentDiff = _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getPercentByTotal(this.height, diff);
        this._start.y = value;
        this.applyStartYPercentLinks({ value: percentDiff, noLink });
    }
    ////////////////////////////
    applyWidthPercentLinks(widthPercent) {
        let { value, noLink } = this.valueLinkControl(widthPercent);
        if (this.linkRects && (typeof noLink === 'boolean' ? !noLink : true)) {
            Array.from(this.linkRects.values()).filter(it => {
                return typeof noLink === 'boolean' ? true : it !== noLink;
            }).forEach(it => {
                it.setWidthByWidthPercent({ value: value, noLink: this });
            });
        }
    }
    applyHeightPercentLinks(heightPercent) {
        let { value, noLink } = this.valueLinkControl(heightPercent);
        if (this.linkRects && (typeof noLink === 'boolean' ? !noLink : true)) {
            Array.from(this.linkRects.values()).filter(it => {
                return typeof noLink === 'boolean' ? true : it !== noLink;
            }).forEach(it => {
                it.setHeightByHeightPercent({ value: value, noLink: this });
            });
        }
    }
    applyStartPercentLinks(startPercent) {
        let { value, noLink } = this.valueLinkControl(startPercent);
        this.applyStartXPercentLinks({ value: value.x, noLink });
        this.applyStartYPercentLinks({ value: value.y, noLink });
    }
    applyStartXPercentLinks(xPercent) {
        let { value, noLink } = this.valueLinkControl(xPercent);
        if (this.linkRects && (typeof noLink === 'boolean' ? !noLink : true)) {
            Array.from(this.linkRects.values()).filter(it => {
                return typeof noLink === 'boolean' ? true : it !== noLink;
            }).forEach(it => {
                it.addXByWidthPercent({ value: value, noLink: this });
            });
        }
    }
    applyStartYPercentLinks(yPercent) {
        let { value, noLink } = this.valueLinkControl(yPercent);
        if (this.linkRects && (typeof noLink === 'boolean' ? !noLink : true)) {
            Array.from(this.linkRects.values()).filter(it => {
                return typeof noLink === 'boolean' ? true : it !== noLink;
            }).forEach(it => {
                it.addYByHeightPercent({ value: value, noLink: this });
            });
        }
    }
    hasLink(rect) {
        return this.linkRects?.has(rect);
    }
    isLinked() {
        return !!this.linkRects?.size;
    }
    addLink(...rect) {
        this.linkRects ??= new Set();
        rect.filter(it => !this.linkRects?.has(it)).forEach(it => {
            this.linkRects?.add(it);
            it.addLink(this);
        });
    }
    setLinks(rects) {
        this.unLinkAll();
        this.addLink(...rects);
    }
    unLinkAll() {
        if (this.linkRects) {
            Array.from(this.linkRects.values()).forEach(it => {
                this.unLink(it);
            });
            this.linkRects.clear();
        }
    }
    unLink(rect) {
        let { value, noLink } = this.valueLinkControl(rect);
        if (this.linkRects) {
            this.linkRects.delete(value);
        }
        if (!noLink)
            value.unLink({ value: this, noLink: this });
    }
    addWidthPercent(wPercent) {
        let { value, noLink } = this.valueLinkControl(wPercent);
        this.setWidth({ value: this.width + _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInPercent(this.width, value), noLink });
    }
    addHeightPercent(hPercent) {
        let { value, noLink } = this.valueLinkControl(hPercent);
        this.setHeight({ value: this.height + _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInPercent(this.height, value), noLink });
    }
    addWidthRatio(wRatio) {
        this.width = this.width + _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInRatio(this.width, wRatio);
    }
    addHeightRatio(hRatio) {
        this.height = this.height + _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInRatio(this.height, hRatio);
    }
    addXPercent(wPercent) {
        let { value, noLink } = this.valueLinkControl(wPercent);
        this.setX({ value: this.x + _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInPercent(this.width, value), noLink });
    }
    addYPercent(hPercent) {
        let { value, noLink } = this.valueLinkControl(hPercent);
        this.setY({ value: this.y + _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInPercent(this.height, value), noLink });
    }
    addXRatio(wRatio) {
        let { value, noLink } = this.valueLinkControl(wRatio);
        this.setX({ value: this.x + _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInRatio(this.width, value), noLink });
    }
    addYRatio(hRatio) {
        let { value, noLink } = this.valueLinkControl(hRatio);
        this.setY({ value: this.y + _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInRatio(this.height, value), noLink });
    }
    ////////////
    set endX(value) {
        const diff = value - this.x;
        this.width = diff;
    }
    set endXPercent(endXPercent) {
        this.endX = _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInPercent(this.width, endXPercent);
    }
    set endYPercent(endYPercent) {
        this.endY = _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInPercent(this.height, endYPercent);
    }
    set endY(value) {
        this.height = value - this.y;
    }
    set end(value) {
        this.width = value.x - this.x;
        this.height = value.y - this.y;
    }
    get x() {
        return this.start.x;
    }
    get y() {
        return this.start.y;
    }
    get endX() {
        return this.end.x;
    }
    get endY() {
        return this.end.y;
    }
    to(startPoint) {
        const r = this.copy();
        r.start = startPoint;
        return r;
    }
    toRotate(r, { rotatePoint = this.center, type = 'degreeAngle' }) {
        const angle = _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.radians(r, { type });
        const centerPoint = rotatePoint instanceof _Point2D__WEBPACK_IMPORTED_MODULE_0__.Point2D ? rotatePoint : new _Point2D__WEBPACK_IMPORTED_MODULE_0__.Point2D(rotatePoint.x, rotatePoint.y);
        const points = [
            this.leftTop,
            this.rightTop,
            this.rightBottom,
            this.leftBottom
        ];
        return points.map(p => _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.rotatePoint(p, centerPoint, angle));
    }
    get center() {
        return new _Point2D__WEBPACK_IMPORTED_MODULE_0__.Point2D(this.start.x + (this.width / 2), this.start.y + (this.height / 2));
    }
    get end() {
        return new _Point2D__WEBPACK_IMPORTED_MODULE_0__.Point2D(this.start.x + this.width, this.start.y + this.height);
    }
    get leftTop() {
        return this.start.copy();
    }
    get leftBottom() {
        return new _Point2D__WEBPACK_IMPORTED_MODULE_0__.Point2D(this.start.x, this.end.y);
    }
    get rightTop() {
        return new _Point2D__WEBPACK_IMPORTED_MODULE_0__.Point2D(this.end.x, this.start.y);
    }
    get rightBottom() {
        return this.end;
    }
    copy() {
        return new Rect(this.x, this.y, this.width, this.height);
    }
    /////////////////
    getWidthPercent(width) {
        return _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getPercentByTotal(this.width, width);
    }
    getWidthRatio(width) {
        return _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getRatioByTotal(this.width, width);
    }
    getWidthByPercent(percent) {
        return _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInPercent(this.width, percent);
    }
    getWidthByRatio(percent) {
        return _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInRatio(this.width, percent);
    }
    getHeightPercent(height) {
        return _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getPercentByTotal(this.height, height);
    }
    getHeightRatio(height) {
        return _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getRatioByTotal(this.height, height);
    }
    getHeightByPercent(percentY) {
        return _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInPercent(this.height, percentY);
    }
    getHeightByRatio(ratio) {
        return _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInRatio(this.height, ratio);
    }
    getXPercent(x) {
        return _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getPercentByTotal(this.width, x - this.x);
    }
    getXRatio(x) {
        return _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getRatioByTotal(this.width, x - this.x);
    }
    getXByPercent(xPercent) {
        return this.x + _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInPercent(this.width, xPercent);
    }
    getXByRatio(ratio) {
        return this.x + _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInRatio(this.width, ratio);
    }
    getYPercent(y) {
        return _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getPercentByTotal(this.height, y - this.y);
    }
    getYRatio(y) {
        return _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getRatioByTotal(this.height, y - this.y);
    }
    getYByPercent(yPercent) {
        return this.y + _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInPercent(this.height, yPercent);
    }
    getYByRatio(ratio) {
        return this.y + _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInRatio(this.height, ratio);
    }
    getPercent(point) {
        return new _Point2D__WEBPACK_IMPORTED_MODULE_0__.Point2D(this.getXPercent(point.x), this.getYPercent(point.y));
    }
    /**
     *  width    height   Rect .
     * @param width  width 
     * @returns   height  Rect
     */
    toScaleByWidth(width) {
        const ratio = this.height / this.width;
        return new Rect(this.x, this.y, width, width * ratio);
    }
    /**
     *  height    width   Rect .
     * @param height  height 
     * @returns   width  Rect
     */
    toScaleByHeight(height) {
        const ratio = this.width / this.height;
        return new Rect(this.x, this.y, height * ratio, height);
    }
    toRatio(point) {
        return new Rect(this.getXRatio(point.x), this.getYRatio(point.y), this.getWidthRatio(point instanceof Rect ? point.width : point.w), this.getHeightRatio(point instanceof Rect ? point.height : point.h));
    }
    getRatio(point) {
        return new _Point2D__WEBPACK_IMPORTED_MODULE_0__.Point2D(this.getXRatio(point.x), this.getYRatio(point.y));
    }
    getByPercent(percent) {
        return new _Point2D__WEBPACK_IMPORTED_MODULE_0__.Point2D(this.getXByPercent(percent.x), this.getYByPercent(percent.y));
    }
    getByRatio(ratio) {
        return new _Point2D__WEBPACK_IMPORTED_MODULE_0__.Point2D(this.getXByRatio(ratio.x), this.getYByRatio(ratio.y));
    }
    getDiffX(x) {
        return x - this.x;
    }
    getDiffY(y) {
        return y - this.y;
    }
    getDiffLeft(x) {
        this.getDiffX(x);
    }
    getDiffTop(y) {
        this.getDiffY(y);
    }
    getDiffRight(x) {
        return x - this.end.x;
    }
    getDiffBottom(y) {
        return y - this.end.y;
    }
    getDiffWidth(width) {
        return width - this.width;
    }
    getDiffHeight(height) {
        return height - this.height;
    }
    toDiff(rect) {
        return new Rect(rect.x - this.x, rect.y - this.y, rect.width - this.width, rect.height - this.height);
    }
    setXByWidthPercent(wPercent) {
        let { value, noLink } = this.valueLinkControl(wPercent);
        this.setX({ value: _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInPercent(this.width, value), noLink });
    }
    set xByWidthPercent(wPercent) {
        this.setXByWidthPercent(wPercent);
    }
    setXByWidthRatio(wRatio) {
        let { value, noLink } = this.valueLinkControl(wRatio);
        this.setX({ value: _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInRatio(this.width, value), noLink });
    }
    set xByWidthRatio(wRatio) {
        this.setXByWidthRatio(wRatio);
    }
    setYByHeightPercent(hPercent) {
        let { value, noLink } = this.valueLinkControl(hPercent);
        this.setY({ value: _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInPercent(this.height, value), noLink });
    }
    set yByHeightPercent(hPercent) {
        this.setYByHeightPercent(hPercent);
    }
    setYByHeightRatio(ratio) {
        let { value, noLink } = this.valueLinkControl(ratio);
        this.setY({ value: _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInRatio(this.height, value), noLink });
    }
    set yByHeightRatio(ratio) {
        this.setYByHeightRatio(ratio);
    }
    addXByWidthPercent(wPercent) {
        let { value, noLink } = this.valueLinkControl(wPercent);
        this.setX({ value: this.x + _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInPercent(this.width, value), noLink });
    }
    addXByWidthRatio(wRatio) {
        let { value, noLink } = this.valueLinkControl(wRatio);
        this.setX({ value: this.x + _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInRatio(this.width, value), noLink });
    }
    addYByHeightPercent(hPercent) {
        let { value, noLink } = this.valueLinkControl(hPercent);
        this.setY({ value: this.y + _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInPercent(this.height, value), noLink });
    }
    addYByHeightRatio(ratio) {
        let { value, noLink } = this.valueLinkControl(ratio);
        this.setY({ value: this.y + _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInRatio(this.height, value), noLink });
    }
    setWidthByWidthPercent(wPercent) {
        let { value, noLink } = this.valueLinkControl(wPercent);
        this.setWidth({ value: _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInPercent(this.width, value), noLink });
    }
    set widthByWidthPercent(wPercent) {
        this.setWidthByWidthPercent(wPercent);
    }
    setWidthByWidthRatio(wRatio) {
        let { value, noLink } = this.valueLinkControl(wRatio);
        this.setWidth({ value: _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInRatio(this.width, value), noLink });
    }
    set widthByWidthRatio(wRatio) {
        this.setWidthByWidthRatio(wRatio);
    }
    setHeightByHeightPercent(hPercent) {
        let { value, noLink } = this.valueLinkControl(hPercent);
        this.setHeight({ value: _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInPercent(this.height, value), noLink });
    }
    set heightByHeightPercent(hPercent) {
        this.setHeightByHeightPercent(hPercent);
    }
    setHeightByHeightRatio(hRatio) {
        let { value, noLink } = this.valueLinkControl(hRatio);
        this.setHeight({ value: _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInRatio(this.height, value), noLink });
    }
    set heightByHeightRatio(hRatio) {
        this.setHeightByHeightRatio(hRatio);
    }
    copyByPercent(percentOrX, percentY) {
        return new Rect(this.x, this.y, _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInPercent(this.width, percentOrX), _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInPercent(this.height, percentY ?? percentOrX));
    }
    copyByRatio(ratioOrX, ratioY) {
        return new Rect(this.x, this.y, _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInRatio(this.width, ratioOrX), _math_MathUtil__WEBPACK_IMPORTED_MODULE_1__.MathUtil.getValueByTotalInRatio(this.height, ratioY ?? ratioOrX));
    }
    isIn(data) {
        if (data instanceof Rect) {
            return this.isIn(data.start) && this.isIn(data.end);
        }
        else {
            return data.x >= this.start.x && data.x <= this.end.x && data.y >= this.start.y && data.y <= this.end.y;
        }
    }
    isOut(data) {
        if (data instanceof Rect) {
            return !this.isOverlap(data);
        }
        else {
            return !this.isIn(data);
        }
    }
    isOverlap(data) {
        if (data instanceof Rect) {
            /*
          "  " ,     "" 
        .         .
      
         (A B)  ,        .
         1. A B    
             * A  (this.endX) B  (data.x)   
             * : this.endX < data.x
      
      
         2. A B    
             * A  (this.x) B  (data.endX)   
             * : this.x > data.endX
      
      
         3. A B    
             * A  (this.endY) B  (data.y)   
             * : this.endY < data.y
      
      
         4. A B    
             * A  (this.y) B  (data.endY)   
             * : this.y > data.endY
             */
            const noOverlap = this.endX < data.x ||
                this.x > data.endX ||
                this.endY < data.y ||
                this.y > data.endY;
            return !noOverlap;
            // return (
            //   this.isOverlap(data.leftTop) ||
            //   this.isOverlap(data.rightTop) ||
            //   this.isOverlap(data.rightBottom) ||
            //   this.isOverlap(data.leftBottom)) ||
            //   (
            //     data.start.x < this.x && data.start.y < this.y &&
            //     data.end.x > this.end.x && data.end.y > this.end.y
            //   );
        }
        else {
            return this.isIn(data);
        }
    }
    toString() {
        return `x:${this.x}, y:${this.y}, width: ${this.width}, height: ${this.height}`;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/entity/SizeType.ts":
/*!***************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/entity/SizeType.ts ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isSizeType: () => (/* binding */ isSizeType)
/* harmony export */ });
const isSizeType = (obj) => !!obj &&
    typeof obj.width === 'number' &&
    typeof obj.height === 'number';


/***/ }),

/***/ "../../packages/@dooboostore/core/src/entity/Vector.ts":
/*!*************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/entity/Vector.ts ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Vector: () => (/* binding */ Vector)
/* harmony export */ });
/* harmony import */ var _Point3D__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Point3D */ "../../packages/@dooboostore/core/src/entity/Point3D.ts");
/* harmony import */ var _Point2D__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Point2D */ "../../packages/@dooboostore/core/src/entity/Point2D.ts");
// https://p5js.org/ko/


class Vector {
    x;
    y;
    z;
    constructor(x, y, z) {
        if (x instanceof _Point3D__WEBPACK_IMPORTED_MODULE_0__.Point3D) {
            this.x = x.x;
            this.y = x.y;
            this.z = x.z;
        }
        else if (typeof x === 'object') {
            this.x = x.x ?? 0;
            this.y = x.y ?? 0;
            this.z = x.z ?? 0;
        }
        else {
            this.x = x ?? 0;
            this.y = y ?? 0;
            this.z = z ?? 0;
        }
    }
    set(v, y = 0, z = 0) {
        if (v instanceof Vector || v instanceof _Point3D__WEBPACK_IMPORTED_MODULE_0__.Point3D) {
            this.set(v.x || 0, v.y || 0, v.z || 0);
        }
        else {
            this.x = v;
            this.y = y;
            this.z = z;
        }
        return this;
    }
    get() {
        return new Vector(this.x, this.y, this.z);
    }
    //   a   b   c     .
    mag() {
        const x = this.x;
        const y = this.y;
        const z = this.z;
        return Math.sqrt(x * x + y * y + z * z); //     .
    }
    add(v, y = 0, z = 0) {
        if (v instanceof Vector || v instanceof _Point3D__WEBPACK_IMPORTED_MODULE_0__.Point3D) {
            this.x += v.x;
            this.y += v.y;
            this.z += v.z;
        }
        else {
            this.x += v;
            this.y += y;
            this.z += z;
        }
    }
    toAdd(v1, v2) {
        return new Vector(v1.x + v2.x, v1.y + v2.y, v1.x + v2.y);
    }
    // public static add(v1: Vector, v2: Vector): Vector {
    //   return new Vector(v1.x + v2.x, v1.y + v2.y, v1.x + v2.y);
    // }
    sub(v, y = 0, z = 0) {
        if (v instanceof Vector || v instanceof _Point3D__WEBPACK_IMPORTED_MODULE_0__.Point3D) {
            this.x -= v.x;
            this.y -= v.y;
            this.z -= v.z;
        }
        else {
            this.x -= v;
            this.y -= y;
            this.z -= z;
        }
    }
    toSub(v2) {
        const v1 = this;
        return new Vector(v1.x - v2.x, v1.y - v2.y, v1.z - v2.z);
    }
    //
    // public static sub(v1: Vector, v2: Vector): Vector {
    //     return new Vector(v1.x - v2.x, v1.y - v2.y, v1.z - v2.z);
    // }
    mult(v) {
        if (v instanceof Vector || v instanceof _Point3D__WEBPACK_IMPORTED_MODULE_0__.Point3D) {
            this.x *= v.x;
            this.y *= v.y;
            this.z *= v.z;
        }
        else {
            this.x *= v;
            this.y *= v;
            this.z *= v;
        }
        return this;
    }
    toMult(v2) {
        const v1 = this;
        return new Vector(v1.x *= v2.x, v1.y *= v2.y, v1.z *= v2.z);
    }
    // public static mult(v1: Vector, v2: Vector) {
    //   return new Vector(v1.x *= v2.x, v1.y *= v2.y, v1.z *= v2.z);
    // }
    div(v) {
        if (v instanceof Vector || v instanceof _Point3D__WEBPACK_IMPORTED_MODULE_0__.Point3D) {
            this.x /= v.x;
            this.y /= v.y;
            this.z /= v.z;
        }
        else {
            this.x /= v;
            this.y /= v;
            this.z /= v;
        }
        return this;
    }
    toDiv(d) {
        const v = this;
        const rv = v.get();
        rv.x /= d;
        rv.y /= d;
        rv.z /= d;
        return rv;
    }
    // public static div(v: Vector, d: number): Vector {
    //   const rv = v.get();
    //   rv.x /= d;
    //   rv.y /= d;
    //   rv.z /= d;
    //   return rv;
    // }
    dist(v) {
        const dx = this.x - v.x, dy = this.y - v.y, dz = this.z - v.z;
        return Math.sqrt(dx * dx + dy * dy + dz * dz);
    }
    toDist(v2) {
        const v1 = this;
        const dx = v1.x - v2.x, dy = v1.y - v2.y, dz = v1.z - v2.z;
        return Math.sqrt(dx * dx + dy * dy + dz * dz);
    }
    // public static dist(v1: Vector, v2: Vector): number {
    //   const dx = v1.x - v2.x,
    //     dy = v1.y - v2.y,
    //     dz = v1.z - v2.z;
    //   return Math.sqrt(dx * dx + dy * dy + dz * dz);
    // }
    dot(v, y, z) {
        if (v instanceof Vector || v instanceof _Point3D__WEBPACK_IMPORTED_MODULE_0__.Point3D) {
            return this.x * v.x + this.y * v.y + this.z * v.z;
        }
        ;
        return this.x * v + this.y * y + this.z * z;
    }
    cross(v) {
        const x = this.x, y = this.y, z = this.z;
        return new Vector(y * v.z - v.y * z, z * v.x - v.z * x, x * v.y - v.x * y);
    }
    normalize() {
        const m = this.mag();
        if (m > 0)
            this.div(m);
    }
    limit(high) {
        if (this.mag() > high) {
            this.normalize();
            this.mult(high);
        }
    }
    heading2D() {
        return -Math.atan2(-this.y, this.x);
    }
    random2D() {
        return this.fromAngle(Math.random() * (2 * Math.PI));
    }
    fromAngle(angle, length = 1) {
        return new Vector(length * Math.cos(angle), length * Math.sin(angle), 0);
    }
    ;
    fromAngles(theta, phi, length = 1) {
        const cosPhi = Math.cos(phi);
        const sinPhi = Math.sin(phi);
        const cosTheta = Math.cos(theta);
        const sinTheta = Math.sin(theta);
        return new Vector(length * sinTheta * sinPhi, -length * cosTheta, length * sinTheta * cosPhi);
    }
    ;
    array() {
        return [this.x, this.y, this.z];
    }
    toPoint3D() {
        return new _Point3D__WEBPACK_IMPORTED_MODULE_0__.Point3D(this.x, this.y, this.z);
    }
    toPoint2D() {
        return new _Point2D__WEBPACK_IMPORTED_MODULE_1__.Point2D(this.x, this.y);
    }
    copy() {
        return new Vector(this.x, this.y, this.z);
    }
    toString() {
        return '[' + this.x + ', ' + this.y + ', ' + this.z + ']';
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/entity/object/obj/Obj.ts":
/*!*********************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/entity/object/obj/Obj.ts ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Obj: () => (/* binding */ Obj)
/* harmony export */ });
/* harmony import */ var _Vector__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../Vector */ "../../packages/@dooboostore/core/src/entity/Vector.ts");
/* harmony import */ var _Rect__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../Rect */ "../../packages/@dooboostore/core/src/entity/Rect.ts");


class Obj extends _Vector__WEBPACK_IMPORTED_MODULE_0__.Vector {
    volume = 0; // 
    mass = 0; // 
    e = 0; // 
    rotate = 0; // 
    width = 0; // 
    height = 0; // 
    data;
    // public age = 0; //   
    // https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/transform
    /*
    a, d: / 
    b, c: (skew)
    e, f: (translate)
    --------------
    a, b, c, d, e, f
   */
    transform = [1, 0, 0, 1, 0, 0];
    color = {
        r: 0,
        g: 0,
        b: 0,
        a: 255
    };
    id;
    // public data?: T;
    constructor(data) {
        super();
        this.updateObjWithDefaults(data);
    }
    copyObj() {
        return new Obj({
            x: this.x,
            y: this.y,
            z: this.z,
            volume: this.volume,
            mass: this.mass,
            e: this.e,
            rotate: this.rotate,
            width: this.width,
            height: this.height,
            transform: [...this.transform],
            color: { ...this.color },
            data: { ...this.data }
        });
    }
    updateObjWithDefaults(data) {
        if (data) {
            this.x = data.x ?? this.x;
            this.y = data.y ?? this.y;
            this.z = data.z ?? this.z;
            this.volume = data.volume ?? this.volume;
            this.mass = data.mass ?? this.mass;
            this.e = data.e ?? this.e;
            this.rotate = data.rotate ?? this.rotate;
            this.width = data.width ?? this.width;
            this.height = data.height ?? this.height;
            this.transform = [...(data.transform ?? this.transform)];
            this.color = { ...(data.color ?? this.color) };
            const t = data.data ?? this.data;
            this.data = t ? { ...t } : undefined;
        }
    }
    setObj(data) {
        if (data) {
            this.x = data.x ?? 0;
            this.y = data.y ?? 0;
            this.z = data.z ?? 0;
            this.volume = data.volume ?? 0;
            this.mass = data.mass ?? 0;
            this.e = data.e ?? 0;
            this.rotate = data.rotate ?? 0;
            this.width = data.width ?? 0;
            this.height = data.height ?? 0;
            this.transform = [...(data.transform ?? [1, 0, 0, 1, 0, 0])];
            this.color = { ...(data.color ?? { r: 0, g: 0, b: 0, a: 255 }) };
            const data1 = data.data;
            this.data = data1 ? { ...data1 } : undefined;
        }
    }
    toRect() {
        return new _Rect__WEBPACK_IMPORTED_MODULE_1__.Rect(this.x, this.y, this.width, this.height);
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/expression/Expression.ts":
/*!*********************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/expression/Expression.ts ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Expression: () => (/* binding */ Expression)
/* harmony export */ });
var Expression;
(function (Expression) {
    // html = html.replace(/\$\{[\s\S]*?\}\$/g, '');
    Expression.bindExpression = (expression, bind) => {
        // ${data}  wow  ${wow:parameter}
        // expression ${...}    
        return (expression ?? '').replace(/\$\{([\s\S.]*?)\}/g, (_, group) => {
            //   : name:param
            const [name, param] = group.split(':');
            const binder = bind[name];
            if (!binder)
                return '';
            if (typeof binder === 'function') {
                return binder(bind[param]);
            }
            return binder;
        });
    };
    /**
     * @deprecated
     */
    // export namespace Group {
    // export const isExpression = (data: string | null) => {
    //     // const reg = /(?:[$#]\{(?:(([$#]\{)??[^$#]?[^{]*?)\}[$#]))/g;
    //     const reg = /[$#]\{([\s\S.]*?)\}[$#]/g;
    //     return reg.test(data ?? '');
    //   }
    //
    // export const expressionGroups = (data: string | null) => {
    //     // const reg = /(?:[$#]\{(?:(([$#]\{)??[^$#]*?)\}[$#]))/g;
    //     // const reg = /(?:[$#]\{(?:(([$#]\{)??[^$#]?[^{]*?)\}[$#]))/g;
    //     const reg = /[$#]\{([\s\S.]*?)\}[$#]/g;
    //     return StringUtils.regexExec(reg, data ?? '');
    //   }
    // }
    let Path;
    (function (Path) {
        Path.pathNameData = (pathName, urlExpression) => {
            const urls = pathName.split('/');
            const urlExpressions = urlExpression.split('/');
            if (urls.length !== urlExpressions.length) {
                return;
            }
            const data = {};
            for (let i = 0; i < urlExpressions.length; i++) {
                const it = urlExpressions[i];
                const urlit = urls[i];
                // ex) {serialNo:[0-9]+} or {no}  ..
                const execResult = /^\{(.+)\}$/g.exec(it);
                if (!execResult) {
                    if (it !== urlit) {
                        return;
                    }
                    continue;
                }
                // regex check
                const [name, regex] = execResult[1].split(':'); // group1
                if (regex && !new RegExp(regex).test(urlit)) {
                    return;
                }
                data[name] = urlit;
            }
            return data;
        };
    })(Path = Expression.Path || (Expression.Path = {}));
})(Expression || (Expression = {}));


/***/ }),

/***/ "../../packages/@dooboostore/core/src/fetch/Fetcher.ts":
/*!*************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/fetch/Fetcher.ts ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Fetcher: () => (/* binding */ Fetcher)
/* harmony export */ });
class Fetcher {
    createPipe(config) {
        return {};
    }
    fetch(config) {
        return new Promise((resolve, reject) => {
            const pipe = this.createPipe(config);
            Promise.resolve()
                .then(() => {
                this.before(config, pipe);
                config?.before?.();
            })
                .then(() => {
                return this.execute(config);
                // return this.execute(config.target, config?.config);
            })
                .then(data => {
                const hasError = config.config?.hasErrorChecker?.(data);
                if (hasError) {
                    throw hasError;
                }
                pipe.responseData = data;
                this.afterSuccess(config, pipe);
                config?.afterSuccess?.();
                const gdata = (config?.transform ? config.transform(data) : data);
                this.afterSuccessTransform(config, pipe);
                resolve(gdata);
            })
                .catch(async (e) => {
                this.error(config, pipe, e);
                config?.error?.();
                if (config?.errorTransform) {
                    e = await config.errorTransform(e);
                }
                e = await this.errorTransform(e);
                reject(e);
            })
                .finally(() => {
                this.finally(config, pipe);
                config?.finally?.();
            });
        });
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/fetch/HttpFetcher.ts":
/*!*****************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/fetch/HttpFetcher.ts ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   HttpFetcher: () => (/* binding */ HttpFetcher),
/* harmony export */   HttpResponseError: () => (/* binding */ HttpResponseError),
/* harmony export */   isHttpResponseError: () => (/* binding */ isHttpResponseError)
/* harmony export */ });
/* harmony import */ var _Fetcher__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Fetcher */ "../../packages/@dooboostore/core/src/fetch/Fetcher.ts");
/* harmony import */ var _convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../convert/ConvertUtils */ "../../packages/@dooboostore/core/src/convert/ConvertUtils.ts");


class HttpResponseError extends Error {
    error;
    body;
    response;
}
const isHttpResponseError = (data) => {
    return data instanceof HttpResponseError;
};
class HttpFetcher extends _Fetcher__WEBPACK_IMPORTED_MODULE_0__.Fetcher {
    get(config) {
        config.config ??= {};
        config.config.fetch = config.config?.fetch ?? {};
        config.config.fetch.method = 'GET';
        return this.fetch(config);
    }
    post(config) {
        config.config ??= {};
        config.config.fetch = config.config?.fetch ?? {};
        config.config.fetch.method = 'POST';
        return this.fetch(config);
    }
    patch(config) {
        config.config ??= {};
        config.config.fetch = config.config?.fetch ?? {};
        config.config.fetch.method = 'PATCH';
        return this.fetch(config);
    }
    put(config) {
        config.config ??= {};
        config.config.fetch = config.config?.fetch ?? {};
        config.config.fetch.method = 'PUT';
        return this.fetch(config);
    }
    head(config) {
        config.config ??= {};
        config.config.fetch = config.config?.fetch ?? {};
        config.config.fetch.method = 'HEAD';
        return this.fetch(config);
    }
    delete(config) {
        config.config ??= {};
        config.config.fetch = config.config?.fetch ?? {};
        config.config.fetch.method = 'DELETE';
        return this.fetch(config);
    }
    async beforeProxyFetch(config) {
        return config;
    }
    async afterProxyFetch(config) {
        return config.response;
    }
    afterSuccess(config, pipe) { }
    afterSuccessTransform(config, pipe) { }
    before(config, pipe) { }
    error(config, pipe, e) { }
    finally(config, pipe) { }
    beforeFetch(fetch) { }
    afterFetch(fetch, response) { }
    // protected async errorTransform(e: any): Promise<HttpResponseError<any>> {
    async errorTransform(e) {
        const httpResponseError = new HttpResponseError();
        httpResponseError.error = e;
        if (e instanceof Response) {
            httpResponseError.response = e;
            try {
                httpResponseError.body = await e.clone().text();
                httpResponseError.message = e.statusText;
            }
            catch (e) {
                httpResponseError.body = e;
                httpResponseError.message = e.message;
            }
        }
        else {
            httpResponseError.body = e;
            httpResponseError.message = e.message;
        }
        return httpResponseError;
    }
    async execute(fetcherRequest) {
        let target = fetcherRequest.target;
        let config = fetcherRequest.config;
        // target data setting
        if (!(target instanceof URL) && typeof target !== 'string') {
            // const url: URL |  string = target.url;
            // if (typeof target.url === 'string') {
            // }
            const searchParams = _convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_1__.ConvertUtils.toURLSearchParams(target.searchParams ?? {});
            try {
                const url = typeof target.url === 'string' ? new URL(target.url) : target.url;
                searchParams.forEach((value, key) => {
                    url.searchParams.append(key, value);
                });
                target = url;
            }
            catch (e) {
                if (typeof target.url === 'string') {
                    const searchParamString = searchParams.toString();
                    target = target.url + (searchParamString ? '?' + searchParamString : '');
                }
                else {
                    target = '';
                }
            }
        }
        // before proxy fetch
        const beforeProxyData = { requestInfo: target, init: config?.fetch };
        let beforeData = config?.beforeProxyFetch
            ? await config?.beforeProxyFetch(config)
            : beforeProxyData.requestInfo;
        beforeData = config?.skipGlobalBeforeProxyFetch ? beforeProxyData : await this.beforeProxyFetch(beforeProxyData);
        target = beforeData.requestInfo;
        if (beforeData.init) {
            config ??= {};
            config.fetch = beforeData.init;
        }
        let abortedTimeout;
        if (config?.fetch && 'timeout' in config.fetch) {
            const abortController = new AbortController();
            abortedTimeout = setTimeout(() => {
                if (config?.fetch?.signal) {
                    const inputSignal = config.fetch.signal;
                    const listener = () => {
                        if (!abortController.signal.aborted) {
                            abortController.abort();
                        }
                        inputSignal.removeEventListener('abort', listener);
                    };
                    inputSignal.addEventListener('abort', listener);
                }
                if (!abortController.signal.aborted) {
                    abortController.abort();
                }
            }, config.fetch.timeout);
            config.fetch.signal = abortController.signal;
        }
        this.beforeFetch({ target, requestInit: config?.fetch });
        return (config.fetcher ?? fetch)(target, config?.fetch)
            .then(async (it) => {
            // console.log('httpFetch!!!', Array.from(it.headers))
            this.afterFetch({ target: target, requestInit: config?.fetch }, it);
            // after proxy fetch
            // @ts-ignore
            const afterProxyData = {
                fetch: { target: target, requestInit: config.fetch },
                config: beforeData,
                response: it
            };
            it = config?.afterProxyFetch ? await config.afterProxyFetch(afterProxyData) : it;
            // @ts-ignore
            it = config?.skipGlobalAfterProxyFetch ? it : await this.afterProxyFetch(afterProxyData);
            config?.fetchResponseAfterCallBack?.(it, config);
            if (!config?.allowedResponseNotOk && !it.ok) {
                throw it;
            }
            const data = config?.hasResponseErrorChecker?.(it, config);
            if (data) {
                throw data;
            }
            return it;
        })
            .finally(() => {
            if (abortedTimeout) {
                clearTimeout(abortedTimeout);
            }
        });
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/fetch/HttpJsonFetcher.ts":
/*!*********************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/fetch/HttpJsonFetcher.ts ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   HttpJsonFetcher: () => (/* binding */ HttpJsonFetcher)
/* harmony export */ });
/* harmony import */ var _HttpFetcher__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./HttpFetcher */ "../../packages/@dooboostore/core/src/fetch/HttpFetcher.ts");

class HttpJsonFetcher extends _HttpFetcher__WEBPACK_IMPORTED_MODULE_0__.HttpFetcher {
    updateJsonFetchConfigAndData(config) {
        const headers = {
            'Content-Type': 'application/json',
            Accept: 'application/json, text/plain, */*'
        };
        config.config ??= {};
        config.config.fetch ??= {};
        config.config.fetch.headers ??= {};
        config.config.fetch.headers = { ...headers, ...config.config.fetch?.headers };
        if (config.config?.fetch?.body && typeof config.config?.fetch?.body !== 'string') {
            config.config.fetch.body = JSON.stringify(config.config.fetch.body);
        }
        return config;
    }
    get(config) {
        return super.get(config);
    }
    delete(config) {
        return super.delete(config);
    }
    post(config) {
        return super.post(config);
    }
    patch(config) {
        return super.patch(config);
    }
    put(config) {
        return super.put(config);
    }
    head(config) {
        return super.head(config);
    }
    postJson(config) {
        return super.post(this.updateJsonFetchConfigAndData(config));
    }
    patchJson(config) {
        return super.patch(this.updateJsonFetchConfigAndData(config));
    }
    putJson(config) {
        return super.put(this.updateJsonFetchConfigAndData(config));
    }
    async errorTransform(e) {
        const httpResponseError = new _HttpFetcher__WEBPACK_IMPORTED_MODULE_0__.HttpResponseError();
        httpResponseError.error = e;
        if (e instanceof Response) {
            httpResponseError.response = e;
            try {
                httpResponseError.body = await e.clone().json();
                httpResponseError.message = e.statusText;
            }
            catch (parseError) {
                httpResponseError.body = parseError; // Store the parsing error
                httpResponseError.message = parseError.message; // Use parsing error message
            }
        }
        else {
            httpResponseError.body = e;
            httpResponseError.message = e.message;
        }
        return httpResponseError;
    }
    // protected execute(target: HttpFetcherTarget, config?: HttpJsonFetcherConfig<C, any>): Promise<any> {
    execute(fetcherRequest) {
        return super.execute(fetcherRequest).then((response) => {
            // fetch  content-length   0     0  .   header  .
            // const contentLength = response.headers.get('Content-Length');
            // const hasBody = contentLength && parseInt(contentLength, 10) > 0;
            // console.log('hgasbody', hasBody)
            const config = fetcherRequest.config;
            const transform = config?.responseTransform ?? (config?.bypassTransform ? 'response' : (config?.transformText ? 'text' : undefined));
            if (transform === 'response') {
                return response;
            }
            else if (transform === 'text') {
                return response?.text();
            }
            else if (typeof transform === 'function') {
                return transform(response);
            }
            else {
                return response?.text().then(it => {
                    if ((it ?? '').length > 0) {
                        return JSON.parse(it);
                    }
                });
            }
        });
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/logger/Logger.ts":
/*!*************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/logger/Logger.ts ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Logger: () => (/* binding */ Logger),
/* harmony export */   LoggerLevel: () => (/* binding */ LoggerLevel)
/* harmony export */ });
/* harmony import */ var _date_DateUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../date/DateUtils */ "../../packages/@dooboostore/core/src/date/DateUtils.ts");
// import { InspectOptions } from 'node:util';

var LoggerLevel;
(function (LoggerLevel) {
    LoggerLevel["LOG"] = "LOG";
    LoggerLevel["ERROR"] = "ERROR";
    LoggerLevel["WARN"] = "WARN";
    LoggerLevel["INFO"] = "INFO";
    LoggerLevel["DEBUG"] = "DEBUG";
    LoggerLevel["TRACE"] = "TRACE";
    LoggerLevel["OFF"] = "OFF";
})(LoggerLevel || (LoggerLevel = {}));
//
// export interface Logger {
//   log(...args: any[]): void;
//
//   error(...args: any[]): void;
//
//   warn(...args: any[]): void;
//
//   info(...args: any[]): void;
//
//   debug(...args: any[]): void;
//
//   trace(...args: any[]): void;
// }
class Logger {
    config;
    constructor(config) {
        this.config = config;
    }
    setConfig(config) {
        this.config = config;
    }
    _log(logLevel, ...args) {
        const now = new Date();
        let file, line;
        // const isNode = typeof process !== "undefined" && process.versions && process.versions.node;
        // console.log('------------isNode', isNode);
        //   
        // if (isNode) {
        //   const stackObj = {} as any;
        //   Error.captureStackTrace(stackObj, this._log);
        //   const stack = stackObj?.stack.split("\n")[1];
        //   const match = stack.match(/at (.*):(\d+):(\d+)/);
        //   const path = isNode ? require("path") : null;
        //   file = path.basename(match[1]);
        //   line = match[2];
        // } else {
        const err = new Error();
        const stackLines = err.stack.split("\n");
        // console.log('------------', stackLines);
        let stack = stackLines[3];
        const match = stack.match(/(?:at\s)?(?:.*\s)?(?:\(|\@)?(.*):(\d+):(\d+)/);
        // console.log('mmmmmmmmmmmmm', match);
        file = match[1]; //new URL(match[1]).pathname.split("/").pop();
        line = `${match[2]}:${match[3]}`;
        // }
        //   
        // const formattedDate = formatDate(now);
        const message = args.map(arg => typeof arg === "object" ? JSON.stringify(arg) : String(arg)).join(" ");
        const format = this.config?.format ?? '';
        //    
        let output = format;
        //  : ${date:''}
        const dateMatch = format.match(/\${date:'([^']+)'\}/);
        if (dateMatch) {
            const dateFormat = dateMatch[1];
            output = output.replace(dateMatch[0], _date_DateUtils__WEBPACK_IMPORTED_MODULE_0__.DateUtils.format(now, dateFormat));
        }
        // //   : ${line:}
        output = output.replace("${line}", line);
        output = output.replace("${level}", logLevel);
        // const lineMatch = format.match(/\${line:(\d+)\}/);
        // if (lineMatch) {
        //   const digits = parseInt(lineMatch[1], 10);
        //   const paddedLine = String(line).padStart(digits, "0");
        //   output = output.replace(lineMatch[0], paddedLine);
        // }
        //  
        output = output.replace("${file}", file.split('/').pop() ?? '');
        //  
        output = output.replace("${message}", message);
        return output;
        // const output = `[${formattedDate}] [${file}:${line}] ${message}`;
        //
        // //   
        // capturedOutput += output + "\n";
    }
    log(msg, ...args) {
        if (this.config?.level === LoggerLevel.OFF) {
            return;
        }
        console.log(this._log(LoggerLevel.LOG, msg), ...args);
    }
    // public logDir(obj: any, option?: InspectOptions) {
    //   if (this.config?.level === LoggerLevel.OFF) {
    //     return;
    //   }
    //   console.dir(obj, option);
    // }
    error(msg, ...args) {
        if (this.config?.level === LoggerLevel.OFF) {
            return;
        }
        (console.error ?? console.log)(this._log(LoggerLevel.ERROR, msg), ...args);
    }
    // public errorDir(obj: any, option?: InspectOptions) {
    //   if (this.config?.level === LoggerLevel.OFF) {
    //     return;
    //   }
    //   console.dir(obj, option);
    // }
    warn(msg, ...args) {
        if (this.config?.level === LoggerLevel.ERROR ||
            this.config?.level === LoggerLevel.LOG ||
            this.config?.level === LoggerLevel.OFF) {
            return;
        }
        (console.warn ?? console.log)(this._log(LoggerLevel.WARN, msg), ...args);
    }
    // public warnDir(obj: any, option?: InspectOptions) {
    //   if (
    //     this.config?.level === LoggerLevel.ERROR ||
    //     this.config?.level === LoggerLevel.LOG ||
    //     this.config?.level === LoggerLevel.OFF
    //   ) {
    //     return;
    //   }
    //   console.dir(obj, option);
    // }
    info(msg, ...args) {
        if (this.config?.level === LoggerLevel.WARN ||
            this.config?.level === LoggerLevel.ERROR ||
            this.config?.level === LoggerLevel.LOG ||
            this.config?.level === LoggerLevel.OFF) {
            return;
        }
        (console.info ?? console.log)(this._log(LoggerLevel.INFO, msg), ...args);
    }
    // public infoDir(obj: any, option?: InspectOptions) {
    //   if (
    //     this.config?.level === LoggerLevel.WARN ||
    //     this.config?.level === LoggerLevel.ERROR ||
    //     this.config?.level === LoggerLevel.LOG ||
    //     this.config?.level === LoggerLevel.OFF
    //   ) {
    //     return;
    //   }
    //   console.dir(obj, option);
    // }
    debug(msg, ...args) {
        if (this.config?.level === LoggerLevel.INFO ||
            this.config?.level === LoggerLevel.WARN ||
            this.config?.level === LoggerLevel.ERROR ||
            this.config?.level === LoggerLevel.LOG ||
            this.config?.level === LoggerLevel.OFF) {
            return;
        }
        (console.debug ?? console.log)(this._log(LoggerLevel.DEBUG, msg), ...args);
    }
    // public debugDir(obj: any, option?: InspectOptions) {
    //   if (
    //     this.config?.level === LoggerLevel.INFO ||
    //     this.config?.level === LoggerLevel.WARN ||
    //     this.config?.level === LoggerLevel.ERROR ||
    //     this.config?.level === LoggerLevel.LOG ||
    //     this.config?.level === LoggerLevel.OFF
    //   ) {
    //     return;
    //   }
    //   console.dir(obj, option);
    // }
    trace(...args) {
        if (this.config?.level === LoggerLevel.TRACE) {
            (console.trace ?? console.log)(...args);
        }
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/math/MathUtil.ts":
/*!*************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/math/MathUtil.ts ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   MathUtil: () => (/* binding */ MathUtil)
/* harmony export */ });
/* harmony import */ var _entity_Point3D__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../entity/Point3D */ "../../packages/@dooboostore/core/src/entity/Point3D.ts");
/* harmony import */ var _entity_Vector__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../entity/Vector */ "../../packages/@dooboostore/core/src/entity/Vector.ts");
/* harmony import */ var _entity_object_obj_Obj__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../entity/object/obj/Obj */ "../../packages/@dooboostore/core/src/entity/object/obj/Obj.ts");
/* harmony import */ var _entity_Point2D__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../entity/Point2D */ "../../packages/@dooboostore/core/src/entity/Point2D.ts");




var MathUtil;
(function (MathUtil) {
    MathUtil.getMinByObjectArray = (objectArray, varName) => {
        let min;
        if (varName && objectArray && objectArray.length > 0) {
            min = objectArray[0][varName];
            for (let i = 1; i < objectArray.length; i++) {
                min = Math.min(min, objectArray[i][varName]);
            }
        }
        return min;
    };
    MathUtil.hypot = (...data) => {
        // 2 
        // Math.hypot(3, 4);  // : 5 (3 + 4 = 9 + 16 = 25, 25 = 5)
        // 3 
        //     Math.hypot(3, 4, 5);  // : 7.0710678118654755
        return Math.hypot(...data);
    };
    //   
    MathUtil.pythagorean = (a, b) => {
        /*
         
        a^2 + b^2 = c^2
        c = (a^2 + b^2)
         */
        // return Math.sqrt(start * start + end * end);
        return Math.sqrt(a * a + b * b);
    };
    MathUtil.getMaxByObjectArray = (objectArray, varName) => {
        let max;
        if (varName && objectArray && objectArray.length > 0) {
            max = objectArray[0][varName];
            for (let i = 1; i < objectArray.length; i++) {
                max = Math.max(max, objectArray[i][varName]);
            }
        }
        return max;
    };
    MathUtil.sum = (array) => {
        return array.reduce((acc, curr) => acc + curr, 0);
    };
    MathUtil.avg = (array) => {
        return array.length > 0 ? MathUtil.sum(array) / array.length : 0;
    };
    MathUtil.minMax = (data, minMax) => {
        return Math.min(Math.max(data, minMax.min), minMax.max);
    };
    MathUtil.max = (array) => {
        return array.length > 0 ? Math.max(...array) : undefined;
    };
    MathUtil.min = (array) => {
        return array.length > 0 ? Math.min(...array) : undefined;
    };
    MathUtil.getSumByObjectArray = (objectArray, varName) => {
        let sum = 0;
        if (varName && objectArray && objectArray.length > 0) {
            for (let i = 0; i < objectArray.length; i++) {
                sum += objectArray[i][varName];
            }
        }
        return sum;
    };
    /**
     * Converts value to radians based on given type.
     * @param data - The value to convert to radians
     * @param option - Conversion type configuration
     * @param option.type - Type of conversion:
     *                      'degreeAngle' - Converts from degrees to radians
     *                      'ratio' - Multiplies value by 2 (input range 0-1)
     *                      'percent' - Converts percentage to 2 ratio (input range 0-100)
     * @returns The converted value in radians
     * @example
     * // Convert 180 degrees to radians (3.14...)
     * radians(180, {type: 'degreeAngle'})
     *
     * // Convert 0.5 ratio to radians (3.14...)
     * radians(0.5, {type: 'ratio'})
     *
     * // Convert 50% to radians (3.14...)
     * radians(50, {type: 'percent'})
     */
    MathUtil.radians = (data, { type = 'degreeAngle' }) => {
        /*
         radian
         * 1.57..: 90, PI/2
         * 3.14..: 180, PI
         * 4.71..: 270, PI + PI/2
         * 6.28..: 360, PI * 2
         */
        if (type === 'ratio') {
            return (data * 2) * Math.PI;
        }
        else if (type === 'percent') {
            return ((data / 100) * 2) * Math.PI;
        }
        else {
            // return data * Math.PI / 180;
            return data / 180 * Math.PI;
        }
    };
    MathUtil.degrees = (data, { type = 'degreeAngle' }) => {
        if (type === 'ratio') {
            return data * 360;
        }
        else if (type === 'percent') {
            return (data / 100) * 360;
        }
        else {
            return data * 180 / Math.PI;
        }
    };
    // static createCanvas(w, h) {
    //     let canvas = document.createElement('canvas');
    //     canvas.width = w;
    //     canvas.height = h;
    //     return canvas;
    // }
    //
    // static copyCanvas(canvas) {
    //     let newCanvas = document.createElement('canvas');
    //     newCanvas.width = canvas.width;
    //     newCanvas.height = canvas.height;
    //     context = newCanvas.getContext('2d');
    //     context.drawImage(canvas, 0, 0);
    //     return newCanvas;
    // }
    /**
     1.  
     (Ratio):      ,    .  , "2:3"     2  3 ,  2/3   .
      (Normalized Ratio):        .  (w) 1 (normalize) (h)     .
      :      "w:h"  ,       .
     2.  
      :
  
     (w) = 1652 
     (h) = 421 
     :  1     
      
       :
       w:h = 1652:421.
        1652 / 421.
      1 :
      1  ,  (1652) 1 ,    .
       =  (h)   (w)
     : h' = h / w ( h'  )
      :
       = 421 / 1652
     : 421  1652  0.25485 (  5)
      :
      1    0.25485.     25.485%  .
     
       ,          .
      (0.25485) 1652 : 1652 * 0.25485  421,      .
     3.  
       :
      (h') = h / w
      (w') = w / w = 1 ()
       :
     h' = 421 / 1652  0.25485
     4. :  
      "1:"  ,      .
     : 1 : 0.25485   1 : 0.255 ( ).
     5.  
     :      , w1 / h1 = w2 / h2  .  w2 = 1  , h2 = h1 / w1 .
      :      ,  (1652:421)       .
     <script>
     const w = 1652;
     const h = 421;
     const normalizedHeight = h / w;
     console.log(` : ${normalizedHeight.toFixed(5)}`); // 0.25485
     console.log(`  : ${w * normalizedHeight}  ${h}`); //  421
     </script>
     */
    MathUtil.ratio = (numerator, denominator, multiplier = 1) => {
        // numerator() : denominator() = multiplier : x
        // x = multiplier * denominator / numerator
        return multiplier * (denominator / numerator);
        // a:b = c:x   x  
        // ax = bc
        // x = bc/a
    };
    //end - start       .
    MathUtil.getBetweenLength = (start, end) => {
        return end - start;
    };
    //   ?      tot  data %.
    MathUtil.getPercentByTotal = (tot, data) => {
        /*
           ?  
           X 100
        ) 300 105 ?
        : 35%
        */
        return (data / tot) * 100;
    };
    MathUtil.getRatioByTotal = (tot, data) => {
        return (data / tot);
    };
    //   ?      tot  wantPercent ?
    MathUtil.getValueByTotalInPercent = (tot, wantPercent) => {
        /*
         X   100
        ) 300 35 ?
        ) 105
         */
        return (tot * wantPercent) / 100;
    };
    MathUtil.getValueByTotalInRatio = (tot, ratio) => {
        return (tot * ratio);
    };
    //        tot  wantPercent  
    MathUtil.getValuePercentUp = (tot, wantPercent) => {
        /*
            
         X (1 +   100)
        ) 1548 66 ?
        ) 2569.68
         */
        return tot * (1 + wantPercent / 100);
    };
    MathUtil.getValueRatioUp = (tot, ratio) => {
        return tot * (1 + ratio);
    };
    //        tot  wantPercent  
    MathUtil.getValuePercentDown = (tot, wantPercent) => {
        /*
            
         X (1 -   100)
        ) 1548 66 ?
        ) 526.32
         */
        return tot * (1 - wantPercent / 100);
    };
    MathUtil.getValueRatioDown = (tot, ratio) => {
        return tot * (1 - ratio);
    };
    //
    // A:B = C:X    => 30:50 = 33 : x
    // 30X = 50*33
    // X = BC / 30
    // Bezier
    // https://cubic-bezier.com/#.17,.67,.83,.67
    // https://matthewlein.com/tools/ceaser
    // https://easings.net/ko#
    // (0.250, 0.250, 0.750, 0.750); /* linear */
    MathUtil.beziers = (points, frame) => {
        const datas = new Array(frame).fill(undefined);
        for (let i = 0; i < datas.length; i++) {
            datas[i] = MathUtil.bezier(points, frame, i);
        }
        return datas;
    };
    //   ,  .
    MathUtil.bezier = (points, frame, idx) => {
        if (points && points.length > 0) {
            const pv = points.map(it => new _entity_Vector__WEBPACK_IMPORTED_MODULE_1__.Vector(it.x, it.y, it.z));
            const steps = [];
            pv.reduce((a, b) => {
                const step = a.toSub(b).div(frame).mult(idx + 1);
                steps.push(a.toSub(step));
                return b;
            });
            if (steps.length <= 1) {
                return steps[0];
            }
            return MathUtil.bezier(steps.map(it => new _entity_Point3D__WEBPACK_IMPORTED_MODULE_0__.Point3D(it)), frame, idx);
        }
        else {
            return new _entity_Vector__WEBPACK_IMPORTED_MODULE_1__.Vector();
        }
    };
    function cubicBezier(position, frameConfig, bezierConfig) {
        if (position.start instanceof _entity_object_obj_Obj__WEBPACK_IMPORTED_MODULE_2__.Obj && position.end instanceof _entity_object_obj_Obj__WEBPACK_IMPORTED_MODULE_2__.Obj) {
            const x = MathUtil.cubicBezier({ start: position.start.x, end: position.end.x }, frameConfig, bezierConfig);
            const y = MathUtil.cubicBezier({ start: position.start.y, end: position.end.y }, frameConfig, bezierConfig);
            const z = MathUtil.cubicBezier({ start: position.start.z, end: position.end.z }, frameConfig, bezierConfig);
            const v = MathUtil.cubicBezier({ start: position.start.volume, end: position.end.volume }, frameConfig, bezierConfig);
            const m = MathUtil.cubicBezier({ start: position.start.mass, end: position.end.mass }, frameConfig, bezierConfig);
            const e = MathUtil.cubicBezier({ start: position.start.e, end: position.end.e }, frameConfig, bezierConfig);
            const r = MathUtil.cubicBezier({ start: position.start.rotate, end: position.end.rotate }, frameConfig, bezierConfig);
            const w = MathUtil.cubicBezier({ start: position.start.width, end: position.end.width }, frameConfig, bezierConfig);
            const h = MathUtil.cubicBezier({ start: position.start.height, end: position.end.height }, frameConfig, bezierConfig);
            const t0 = MathUtil.cubicBezier({ start: position.start.transform[0], end: position.end.transform[0] }, frameConfig, bezierConfig);
            const t1 = MathUtil.cubicBezier({ start: position.start.transform[1], end: position.end.transform[1] }, frameConfig, bezierConfig);
            const t2 = MathUtil.cubicBezier({ start: position.start.transform[2], end: position.end.transform[2] }, frameConfig, bezierConfig);
            const t3 = MathUtil.cubicBezier({ start: position.start.transform[3], end: position.end.transform[3] }, frameConfig, bezierConfig);
            const t4 = MathUtil.cubicBezier({ start: position.start.transform[4], end: position.end.transform[4] }, frameConfig, bezierConfig);
            const t5 = MathUtil.cubicBezier({ start: position.start.transform[5], end: position.end.transform[5] }, frameConfig, bezierConfig);
            const colorR = MathUtil.cubicBezier({ start: position.start.color.r ?? 0, end: position.end.color.r ?? 0 }, frameConfig, bezierConfig);
            const colorG = MathUtil.cubicBezier({ start: position.start.color.g ?? 0, end: position.end.color.g ?? 0 }, frameConfig, bezierConfig);
            const colorB = MathUtil.cubicBezier({ start: position.start.color.b ?? 0, end: position.end.color.b ?? 0 }, frameConfig, bezierConfig);
            const colorA = MathUtil.cubicBezier({ start: position.start.color.a ?? 255, end: position.end.color.a ?? 255 }, frameConfig, bezierConfig);
            const objs = x.map((x, idx) => {
                const obj = new _entity_object_obj_Obj__WEBPACK_IMPORTED_MODULE_2__.Obj({ x, y: y[idx], z: z[idx] });
                obj.volume = v[idx];
                obj.mass = m[idx];
                obj.e = e[idx];
                obj.rotate = r[idx];
                obj.width = w[idx];
                obj.height = h[idx];
                obj.transform = [t0[idx], t1[idx], t2[idx], t3[idx], t4[idx], t5[idx]];
                obj.color = { r: colorR[idx], g: colorG[idx], b: colorB[idx], a: colorA[idx] };
                return obj;
            });
            return objs;
        }
        else if (position.start instanceof _entity_Point3D__WEBPACK_IMPORTED_MODULE_0__.Point3D && position.end instanceof _entity_Point3D__WEBPACK_IMPORTED_MODULE_0__.Point3D) {
            const x = MathUtil.cubicBezier({ start: position.start.x, end: position.end.x }, frameConfig, bezierConfig);
            const y = MathUtil.cubicBezier({ start: position.start.y, end: position.end.y }, frameConfig, bezierConfig);
            const z = MathUtil.cubicBezier({ start: position.start.z, end: position.end.z }, frameConfig, bezierConfig);
            return x.map((x, idx) => new _entity_Point3D__WEBPACK_IMPORTED_MODULE_0__.Point3D(x, y[idx], z[idx]));
        }
        const { start, end } = position;
        // ----
        const { frame } = frameConfig;
        let { p1x, p1y, p2x, p2y } = Array.isArray(bezierConfig) ? { p1x: bezierConfig[0], p1y: bezierConfig[1], p2x: bezierConfig[2], p2y: bezierConfig[3] } : bezierConfig;
        p1x = p1x === 'random' ? Math.random() : p1x;
        p1y = p1y === 'random' ? Math.random() : p1y;
        p2x = p2x === 'random' ? Math.random() : p2x;
        p2y = p2y === 'random' ? Math.random() : p2y;
        const result = [];
        const totalChange = end - start;
        // console.log('----222->',totalChange);
        // 3   
        const bezier = (t) => {
            const t2 = Number(t * t);
            const t3 = Number(t2 * t);
            const mt = Number(1 - t);
            const mt2 = Number(mt * mt);
            const mt3 = Number(mt2 * mt);
            return mt3 * 0 + 3 * mt2 * t * Number(p1y) + 3 * mt * t2 * Number(p2y) + t3 * 1;
        };
        // frame  , ,  
        const targetFrame = frame + 1;
        for (let i = 1; i < targetFrame; i++) {
            // const t = frame <= 1 ? 1 : (i + 1) / frame;
            // const t = frame <= 1 ? 1 : (i + 1) / frame;
            const t = i / targetFrame;
            const progress = bezier(t);
            // console.log('pppppppp', progress);
            const value = start + totalChange * progress;
            result.push(value);
        }
        return result;
    }
    MathUtil.cubicBezier = cubicBezier;
    MathUtil.diff = (a, b) => {
        return Math.abs(a - b);
    };
    /*
    > ?      
  
   , .           
    .
  
     :   (Projection)
  
       .
  
  
     * ` vw`:     . (v , w )
     * ` p`:       .
     * :  (p) (vw)     .
  
  
       p       .  p   
         .      (projection).
  
    ---
  
      
  
  
    let t = ((p.x - v.x) * (w.x - v.x) + (p.y - v.y) * (w.y - v.y)) / l2;
  
          '   '  .  t
     .
  
    1. (Vector) 
  
  
           .
  
  
     *  1 (`vw`):      .
         * w.x - v.x (x)
         * w.y - v.y (y)
     *  2 (`vp`):     .
         * p.x - v.x (x)
         * p.y - v.y (y)
  
  
    2. :   (Dot Product)
  
    ((p.x - v.x) * (w.x - v.x) + (p.y - v.y) * (w.y - v.y))
  
  
        vp vw (dot product)  .     
    "   "  .
  
  
     *      0.
     *        .
  
    , `vp`  `vw`   ()    .
  
    3. : l2
  
  
    l2     vw  .
  
    4. t : 
  
     t   .
  
    t = ( vp vw ) / ( vw  )
  
  
     t        `v`     
    .
  
  
     * `t = 0`:     v .
     * `t = 1`:     w .
     * `t = 0.5`:     .
     * `t < 0` (: `t = -0.2`): p v "" ,     .
       (    )
     * `t > 1` (: `t = 1.5`): p w "" ,     .
       (    )
  
    
  
  
     t     ,  (p)      ,
              .
  
  
     * t 0 1  ,      '' .
     * t 0 ,      v.
     * t 1 ,      w.
  
  
         t = Math.max(0, Math.min(1, t)); t 0 1   .
          (  )    .
     */
    MathUtil.distSqToLineSegment = (p, v, w) => {
        const l2 = (v.x - w.x) ** 2 + (v.y - w.y) ** 2;
        if (l2 === 0)
            return (p.x - v.x) ** 2 + (p.y - v.y) ** 2;
        let t = ((p.x - v.x) * (w.x - v.x) + (p.y - v.y) * (w.y - v.y)) / l2;
        t = Math.max(0, Math.min(1, t));
        const projection = { x: v.x + t * (w.x - v.x), y: v.y + t * (w.y - v.y) };
        return (p.x - projection.x) ** 2 + (p.y - projection.y) ** 2;
    };
    // static bezirePointToPointVector(point: {point1: Point, point2?: Point, point3?: Point, point4?: Point}) {
    //     if (!point.point2) {
    //         point.point2 = point.point1;
    //     }
    //     if (!point.point3) {
    //         point.point3 = point.point2;
    //     }
    //     if (!point.point4) {
    //         point.point4 = point.point3;
    //     }
    //     return {
    //         point1: new PointVector(point.point1.x, point.point1.y, point.point1.z),
    //         point2: new PointVector(point.point2.x, point.point2.y, point.point2.z),
    //         point3: new PointVector(point.point3.x, point.point3.y, point.point3.z),
    //         point4: new PointVector(point.point4.x, point.point4.y, point.point4.z),
    //     }
    // }
    // static bezier(point: {point1: Point, point2?: Point, point3?: Point, point4?: Point}, frame: number, idx: number) {
    //     const pointVector = MathUtil.bezirePointToPointVector(point);
    //
    //     const point12Step = PointVector.sub(pointVector.point1, pointVector.point2).div(frame).mult(idx + 1);
    //     const point23Step = PointVector.sub(pointVector.point2, pointVector.point3).div(frame).mult(idx + 1);
    //     const point34Step = PointVector.sub(pointVector.point3, pointVector.point4).div(frame).mult(idx + 1);
    //
    //     pointVector.point1.sub(point12Step);
    //     pointVector.point2.sub(point23Step);
    //     pointVector.point3.sub(point34Step);
    //
    //     const point12MoveStep = PointVector.sub(pointVector.point1, pointVector.point2).div(frame);
    //     const point23MoveStep = PointVector.sub(pointVector.point2, pointVector.point3).div(frame);
    //     // const point34MoveStep = PointVector.sub(point3, point4).div(frame); // 
    //
    //     const cnt = idx + 1;
    //     const point12MovePoint = point12MoveStep.mult(cnt)
    //     const point23MovePoint = point23MoveStep.mult(cnt);
    //     const combinationPoint1MovePoint = PointVector.sub(pointVector.point1, point12MovePoint); //new PointVector(point1.x - point12MovePoint.x, point1.y - point12MovePoint.y);
    //     const combinationPoint2MovePoint = PointVector.sub(pointVector.point2, point23MovePoint); // new PointVector(point2.x - point23MovePoint.x, point2.y - point23MovePoint.y);
    //
    //     const finalPointMoveStep =  PointVector.sub(combinationPoint1MovePoint, combinationPoint2MovePoint).div(frame);
    //     const finalPointMovePoint = finalPointMoveStep.mult(cnt);
    //     const final = PointVector.sub(combinationPoint1MovePoint, finalPointMovePoint);
    //     return final;
    // }
    //
    // static beziers(point: {point1: Point, point2?: Point, point3?: Point, point4?: Point}, frame: number) {
    //     const pointVector = MathUtil.bezirePointToPointVector(point);
    //     const frames = new Array(frame).fill(undefined) as PointVector[];
    //     for (let i = 0; i < frame; i++) {
    //         frames[i] = MathUtil.bezier(point, frame, i);
    //         // pointVector.point1.sub(point12Step);
    //         // pointVector.point2.sub(point23Step);
    //         // pointVector.point3.sub(point34Step);
    //         //
    //         // const point12MoveStep = PointVector.sub(pointVector.point1, pointVector.point2).div(frame);
    //         // const point23MoveStep = PointVector.sub(pointVector.point2, pointVector.point3).div(frame);
    //         // // const point34MoveStep = PointVector.sub(point3, point4).div(frame); // 
    //         //
    //         // const cnt = i + 1;
    //         // const point12MovePoint = point12MoveStep.mult(cnt)
    //         // const point23MovePoint = point23MoveStep.mult(cnt);
    //         // const combinationPoint1MovePoint = PointVector.sub(pointVector.point1, point12MovePoint); //new PointVector(point1.x - point12MovePoint.x, point1.y - point12MovePoint.y);
    //         // const combinationPoint2MovePoint = PointVector.sub(pointVector.point2, point23MovePoint); // new PointVector(point2.x - point23MovePoint.x, point2.y - point23MovePoint.y);
    //         //
    //         // const finalPointMoveStep =  PointVector.sub(combinationPoint1MovePoint, combinationPoint2MovePoint).div(frame);
    //         // const finalPointMovePoint = finalPointMoveStep.mult(cnt);
    //         // const final = PointVector.sub(combinationPoint1MovePoint, finalPointMovePoint);
    //     }
    //     return frames;
    // }
    //   interface Point {
    //     x: number;
    //     y: number;
    //   }
    //
    //   interface BezierPathOptions {
    //     /**
    //      *      . (: 0.25)
    //      * 0    ,     .
    //      *      .
    //      */
    //     controlPointOffsetFactor?: number;
    //
    //     /**
    //      *     . (: 1)
    //      * 1:  ()
    //      * > 1:         (, ease-in)
    //      * < 1:         (, ease-out)
    //      * : 2  , 0.5  .
    //      */
    //     accelerationFactor?: number;
    //   }
    //
    //   /**
    //    * 2     t    .
    //    * B(t) = (1-t)^2 * P0 + 2 * (1-t) * t * P1 + t^2 * P2
    //    * @param t  (0 1 )
    //    * @param p0 
    //    * @param p1 
    //    * @param p2 
    //    * @returns   
    //    */
    //   function quadraticBezier(t: number, p0: Point, p1: Point, p2: Point): Point {
    //     const mt = 1 - t; // (1-t)
    //     const mt2 = mt * mt; // (1-t)^2
    //     const t2 = t * t; // t^2
    //
    //     const x = mt2 * p0.x + 2 * mt * t * p1.x + t2 * p2.x;
    //     const y = mt2 * p0.y + 2 * mt * t * p1.y + t2 * p2.y;
    //
    //     return { x, y };
    //   }
    //
    //   /**
    //    *     2      .
    //    * @param startPoint   { x, y }
    //    * @param endPoint   { x, y }
    //    * @param options      
    //    * @param numberOfSteps      (   )
    //    * @returns    (startPoint  , endPoint )
    //    */
    //   function getPointsOnBezierPath(
    //     startPoint: Point,
    //     endPoint: Point,
    //     options: BezierPathOptions = {}, //   
    //     numberOfSteps: number
    //   ): Point[] {
    //     // ---    ---
    //     const controlPointOffsetFactor = options.controlPointOffsetFactor ?? 0.25; //  0.25
    //     const accelerationFactor = options.accelerationFactor ?? 1; //  1 ()
    //
    //     // ---    ---
    //     if (numberOfSteps <= 0) {
    //       console.warn("numberOfSteps 0  .");
    //       return []; //      
    //     }
    //
    //     const points: Point[] = [];
    //     const p0 = startPoint;
    //     const p2 = endPoint;
    //
    //     // --- (P1)   ---
    //     const midX = (p0.x + p2.x) / 2;
    //     const midY = (p0.y + p2.y) / 2;
    //
    //     const deltaX = p2.x - p0.x;
    //     const deltaY = p2.y - p0.y;
    //
    //     const distance = Math.sqrt(deltaX * deltaX + deltaY * deltaY);
    //
    //     let p1: Point;
    //
    //     if (distance === 0) {
    //       //        (  )
    //       p1 = { ...p0 };
    //       //  ,    /   .
    //       //     ,  numberOfSteps   .
    //       //          .
    //     } else {
    //       //        (   90 )
    //       const perpX = -deltaY / distance;
    //       const perpY = deltaX / distance;
    //
    //       //         
    //       const offset = distance * controlPointOffsetFactor;
    //       p1 = {
    //         x: midX + perpX * offset,
    //         y: midY + perpY * offset,
    //       };
    //     }
    //
    //     // ---     ---
    //     for (let i = 1; i <= numberOfSteps; i++) {
    //       // 1.   u  (0 < u <= 1)
    //       const u = i / numberOfSteps;
    //       // 2.    t 
    //       const t = Math.pow(u, accelerationFactor);
    //       // 3.     
    //       const pointOnCurve = quadraticBezier(t, p0, p1, p2);
    //       points.push(pointOnCurve);
    //     }
    //
    //     return points; //     
    //   }
    //
    // // ---   ---
    //   const start: Point = { x: 4, y: 10 };
    //   const end: Point = { x: 50, y: 20 };
    //   const steps = 10; // 10   
    //
    // //  1:   ( , )
    //   const path1 = getPointsOnBezierPath(start, end, {}, steps);
    //   console.log("  :", path1.map(p => `(${p.x.toFixed(1)}, ${p.y.toFixed(1)})`).join(" -> "));
    //
    // //  2:    (offset ),    (acceleration > 1)
    //   const path2 = getPointsOnBezierPath(start, end, { controlPointOffsetFactor: 0.6, accelerationFactor: 2 }, steps);
    //   console.log("  +  :", path2.map(p => `(${p.x.toFixed(1)}, ${p.y.toFixed(1)})`).join(" -> "));
    //
    // //  3:    (offset ),    (acceleration < 1)
    //   const path3 = getPointsOnBezierPath(start, end, { controlPointOffsetFactor: -0.3, accelerationFactor: 0.5 }, steps);
    //   console.log("  +  :", path3.map(p => `(${p.x.toFixed(1)}, ${p.y.toFixed(1)})`).join(" -> "));
    MathUtil.rotatePoint = (point, center, angleInRadians) => {
        // Translate point to origin so that center is the origin
        const translatedX = point.x - center.x;
        const translatedY = point.y - center.y;
        // Rotate point
        const rotatedX = translatedX * Math.cos(angleInRadians) - translatedY * Math.sin(angleInRadians);
        const rotatedY = translatedX * Math.sin(angleInRadians) + translatedY * Math.cos(angleInRadians);
        // Translate point back
        return new _entity_Point2D__WEBPACK_IMPORTED_MODULE_3__.Point2D(rotatedX + center.x, rotatedY + center.y);
    };
})(MathUtil || (MathUtil = {}));


/***/ }),

/***/ "../../packages/@dooboostore/core/src/message/BehaviorSubject.ts":
/*!***********************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/message/BehaviorSubject.ts ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   BehaviorSubject: () => (/* binding */ BehaviorSubject)
/* harmony export */ });
/* harmony import */ var _Subject__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Subject */ "../../packages/@dooboostore/core/src/message/Subject.ts");

class BehaviorSubject extends _Subject__WEBPACK_IMPORTED_MODULE_0__.Subject {
    _value; // BehaviorSubject always has a current value
    constructor(initialValue) {
        super();
        this._value = initialValue; // Store the initial value
    }
    next(data) {
        this._value = data; // Update the current value
        super.next(data); // Multicast to all current subscribers
    }
    _subscribeToSubject(subscriber) {
        // Call parent's subscribe logic first
        const subscription = super._subscribeToSubject(subscriber);
        // Immediately emit the current value to the new subscriber
        // Only if the subject has not completed or errored
        if (!this._isStopped) { // _isStopped is from Subject
            subscriber.next(this._value);
        }
        else if (this._hasError) { // _hasError is from Subject
            subscriber.error(this._error); // _error is from Subject
        }
        else {
            subscriber.complete();
        }
        return subscription;
    }
    getValue() {
        if (this._hasError) {
            throw this._error;
        }
        return this._value;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/message/Observable.ts":
/*!******************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/message/Observable.ts ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Observable: () => (/* binding */ Observable)
/* harmony export */ });
/* harmony import */ var _Subscriber__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Subscriber */ "../../packages/@dooboostore/core/src/message/Subscriber.ts");

class Observable {
    _producerFunction;
    constructor(producerFunction) {
        this._producerFunction = producerFunction;
    }
    subscribe(observer, e, c) {
        /*
            const observer = observerOrNext;
    
        const partialObserver: Partial<Observer<T, E>> = typeof observer === 'function'
          ? {
              next: observer,
              error: error,
              complete: complete
            }
          : {
              next: observer.next,
              error: observer.error,
              complete: observer.complete
            };
         */
        const partialObserver = {
            next: typeof observer === 'object' ? observer.next : observer,
            error: typeof observer === 'object' ? observer.error : e,
            complete: typeof observer === 'object' ? observer.complete : c
        };
        // Create a new internal subscriber for this specific subscription
        const internalSubscriber = new _Subscriber__WEBPACK_IMPORTED_MODULE_0__.Subscriber({
            next: (data) => {
                partialObserver.next?.(data);
            },
            error: (e) => {
                partialObserver.error?.(e);
            },
            complete: () => {
                partialObserver.complete?.();
            }
        });
        let teardownLogic;
        if (this._producerFunction) {
            teardownLogic = this._producerFunction(internalSubscriber);
        }
        let closed = false;
        return {
            get closed() {
                return closed;
            },
            unsubscribe: () => {
                // console.log('unsubscribe-->', teardownLogic)
                // Execute the teardown logic returned by the producer function
                if (typeof teardownLogic === 'function') {
                    teardownLogic();
                }
                else if (teardownLogic && typeof teardownLogic.unsubscribe === 'function') {
                    teardownLogic.unsubscribe();
                }
                closed = true;
            }
        };
    }
    // complete   !
    toPromise() {
        return new Promise((resolve, reject) => {
            let lastValue;
            let subscription;
            subscription = this.subscribe({
                next: (value) => {
                    lastValue = value;
                },
                error: (err) => {
                    reject(err);
                    subscription.unsubscribe();
                },
                complete: () => {
                    resolve(lastValue);
                    subscription.unsubscribe();
                }
            });
        });
    }
    pipe(...operators) {
        if (operators.length === 0) {
            return this;
        }
        return operators.reduce((prev, operator) => operator(prev), this);
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/message/ReplaySubject.ts":
/*!*********************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/message/ReplaySubject.ts ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ReplaySubject: () => (/* binding */ ReplaySubject)
/* harmony export */ });
/* harmony import */ var _Subject__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Subject */ "../../packages/@dooboostore/core/src/message/Subject.ts");

class ReplaySubject extends _Subject__WEBPACK_IMPORTED_MODULE_0__.Subject {
    bufferSize;
    _buffer = [];
    // Removed: private _error: E | undefined;
    // Removed: private _isStopped = false;
    constructor(bufferSize = Infinity) {
        super();
        this.bufferSize = bufferSize;
    }
    next(data) {
        // Rely on parent Subject's _isStopped
        if (this._isStopped) {
            return; // Cannot emit after stopped
        }
        this._buffer.push(data);
        if (this._buffer.length > this.bufferSize) {
            this._buffer.shift(); // Remove oldest if buffer exceeds size
        }
        super.next(data); // Multicast to current subscribers
    }
    error(err) {
        // Rely on parent Subject to manage _isStopped and _error
        super.error(err); // Multicast error and stop
    }
    complete() {
        // Rely on parent Subject to manage _isStopped
        super.complete(); // Multicast complete and stop
    }
    _subscribeToSubject(subscriber) {
        // Emit buffered values to the new subscriber first
        this._buffer.forEach(value => subscriber.next(value));
        // If the subject has already completed or errored, emit that status
        // Rely on parent Subject's _isStopped, _hasError, _error
        if (this._isStopped) {
            if (this._hasError) {
                subscriber.error(this._error);
            }
            else {
                subscriber.complete();
            }
            return { closed: true, unsubscribe: () => { } }; // Return dummy subscription as it's already done
        }
        // Then, call super._subscribeToSubject to add the observer for future values
        return super._subscribeToSubject(subscriber);
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/message/Subject.ts":
/*!***************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/message/Subject.ts ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Subject: () => (/* binding */ Subject)
/* harmony export */ });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Observable */ "../../packages/@dooboostore/core/src/message/Observable.ts");

class Subject extends _Observable__WEBPACK_IMPORTED_MODULE_0__.Observable {
    _observers = new Set();
    _isStopped = false;
    _hasError = false;
    _error;
    constructor() {
        // Call parent Observable constructor with our own subscribe logic
        super((subscriber) => {
            return this._subscribeToSubject(subscriber);
        });
    }
    _subscribeToSubject(subscriber) {
        const partialObserver = {
            next: subscriber.next.bind(subscriber),
            error: subscriber.error.bind(subscriber),
            complete: subscriber.complete.bind(subscriber)
        };
        if (this._isStopped) {
            if (this._hasError) {
                partialObserver.error?.(this._error);
            }
            else {
                partialObserver.complete?.();
            }
            return { closed: true, unsubscribe: () => { } }; // Already stopped, return dummy subscription
        }
        this._observers.add(partialObserver);
        let closed = false;
        return {
            get closed() {
                return closed;
            },
            unsubscribe: () => {
                this._observers.delete(partialObserver);
                closed = true;
            }
        };
    }
    next(data) {
        if (this._isStopped) {
            return; // Subject is stopped, no more emissions
        }
        this._observers.forEach(observer => {
            observer.next?.(data);
        });
    }
    error(err) {
        if (this._isStopped) {
            return; // Subject is stopped, no more errors
        }
        this._hasError = true;
        this._error = err;
        this._isStopped = true; // Subject stops after error
        this._observers.forEach(observer => observer.error?.(err));
        this._observers.clear(); // Clear observers after error
    }
    complete() {
        if (this._isStopped) {
            return; // Subject is stopped, no more completions
        }
        this._isStopped = true; // Subject stops after completion
        this._observers.forEach(observer => observer.complete?.());
        this._observers.clear(); // Clear observers after completion
    }
    asObservable() {
        // Returns a new Observable that wraps this Subject's subscribe method.
        // This hides the next/error/complete methods from the consumer.
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__.Observable(subscriber => {
            return this._subscribeToSubject(subscriber);
        });
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/message/Subscriber.ts":
/*!******************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/message/Subscriber.ts ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Subscriber: () => (/* binding */ Subscriber)
/* harmony export */ });
class Subscriber {
    destination;
    closed = false;
    constructor(destination) {
        this.destination = destination;
    }
    next(value) {
        if (this.closed) {
            return;
        }
        this.destination.next(value);
    }
    error(err) {
        if (this.closed) {
            return;
        }
        this.closed = true;
        this.destination.error(err);
        this.unsubscribe();
    }
    complete() {
        if (this.closed) {
            return;
        }
        this.closed = true;
        this.destination.complete();
        this.unsubscribe();
    }
    unsubscribe() {
        this.closed = true;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/message/operators/bufferTime.ts":
/*!****************************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/message/operators/bufferTime.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   bufferTime: () => (/* binding */ bufferTime)
/* harmony export */ });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "../../packages/@dooboostore/core/src/message/Observable.ts");

/**
 * Buffers the source Observable values for a specific time period.
 *
 * @param bufferTimeSpan The amount of time to fill each buffer for.
 * @param config Configuration object with optional bufferCreationInterval, maxBufferSize, and custom timer functions
 * @return An Observable of arrays of values.
 */
function bufferTime(bufferTimeSpan, config) {
    return (source) => {
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__.Observable(subscriber => {
            const bufferCreationInterval = config?.bufferCreationInterval;
            const maxBufferSize = config?.maxBufferSize;
            const skipEmpty = config?.skipEmpty ?? false;
            const setIntervalFn = config?.setInterval || setInterval;
            const setTimeoutFn = config?.setTimeout || setTimeout;
            const clearIntervalFn = config?.clearInterval || clearInterval;
            const clearTimeoutFn = config?.clearTimeout || clearTimeout;
            // If bufferCreationInterval is not provided or null, use simple single buffer mode
            if (bufferCreationInterval === undefined || bufferCreationInterval === null) {
                let buffer = [];
                const intervalId = setIntervalFn(() => {
                    if (!skipEmpty || buffer.length > 0) {
                        subscriber.next(buffer);
                    }
                    buffer = [];
                }, bufferTimeSpan);
                const sourceSubscription = source.subscribe({
                    next: (value) => {
                        buffer.push(value);
                        // If maxBufferSize is set and reached, emit immediately
                        if (maxBufferSize && buffer.length >= maxBufferSize) {
                            subscriber.next(buffer);
                            buffer = [];
                        }
                    },
                    error: (err) => {
                        subscriber.error(err);
                        clearIntervalFn(intervalId);
                    },
                    complete: () => {
                        if (!skipEmpty || buffer.length > 0) {
                            subscriber.next(buffer);
                        }
                        subscriber.complete();
                        clearIntervalFn(intervalId);
                    }
                });
                return () => {
                    sourceSubscription.unsubscribe();
                    clearIntervalFn(intervalId);
                };
            }
            // Multiple overlapping/non-overlapping buffers mode
            const buffers = [];
            let creationIntervalId;
            const createBuffer = () => {
                const newBuffer = [];
                const timeoutId = setTimeoutFn(() => {
                    // Find and remove this buffer
                    const index = buffers.findIndex(b => b.timeoutId === timeoutId);
                    if (index !== -1) {
                        const [removed] = buffers.splice(index, 1);
                        if (!skipEmpty || removed.buffer.length > 0) {
                            subscriber.next(removed.buffer);
                        }
                    }
                }, bufferTimeSpan);
                buffers.push({ buffer: newBuffer, timeoutId });
            };
            // Create first buffer immediately
            createBuffer();
            // Create new buffers at specified interval
            creationIntervalId = setIntervalFn(() => {
                createBuffer();
            }, bufferCreationInterval);
            const sourceSubscription = source.subscribe({
                next: (value) => {
                    // Add value to all active buffers
                    for (const bufferObj of buffers) {
                        bufferObj.buffer.push(value);
                        // If maxBufferSize is set and reached, emit immediately
                        if (maxBufferSize && bufferObj.buffer.length >= maxBufferSize) {
                            const index = buffers.indexOf(bufferObj);
                            if (index !== -1) {
                                buffers.splice(index, 1);
                                clearTimeoutFn(bufferObj.timeoutId);
                                subscriber.next(bufferObj.buffer);
                            }
                        }
                    }
                },
                error: (err) => {
                    subscriber.error(err);
                    clearIntervalFn(creationIntervalId);
                    buffers.forEach(b => clearTimeoutFn(b.timeoutId));
                },
                complete: () => {
                    clearIntervalFn(creationIntervalId);
                    // Emit all remaining buffers
                    buffers.forEach(b => {
                        clearTimeoutFn(b.timeoutId);
                        if (!skipEmpty || b.buffer.length > 0) {
                            subscriber.next(b.buffer);
                        }
                    });
                    subscriber.complete();
                }
            });
            return () => {
                sourceSubscription.unsubscribe();
                clearIntervalFn(creationIntervalId);
                buffers.forEach(b => clearTimeoutFn(b.timeoutId));
            };
        });
    };
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/message/operators/debounceTime.ts":
/*!******************************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/message/operators/debounceTime.ts ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   debounceTime: () => (/* binding */ debounceTime)
/* harmony export */ });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "../../packages/@dooboostore/core/src/message/Observable.ts");

function debounceTime(duration, config) {
    return (source) => {
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__.Observable(subscriber => {
            const setTimeoutFn = config?.setTimeout || setTimeout;
            const clearTimeoutFn = config?.clearTimeout || clearTimeout;
            let timeoutId = null;
            let lastValue;
            let hasValue = false;
            const subscription = source.subscribe({
                next: (value) => {
                    clearTimeoutFn(timeoutId);
                    lastValue = value;
                    hasValue = true;
                    timeoutId = setTimeoutFn(() => {
                        if (hasValue) {
                            subscriber.next(lastValue);
                            hasValue = false; // Reset after emitting
                        }
                    }, duration);
                },
                error: (err) => {
                    clearTimeoutFn(timeoutId);
                    subscriber.error(err);
                },
                complete: () => {
                    clearTimeoutFn(timeoutId);
                    // Emit the last value if it's pending
                    if (hasValue) {
                        subscriber.next(lastValue);
                    }
                    subscriber.complete();
                }
            });
            return subscription; // Return the subscription for teardown
        });
    };
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/message/operators/distinctUntilChanged.ts":
/*!**************************************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/message/operators/distinctUntilChanged.ts ***!
  \**************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   distinctUntilChanged: () => (/* binding */ distinctUntilChanged)
/* harmony export */ });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "../../packages/@dooboostore/core/src/message/Observable.ts");

function distinctUntilChanged(comparator) {
    return (source) => {
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__.Observable(subscriber => {
            let hasValue = false;
            let previousValue;
            const subscription = source.subscribe({
                next: (value) => {
                    const areEqual = hasValue
                        ? comparator
                            ? comparator(previousValue, value)
                            : previousValue === value
                        : false;
                    if (!areEqual) {
                        hasValue = true;
                        previousValue = value;
                        subscriber.next(value);
                    }
                },
                error: (err) => {
                    subscriber.error(err);
                },
                complete: () => {
                    subscriber.complete();
                }
            });
            return subscription; // Return the subscription for teardown
        });
    };
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/message/operators/filter.ts":
/*!************************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/message/operators/filter.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   filter: () => (/* binding */ filter)
/* harmony export */ });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "../../packages/@dooboostore/core/src/message/Observable.ts");

function filter(predicate) {
    return (source) => {
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__.Observable(subscriber => {
            let index = 0;
            const subscription = source.subscribe({
                next: (value) => {
                    try {
                        if (predicate(value, index++)) {
                            subscriber.next(value);
                        }
                    }
                    catch (err) {
                        subscriber.error(err);
                    }
                },
                error: (err) => {
                    subscriber.error(err);
                },
                complete: () => {
                    subscriber.complete();
                }
            });
            return subscription; // Return the subscription for teardown
        });
    };
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/message/operators/first.ts":
/*!***********************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/message/operators/first.ts ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   first: () => (/* binding */ first)
/* harmony export */ });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "../../packages/@dooboostore/core/src/message/Observable.ts");

/**
 * Emits only the first value (or the first value that meets some condition) emitted by the source Observable.
 *
 * @param predicate An optional function to test each item emitted by the source Observable.
 * @param defaultValue The default value emitted in case no valid value was found on the source.
 * @return An Observable that emits only the first value from the source Observable, or a default value if no value is emitted.
 */
function first(predicate, defaultValue) {
    return (source) => {
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__.Observable(subscriber => {
            let index = 0;
            let hasValue = false;
            const subscription = source.subscribe({
                next: (value) => {
                    if (hasValue) {
                        return; // Already found first value
                    }
                    const shouldEmit = predicate ? predicate(value, index++) : true;
                    if (shouldEmit) {
                        hasValue = true;
                        subscriber.next(value);
                        subscriber.complete();
                        subscription.unsubscribe();
                    }
                },
                error: (err) => {
                    if (!hasValue) {
                        subscriber.error(err);
                    }
                },
                complete: () => {
                    if (!hasValue) {
                        if (defaultValue !== undefined) {
                            subscriber.next(defaultValue);
                            subscriber.complete();
                        }
                        else {
                            subscriber.error(new Error('no elements in sequence'));
                        }
                    }
                }
            });
            return subscription;
        });
    };
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/message/operators/map.ts":
/*!*********************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/message/operators/map.ts ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   map: () => (/* binding */ map)
/* harmony export */ });
/* harmony import */ var _Observable__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../Observable */ "../../packages/@dooboostore/core/src/message/Observable.ts");

function map(project) {
    return (source) => {
        return new _Observable__WEBPACK_IMPORTED_MODULE_0__.Observable(subscriber => {
            let index = 0;
            const subscription = source.subscribe({
                next: (value) => {
                    try {
                        subscriber.next(project(value, index++));
                    }
                    catch (err) {
                        subscriber.error(err);
                    }
                },
                error: (err) => {
                    subscriber.error(err);
                },
                complete: () => {
                    subscriber.complete();
                }
            });
            return subscription; // Return the subscription for teardown
        });
    };
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts":
/*!******************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/object/ObjectUtils.ts ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ObjectUtils: () => (/* binding */ ObjectUtils)
/* harmony export */ });
/* harmony import */ var _valid_ValidUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../valid/ValidUtils */ "../../packages/@dooboostore/core/src/valid/ValidUtils.ts");
/* harmony import */ var _types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../types */ "../../packages/@dooboostore/core/src/types.ts");
/* harmony import */ var _parser_path_ObjectPathParser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../parser/path/ObjectPathParser */ "../../packages/@dooboostore/core/src/parser/path/ObjectPathParser.ts");



var ObjectUtils;
(function (ObjectUtils) {
    ObjectUtils.constructorName = (target) => {
        if (target && target.constructor && target.constructor.name) {
            return target.constructor.name;
        }
        else if (target && target.name) {
            return target.name;
        }
    };
    ObjectUtils.deepCopy = (obj) => {
        if (obj instanceof Map) {
            return new Map(JSON.parse(JSON.stringify(Array.from(obj.entries()))));
        }
        else if (obj instanceof Set) {
            return new Set(JSON.parse(JSON.stringify(Array.from(obj.values()))));
        }
        else if (_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_0__.ValidUtils.isNullOrUndefined(obj)) {
            return obj;
        }
        return JSON.parse(JSON.stringify(obj));
    };
    ObjectUtils.allProtoTypeName = (target, filter) => {
        let data = [];
        if (target) {
            const proto = Object.getPrototypeOf(target);
            if (proto && (data = Object.keys(proto) || []).length > 0) {
                data = data.concat(ObjectUtils.allProtoTypeName(proto, filter));
            }
        }
        let result = data.filter(it => it !== 'constructor');
        if (filter && target) {
            const proto = Object.getPrototypeOf(target);
            result = result.filter(key => filter(key, proto?.[key]));
        }
        return result;
    };
    ObjectUtils.uniqueKeys = (obj) => {
        const allKeys = Array.from(new Set((Array.isArray(obj) ? obj : [obj]).flatMap(item => Object.keys(item))));
        return allKeys;
    };
    ObjectUtils.ownPropertyNames = (target) => {
        const data = [];
        if (target) {
            if (!target.prototype) {
                const a = Object.getPrototypeOf(target);
                data.push(...Object.getOwnPropertyNames(a));
            }
            else {
                data.push(...Object.getOwnPropertyNames(Object.getPrototypeOf(target)));
            }
        }
        return data.filter(it => it !== 'constructor');
    };
    ObjectUtils.protoTypeName = (target) => {
        let data = [];
        if (target) {
            const proto = Object.getPrototypeOf(target);
            data = Object.keys(proto) || [];
        }
        return data.filter(it => it !== 'constructor');
    };
    ObjectUtils.protoTypes = (target) => {
        const data = [];
        if (target) {
            const proto = Object.getPrototypeOf(target);
            (Object.keys(proto) || []).filter(it => it !== 'constructor').forEach(it => {
                data.push(proto[it]);
            });
        }
        return data;
    };
    ObjectUtils.seal = (target) => {
        return Object.seal(target);
    };
    /*
    Object.prototype.isPrototypeOf()
    isPrototypeOf()            .
     */
    ObjectUtils.isPrototypeOfTarget = (start, target) => {
        if (start && target) {
            return Object.prototype.isPrototypeOf.call(start.prototype, target);
        }
        else {
            return false;
        }
    };
    ObjectUtils.prototypeOfDepth = (target, dest) => {
        let object = target;
        const r = [];
        if (dest) {
            do {
                object = Object.getPrototypeOf(object);
                if (object?.constructor === dest) {
                    break;
                }
                r.push(object);
            } while (object);
        }
        return r;
    };
    ObjectUtils.allProtoType = (start) => {
        const depth = (target, bowl = []) => {
            if (target.prototype) {
                bowl.push(target);
                depth(Object.getPrototypeOf(target), bowl);
            }
            return bowl;
        };
        const d = depth(start);
        return d;
        // const protos: (ConstructorType<any> | Function)[] = []
        // while (start) {
        //     protos.push(start);
        //     start = Object.getPrototypeOf(start)
        // }
        // return protos;
    };
    ObjectUtils.prototypeOf = (start) => {
        return Object.getPrototypeOf(start);
    };
    ObjectUtils.prototypeKeyMap = (target) => {
        const data = new Map();
        if (target) {
            const proto = Object.getPrototypeOf(target);
            (Object.keys(proto) || []).filter(it => it !== 'constructor').forEach(it => {
                data.set(proto[it], it);
            });
        }
        return data;
    };
    ObjectUtils.prototypeName = (target, fnc) => {
        return ObjectUtils.prototypeKeyMap(target).get(fnc);
    };
    ObjectUtils.pickRandomKey = (target) => {
        const keys = Object.keys(target);
        return keys[Math.floor(Math.random() * keys.length)];
    };
    ObjectUtils.pickRandomValue = (target) => {
        const keys = Object.keys(target);
        return target[keys[Math.floor(Math.random() * keys.length)]];
    };
    ObjectUtils.pickRandomKeyValue = (target) => {
        const keys = Object.keys(target);
        const key = keys[Math.floor(Math.random() * keys.length)];
        return { key, value: target[key] };
    };
    ObjectUtils.keyValues = (target) => {
        const keys = Object.keys(target);
        return keys.map(key => ({ key, value: target[key] }));
    };
    ObjectUtils.entries = (target) => {
        return Object.entries(target);
    };
    ObjectUtils.values = (target) => {
        return Object.values(target);
    };
    ObjectUtils.keys = (target) => {
        return Object.keys(target);
    };
    ObjectUtils.keyLength = (target) => {
        return ObjectUtils.keys(target).length;
    };
    ObjectUtils.toDeleteUndefinedAndNull = (target, config) => {
        const cleanValue = (value) => {
            if (Array.isArray(value)) {
                return value.filter(item => item !== undefined && item !== null).map(cleanValue);
            }
            else if (value && typeof value === 'object') {
                if (config?.deep) {
                    return Object.fromEntries(Object.entries(value).filter(([_, v]) => v !== undefined && v !== null).map(([k, v]) => [k, cleanValue(v)]));
                }
                else {
                    return Object.fromEntries(Object.entries(value).filter(([_, v]) => v !== undefined && v !== null));
                }
            }
            return value;
        };
        return cleanValue(target);
    };
    let Path;
    (function (Path) {
        Path.isFunctionScript = (script) => {
            return _parser_path_ObjectPathParser__WEBPACK_IMPORTED_MODULE_2__.ObjectPathParser.isFunctionScript(script);
        };
        Path.isArrowFunctionScript = (script) => {
            return _parser_path_ObjectPathParser__WEBPACK_IMPORTED_MODULE_2__.ObjectPathParser.isArrowFunctionScript(script);
        };
        Path.toOptionalChainPath = (path) => {
            if (!path) {
                return '';
            }
            const parser = new _parser_path_ObjectPathParser__WEBPACK_IMPORTED_MODULE_2__.ObjectPathParser(path);
            return parser.toOptionalChainPath();
        };
        Path.removeOptionalChainOperator = (path) => {
            if (!path) {
                return '';
            }
            const parser = new _parser_path_ObjectPathParser__WEBPACK_IMPORTED_MODULE_2__.ObjectPathParser(path);
            return parser.removeOptionalChainOperator();
        };
        const parsePath = (path) => {
            const result = [];
            const regex = /\.([^.\[]+)|\[(\d+)\]|\[(['"])(.*?)\3\]/g;
            let match;
            let lastIndex = 0;
            const firstMatch = path.match(regex);
            if (firstMatch && (firstMatch?.index ?? 0) > 0) {
                result.push(path.substring(0, firstMatch.index));
                lastIndex = firstMatch.index;
            }
            else if (!firstMatch && path.length > 0) {
                result.push(path);
                return result;
            }
            while ((match = regex.exec(path)) !== null) {
                if (match.index > lastIndex) {
                    const segment = path.substring(lastIndex, match.index);
                    if (segment.startsWith('.')) {
                        result.push(segment.substring(1));
                    }
                    else {
                        result.push(segment);
                    }
                }
                if (match[1]) {
                    result.push(match[1]);
                }
                else if (match[2]) {
                    result.push(parseInt(match[2], 10));
                }
                else if (match[4]) {
                    result.push(match[4]);
                }
                lastIndex = regex.lastIndex;
            }
            if (lastIndex < path.length) {
                const remaining = path.substring(lastIndex);
                if (remaining.startsWith('.')) {
                    result.push(remaining.substring(1));
                }
                else {
                    result.push(remaining);
                }
            }
            return result;
        };
        Path.to = (obj) => {
            const destination = {};
            Object.entries(obj).forEach(([path, value]) => {
                Path.set(destination, path, value);
            });
            return destination;
        };
        Path.set = (obj, path, value) => {
            const pathParts = parsePath(path);
            let current = obj;
            for (let i = 0; i < pathParts.length; i++) {
                const part = pathParts[i];
                const isLastPart = i === pathParts.length - 1;
                if (isLastPart) {
                    current[part] = value;
                }
                else {
                    // Ensure current[part] is of the correct type for the next part
                    const nextPart = pathParts[i + 1];
                    if (typeof nextPart === 'number') { // Next part is an array index
                        if (!Array.isArray(current[part])) {
                            current[part] = [];
                        }
                        // Fill holes if current[part] is an array and nextPart is a skipped index
                        if (Array.isArray(current[part])) {
                            while (current[part].length <= nextPart) {
                                current[part].push({}); // Fill with empty objects
                            }
                        }
                    }
                    else { // Next part is a string (object property)
                        if (typeof current[part] !== 'object' || current[part] === null) {
                            current[part] = {};
                        }
                    }
                    current = current[part];
                }
            }
        };
        Path.get = (obj, path, defaultValue) => {
            const pathParts = parsePath(path);
            let current = obj;
            for (let i = 0; i < pathParts.length; i++) {
                const part = pathParts[i];
                if (current === null || current === undefined) {
                    return defaultValue;
                }
                // Check if the current object has the property/index
                if (typeof current === 'object' && current !== null && part in current) {
                    current = current[part];
                }
                else {
                    // Property/index not found
                    return defaultValue;
                }
            }
            return current;
        };
        Path.deletePath = (obj, path) => {
            const pathParts = parsePath(path);
            if (pathParts.length === 0) {
                return false;
            }
            let current = obj;
            // Navigate to the parent of the target property
            for (let i = 0; i < pathParts.length - 1; i++) {
                const part = pathParts[i];
                if (current === null || current === undefined) {
                    return false;
                }
                if (typeof current === 'object' && current !== null && part in current) {
                    current = current[part];
                }
                else {
                    return false;
                }
            }
            // Delete the final property
            const finalPart = pathParts[pathParts.length - 1];
            if (current !== null && typeof current === 'object' && finalPart in current) {
                if (Array.isArray(current) && typeof finalPart === 'number') {
                    current.splice(finalPart, 1);
                }
                else {
                    delete current[finalPart];
                }
                return true;
            }
            return false;
        };
        Path.availablePath = (obj, filter) => {
            const paths = [];
            const formatKey = (key) => {
                if (typeof key === 'number') {
                    return '[' + key + ']'; // Array index
                }
                // Check if the key is a valid JavaScript identifier.
                // If not, it needs to be quoted.
                // A valid identifier starts with a letter, _, or $, followed by letters, digits, _, or $.
                // This regex checks for characters that are NOT valid in an identifier.
                if (!/^[a-zA-Z_$][a-zA-Z0-9_$]*$/.test(key)) {
                    // If it's not a valid identifier, quote it.
                    // Use single quotes without escaping for test compatibility
                    return "['" + key + "']";
                }
                return key;
            };
            const traverse = (current, currentPath, visited) => {
                if (current === null || typeof current !== 'object') {
                    return;
                }
                // Detect circular references
                if (visited.has(current)) {
                    return;
                }
                visited.add(current);
                if (Array.isArray(current)) {
                    current.forEach((item, index) => {
                        const formattedIndex = formatKey(index); // This will be [index]
                        const newPath = currentPath ? `${currentPath}${formattedIndex}` : formattedIndex;
                        // Apply filter if provided
                        if (!filter || filter(newPath, item)) {
                            paths.push(newPath);
                        }
                        traverse(item, newPath, visited);
                    });
                }
                else {
                    Object.keys(current).forEach(key => {
                        const formattedKey = formatKey(key);
                        let newPath;
                        // If the key needs brackets (special characters), don't add a dot before brackets
                        if (formattedKey.startsWith('[')) {
                            newPath = currentPath ? `${currentPath}${formattedKey}` : formattedKey;
                        }
                        else {
                            newPath = currentPath ? `${currentPath}.${formattedKey}` : formattedKey;
                        }
                        // Apply filter if provided
                        if (!filter || filter(newPath, current[key])) {
                            paths.push(newPath);
                        }
                        traverse(current[key], newPath, visited);
                    });
                }
            };
            traverse(obj, '', new Set());
            return paths;
        };
        /**
         *     .
         *          .
         *
         * @param script  JavaScript  
         * @param options  
         * @param options.excludeThis true  'this'   
         * @returns     Set
         */
        Path.detectPathFromScript = (script, options) => {
            const usingVars = new Set();
            class GetDetectProxy {
                prefix;
                usingVars = usingVars;
                constructor(prefix) {
                    this.prefix = prefix;
                }
                set(target, p, value, receiver) {
                    return true;
                }
                get(target, p, receiver) {
                    // Symbol   (toString, valueOf )
                    if (typeof p === 'symbol') {
                        return this.createSafeProxy(this.prefix);
                    }
                    let items;
                    const propStr = String(p);
                    //   
                    if (!isNaN(Number(propStr))) {
                        items = this.prefix ? `${this.prefix}[${propStr}]` : propStr;
                    }
                    //   
                    else {
                        items = this.prefix ? `${this.prefix}.${propStr}` : propStr;
                    }
                    //    
                    if (items) {
                        this.usingVars.add(items);
                    }
                    return this.createSafeProxy(items);
                }
                apply(target, thisArg, argArray) {
                    //       ( )
                    return this.createSafeProxy(this.prefix);
                }
                createSafeProxy(prefix) {
                    const dummyFunction = () => { };
                    const handler = new GetDetectProxy(prefix);
                    return new Proxy(dummyFunction, {
                        get: (target, prop, receiver) => {
                            if (prop === Symbol.toPrimitive) {
                                return () => '';
                            }
                            if (prop === 'valueOf') {
                                return () => handler.createSafeProxy(prefix);
                            }
                            if (prop === 'toString') {
                                return () => '';
                            }
                            return handler.get(target, prop, receiver);
                        },
                        set: handler.set.bind(handler),
                        apply: handler.apply.bind(handler)
                    });
                }
            }
            //       
            const globalContext = {
                window: new Proxy(() => { }, new GetDetectProxy('window')),
                document: new Proxy(() => { }, new GetDetectProxy('document')),
                console: new Proxy(() => { }, new GetDetectProxy('console')),
                // this destUser  
            };
            const destUser = new Proxy(() => { }, new GetDetectProxy('this'));
            try {
                //    
                const func = new Function('window', 'document', 'console', `"use strict"; ${script}; `);
                func.call(destUser, globalContext.window, globalContext.document, globalContext.console);
                // console.log('------->', script);
            }
            catch (e) {
                console.error('detectPathFromScript error:', script, e);
            }
            // excludeThis  true 'this'   'this' 
            if (options?.excludeThis) {
                const filteredVars = new Set();
                usingVars.forEach(path => {
                    if (path === 'this') {
                        // 'this'  
                        return;
                    }
                    else if (path.startsWith('this.')) {
                        // 'this.'   'this.'  
                        filteredVars.add(path.substring(5));
                    }
                    else {
                        //    
                        filteredVars.add(path);
                    }
                });
                return filteredVars;
            }
            return usingVars;
        };
    })(Path = ObjectUtils.Path || (ObjectUtils.Path = {}));
    ObjectUtils.toDeleteKey = (obj, keys) => {
        const target = { ...obj };
        ObjectUtils.deleteKey(target, keys);
        return target;
    };
    ObjectUtils.deleteKey = (obj, keys) => {
        keys.filter(it => (0,_types__WEBPACK_IMPORTED_MODULE_1__.isDefined)(it)).forEach(it => {
            delete obj[it];
        });
    };
    let Script;
    (function (Script) {
        /**
         * JavaScript    .
         *
         * @param script     {bodyScript, returnScript} 
         * @param thisTarget    this  
         * @returns   
         */
        Script.evaluateReturn = (script, thisTarget = {}) => {
            let bodyScript = '';
            let returnScript = '';
            if (typeof script === 'object') {
                bodyScript = script.bodyScript;
                returnScript = script.returnScript;
            }
            else {
                returnScript = script;
            }
            return Script.evaluate(`${bodyScript}; return ${returnScript} `, thisTarget);
        };
        /**
         * JavaScript   .
         *
         * @param script   
         * @param thisTarget    this  
         * @returns     undefined ( )
         */
        // @ts-ignore
        Script.evaluate = (script, thisTarget = {}) => {
            try {
                return Function(`"use strict"; ${script} `).bind(thisTarget)();
            }
            catch (e) {
                console.error('eval error', e);
                console.error(script);
                return undefined;
            }
        };
    })(Script = ObjectUtils.Script || (ObjectUtils.Script = {}));
})(ObjectUtils || (ObjectUtils = {}));


/***/ }),

/***/ "../../packages/@dooboostore/core/src/parser/css/CssParser.ts":
/*!********************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/parser/css/CssParser.ts ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AtRule: () => (/* binding */ AtRule),
/* harmony export */   CssNode: () => (/* binding */ CssNode),
/* harmony export */   CssParser: () => (/* binding */ CssParser),
/* harmony export */   StyleRule: () => (/* binding */ StyleRule),
/* harmony export */   isAtRule: () => (/* binding */ isAtRule),
/* harmony export */   isCssCommentItem: () => (/* binding */ isCssCommentItem),
/* harmony export */   isCssDeclarationItem: () => (/* binding */ isCssDeclarationItem),
/* harmony export */   isCssRuleItem: () => (/* binding */ isCssRuleItem),
/* harmony export */   isRule: () => (/* binding */ isRule),
/* harmony export */   isStyleRule: () => (/* binding */ isStyleRule)
/* harmony export */ });
// --- Base CSS Node Class with common functionality ---
class CssNode {
    content; // Maintains order of declarations and rules
    constructor(content = []) {
        this.content = content;
    }
    // --- Computed properties for backward compatibility ---
    get declarations() {
        const declarations = {};
        this.content.forEach(item => {
            if (item.type === 'declaration') {
                declarations[item.property] = item.value;
            }
        });
        return declarations;
    }
    get children() {
        return this.content
            .filter(item => item.type === 'rule')
            .map(item => item.rule);
    }
    // --- Common Manipulation Methods for content ---
    _addRules(rulesToAdd, atIndex) {
        const ruleItems = rulesToAdd.map(rule => ({ type: 'rule', rule }));
        if (atIndex === undefined) {
            this.content.push(...ruleItems);
        }
        else {
            // Find the actual content index for the rule at the given children index
            const ruleContentIndices = this.content
                .map((item, idx) => ({ item, idx }))
                .filter(({ item }) => item.type === 'rule')
                .map(({ idx }) => idx);
            const insertIndex = atIndex < ruleContentIndices.length ? ruleContentIndices[atIndex] : this.content.length;
            this.content.splice(insertIndex, 0, ...ruleItems);
        }
        return this;
    }
    append(ruleOrCss) {
        const rulesToAdd = CssParser._parseInputToRules(ruleOrCss);
        return this._addRules(rulesToAdd);
    }
    prepend(ruleOrCss) {
        const rulesToAdd = CssParser._parseInputToRules(ruleOrCss);
        return this._addRules(rulesToAdd, 0);
    }
    insertAt(index, ruleOrCss) {
        const rulesToAdd = CssParser._parseInputToRules(ruleOrCss);
        return this._addRules(rulesToAdd, index);
    }
    insertBefore(target, newRuleOrCss) {
        const contentIndex = this.content.findIndex(item => item.type === 'rule' && item.rule === target);
        if (contentIndex > -1) {
            const rulesToAdd = CssParser._parseInputToRules(newRuleOrCss);
            const ruleItems = rulesToAdd.map(rule => ({ type: 'rule', rule }));
            this.content.splice(contentIndex, 0, ...ruleItems);
        }
        return this;
    }
    insertAfter(target, newRuleOrCss) {
        const contentIndex = this.content.findIndex(item => item.type === 'rule' && item.rule === target);
        if (contentIndex > -1) {
            const rulesToAdd = CssParser._parseInputToRules(newRuleOrCss);
            const ruleItems = rulesToAdd.map(rule => ({ type: 'rule', rule }));
            this.content.splice(contentIndex + 1, 0, ...ruleItems);
        }
        return this;
    }
    replace(target, newRuleOrCss) {
        const contentIndex = this.content.findIndex(item => item.type === 'rule' && item.rule === target);
        if (contentIndex > -1) {
            const rulesToReplace = CssParser._parseInputToRules(newRuleOrCss);
            const ruleItems = rulesToReplace.map(rule => ({ type: 'rule', rule }));
            this.content.splice(contentIndex, 1, ...ruleItems);
        }
        return this;
    }
    remove(target) {
        const contentIndex = this.content.findIndex(item => item.type === 'rule' && item.rule === target);
        if (contentIndex > -1) {
            this.content.splice(contentIndex, 1);
        }
        return this;
    }
}
// --- Style Rule Class ---
class StyleRule extends CssNode {
    selector;
    constructor(selector, content = []) {
        super(content);
        this.selector = selector;
    }
    stringify(indent = 0) {
        const indentStr = '  '.repeat(indent);
        const innerIndentStr = '  '.repeat(indent + 1);
        if (this.content.length === 0) {
            return `${indentStr}${this.selector} {}`;
        }
        const contentLines = [];
        for (const item of this.content) {
            if (item.type === 'declaration') {
                const kebabProperty = CssParser._camelToKebab(item.property);
                contentLines.push(`${innerIndentStr}${kebabProperty}: ${item.value};`);
            }
            else if (item.type === 'rule') {
                contentLines.push(item.rule.stringify(indent + 1));
            }
            else if (item.type === 'comment') {
                contentLines.push(`${innerIndentStr}/* ${item.text} */`);
            }
        }
        const innerContent = contentLines.join('\n');
        return `${indentStr}${this.selector} {\n${innerContent}\n${indentStr}}`;
    }
}
// --- At Rule Class ---
class AtRule extends CssNode {
    name;
    condition;
    constructor(name, condition, content = []) {
        super(content);
        this.name = name;
        this.condition = condition;
    }
    stringify(indent = 0) {
        const indentStr = '  '.repeat(indent);
        const innerIndentStr = '  '.repeat(indent + 1);
        const prelude = `@${this.name}${this.condition ? ' ' + this.condition : ''}`;
        if (this.content.length === 0) {
            return `${indentStr}${prelude};`;
        }
        const contentLines = [];
        for (const item of this.content) {
            if (item.type === 'declaration') {
                const kebabProperty = CssParser._camelToKebab(item.property);
                contentLines.push(`${innerIndentStr}${kebabProperty}: ${item.value};`);
            }
            else if (item.type === 'rule') {
                contentLines.push(item.rule.stringify(indent + 1));
            }
            else if (item.type === 'comment') {
                contentLines.push(`${innerIndentStr}/* ${item.text} */`);
            }
        }
        const innerContent = contentLines.join('\n');
        return `${indentStr}${prelude} {\n${innerContent}\n${indentStr}}`;
    }
}
// --- The main parser class ---
class CssParser extends CssNode {
    constructor(css = '') {
        const content = CssParser._parseTopLevel(css);
        super(content);
    }
    // --- Accessors ---
    get rules() {
        return this.children;
    }
    // --- Stringify ---
    stringify(indent = 0) {
        if (this.content.length === 0) {
            return '';
        }
        const contentLines = [];
        for (const item of this.content) {
            if (item.type === 'declaration') {
                const kebabProperty = CssParser._camelToKebab(item.property);
                contentLines.push(`${kebabProperty}: ${item.value};`);
            }
            else if (item.type === 'rule') {
                contentLines.push(item.rule.stringify(indent));
            }
            else if (item.type === 'comment') {
                contentLines.push(`/* ${item.text} */`);
            }
        }
        return contentLines.join('\n');
    }
    // --- Static parsing method ---
    static _parseTopLevel(css) {
        const cleanedCss = CssParser._cleanCss(css);
        // Parse top-level content including comments, declarations, and rules
        return CssParser._parseContent(cleanedCss);
    }
    // --- Parsing Logic ---
    static _cleanCss(css) {
        // Don't remove comments - we'll parse them as content items
        return css.trim();
    }
    // --- Universal content parser that handles comments, declarations, and rules ---
    static _parseContent(css) {
        const content = [];
        let i = 0;
        while (i < css.length) {
            // Skip whitespace
            while (i < css.length && /\s/.test(css[i])) {
                i++;
            }
            if (i >= css.length)
                break;
            // Handle comments
            if (css[i] === '/' && i + 1 < css.length && css[i + 1] === '*') {
                const commentStart = i + 2;
                let commentEnd = css.indexOf('*/', commentStart);
                if (commentEnd === -1) {
                    commentEnd = css.length;
                    i = css.length;
                }
                else {
                    const commentText = css.substring(commentStart, commentEnd).trim();
                    content.push({ type: 'comment', text: commentText });
                    i = commentEnd + 2;
                }
                continue;
            }
            // Find the next significant token
            const nextBraceIndex = css.indexOf('{', i);
            const nextSemicolonIndex = css.indexOf(';', i);
            const nextCommentIndex = css.indexOf('/*', i);
            // Determine what comes first
            const nextTokens = [
                { type: 'brace', index: nextBraceIndex },
                { type: 'semicolon', index: nextSemicolonIndex },
                { type: 'comment', index: nextCommentIndex }
            ].filter(token => token.index !== -1).sort((a, b) => a.index - b.index);
            if (nextTokens.length === 0) {
                // No more tokens, parse remaining as declaration if it contains ':'
                const remaining = css.substring(i).trim();
                if (remaining && remaining.includes(':')) {
                    const parts = remaining.split(':');
                    if (parts.length >= 2) {
                        const prop = parts[0].trim();
                        const val = parts.slice(1).join(':').trim();
                        if (prop && val) {
                            content.push({ type: 'declaration', property: prop, value: val });
                        }
                    }
                }
                break;
            }
            const nextToken = nextTokens[0];
            if (nextToken.type === 'comment') {
                // Handle comment (already handled above, but just in case)
                i = nextToken.index;
                continue;
            }
            if (nextToken.type === 'brace') {
                // This is a rule (selector or at-rule)
                const prelude = css.substring(i, nextToken.index).trim();
                if (prelude) {
                    const blockEndIndex = CssParser._findMatchingBrace(css, nextToken.index);
                    if (blockEndIndex !== -1) {
                        const blockContent = css.substring(nextToken.index + 1, blockEndIndex).trim();
                        if (prelude.startsWith('@')) {
                            // At-rule
                            const name = prelude.match(/^@([^\s]+)/)?.[1] || 'unknown';
                            const condition = prelude.replace(/^@[^\s]+\s*/, '').trim();
                            const childContent = CssParser._parseContent(blockContent);
                            content.push({ type: 'rule', rule: new AtRule(name, condition, childContent) });
                        }
                        else {
                            // Style rule
                            const childContent = CssParser._parseContent(blockContent);
                            content.push({ type: 'rule', rule: new StyleRule(prelude, childContent) });
                        }
                        i = blockEndIndex + 1;
                        continue;
                    }
                }
            }
            if (nextToken.type === 'semicolon') {
                // This could be a declaration or at-rule without block
                const statement = css.substring(i, nextToken.index).trim();
                if (statement) {
                    if (statement.startsWith('@')) {
                        // At-rule without block
                        const name = statement.match(/^@([^\s]+)/)?.[1] || 'unknown';
                        const condition = statement.replace(/^@[^\s]+\s*/, '').trim();
                        content.push({ type: 'rule', rule: new AtRule(name, condition, []) });
                    }
                    else if (statement.includes(':')) {
                        // Declaration
                        const parts = statement.split(':');
                        if (parts.length >= 2) {
                            const prop = parts[0].trim();
                            const val = parts.slice(1).join(':').trim();
                            if (prop && val) {
                                content.push({ type: 'declaration', property: prop, value: val });
                            }
                        }
                    }
                }
                i = nextToken.index + 1;
                continue;
            }
            // Fallback: move to next character
            i++;
        }
        return content;
    }
    static _parseBlockContent(css) {
        // Use the universal content parser
        return { content: CssParser._parseContent(css) };
    }
    static _parseRules(css) {
        const rules = [];
        let currentIndex = 0;
        css = css.trim();
        const recursiveAtRules = ['media', 'supports', 'container', 'scope', 'layer'];
        while (currentIndex < css.length) {
            while (currentIndex < css.length && /\s/.test(css[currentIndex])) {
                currentIndex++;
            }
            if (currentIndex >= css.length) {
                break;
            }
            const nextBraceIndex = css.indexOf('{', currentIndex);
            const nextSemicolonIndex = css.indexOf(';', currentIndex);
            if (nextBraceIndex !== -1 && (nextBraceIndex < nextSemicolonIndex || nextSemicolonIndex === -1)) {
                const prelude = css.substring(currentIndex, nextBraceIndex).trim();
                if (!prelude) {
                    currentIndex = nextBraceIndex + 1;
                    continue;
                }
                const blockEndIndex = CssParser._findMatchingBrace(css, nextBraceIndex);
                if (blockEndIndex === -1) {
                    console.error("Malformed CSS: No matching brace for selector -> ", prelude);
                    return rules;
                }
                const blockContent = css.substring(nextBraceIndex + 1, blockEndIndex).trim();
                if (prelude.startsWith('@')) {
                    const name = prelude.match(/^@([^\s]+)/)?.[1] || 'unknown';
                    const condition = prelude.replace(/^@[^\s]+\s*/, '').trim();
                    const content = CssParser._parseContent(blockContent);
                    rules.push(new AtRule(name, condition, content));
                }
                else {
                    const content = CssParser._parseContent(blockContent);
                    rules.push(new StyleRule(prelude, content));
                }
                currentIndex = blockEndIndex + 1;
            }
            else if (nextSemicolonIndex !== -1) {
                const statement = css.substring(currentIndex, nextSemicolonIndex).trim();
                if (statement.startsWith('@')) {
                    const name = statement.match(/^@([^\s]+)/)?.[1] || 'unknown';
                    const condition = statement.replace(/^@[^\s]+\s*/, '').trim();
                    rules.push(new AtRule(name, condition, []));
                }
                currentIndex = nextSemicolonIndex + 1;
            }
            else {
                break;
            }
        }
        return rules;
    }
    static _findMatchingBrace(str, startIndex) {
        let depth = 1;
        for (let i = startIndex + 1; i < str.length; i++) {
            if (str[i] === '{') {
                depth++;
            }
            else if (str[i] === '}') {
                depth--;
                if (depth === 0) {
                    return i;
                }
            }
        }
        return -1;
    }
    static _parseDeclarations(declarationString) {
        const declarations = {};
        const declarationPairs = declarationString.split(';');
        for (const pair of declarationPairs) {
            if (pair.trim() === '') {
                continue;
            }
            const parts = pair.split(':');
            if (parts.length >= 2) {
                const property = parts[0].trim();
                const value = parts.slice(1).join(':').trim();
                if (property && value) {
                    declarations[property] = value;
                }
            }
        }
        return declarations;
    }
    static _declarationsToCSS(declarations, indent) {
        const indentStr = '  '.repeat(indent);
        return Object.entries(declarations)
            .map(([prop, value]) => `${indentStr}${CssParser._camelToKebab(prop)}: ${value};`)
            .join('\n');
    }
    static _camelToKebab(camelCase) {
        return camelCase.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g, '$1-$2').toLowerCase();
    }
    // Helper to parse string input to CssRule[]
    static _parseInputToRules(ruleOrCss) {
        if (typeof ruleOrCss === 'string') {
            const parsed = new CssParser(ruleOrCss).rules;
            if (parsed.length === 0) {
                console.warn('Provided CSS string resulted in no rules.');
            }
            return [...parsed];
        }
        else {
            return [ruleOrCss];
        }
    }
}
// --- Type Guards ---
function isRule(obj) {
    return obj instanceof StyleRule || obj instanceof AtRule;
}
function isStyleRule(rule) {
    return rule instanceof StyleRule;
}
function isAtRule(rule) {
    return rule instanceof AtRule;
}
function isCssDeclarationItem(item) {
    return item && typeof item === 'object' && item.type === 'declaration' &&
        typeof item.property === 'string' && typeof item.value === 'string';
}
function isCssRuleItem(item) {
    return item && typeof item === 'object' && item.type === 'rule' && isRule(item.rule);
}
function isCssCommentItem(item) {
    return item && typeof item === 'object' && item.type === 'comment' && typeof item.text === 'string';
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/parser/path/ObjectPathParser.ts":
/*!****************************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/parser/path/ObjectPathParser.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ObjectPathParser: () => (/* binding */ ObjectPathParser),
/* harmony export */   Token: () => (/* binding */ Token),
/* harmony export */   TokenType: () => (/* binding */ TokenType)
/* harmony export */ });
/**
 * ObjectPathParser - JavaScript    Optional Chaining  
 *
 *       
 *
 * :
 * const parser = new ObjectPathParser('this.obj.func(a.b[0])');
 * const root = parser.getRoot();
 * root.children.forEach(child => console.log(child.type));
 */
// --- Token Types ---
var TokenType;
(function (TokenType) {
    // Leaf tokens
    TokenType["IDENTIFIER"] = "identifier";
    TokenType["STRING"] = "string";
    TokenType["NUMBER"] = "number";
    TokenType["TEMPLATE_LITERAL"] = "template_literal";
    TokenType["OPERATOR"] = "operator";
    TokenType["WHITESPACE"] = "whitespace";
    // Structural tokens (can have children)
    TokenType["MEMBER_EXPRESSION"] = "member_expression";
    TokenType["PROPERTY_ACCESS"] = "property_access";
    TokenType["BRACKET_ACCESS"] = "bracket_access";
    TokenType["FUNCTION_CALL"] = "function_call";
    TokenType["PARENTHESIZED"] = "parenthesized";
    TokenType["OBJECT_LITERAL"] = "object_literal";
    TokenType["ARRAY_LITERAL"] = "array_literal";
    TokenType["TERNARY"] = "ternary";
    TokenType["BINARY"] = "binary";
    // Root
    TokenType["ROOT"] = "root";
    TokenType["EOF"] = "eof";
})(TokenType || (TokenType = {}));
// --- Base Token Class ---
class Token {
    type;
    value;
    start;
    end;
    parent = null;
    children = [];
    isOptional = false;
    //    
    leftSpace = '';
    rightSpace = '';
    constructor(type, value, start, end) {
        this.type = type;
        this.value = value;
        this.start = start;
        this.end = end;
    }
    // --- Child management ---
    addChild(child) {
        child.parent = this;
        this.children.push(child);
        return this;
    }
    getChildren() {
        return this.children;
    }
    hasChildren() {
        return this.children.length > 0;
    }
    getParent() {
        return this.parent;
    }
    // --- Type checks ---
    isIdentifier() { return this.type === TokenType.IDENTIFIER; }
    isString() { return this.type === TokenType.STRING; }
    isNumber() { return this.type === TokenType.NUMBER; }
    isTemplateLiteral() { return this.type === TokenType.TEMPLATE_LITERAL; }
    isOperator() { return this.type === TokenType.OPERATOR; }
    isWhitespace() { return this.type === TokenType.WHITESPACE; }
    isMemberExpression() { return this.type === TokenType.MEMBER_EXPRESSION; }
    isPropertyAccess() { return this.type === TokenType.PROPERTY_ACCESS; }
    isBracketAccess() { return this.type === TokenType.BRACKET_ACCESS; }
    isFunctionCall() { return this.type === TokenType.FUNCTION_CALL; }
    isParenthesized() { return this.type === TokenType.PARENTHESIZED; }
    isObjectLiteral() { return this.type === TokenType.OBJECT_LITERAL; }
    isArrayLiteral() { return this.type === TokenType.ARRAY_LITERAL; }
    isTernary() { return this.type === TokenType.TERNARY; }
    isBinary() { return this.type === TokenType.BINARY; }
    isRoot() { return this.type === TokenType.ROOT; }
    isEOF() { return this.type === TokenType.EOF; }
    // --- Keyword check for identifiers ---
    isKeyword() {
        if (this.type !== TokenType.IDENTIFIER)
            return false;
        return ['true', 'false', 'null', 'undefined', 'this', 'window', 'document'].includes(this.value);
    }
    // --- Operator checks ---
    isLogicalOperator() {
        return this.type === TokenType.OPERATOR && (this.value === '||' || this.value === '&&');
    }
    isNullishOperator() {
        return this.type === TokenType.OPERATOR && this.value === '??';
    }
    isComparisonOperator() {
        return this.type === TokenType.OPERATOR &&
            ['===', '!==', '==', '!=', '<', '>', '<=', '>='].includes(this.value);
    }
    isArithmeticOperator() {
        return this.type === TokenType.OPERATOR && ['+', '-', '*', '/', '%'].includes(this.value);
    }
    // --- Stringify ---
    stringify() {
        if (this.children.length === 0) {
            return this.value;
        }
        return this.children.map(c => c.stringify()).join('');
    }
    // --- Optional chain conversion ---
    toOptionalChain(isFirst = false) {
        switch (this.type) {
            case TokenType.PROPERTY_ACCESS:
                return `?.${this.children.map(c => c.toOptionalChain()).join('')}`;
            case TokenType.BRACKET_ACCESS:
                //     ?.  
                if (isFirst) {
                    return `[${this.children.map(c => c.toOptionalChain()).join('')}]`;
                }
                return `?.[${this.children.map(c => c.toOptionalChain()).join('')}]`;
            case TokenType.FUNCTION_CALL:
                return `?.(${this.children.map(c => c.toOptionalChain()).join('')})`;
            case TokenType.MEMBER_EXPRESSION:
                if (this.children.length === 0)
                    return this.value;
                let result = '';
                for (let i = 0; i < this.children.length; i++) {
                    const child = this.children[i];
                    //    isFirst=true 
                    result += child.toOptionalChain(i === 0);
                }
                return result;
            case TokenType.PARENTHESIZED:
                // isOptional   ?.  
                if (this.isOptional) {
                    return `?.(${this.children.map(c => c.toOptionalChain()).join('')})`;
                }
                //  MEMBER_EXPRESSION     ?. 
                if (this.parent?.type === TokenType.MEMBER_EXPRESSION && !isFirst) {
                    return `?.(${this.children.map(c => c.toOptionalChain()).join('')})`;
                }
                return `(${this.children.map(c => c.toOptionalChain()).join('')})`;
            case TokenType.TERNARY:
                // children: [condition, trueBranch, falseBranch]
                if (this.children.length >= 3) {
                    return `${this.children[0].toOptionalChain()} ? ${this.children[1].toOptionalChain()} : ${this.children[2].toOptionalChain()}`;
                }
                return this.stringify();
            case TokenType.BINARY:
                // children: [left, right], value contains operator
                if (this.children.length >= 2) {
                    const op = this.value;
                    //   
                    const leftSp = this.leftSpace;
                    const rightSp = this.rightSpace;
                    return `${this.children[0].toOptionalChain()}${leftSp}${op}${rightSp}${this.children[1].toOptionalChain()}`;
                }
                return this.stringify();
            case TokenType.ROOT:
                return this.children.map(c => c.toOptionalChain()).join('');
            case TokenType.OBJECT_LITERAL:
            case TokenType.ARRAY_LITERAL:
            case TokenType.STRING:
            case TokenType.NUMBER:
            case TokenType.TEMPLATE_LITERAL:
                return this.value;
            case TokenType.OPERATOR:
                // Unary operator with children (e.g., !expr)
                if (this.children.length > 0) {
                    return `${this.value}${this.children.map(c => c.toOptionalChain()).join('')}`;
                }
                return this.value;
            default:
                return this.value;
        }
    }
    // --- Tree traversal ---
    walk(callback, depth = 0) {
        callback(this, depth);
        for (const child of this.children) {
            child.walk(callback, depth + 1);
        }
    }
    find(predicate) {
        if (predicate(this))
            return this;
        for (const child of this.children) {
            const found = child.find(predicate);
            if (found)
                return found;
        }
        return null;
    }
    findAll(predicate) {
        const results = [];
        this.walk((token) => {
            if (predicate(token))
                results.push(token);
        });
        return results;
    }
}
// --- ObjectPathParser Class ---
class ObjectPathParser {
    input;
    pos = 0;
    root;
    constructor(input = '') {
        this.input = input;
        this.root = new Token(TokenType.ROOT, '', 0, input.length);
        if (input) {
            this.parse();
        }
    }
    // --- Getters ---
    getInput() {
        return this.input;
    }
    getRoot() {
        return this.root;
    }
    getTokens() {
        return this.root.children;
    }
    // --- Flat token list (for backward compatibility) ---
    getFlatTokens() {
        const tokens = [];
        this.root.walk((token) => {
            if (token.type !== TokenType.ROOT) {
                tokens.push(token);
            }
        });
        return tokens;
    }
    // --- Helper methods ---
    isFunctionScript() {
        return this.input.trim().startsWith('function');
    }
    isArrowFunctionScript() {
        return /^\s*\([^)]*\)\s*=>/.test(this.input);
    }
    isObjectLiteralInput() {
        const trimmed = this.input.trim();
        return trimmed.startsWith('{') && trimmed.endsWith('}');
    }
    // --- Tokenizer helpers ---
    peek(offset = 0) {
        return this.input[this.pos + offset] || '';
    }
    advance() {
        return this.input[this.pos++] || '';
    }
    isEOF() {
        return this.pos >= this.input.length;
    }
    skipWhitespace() {
        while (!this.isEOF() && /\s/.test(this.peek())) {
            this.advance();
        }
    }
    // --- Main parse method ---
    parse() {
        this.pos = 0;
        this.root = new Token(TokenType.ROOT, '', 0, this.input.length);
        while (!this.isEOF()) {
            this.skipWhitespace();
            if (this.isEOF())
                break;
            const token = this.parseExpression();
            if (token) {
                this.root.addChild(token);
            }
        }
    }
    parseExpression() {
        this.skipWhitespace();
        if (this.isEOF())
            return null;
        // Check for ternary operator at top level
        const ternary = this.tryParseTernary();
        if (ternary)
            return ternary;
        // Check for binary operators
        const binary = this.tryParseBinary();
        if (binary)
            return binary;
        // Parse primary expression (member expression, literal, etc.)
        return this.parsePrimaryExpression();
    }
    parsePrimaryExpression() {
        this.skipWhitespace();
        if (this.isEOF())
            return null;
        const start = this.pos;
        const char = this.peek();
        // String literal
        if (char === "'" || char === '"') {
            return this.parseString(char);
        }
        // Template literal
        if (char === '`') {
            return this.parseTemplateLiteral();
        }
        // Object literal
        if (char === '{') {
            return this.parseObjectLiteral();
        }
        // Array literal or bracket access at start
        if (char === '[') {
            return this.parseArrayOrBracket();
        }
        // Parenthesized expression
        if (char === '(') {
            return this.parseParenthesized();
        }
        // Number
        if (/\d/.test(char)) {
            return this.parseNumber();
        }
        // Identifier (start of member expression)
        if (/[a-zA-Z_$]/.test(char)) {
            return this.parseMemberExpression();
        }
        // Unary NOT operator (!)
        if (char === '!') {
            return this.parseUnaryNot();
        }
        // Operator
        if (this.isOperatorChar(char)) {
            return this.parseOperator();
        }
        // Unknown - skip
        this.advance();
        return null;
    }
    // Parse unary NOT operator (!expr)
    parseUnaryNot() {
        const start = this.pos;
        this.advance(); // consume !
        this.skipWhitespace();
        // Parse the expression after !
        const expr = this.parsePrimaryExpression();
        if (expr) {
            // Create a unary token that wraps the expression
            const unary = new Token(TokenType.OPERATOR, '!', start, this.pos);
            unary.addChild(expr);
            return unary;
        }
        return new Token(TokenType.OPERATOR, '!', start, this.pos);
    }
    parseMemberExpression() {
        const start = this.pos;
        const memberExpr = new Token(TokenType.MEMBER_EXPRESSION, '', start, start);
        // Parse the base identifier
        const identifier = this.parseIdentifier();
        memberExpr.addChild(identifier);
        // Parse chain of accesses
        while (!this.isEOF()) {
            const char = this.peek();
            // Optional chaining: ?.
            if (char === '?' && this.peek(1) === '.') {
                this.advance();
                this.advance(); // consume ?.
                if (this.peek() === '[') {
                    // ?.[
                    const bracket = this.parseBracketAccess(true);
                    memberExpr.addChild(bracket);
                }
                else if (this.peek() === '(') {
                    // ?.(
                    const funcCall = this.parseFunctionCall(true);
                    memberExpr.addChild(funcCall);
                }
                else {
                    // ?.property
                    const prop = this.parsePropertyAccess(true);
                    memberExpr.addChild(prop);
                }
            }
            // Regular dot access
            else if (char === '.') {
                this.advance(); // consume .
                // Check if next is parenthesis (e.g., a.(b).c)
                if (this.peek() === '(') {
                    const paren = this.parseParenthesizedAccess(false);
                    memberExpr.addChild(paren);
                }
                else {
                    const prop = this.parsePropertyAccess(false);
                    memberExpr.addChild(prop);
                }
            }
            // Bracket access
            else if (char === '[') {
                const bracket = this.parseBracketAccess(false);
                memberExpr.addChild(bracket);
            }
            // Function call
            else if (char === '(') {
                const funcCall = this.parseFunctionCall(false);
                memberExpr.addChild(funcCall);
            }
            else {
                break;
            }
        }
        memberExpr.end = this.pos;
        memberExpr.value = this.input.substring(start, this.pos);
        return memberExpr;
    }
    //     (e.g., a.(b).c)
    parseParenthesizedAccess(isOptional) {
        const start = this.pos;
        this.advance(); // consume (
        const paren = new Token(TokenType.PARENTHESIZED, '', start, start);
        paren.isOptional = isOptional;
        let depth = 1;
        let content = '';
        while (!this.isEOF() && depth > 0) {
            const char = this.peek();
            if (char === '(')
                depth++;
            else if (char === ')') {
                depth--;
                if (depth === 0)
                    break;
            }
            content += this.advance();
        }
        if (content.trim()) {
            const innerParser = new ObjectPathParser(content);
            for (const child of innerParser.getTokens()) {
                paren.addChild(child);
            }
        }
        if (this.peek() === ')')
            this.advance(); // consume )
        paren.end = this.pos;
        paren.value = this.input.substring(start, this.pos);
        return paren;
    }
    parseIdentifier() {
        const start = this.pos;
        let value = '';
        while (!this.isEOF() && /[a-zA-Z0-9_$]/.test(this.peek())) {
            value += this.advance();
        }
        return new Token(TokenType.IDENTIFIER, value, start, this.pos);
    }
    parsePropertyAccess(isOptional) {
        const start = this.pos;
        const prop = new Token(TokenType.PROPERTY_ACCESS, '', start, start);
        prop.isOptional = isOptional;
        const identifier = this.parseIdentifier();
        prop.addChild(identifier);
        prop.end = this.pos;
        prop.value = this.input.substring(start, this.pos);
        return prop;
    }
    parseBracketAccess(isOptional) {
        const start = this.pos;
        this.advance(); // consume [
        const bracket = new Token(TokenType.BRACKET_ACCESS, '', start, start);
        bracket.isOptional = isOptional;
        // Parse content inside brackets
        const contentStart = this.pos;
        let depth = 1;
        let content = '';
        while (!this.isEOF() && depth > 0) {
            const char = this.peek();
            if (char === '[')
                depth++;
            else if (char === ']') {
                depth--;
                if (depth === 0)
                    break;
            }
            content += this.advance();
        }
        // Parse the content as expression
        if (content.trim()) {
            const innerParser = new ObjectPathParser(content);
            for (const child of innerParser.getTokens()) {
                bracket.addChild(child);
            }
        }
        if (this.peek() === ']')
            this.advance(); // consume ]
        bracket.end = this.pos;
        bracket.value = this.input.substring(start, this.pos);
        return bracket;
    }
    parseFunctionCall(isOptional) {
        const start = this.pos;
        this.advance(); // consume (
        const funcCall = new Token(TokenType.FUNCTION_CALL, '', start, start);
        funcCall.isOptional = isOptional;
        // Parse arguments
        let depth = 1;
        let content = '';
        while (!this.isEOF() && depth > 0) {
            const char = this.peek();
            if (char === '(')
                depth++;
            else if (char === ')') {
                depth--;
                if (depth === 0)
                    break;
            }
            content += this.advance();
        }
        // Parse arguments as expressions
        if (content.trim()) {
            const innerParser = new ObjectPathParser(content);
            for (const child of innerParser.getTokens()) {
                funcCall.addChild(child);
            }
        }
        if (this.peek() === ')')
            this.advance(); // consume )
        funcCall.end = this.pos;
        funcCall.value = this.input.substring(start, this.pos);
        return funcCall;
    }
    parseParenthesized() {
        const start = this.pos;
        this.advance(); // consume (
        const paren = new Token(TokenType.PARENTHESIZED, '', start, start);
        let depth = 1;
        let content = '';
        while (!this.isEOF() && depth > 0) {
            const char = this.peek();
            if (char === '(')
                depth++;
            else if (char === ')') {
                depth--;
                if (depth === 0)
                    break;
            }
            content += this.advance();
        }
        if (content.trim()) {
            const innerParser = new ObjectPathParser(content);
            for (const child of innerParser.getTokens()) {
                paren.addChild(child);
            }
        }
        if (this.peek() === ')')
            this.advance(); // consume )
        paren.end = this.pos;
        paren.value = this.input.substring(start, this.pos);
        // Check if followed by member access (e.g., (expr).prop or (expr)[0] or (expr)?.prop)
        if (this.peek() === '.' || this.peek() === '[' || (this.peek() === '?' && this.peek(1) === '.')) {
            const memberExpr = new Token(TokenType.MEMBER_EXPRESSION, '', start, start);
            memberExpr.addChild(paren);
            while (!this.isEOF()) {
                const char = this.peek();
                // Optional chaining: ?.
                if (char === '?' && this.peek(1) === '.') {
                    this.advance();
                    this.advance(); // consume ?.
                    if (this.peek() === '[') {
                        const bracket = this.parseBracketAccess(true);
                        memberExpr.addChild(bracket);
                    }
                    else if (this.peek() === '(') {
                        const funcCall = this.parseFunctionCall(true);
                        memberExpr.addChild(funcCall);
                    }
                    else {
                        const prop = this.parsePropertyAccess(true);
                        memberExpr.addChild(prop);
                    }
                }
                else if (char === '.') {
                    this.advance(); // consume .
                    if (this.peek() === '(') {
                        const parenAccess = this.parseParenthesizedAccess(false);
                        memberExpr.addChild(parenAccess);
                    }
                    else {
                        const prop = this.parsePropertyAccess(false);
                        memberExpr.addChild(prop);
                    }
                }
                else if (char === '[') {
                    const bracket = this.parseBracketAccess(false);
                    memberExpr.addChild(bracket);
                }
                else {
                    break;
                }
            }
            memberExpr.end = this.pos;
            memberExpr.value = this.input.substring(start, this.pos);
            return memberExpr;
        }
        return paren;
    }
    parseString(quote) {
        const start = this.pos;
        let value = this.advance(); // opening quote
        while (!this.isEOF() && this.peek() !== quote) {
            if (this.peek() === '\\') {
                value += this.advance();
                if (!this.isEOF())
                    value += this.advance();
            }
            else {
                value += this.advance();
            }
        }
        if (!this.isEOF())
            value += this.advance(); // closing quote
        return new Token(TokenType.STRING, value, start, this.pos);
    }
    parseTemplateLiteral() {
        const start = this.pos;
        let value = this.advance(); // opening `
        let depth = 0;
        while (!this.isEOF()) {
            const char = this.peek();
            if (char === '`' && depth === 0) {
                value += this.advance();
                break;
            }
            // Handle ${...} expressions - process them for optional chaining
            if (char === '$' && this.peek(1) === '{') {
                value += this.advance(); // $
                value += this.advance(); // {
                depth++;
                // Collect the expression inside ${...}
                let exprContent = '';
                let exprDepth = 1;
                while (!this.isEOF() && exprDepth > 0) {
                    const c = this.peek();
                    if (c === '{')
                        exprDepth++;
                    else if (c === '}') {
                        exprDepth--;
                        if (exprDepth === 0)
                            break;
                    }
                    exprContent += this.advance();
                }
                // Process the expression for optional chaining
                if (exprContent.trim()) {
                    const innerParser = new ObjectPathParser(exprContent);
                    value += innerParser.toOptionalChainPath();
                }
                if (this.peek() === '}') {
                    value += this.advance(); // }
                    depth--;
                }
                continue;
            }
            if (char === '\\') {
                value += this.advance();
                if (!this.isEOF())
                    value += this.advance();
            }
            else {
                value += this.advance();
            }
        }
        return new Token(TokenType.TEMPLATE_LITERAL, value, start, this.pos);
    }
    parseNumber() {
        const start = this.pos;
        let value = '';
        while (!this.isEOF() && /[\d.]/.test(this.peek())) {
            value += this.advance();
        }
        return new Token(TokenType.NUMBER, value, start, this.pos);
    }
    parseObjectLiteral() {
        const start = this.pos;
        this.advance(); // consume {
        let depth = 1;
        let content = '{';
        while (!this.isEOF() && depth > 0) {
            const char = this.peek();
            if (char === '{')
                depth++;
            else if (char === '}')
                depth--;
            content += this.advance();
        }
        return new Token(TokenType.OBJECT_LITERAL, content, start, this.pos);
    }
    parseArrayOrBracket() {
        const start = this.pos;
        this.advance(); // consume [
        let depth = 1;
        let content = '';
        while (!this.isEOF() && depth > 0) {
            const char = this.peek();
            if (char === '[')
                depth++;
            else if (char === ']') {
                depth--;
                if (depth === 0)
                    break;
            }
            content += this.advance();
        }
        if (this.peek() === ']')
            this.advance();
        // Check if this is followed by member access (then it's bracket access at start)
        if (this.peek() === '.' || this.peek() === '[') {
            const bracket = new Token(TokenType.BRACKET_ACCESS, `[${content}]`, start, this.pos);
            if (content.trim()) {
                const innerParser = new ObjectPathParser(content);
                for (const child of innerParser.getTokens()) {
                    bracket.addChild(child);
                }
            }
            // Continue parsing as member expression
            const memberExpr = new Token(TokenType.MEMBER_EXPRESSION, '', start, start);
            memberExpr.addChild(bracket);
            while (!this.isEOF()) {
                const char = this.peek();
                if (char === '.') {
                    this.advance();
                    memberExpr.addChild(this.parsePropertyAccess(false));
                }
                else if (char === '[') {
                    memberExpr.addChild(this.parseBracketAccess(false));
                }
                else {
                    break;
                }
            }
            memberExpr.end = this.pos;
            memberExpr.value = this.input.substring(start, this.pos);
            return memberExpr;
        }
        // Otherwise it's an array literal
        return new Token(TokenType.ARRAY_LITERAL, `[${content}]`, start, this.pos);
    }
    isOperatorChar(char) {
        return ['+', '-', '*', '/', '%', '=', '!', '<', '>', '&', '|', '?'].includes(char);
    }
    parseOperator() {
        const start = this.pos;
        let value = this.advance();
        const next = this.peek();
        // Multi-char operators
        if ((value === '=' || value === '!' || value === '<' || value === '>') && next === '=') {
            value += this.advance();
            if (this.peek() === '=')
                value += this.advance();
        }
        else if ((value === '&' && next === '&') || (value === '|' && next === '|')) {
            value += this.advance();
        }
        else if (value === '?' && next === '?') {
            value += this.advance();
        }
        return new Token(TokenType.OPERATOR, value, start, this.pos);
    }
    tryParseTernary() {
        // Look ahead for ternary pattern: expr ? expr : expr
        const savedPos = this.pos;
        const remaining = this.input.substring(this.pos);
        // Find ternary operator at depth 0, respecting string literals
        let depth = 0;
        let inString = false;
        let stringChar = '';
        let questionIdx = -1;
        let colonIdx = -1;
        for (let i = 0; i < remaining.length; i++) {
            const char = remaining[i];
            const prevChar = i > 0 ? remaining[i - 1] : '';
            // Track string state (handle escape characters)
            if ((char === '"' || char === "'" || char === '`') && prevChar !== '\\') {
                if (!inString) {
                    inString = true;
                    stringChar = char;
                }
                else if (char === stringChar) {
                    inString = false;
                    stringChar = '';
                }
            }
            if (inString)
                continue;
            // Track depth for parentheses, brackets, braces
            if (char === '(' || char === '[' || char === '{')
                depth++;
            else if (char === ')' || char === ']' || char === '}')
                depth--;
            // Find ternary ? at depth 0
            if (depth === 0 && char === '?') {
                const nextChar = remaining[i + 1] || '';
                // Skip optional chaining (?.) and nullish coalescing (??)
                if (nextChar === '.' || nextChar === '?')
                    continue;
                // Ternary ? should be followed by whitespace or expression
                questionIdx = i;
            }
            // Find ternary : at depth 0 (only after finding ?)
            if (depth === 0 && char === ':' && questionIdx >= 0 && colonIdx < 0) {
                colonIdx = i;
                break;
            }
        }
        // Not a ternary expression
        if (questionIdx < 0 || colonIdx < 0)
            return null;
        const condStr = remaining.substring(0, questionIdx).trim();
        const trueStr = remaining.substring(questionIdx + 1, colonIdx).trim();
        const falseStr = remaining.substring(colonIdx + 1).trim();
        if (!condStr || !trueStr || !falseStr)
            return null;
        const ternary = new Token(TokenType.TERNARY, remaining, savedPos, savedPos + remaining.length);
        const condParser = new ObjectPathParser(condStr);
        const trueParser = new ObjectPathParser(trueStr);
        const falseParser = new ObjectPathParser(falseStr);
        for (const child of condParser.getTokens())
            ternary.addChild(child);
        for (const child of trueParser.getTokens())
            ternary.addChild(child);
        for (const child of falseParser.getTokens())
            ternary.addChild(child);
        this.pos = this.input.length; // consume all
        return ternary;
    }
    tryParseBinary() {
        // Look for binary operators at top level
        const remaining = this.input.substring(this.pos);
        // Check operators in order of precedence (lowest to highest)
        // This ensures we parse correctly: a < b - c => a < (b - c), not (a < b) - c
        const operatorGroups = [
            ['||'], // Logical OR (lowest precedence)
            ['&&'], // Logical AND
            ['??'], // Nullish coalescing
            ['<', '>', '<=', '>='], // Comparison
            ['===', '!==', '==', '!='], // Equality
            ['+', '-'], // Addition/Subtraction
            ['*', '/', '%'] // Multiplication/Division (highest precedence)
        ];
        // Search from lowest to highest precedence
        for (const operators of operatorGroups) {
            for (const op of operators) {
                let depth = 0;
                let inString = false;
                let stringChar = '';
                let lastMatchIndex = -1;
                // Find the LAST occurrence of this operator at depth 0 (right-to-left for left-associative)
                for (let i = 0; i < remaining.length - op.length + 1; i++) {
                    const char = remaining[i];
                    // Track string state
                    if ((char === '"' || char === "'" || char === '`') && (i === 0 || remaining[i - 1] !== '\\')) {
                        if (!inString) {
                            inString = true;
                            stringChar = char;
                        }
                        else if (char === stringChar) {
                            inString = false;
                        }
                    }
                    if (inString)
                        continue;
                    // Track depth
                    if (char === '(' || char === '[' || char === '{')
                        depth++;
                    else if (char === ')' || char === ']' || char === '}')
                        depth--;
                    // Check for operator at depth 0
                    if (depth === 0 && remaining.substring(i, i + op.length) === op) {
                        // Make sure it's not part of optional chaining
                        if (op === '?' && remaining[i + 1] === '.')
                            continue;
                        // For - operator, make sure it's not a negative number
                        if (op === '-') {
                            // Look back to find the last non-whitespace character
                            let lastNonSpace = '';
                            for (let j = i - 1; j >= 0; j--) {
                                if (remaining[j].trim()) {
                                    lastNonSpace = remaining[j];
                                    break;
                                }
                            }
                            // Skip if it looks like a negative number (after operator, comma, or opening bracket/paren, or at start)
                            if (!lastNonSpace || /[+\-*\/%=<>!&|,(\[]/.test(lastNonSpace)) {
                                continue;
                            }
                        }
                        // For comparison/equality operators, make sure we're not matching part of a longer operator
                        if (['<', '>', '=', '!'].includes(op)) {
                            const nextChar = remaining[i + op.length] || '';
                            if (nextChar === '=')
                                continue; // Skip < if it's part of <=
                        }
                        lastMatchIndex = i;
                    }
                }
                // If we found a match, split there
                if (lastMatchIndex >= 0) {
                    const i = lastMatchIndex;
                    const leftRaw = remaining.substring(0, i);
                    const rightRaw = remaining.substring(i + op.length);
                    const leftStr = leftRaw.trim();
                    const rightStr = rightRaw.trim();
                    if (leftStr && rightStr) {
                        const binary = new Token(TokenType.BINARY, op, this.pos, this.pos + remaining.length);
                        //    
                        const leftTrailingSpace = leftRaw.substring(leftStr.length);
                        const rightLeadingSpace = rightRaw.substring(0, rightRaw.length - rightRaw.trimStart().length);
                        binary.leftSpace = leftTrailingSpace;
                        binary.rightSpace = rightLeadingSpace;
                        const leftParser = new ObjectPathParser(leftStr);
                        const rightParser = new ObjectPathParser(rightStr);
                        // Binary token should have exactly 2 children: left and right
                        // Wrap the parsed results in containers that preserve the original structure
                        const leftContainer = new Token(TokenType.ROOT, leftStr, 0, leftStr.length);
                        for (const child of leftParser.getTokens())
                            leftContainer.addChild(child);
                        binary.addChild(leftContainer);
                        const rightContainer = new Token(TokenType.ROOT, rightStr, 0, rightStr.length);
                        for (const child of rightParser.getTokens())
                            rightContainer.addChild(child);
                        binary.addChild(rightContainer);
                        this.pos = this.input.length;
                        return binary;
                    }
                }
            }
        }
        return null;
    }
    // --- Main conversion method ---
    toOptionalChainPath() {
        if (!this.input)
            return '';
        //    
        if (this.isObjectLiteralInput())
            return this.input;
        //    
        if (this.isFunctionScript() || this.isArrowFunctionScript())
            return this.input;
        return this.root.toOptionalChain();
    }
    removeOptionalChainOperator() {
        if (!this.input)
            return '';
        return this.input.replace(/\?\./g, '.').replace(/\.\[/g, '[');
    }
    stringify() {
        return this.root.stringify();
    }
    // --- Static factory methods ---
    static parse(input) {
        return new ObjectPathParser(input);
    }
    static isFunctionScript(script) {
        return script.trim().startsWith('function');
    }
    static isArrowFunctionScript(script) {
        return /^\s*\([^)]*\)\s*=>/.test(script);
    }
    static isObjectLiteral(script) {
        const trimmed = script.trim();
        return trimmed.startsWith('{') && trimmed.endsWith('}');
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/promise/AbortablePromise.ts":
/*!************************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/promise/AbortablePromise.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AbortablePromise: () => (/* binding */ AbortablePromise)
/* harmony export */ });
/**
 * AbortablePromise - Promise-like class that supports AbortSignal
 * Allows chaining with .then() and collects steps for sequential execution
 */
class AbortablePromise {
    steps = [];
    signal;
    initialExecutor;
    errorHandler;
    constructor(executor, signal) {
        this.initialExecutor = executor;
        this.signal = signal;
    }
    then(onfulfilled, onrejected) {
        // Create new promise instance
        const newPromise = new AbortablePromise(this.initialExecutor, this.signal);
        // Copy existing steps
        newPromise.steps = [...this.steps];
        // Add new step if provided
        if (onfulfilled) {
            newPromise.steps.push(onfulfilled);
        }
        // Set error handler if provided
        if (onrejected) {
            newPromise.errorHandler = onrejected;
        }
        else if (this.errorHandler) {
            newPromise.errorHandler = this.errorHandler;
        }
        return newPromise;
    }
    catch(onrejected) {
        return this.then(undefined, onrejected);
    }
    finally(onfinally) {
        return this.then((value) => {
            onfinally?.();
            return value;
        }, (reason) => {
            onfinally?.();
            throw reason;
        });
    }
    async execute() {
        try {
            // Check abort before starting
            if (this.signal?.aborted) {
                throw new Error(this.signal.reason || 'Aborted');
            }
            // Create abort promise
            const abortPromise = new Promise((_, reject) => {
                if (this.signal?.aborted) {
                    return reject(new Error(this.signal.reason || 'Aborted'));
                }
                const callback = (e) => {
                    const target = e.target;
                    this.signal?.removeEventListener('abort', callback);
                    reject(new Error(target.reason || 'Aborted'));
                };
                this.signal?.addEventListener('abort', callback, { once: true });
            });
            // Pipeline runner
            const pipelineRunner = async () => {
                // Execute initial executor
                let lastResult;
                if (typeof this.initialExecutor === 'function') {
                    if (this.signal?.aborted) {
                        throw new Error(this.signal.reason || 'Aborted');
                    }
                    lastResult = await this.initialExecutor();
                }
                else {
                    lastResult = await this.initialExecutor;
                }
                // Execute each step sequentially
                for (let i = 0; i < this.steps.length; i++) {
                    // Check abort before each step
                    if (this.signal?.aborted) {
                        throw new Error(this.signal.reason || 'Aborted');
                    }
                    const step = this.steps[i];
                    lastResult = await step(lastResult);
                }
                return lastResult;
            };
            return await Promise.race([pipelineRunner(), abortPromise]);
        }
        catch (error) {
            if (this.errorHandler) {
                return await this.errorHandler(error);
            }
            throw error;
        }
    }
    // Convert to native Promise
    toPromise() {
        return this.execute();
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/core/src/promise/Promises.ts":
/*!****************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/promise/Promises.ts ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Promises: () => (/* binding */ Promises)
/* harmony export */ });
/* harmony import */ var _valid_ValidUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../valid/ValidUtils */ "../../packages/@dooboostore/core/src/valid/ValidUtils.ts");
/* harmony import */ var _AbortablePromise__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AbortablePromise */ "../../packages/@dooboostore/core/src/promise/AbortablePromise.ts");


var Promises;
(function (Promises) {
    Promises.isFulfilled = (result) => {
        return result.status === 'fulfilled';
    };
    Promises.isRejected = (result) => {
        return result.status === 'rejected';
    };
    Promises.filterCatch = async (promise, has) => {
        try {
            await promise;
            return undefined;
        }
        catch (e) {
            const targetHas = Array.isArray(has) ? has : [has];
            for (let ha of targetHas) {
                if (_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_0__.ValidUtils.isConstructor(ha)) {
                    if (e instanceof ha) {
                        return e;
                    }
                }
                else {
                    if (ha(e)) {
                        return e;
                    }
                }
            }
            throw e;
        }
        // removed by dead control flow

    };
    Promises.sleep = (ms) => new Promise(resolve => setTimeout(resolve, ms));
    Promises.sleepReject = (ms) => new Promise((resolve, reject) => setTimeout(reject, ms));
    Promises.settle = async (promise) => {
        return Promise.allSettled([promise]).then(results => results[0]);
    };
    Promises.settles = async (...promises) => {
        return Promise.allSettled(promises);
    };
    Promises.loop = (config) => {
        return {
            subscribe: (callback) => {
                let stop = false;
                let age = 0;
                const loopExecute = async () => {
                    const start = Date.now();
                    let end = start;
                    age++;
                    const executeConfig = { age: age };
                    let t;
                    let isCatch = false;
                    try {
                        t = await config.factory(executeConfig);
                        end = Date.now();
                        callback.then?.(t, { ...executeConfig, duration: end - start });
                    }
                    catch (e) {
                        isCatch = true;
                        end = Date.now();
                        callback.catch?.(e, { ...executeConfig, duration: end - start });
                    }
                    await Promises.sleep(config.loopDelay ?? 0);
                    // @ts-ignore
                    callback.delayThen?.({ ...executeConfig, duration: end - start, isCatch: isCatch, data: t });
                    if (!stop)
                        return loopExecute();
                };
                setTimeout(() => {
                    loopExecute();
                }, config.delay ?? 0);
                return {
                    get closed() {
                        return stop;
                    },
                    unsubscribe: () => {
                        stop = true;
                    }
                };
            }
        };
    };
    Promises.delayExecute = (value, delay = 0) => {
        return new Promise(resolve => {
            setTimeout(async () => {
                const t = await value();
                resolve(t);
            }, delay);
        });
    };
    /**
     * Create an abortable promise chain
     * @param executor Initial promise or promise factory
     * @param signal Optional AbortSignal to cancel the execution
     */
    Promises.abortable = (executor, signal) => {
        return new _AbortablePromise__WEBPACK_IMPORTED_MODULE_1__.AbortablePromise(executor, signal);
    };
    Promises.withResolvers = () => {
        let resolve;
        let reject;
        const promise = new Promise((res, rej) => {
            resolve = res;
            reject = rej;
        });
        return { promise, resolve, reject };
    };
    /**
     * Execute promises in chunks with concurrency limit to prevent network overload
     * @param promiseFactories Array of promise factories (functions that return promises)
     * @param chunkSize Number of promises to execute concurrently
     * @returns Promise that resolves with all results
     */
    Promises.executeInChunks = async (promiseFactories, chunkSize = 10) => {
        const results = [];
        for (let i = 0; i < promiseFactories.length; i += chunkSize) {
            const chunk = promiseFactories.slice(i, i + chunkSize);
            const chunkResults = await Promise.all(chunk.map(factory => factory()));
            results.push(...chunkResults);
            // Add small delay between chunks to be extra safe
            if (i + chunkSize < promiseFactories.length) {
                await Promises.sleep(100);
            }
        }
        return results;
    };
    /**
     * Execute promises with concurrency limit using a pool pattern
     * @param promiseFactories Array of promise factories
     * @param concurrency Maximum number of concurrent executions
     * @returns Promise that resolves with all results
     */
    Promises.executeWithConcurrency = async (promiseFactories, concurrency = 10) => {
        const results = new Array(promiseFactories.length);
        let currentIndex = 0;
        const executeNext = async (index) => {
            while (currentIndex < promiseFactories.length) {
                const factoryIndex = currentIndex++;
                results[factoryIndex] = await promiseFactories[factoryIndex]();
            }
        };
        // Create pool of concurrent workers
        const workers = Array(Math.min(concurrency, promiseFactories.length))
            .fill(0)
            .map((_, i) => executeNext(i));
        await Promise.all(workers);
        return results;
    };
    /**
     * Execute promises with concurrency limit using race pattern (most efficient)
     * Automatically starts a new promise as soon as one completes
     * @param promiseFactories Array of promise factories
     * @param limit Maximum number of concurrent executions (default: 5)
     * @returns Promise that resolves with all results
     */
    Promises.executeWithLimit = async (promiseFactories, limit = 5) => {
        const results = new Array(promiseFactories.length);
        const executing = [];
        for (const [index, factory] of promiseFactories.entries()) {
            const promise = factory()
                .then(result => {
                results[index] = result;
            })
                .finally(() => {
                executing.splice(executing.indexOf(promise), 1);
            });
            executing.push(promise);
            if (executing.length >= limit) {
                await Promise.race(executing);
            }
        }
        await Promise.all(executing);
        return results;
    };
    /**
     * Retry a promise with configurable delays
     * @param factory Function that returns a promise to retry (receives attempt number and previous error as parameters)
     * @param config Retry configuration
     * @param config.retry Number of retries (0 = no retry, 1 = retry once if failed, etc.)
     * @param config.delay.initialDelay Delay before first attempt (default: 0)
     * @param config.delay.retryDelay Delay between retry attempts (default: 0)
     * @param config.onRetry Callback called on each retry with error and attempt number
     * @returns Promise that resolves with the result or rejects after all retries
     * @example
     * // Retry up to 3 times with 1 second delay between attempts
     * await Promises.retry((attempt, error) => {
     *   if (error) console.log('Previous error:', error);
     *   return fetchData(attempt);
     * }, { retry: 3, delay: { retryDelay: 1000 } })
     */
    Promises.retry = async (factory, config) => {
        const initialDelay = config.delay?.initialDelay ?? 0;
        const retryDelay = config.delay?.retryDelay ?? 0;
        // Initial delay before first attempt
        if (initialDelay > 0) {
            await Promises.sleep(initialDelay);
        }
        let lastError;
        for (let attempt = 0; attempt <= config.retry; attempt++) {
            try {
                return await factory(attempt, lastError);
            }
            catch (error) {
                lastError = error;
                // Don't retry if this was the last attempt
                if (attempt === config.retry) {
                    break;
                }
                // Call onRetry callback if provided
                config.onRetry?.(error, attempt + 1);
                // Wait before retrying
                if (retryDelay > 0) {
                    await Promises.sleep(retryDelay);
                }
            }
        }
        // All retries failed, throw the last error
        throw lastError;
    };
    let Result;
    (function (Result) {
        async function awaitWrap(promise) {
            const data = typeof promise === 'function' ? wrap(promise) : wrap(promise);
            // try {
            try {
                await data;
            }
            catch (e) {
            }
            const rData = {
                status: data.status,
                isFulfilled: data.isFulfilled,
                isRejected: data.isRejected,
                isPending: data.isPending,
                value: data.value,
                reason: data.reason,
            };
            if (typeof promise === 'function') {
                rData.factory = () => {
                    return awaitWrap(promise);
                };
                return rData;
            }
            else {
                return rData;
            }
        }
        Result.awaitWrap = awaitWrap;
        function wrap(promise) {
            const promiseResult = (typeof promise === 'function' ? promise() : promise);
            if (typeof promise === 'function') {
                const p = promiseResult;
                p.factory = () => {
                    return wrap(promise);
                };
            }
            if (promiseResult.status === undefined) {
                const p = promiseResult;
                p.status = 'pending';
                p.isPending = true;
                p.isFulfilled = false;
                p.isRejected = false;
                p.then(result => {
                    console.log('result??', result);
                    const p = promiseResult;
                    p.status = 'fulfilled';
                    p.isFulfilled = true;
                    p.isRejected = false;
                    p.isPending = false;
                    p.value = result;
                }, reason => {
                    console.log('rejet??', reason);
                    const p = promiseResult;
                    p.status = 'rejected';
                    p.isFulfilled = false;
                    p.isRejected = true;
                    p.isPending = false;
                    p.reason = reason;
                });
            }
            return promiseResult;
        }
        Result.wrap = wrap;
    })(Result = Promises.Result || (Promises.Result = {}));
})(Promises || (Promises = {}));


/***/ }),

/***/ "../../packages/@dooboostore/core/src/random/RandomUtils.ts":
/*!******************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/random/RandomUtils.ts ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   RandomUtils: () => (/* binding */ RandomUtils)
/* harmony export */ });
/* harmony import */ var _valid_ValidUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../valid/ValidUtils */ "../../packages/@dooboostore/core/src/valid/ValidUtils.ts");

var RandomUtils;
(function (RandomUtils) {
    // export const readonly d = ''
    // export const getUniqueNumbers = (max: number, length: number) => {
    //   max = Math.max(max, 0);
    //   length = Math.max(Math.min(max, length), 0);
    //   const array: number[] = [];
    //   while (array.length < length) {
    //     const num = Math.floor(Math.random() * max);
    //     if (!array.includes(num)) array.push(num);
    //   }
    //   return array;
    // };
    RandomUtils.uniqueInts = (min, max, count) => {
        const result = [];
        if (count > max - min) {
            throw new Error('Count is greater than the range of unique integers');
        }
        while (result.length < count) {
            const randomInt = RandomUtils.int(min, max);
            if (!result.includes(randomInt)) {
                result.push(randomInt);
            }
        }
        return result;
    };
    RandomUtils.chance = (percentage) => {
        if (percentage < 0 || percentage > 1) {
            throw new Error('Percentage must be between 0 and 1');
        }
        return Math.random() < percentage;
    };
    // max  
    RandomUtils.int = (min, max) => {
        return Math.floor(RandomUtils.float(min, max));
    };
    // ex) 0,5   0~<5   <5  .   
    RandomUtils.float = (min, max) => {
        if (_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_0__.ValidUtils.isNullOrUndefined(min)) {
            return Math.random();
        }
        else if (!_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_0__.ValidUtils.isNullOrUndefined(min) && _valid_ValidUtils__WEBPACK_IMPORTED_MODULE_0__.ValidUtils.isNullOrUndefined(max)) {
            return Math.random() * (min || 0);
        }
        else {
            return Math.random() * ((max || 0) - (min || 0)) + (min || 0);
        }
    };
    RandomUtils.uuid = (format = 'xxxx-xxxx-xxxx-xxxx') => {
        return format.replace(/[xy]/g, function (c) {
            const r = Math.random() * 16 | 0;
            const v = c === 'x' ? r : (r & 0x3 | 0x8);
            return v.toString(16);
        });
    };
    RandomUtils.uuid4 = () => {
        // // return uuid of form xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx
        let uuid = '';
        let ii;
        for (ii = 0; ii < 32; ii += 1) {
            switch (ii) {
                case 8:
                case 20:
                    uuid += '-';
                    uuid += ((Math.random() * 16) | 0).toString(16);
                    break;
                case 12:
                    uuid += '-';
                    uuid += '4';
                    break;
                case 16:
                    uuid += '-';
                    uuid += ((Math.random() * 4) | 8).toString(16);
                    break;
                default:
                    uuid += ((Math.random() * 16) | 0).toString(16);
            }
        }
        return uuid;
    };
    RandomUtils.hex = () => {
        const letters = '0123456789ABCDEF'.split('');
        let hex = '';
        for (let i = 0; i < 6; i++) {
            hex += letters[Math.floor(Math.random() * 16)];
        }
        return hex;
    };
    RandomUtils.rgb = () => {
        const letters = '0123456789ABCDEF'.split('');
        let color = '#';
        for (let i = 0; i < 6; i++) {
            color += letters[Math.floor(Math.random() * 16)];
        }
        return color;
    };
    RandomUtils.rgba = () => {
        const letters = '0123456789ABCDEF'.split('');
        let color = '#';
        for (let i = 0; i < 8; i++) {
            color += letters[Math.floor(Math.random() * 16)];
        }
        return color;
    };
    // (Math.random().toString(36)+'00000000000000000').slice(2, 10) + Date.now()
    RandomUtils.alphabet = (len) => {
        const letters = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
        let color = '';
        for (let i = 0; i < len; i++) {
            color += letters[Math.floor(Math.random() * letters.length)];
        }
        return color;
    };
})(RandomUtils || (RandomUtils = {}));


/***/ }),

/***/ "../../packages/@dooboostore/core/src/reflect/ReflectUtils.ts":
/*!********************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/reflect/ReflectUtils.ts ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ReflectUtils: () => (/* binding */ ReflectUtils)
/* harmony export */ });
var ReflectUtils;
(function (ReflectUtils) {
    ReflectUtils.getParameterTypes = (target, propertyKey) => {
        // console.log('---------param')
        if (propertyKey) {
            return Reflect.getMetadata('design:paramtypes', target, propertyKey) || [];
        }
        else {
            return Reflect.getMetadata('design:paramtypes', target) || [];
        }
    };
    ReflectUtils.getReturnType = (target, propertyKey) => {
        return Reflect.getMetadata('design:returntype', target, propertyKey);
    };
    // @Reflect.metadata("design:type", Point)
    ReflectUtils.getType = (target, propertyKey) => {
        if (propertyKey) {
            return Reflect.getMetadata('design:type', target, propertyKey);
        }
        else {
            return Reflect.getMetadata('design:type', target);
        }
    };
    ReflectUtils.getMetadata = (metadataKey, target, propertyKey) => {
        if (propertyKey) {
            return Reflect.getMetadata(metadataKey, target, propertyKey);
        }
        else {
            return Reflect.getMetadata(metadataKey, target);
        }
    };
    ReflectUtils.getMetadataKeys = (target) => {
        return Reflect.getMetadataKeys(target);
    };
    ReflectUtils.getOwnMetadata = (metadataKey, target, propertyKey) => {
        if (propertyKey) {
            return Reflect.getOwnMetadata(metadataKey, target, propertyKey);
        }
        else {
            return Reflect.getOwnMetadata(metadataKey, target);
        }
    };
    ReflectUtils.getMetadatas = (target) => {
        return ReflectUtils.getMetadataKeys(target).map(it => ReflectUtils.getMetadata(it, target));
    };
    ReflectUtils.metadata = (metadataKey, data) => {
        return Reflect.metadata(metadataKey, data);
    };
    ReflectUtils.defineMetadata = (metadataKey, value, target, propertyKey) => {
        // console.log("Reflect:",Reflect)
        if (propertyKey && Reflect.defineMetadata) {
            Reflect.defineMetadata(metadataKey, value, target, propertyKey);
        }
        else if (Reflect.defineMetadata) {
            Reflect.defineMetadata(metadataKey, value, target);
            // Reflect.defineMetadata("design:paramtypes", value, target);
        }
        // console.log("Reflect:",Reflect.getMetadata(metadataKey, target))
        // console.log("Reflect:",Reflect.getMetadata('design:paramtypes', target))
    };
})(ReflectUtils || (ReflectUtils = {}));


/***/ }),

/***/ "../../packages/@dooboostore/core/src/string/StringUtils.ts":
/*!******************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/string/StringUtils.ts ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   StringUtils: () => (/* binding */ StringUtils)
/* harmony export */ });
/* harmony import */ var _valid_ValidUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../valid/ValidUtils */ "../../packages/@dooboostore/core/src/valid/ValidUtils.ts");

var StringUtils;
(function (StringUtils) {
    StringUtils.deleteEnter = (data) => {
        return data.replace(/\r?\n/g, '');
    };
    StringUtils.pickEmoji = (data) => {
        return data.match(/[\p{Emoji}]/gu) ?? [];
    };
    StringUtils.regexExec = (regex, text) => {
        let varExec = regex.exec(text);
        const usingVars = [];
        while (varExec) {
            usingVars.push(varExec);
            varExec = regex.exec(varExec.input);
        }
        return usingVars;
    };
    StringUtils.escapeSpecialCharacterRegExp = (data) => {
        return data.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    };
    StringUtils.trim = (data) => data.trim();
    StringUtils.rsubString = (data_s, blen_n) => data_s.substring(data_s.length - blen_n, data_s.length);
    StringUtils.lsubString = (data_s, alen_n) => data_s.substring(0, alen_n);
    StringUtils.lpad = (fill_s, len_n, full_s) => {
        while (len_n > full_s.length) {
            full_s = fill_s + full_s;
        }
        return StringUtils.rsubString(full_s, len_n);
    };
    StringUtils.rpad = (fill_s, len_n, full_s) => {
        while (len_n > full_s.length) {
            full_s += fill_s;
        }
        return StringUtils.lsubString(full_s, len_n);
    };
    StringUtils.lappend = (count_n, input_s) => {
        let s = '';
        let i = 0;
        while (i++ < count_n) {
            s += input_s;
        }
        return s;
    };
    StringUtils.unescape = (html) => {
        if (!html)
            return '';
        const htmlEntity = {
            quot: '"',
            amp: '&',
            apos: "'",
            lt: '<',
            gt: '>',
            nbsp: '\u00A0',
            iexcl: '',
            cent: '',
            pound: '',
            curren: '',
            yen: '',
            brvbar: '',
            sect: '',
            uml: '',
            copy: '',
            ordf: '',
            laquo: '',
            not: '',
            shy: '\u00AD',
            reg: '',
            macr: '',
            deg: '',
            plusmn: '',
            sup2: '',
            sup3: '',
            acute: '',
            micro: '',
            para: '',
            middot: '',
            cedil: '',
            sup1: '',
            ordm: '',
            raquo: '',
            frac14: '',
            frac12: '',
            frac34: '',
            iquest: '',
            '#x27': "'"
        };
        return html.replace(/&((?:(?:[a-z0-9]+|#[0-9]{1,6}|#x[0-9a-fA-F]{1,6});?)+);/gi, (match, entity) => {
            const entities = entity.toLowerCase().split(';');
            return entities.map(it => (it in htmlEntity ? htmlEntity[it] : match)).join('');
        });
    };
    StringUtils.executeExpression = (formatString, object) => {
        return formatString.replace(/\${([^{}]*)}/g, (matched, piece) => String(object[piece] ?? matched));
    };
    StringUtils.ellipsis = (text, length) => {
        if (text.length > length)
            return `${text.slice(0, length)}...`;
        return text;
    };
    /*
    const str = 'dr-class:set("MycLasS")'; //  'dr-class'
    const regex = /^([^\s:]+)(?::(\w+)\("([^"]+)"\))?$/;
    const match = str.match(regex);
    
    if (match) {
      const className = match[1]; // dr-class
      const functionName = match[2] || ''; // set  ''
      const argument = match[3] || ''; // MycLasS  ''
      console.log('Class Name:', className);
      console.log('Function Name:', functionName);
      console.log('Argument:', argument);
    } else {
      console.log('Invalid format');
    }
     */
    // type Postposition =
    /**
     * Appends a postposition to the given text based on the provided options.
     * @param {string} text - The text to append the postposition to.
     * @param {object} options - The options for postposition.
     * @param {string} options.vowel - The postposition to append if the text ends with a vowel().
     * @param {string} options.consonant - The postposition to append if the text ends with a consonant().
     * @returns {string} - The text with the appropriate postposition appended.
     */
    StringUtils.appendPostposition = (text, { vowel, consonant }) => {
        return `${text}${_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_0__.ValidUtils.lastConsonantLetter(text) ? consonant : vowel}`;
    };
    StringUtils.replaceSequentially = (text, replacements) => {
        let remainingText = text;
        let result = '';
        // console.log('Executing replaceSequentially with robust fix');
        while (remainingText.length > 0) {
            let bestMatch = null;
            // Find the earliest match in the remaining text
            for (const replacement of replacements) {
                const newRegex = new RegExp(replacement.regex);
                const match = newRegex.exec(remainingText);
                if (match) {
                    if (bestMatch === null || match.index < bestMatch.index) {
                        bestMatch = { index: match.index, match, replacement };
                    }
                }
            }
            if (bestMatch) {
                const { index, match, replacement } = bestMatch;
                const matchedString = match[0];
                // Append the text before the match and the replacement
                result += remainingText.substring(0, index);
                result += replacement.callback(matchedString);
                // Update remainingText to be the part after the match
                remainingText = remainingText.substring(index + matchedString.length);
            }
            else {
                // No more matches, append the rest of the text and finish
                result += remainingText;
                break;
            }
        }
        return result;
    };
})(StringUtils || (StringUtils = {}));


/***/ }),

/***/ "../../packages/@dooboostore/core/src/types.ts":
/*!*****************************************************!*\
  !*** ../../packages/@dooboostore/core/src/types.ts ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isDefined: () => (/* binding */ isDefined)
/* harmony export */ });
// export const isDefined = <T>(value: T | undefined | null): value is T => value !== undefined && value !== null;
// export const isDefined = <T>(value: T | undefined | null): value is NonNullable<T> => value !== undefined && value !== null;
const isDefined = (value) => value !== undefined && value !== null;


/***/ }),

/***/ "../../packages/@dooboostore/core/src/valid/ValidUtils.ts":
/*!****************************************************************!*\
  !*** ../../packages/@dooboostore/core/src/valid/ValidUtils.ts ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ValidUtils: () => (/* binding */ ValidUtils)
/* harmony export */ });
var ValidUtils;
(function (ValidUtils) {
    ValidUtils.isArrowFunction = (fn) => {
        // 1.   false
        if (typeof fn !== 'function') {
            return false;
        }
        // 2. prototype     ( prototype   callable)
        // 3.  'class'   
        return typeof fn.prototype === 'undefined' && !fn.toString().startsWith('class');
    };
    ValidUtils.isPlainObject = (obj) => {
        return obj !== null && typeof obj === 'object' && obj.constructor === Object;
    };
    const isConstructorLike = (fn) => {
        // 1.  ,
        // 2. prototype   
        return typeof fn === 'function' && typeof fn.prototype !== 'undefined';
    };
    ValidUtils.isUrl = (str) => {
        try {
            new URL(str);
            return true;
        }
        catch (_) {
            return false;
        }
    };
    ValidUtils.isFrozen = (obj) => {
        return Object.isFrozen(obj);
    };
    ValidUtils.isSealed = (obj) => {
        return Object.isSealed(obj);
    };
    ValidUtils.isFrozenOrSealed = (obj) => {
        return ValidUtils.isFrozen(obj) || ValidUtils.isSealed(obj);
    };
    ValidUtils.isFrozenAndSealed = (obj) => {
        return ValidUtils.isFrozen(obj) && ValidUtils.isSealed(obj);
    };
    ValidUtils.isNotFrozen = (obj) => {
        return !Object.isFrozen(obj);
    };
    ValidUtils.isNotSealed = (obj) => {
        return !Object.isSealed(obj);
    };
    ValidUtils.isNotFrozenOrSealed = (obj) => {
        return !ValidUtils.isFrozen(obj) && !ValidUtils.isSealed(obj);
    };
    ValidUtils.isNotFrozenAndSealed = (obj) => {
        return !ValidUtils.isFrozen(obj) || !ValidUtils.isSealed(obj);
    };
    ValidUtils.isNullOrUndefined = (data) => {
        return data == null || undefined === data;
    };
    ValidUtils.isConstructor = (obj) => {
        //  prototype   prototype  
        return typeof obj === 'function'
            && obj.prototype !== undefined
            && obj.prototype.constructor === obj;
        // && Object.getOwnPropertyNames(obj.prototype).length > 1; // constructor     
    };
    ValidUtils.isFunction = (obj) => {
        return typeof obj === 'function' && !ValidUtils.isConstructor(obj);
    };
    ValidUtils.isNullish = (data) => {
        return ValidUtils.isNotNullish(data);
    };
    ValidUtils.isNotNullish = (data) => {
        if ((Array.isArray(data) || ValidUtils.isString(data))) {
            return data.length > 0;
        }
        if (data instanceof Set || data instanceof Map) {
            return data.size > 0;
        }
        if (typeof data === 'object' && data !== null) {
            return Object.keys(data).length > 0;
        }
        return data !== null && data !== undefined;
    };
    ValidUtils.isNotNullUndefined = (data) => {
        return data !== null && data !== undefined;
    };
    ValidUtils.isNull = (data) => {
        return data === null;
    };
    ValidUtils.isUndefined = (data) => {
        return data === undefined;
    };
    ValidUtils.isArray = (object_o) => {
        if (ValidUtils.isNullOrUndefined(object_o)) {
            return false;
        }
        else {
            return Object.prototype.toString.call(object_o).trim() === '[object Array]';
        }
    };
    ValidUtils.isStringNumber = (value) => {
        if (typeof value === 'number') {
            return !isNaN(value);
        }
        return typeof value === 'string' && value.trim() !== '' && !isNaN(Number(value));
    };
    ValidUtils.isNumber = (object_o) => {
        if (ValidUtils.isNullOrUndefined(object_o)) {
            return false;
        }
        else {
            return Object.prototype.toString.call(object_o).trim() === '[object Number]';
        }
    };
    ValidUtils.isIterator = (object_o) => {
        return object_o != null && typeof object_o[Symbol.iterator] === 'function';
    };
    ValidUtils.isString = (object_o) => {
        if (ValidUtils.isNullOrUndefined(object_o)) {
            return false;
        }
        else {
            return Object.prototype.toString.call(object_o).trim() === '[object String]';
        }
    };
    // export const isFunction = (object_o: any): boolean => {
    //   if (ValidUtils.isNullOrUndefined(object_o)) {
    //     return false
    //   } else {
    //     return Object.prototype.toString.call(object_o).trim() === '[object Function]'
    //   }
    //   // if (typeof object_o === 'function') {
    //   //     return true;
    //   // }else {
    //   //     return false;
    //   // }
    // }
    ValidUtils.isObject = (object_o) => {
        if (ValidUtils.isNullOrUndefined(object_o)) {
            return false;
        }
        else {
            return Object.prototype.toString.call(object_o).trim() === '[object Object]';
        }
    };
    ValidUtils.isMap = (object_o) => {
        if (ValidUtils.isNullOrUndefined(object_o)) {
            return false;
        }
        else {
            return Object.prototype.toString.call(object_o).trim() === '[object Map]';
        }
    };
    ValidUtils.isEmpty = (object_o) => {
        if (ValidUtils.isNullOrUndefined(object_o)) {
            return true;
        }
        else if (ValidUtils.isArray(object_o)) {
            return object_o.length === 0;
        }
        else if (ValidUtils.isString(object_o)) {
            return object_o.trim().length === 0;
        }
        else if (ValidUtils.isMap(object_o)) {
            return object_o.size === 0;
        }
        else if (ValidUtils.isObject(object_o)) {
            return Object.keys(object_o).length === 0;
        }
        else {
            return false;
        }
    };
    ValidUtils.isSet = (data) => {
        return data instanceof Set;
    };
    ValidUtils.isNullishFiltered = (value) => {
        if (Array.isArray(value)) {
            return value.every(it => it !== undefined && it !== null);
        }
        return value !== undefined && value !== null;
    };
    ValidUtils.isFalsyFiltered = (value) => {
        if (Array.isArray(value)) {
            return value.every(it => {
                return it;
            });
        }
        return !!value;
    };
    ValidUtils.includeValue = (obj, value) => {
        return Object.values(obj).includes(value);
    };
    ValidUtils.includeKey = (obj, key) => {
        return Object.keys(obj).includes(key);
    };
    /**     */
    ValidUtils.lastConsonantLetter = (value) => {
        const lastLetter = value.charCodeAt(value.length - 1);
        return (lastLetter - 0xac00) % 28 > 0;
    };
    ValidUtils.inRange = (value, min, max) => {
        return min <= value && value <= max;
    };
    ValidUtils.isBase64 = (inputString) => {
        // data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAA
        // const isValidBase64 = /^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/;
        // return isValidBase64.test(base64String);
        let base64Data = inputString;
        // Data URL   (: "data:image/png;base64,")
        const parts = inputString.split(';base64,');
        if (parts.length > 1) {
            base64Data = parts[1];
        }
        else {
            // "data:"  ";base64,"    ( base64   )
            if (inputString.startsWith('data:')) {
                //    base64    
                //   base64    false 
                // return false;
                //        
                const commaIndex = inputString.indexOf(',');
                if (commaIndex > -1) {
                    base64Data = inputString.substring(commaIndex + 1);
                }
                else {
                    //  base64   
                    // return false;
                }
            }
        }
        // Base64   
        // -   4   ( )
        // -  '='  2     
        // -  1 ,    [A-Za-z0-9+/]
        // -  2 ,     [A-Za-z0-9+/]
        //     :
        const base64Regex = /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/;
        // ,  base64     4  .
        //        ,     .
        //          .
        // (([A-Za-z0-9+/]{4})*   )
        if (base64Data === '' || base64Data.length % 4 !== 0) {
            //  ,  4   ()  base64 .
            // (,     base64 ,    )
            //        4      
            // : "QQ" ( 2) -> false, "QQQ" ( 3) -> false
            // "QQ==" ( 4) -> true, "QQQ=" ( 4) -> true
            // "QQQ" `base64Regex.test("QQQ")` false, `Buffer.from("QQQ", "base64").toString("base64")` "QQ==" .
            //            ,     .
        }
        return base64Regex.test(base64Data);
    };
})(ValidUtils || (ValidUtils = {}));


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/DomRender.ts":
/*!***************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/DomRender.ts ***!
  \***************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DomRender: () => (/* binding */ DomRender)
/* harmony export */ });
/* harmony import */ var _DomRenderProxy__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./DomRenderProxy */ "../../packages/@dooboostore/dom-render/src/DomRenderProxy.ts");
/* harmony import */ var _routers_PathRouter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./routers/PathRouter */ "../../packages/@dooboostore/dom-render/src/routers/PathRouter.ts");
/* harmony import */ var _routers_HashRouter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./routers/HashRouter */ "../../packages/@dooboostore/dom-render/src/routers/HashRouter.ts");
/* harmony import */ var _types_Types__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./types/Types */ "../../packages/@dooboostore/dom-render/src/types/Types.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _messenger_DefaultMessenger__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./messenger/DefaultMessenger */ "../../packages/@dooboostore/dom-render/src/messenger/DefaultMessenger.ts");
/* harmony import */ var _components__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./components */ "../../packages/@dooboostore/dom-render/src/components/index.ts");
/* harmony import */ var _events_EventManager__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./events/EventManager */ "../../packages/@dooboostore/dom-render/src/events/EventManager.ts");
/* harmony import */ var _dooboostore_core_random_RandomUtils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @dooboostore/core/random/RandomUtils */ "../../packages/@dooboostore/core/src/random/RandomUtils.ts");









let eventManager = null;
class DomRender {
    _config;
    _target;
    _rootObject;
    _router;
    _eventManager;
    constructor(parameter, executeConfig) {
        const s = DomRender.runSet(parameter, executeConfig);
        this._config = s.config;
        this._target = s.target;
        this._rootObject = s.rootObject;
        this._router = s.config.router;
        this._eventManager = s.config.eventManager;
        // if (executeConfig && executeConfig?.autoGo) {
        //   this._config.router?.go(executeConfig.autoGo);
        // }
    }
    get rootObject() {
        return this._rootObject;
    }
    get config() {
        return this._config;
    }
    get router() {
        return this._router;
    }
    get eventManager() {
        return this._eventManager;
    }
    get target() {
        return this._target;
    }
    static run(data) {
        return DomRender.runSet(data).rootObject;
    }
    static runSet({ rootObject, target, config }, executeConfig) {
        // public static run<T extends object>({rootObject, target, config}: DomRenderRunParameter<T>): T {
        //   console.log('runSet')
        rootObject = typeof rootObject === 'function' ? rootObject() : rootObject;
        let targetObject = rootObject;
        if ('_DomRender_isProxy' in rootObject) {
            if (target) {
                rootObject._DomRender_proxy.initRender(target);
            }
            targetObject = rootObject;
            // return targetObject;
            return { rootObject: targetObject, target, config: rootObject._domRender_config };
        }
        const targetConfig = Object.assign({}, config);
        eventManager ??= new _events_EventManager__WEBPACK_IMPORTED_MODULE_7__.EventManager(targetConfig.window);
        targetConfig.uuid = _dooboostore_core_random_RandomUtils__WEBPACK_IMPORTED_MODULE_8__.RandomUtils.uuid4();
        targetConfig.messenger = _types_Types__WEBPACK_IMPORTED_MODULE_3__.DomRenderFinalProxy.final(targetConfig.messenger ?? new _messenger_DefaultMessenger__WEBPACK_IMPORTED_MODULE_5__.DefaultMessenger(targetConfig));
        targetConfig.proxyExcludeTyps = targetConfig.proxyExcludeTyps ?? [];
        targetConfig.targetElements ??= [];
        if (typeof Window !== 'undefined' && !targetConfig.proxyExcludeTyps.some(it => it === Window)) {
            targetConfig.proxyExcludeTyps.push(Window);
        }
        if (typeof Map !== 'undefined' && !targetConfig.proxyExcludeTyps.some(it => it === Map)) {
            targetConfig.proxyExcludeTyps.push(Map);
        }
        if (typeof Set !== 'undefined' && !targetConfig.proxyExcludeTyps.some(it => it === Set)) {
            targetConfig.proxyExcludeTyps.push(Set);
        }
        if (typeof Promise !== 'undefined' && !targetConfig.proxyExcludeTyps.some(it => it === Promise)) {
            targetConfig.proxyExcludeTyps.push(Promise);
        }
        if (typeof ResizeObserver !== 'undefined' && !targetConfig.proxyExcludeTyps.some(it => it === ResizeObserver)) {
            targetConfig.proxyExcludeTyps.push(ResizeObserver);
        }
        if (typeof ImageBitmap !== 'undefined' && !targetConfig.proxyExcludeTyps.some(it => it === ImageBitmap)) {
            targetConfig.proxyExcludeTyps.push(ImageBitmap);
        }
        if (typeof CanvasRenderingContext2D !== 'undefined' && !targetConfig.proxyExcludeTyps.some(it => it === CanvasRenderingContext2D)) {
            targetConfig.proxyExcludeTyps.push(CanvasRenderingContext2D);
        }
        if (typeof CSSStyleDeclaration !== 'undefined' && !targetConfig.proxyExcludeTyps.some(it => it === CSSStyleDeclaration)) {
            targetConfig.proxyExcludeTyps.push(CSSStyleDeclaration);
        }
        if (typeof Date !== 'undefined' && !targetConfig.proxyExcludeTyps.some(it => it === Date)) {
            targetConfig.proxyExcludeTyps.push(Date);
        }
        if (typeof MutationObserver !== 'undefined' && !targetConfig.proxyExcludeTyps.some(it => it === IntersectionObserver)) {
            targetConfig.proxyExcludeTyps.push(IntersectionObserver);
        }
        if (typeof IntersectionObserver !== 'undefined' && !targetConfig.proxyExcludeTyps.some(it => it === IntersectionObserver)) {
            targetConfig.proxyExcludeTyps.push(IntersectionObserver);
        }
        if (typeof HTMLElement !== 'undefined' && !targetConfig.proxyExcludeTyps.some(it => it === HTMLElement)) {
            targetConfig.proxyExcludeTyps.push(HTMLElement);
        }
        // if (typeof HTMLCanvasElement !== 'undefined' && !targetConfig.proxyExcludeTyps.some(it => it === HTMLCanvasElement)) {
        //   targetConfig.proxyExcludeTyps.push(HTMLCanvasElement);
        // }
        if (!targetConfig.proxyExcludeTyps.some(it => it === _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_4__.RawSet)) {
            targetConfig.proxyExcludeTyps.push(_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_4__.RawSet);
        }
        if (!targetConfig.proxyExcludeTyps.some(it => it === DomRender)) {
            targetConfig.proxyExcludeTyps.push(DomRender);
        }
        targetConfig.rootElement = target;
        targetConfig.eventManager = eventManager;
        // (targetConfig.window as any).domRender ??= {configs: []};
        // (targetConfig.window as any).domRender.configs.push(targetConfig);
        const domRender = new _DomRenderProxy__WEBPACK_IMPORTED_MODULE_0__.DomRenderProxy(rootObject, target, targetConfig);
        const dest = new Proxy(rootObject, domRender);
        targetObject = dest;
        targetConfig.root = targetObject;
        // proxy  targetObject   router 
        if (!targetConfig.router) {
            let targetRouter;
            if ('routerType' in config && config?.routerType === 'hash') {
                targetRouter = new _routers_HashRouter__WEBPACK_IMPORTED_MODULE_2__.HashRouter({ rootObject: targetObject, window: targetConfig.window, firstUrl: executeConfig?.firstUrl });
            }
            else if ('routerType' in config && config?.routerType === 'path') {
                targetRouter = new _routers_PathRouter__WEBPACK_IMPORTED_MODULE_1__.PathRouter({ rootObject: targetObject, window: targetConfig.window, firstUrl: executeConfig?.firstUrl });
            }
            else if ('routerType' in config && typeof config?.routerType === 'function') {
                targetRouter = config.routerType(targetObject, targetConfig);
            }
            else if ('routerType' in config && typeof config?.routerType === 'object') {
                targetRouter = config.routerType;
            }
            targetConfig.router = targetRouter;
        }
        for (const value of Object.values(_components__WEBPACK_IMPORTED_MODULE_6__.drComponent)) {
            const a = value(targetConfig, DomRender);
            if (!targetConfig.targetElements.some(it => it.name === a.name)) {
                targetConfig.targetElements.push(a);
            }
        }
        // console.log('cccccccccccccccccc', targetRouter)
        // targetRouter.go({path: targetRouter.getUrl()})
        // if (!config.router) {
        //   if (config.routerType === 'path') {
        //     config.router = new PathRouter(targetObject, config.window);
        //   } else if (config.routerType === 'hash') {
        //     config.router = new HashRouter(targetObject, config.window);
        //   } else { // none
        //     config.router = new HashRouter(targetObject, config.window);
        //   }
        // }
        domRender.run(targetObject);
        return { rootObject: targetObject, config: targetConfig, target };
        // return targetObject;
    }
    static createComponent(param) {
        // console.log('===>', typeof param.type, param.type.name, param.type.constructor.name)
        const component = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_4__.RawSet.createComponentTargetElement({
            name: param.tagName ?? (typeof param.type === 'function' ? param.type.name : param.type.constructor.name),
            objFactory: (e, o, r2, counstructorParam) => {
                return typeof param.type === 'function' ? new param.type(...counstructorParam) : param.type;
            },
            noStrip: param.noStrip,
            template: param.template ?? '',
            styles: Array.isArray(param.styles) ? param.styles : param.styles ? [param.styles] : undefined
        });
        return component;
    }
    // ??  ?? ..
    static createAttribute(attrName, getThisObj, factory) {
        const targetAttribute = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_4__.RawSet.createComponentTargetAttribute(attrName, getThisObj, factory);
        return targetAttribute;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/DomRenderProxy.ts":
/*!********************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/DomRenderProxy.ts ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DomRenderProxy: () => (/* binding */ DomRenderProxy),
/* harmony export */   getDomRenderConfig: () => (/* binding */ getDomRenderConfig),
/* harmony export */   getDomRenderOriginObject: () => (/* binding */ getDomRenderOriginObject),
/* harmony export */   getDomRenderProxy: () => (/* binding */ getDomRenderProxy),
/* harmony export */   isWrapProxyDomRenderProxy: () => (/* binding */ isWrapProxyDomRenderProxy)
/* harmony export */ });
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _events_EventManager__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./events/EventManager */ "../../packages/@dooboostore/dom-render/src/events/EventManager.ts");
/* harmony import */ var _types_Types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./types/Types */ "../../packages/@dooboostore/dom-render/src/types/Types.ts");
/* harmony import */ var _rawsets_RawSetType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./rawsets/RawSetType */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSetType.ts");
/* harmony import */ var _operators_DrThisProperty__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./operators/DrThisProperty */ "../../packages/@dooboostore/dom-render/src/operators/DrThisProperty.ts");
/* harmony import */ var _rawsets_RawSetOperatorType__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./rawsets/RawSetOperatorType */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSetOperatorType.ts");
/* harmony import */ var _components_ComponentSet__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./components/ComponentSet */ "../../packages/@dooboostore/dom-render/src/components/ComponentSet.ts");
/* harmony import */ var _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./decorators/DomRenderNoProxy */ "../../packages/@dooboostore/dom-render/src/decorators/DomRenderNoProxy.ts");
/* harmony import */ var _lifecycle_OnCreateRender__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./lifecycle/OnCreateRender */ "../../packages/@dooboostore/dom-render/src/lifecycle/OnCreateRender.ts");
/* harmony import */ var _lifecycle_OnInitRender__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./lifecycle/OnInitRender */ "../../packages/@dooboostore/dom-render/src/lifecycle/OnInitRender.ts");
/* harmony import */ var _lifecycle_OnCreateRenderData__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./lifecycle/OnCreateRenderData */ "../../packages/@dooboostore/dom-render/src/lifecycle/OnCreateRenderData.ts");
/* harmony import */ var _lifecycle_OnChangeAttrRender__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./lifecycle/OnChangeAttrRender */ "../../packages/@dooboostore/dom-render/src/lifecycle/OnChangeAttrRender.ts");
/* harmony import */ var _dooboostore_core_web_document_DocumentUtils__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @dooboostore/core-web/document/DocumentUtils */ "../../packages/@dooboostore/core-web/src/document/DocumentUtils.ts");
/* harmony import */ var _dooboostore_core_types__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @dooboostore/core/types */ "../../packages/@dooboostore/core/src/types.ts");
/* harmony import */ var _lifecycle_OnBeforeReturnSet__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./lifecycle/OnBeforeReturnSet */ "../../packages/@dooboostore/dom-render/src/lifecycle/OnBeforeReturnSet.ts");
/* harmony import */ var _lifecycle_OnChildRenderedByProperty__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./lifecycle/OnChildRenderedByProperty */ "../../packages/@dooboostore/dom-render/src/lifecycle/OnChildRenderedByProperty.ts");
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");
/* harmony import */ var _dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @dooboostore/core/valid/ValidUtils */ "../../packages/@dooboostore/core/src/valid/ValidUtils.ts");
/* harmony import */ var _lifecycle_OnProxyDomRender__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./lifecycle/OnProxyDomRender */ "../../packages/@dooboostore/dom-render/src/lifecycle/OnProxyDomRender.ts");
/* harmony import */ var _lifecycle_OnRawSetRendered__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./lifecycle/OnRawSetRendered */ "../../packages/@dooboostore/dom-render/src/lifecycle/OnRawSetRendered.ts");
/* harmony import */ var _lifecycle_OnChildRawSetRendered__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./lifecycle/OnChildRawSetRendered */ "../../packages/@dooboostore/dom-render/src/lifecycle/OnChildRawSetRendered.ts");
/* harmony import */ var _rawsets__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./rawsets */ "../../packages/@dooboostore/dom-render/src/rawsets/index.ts");






















const excludeGetSetPropertys = [
    // '__domrender_components',
    _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderComponentMetaKey.DOMRENDER_COMPONENTS_KEY,
    _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey.onBeforeReturnGet,
    _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey.onBeforeReturnSet,
    _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey.__render,
    _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey._rawSets,
    _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey._targets,
    _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey._domRender_proxy,
    _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey._DomRender_isFinal,
    _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey._domRender_ref,
    _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey._DomRender_origin,
    _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey._DomRender_ref,
    _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey._DomRender_proxy
];
const isWrapProxyDomRenderProxy = (obj) => {
    return obj && typeof obj === 'object' && '_DomRender_isProxy' in obj;
};
const getDomRenderOriginObject = (obj) => {
    if (isWrapProxyDomRenderProxy(obj)) {
        return obj._domRender_origin;
    }
    return obj;
};
const getDomRenderConfig = (obj) => {
    if (isWrapProxyDomRenderProxy(obj)) {
        return obj._domRender_config;
    }
    return undefined;
};
//@ts-ignore
const getDomRenderProxy = (obj) => {
    if (isWrapProxyDomRenderProxy(obj)) {
        //@ts-ignore
        return obj._domRender_proxy;
    }
    return undefined;
};
class DomRenderProxy {
    _domRender_origin;
    _domRender_config;
    _domRender_ref = new Map();
    _rawSets = new Map();
    _domRender_proxy;
    _targets = new Set();
    // public name = Math.random();
    constructor(_domRender_origin, target, _domRender_config) {
        this._domRender_origin = _domRender_origin;
        this._domRender_config = _domRender_config;
        if (target) {
            this._targets.add(target);
            // this._firstTarget = target;
        }
        // setInterval(() => {
        //   this._rawSets.forEach(it => {
        //     Array.from(it).forEach(it => {
        //       console.log(it, it.isConnected)
        //     })
        //   });
        // }, 1000)
    }
    static unFinal(obj) {
        return _types_Types__WEBPACK_IMPORTED_MODULE_2__.DomRenderFinalProxy.unFinal(obj);
    }
    static final(obj) {
        return _types_Types__WEBPACK_IMPORTED_MODULE_2__.DomRenderFinalProxy.final(obj);
    }
    static isFinal(obj) {
        return _dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_17__.ValidUtils.isNull(obj) || _types_Types__WEBPACK_IMPORTED_MODULE_2__.DomRenderFinalProxy.isFinal(obj);
    }
    async run(objProxy) {
        this._domRender_proxy = objProxy;
        if ((0,_lifecycle_OnProxyDomRender__WEBPACK_IMPORTED_MODULE_18__.isOnProxyDomRender)(objProxy)) {
            objProxy.onProxyDomRender(this._domRender_config);
        }
        const obj = getDomRenderOriginObject(objProxy);
        if (obj) {
            Object.keys(obj).forEach(it => {
                // Reflect  domRender:NoProxy  
                try {
                    const isNoProxy = Reflect.getMetadata(_decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_7__.DomRenderNoProxyKey, obj, it) ||
                        Reflect.getMetadata(_decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_7__.DomRenderNoProxyKey, Object.getPrototypeOf(obj).constructor);
                    if (isNoProxy) {
                        return obj;
                    }
                }
                catch (e) { }
                const target = obj[it];
                if (target !== undefined &&
                    target !== null &&
                    typeof target === 'object' &&
                    !DomRenderProxy.isFinal(target) &&
                    !Object.isFrozen(target) &&
                    !(obj instanceof _types_Types__WEBPACK_IMPORTED_MODULE_2__.Shield)) {
                    const isExcluded = this._domRender_config.proxyExcludeTyps?.some(it => target instanceof it) ?? false;
                    // const filter = this._domRender_config.proxyExcludeTyps?.filter(it => target instanceof it) ?? [];
                    if (!isExcluded) {
                        const proxyAfter = this.proxy(objProxy, target, it);
                        obj[it] = proxyAfter;
                    }
                }
            });
        }
        // console.log('target', this._targets);
        for (let target of this._targets) {
            await this.initRender(target);
        }
    }
    async initRender(target, rawSet) {
        // if (target instanceof Element) {
        //   target.setAttribute('dr-this', 'this');
        //   const rawSets = RawSet.checkPointCreates(target, this._domRender_proxy, this.config);
        //   this.render(rawSets)
        //   return;
        // }
        //
        if (target instanceof Element) {
            // :      TargetElement    .    .
            // const targetElementNames = (this.config.targetElements?.map(it => it.name.toLowerCase().replaceAll('.', '\\.')) ?? []).join(',');
            // Array.from(target.querySelectorAll(targetElementNames)).forEach(it => it.setAttribute(EventManager.parentVariablePathAttrName, '@this@'));
            target.innerHTML = target.innerHTML.replace(/@this@/g, 'this');
        }
        // TODO:   ..   .
        const onCreate = target.getAttribute?.(_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_0__.RawSet.DR_ON_CREATE_ARGUMENTS_OPTIONNAME);
        let createParam = [];
        if (onCreate) {
            createParam = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_16__.ObjectUtils.Script.evaluateReturn(onCreate, this._domRender_proxy);
            if (!Array.isArray(createParam)) {
                createParam = [createParam];
            }
        }
        if ((0,_lifecycle_OnCreateRenderData__WEBPACK_IMPORTED_MODULE_10__.isOnCreateRenderData)(this._domRender_proxy)) {
            this._domRender_proxy?.onCreateRenderData({ rootParent: this._domRender_proxy });
        }
        if ((0,_lifecycle_OnCreateRender__WEBPACK_IMPORTED_MODULE_8__.isOnCreateRender)(this._domRender_proxy)) {
            this._domRender_proxy.onCreateRender(...createParam);
        }
        // const innerHTML = (target as any).innerHTML ?? '';
        this._targets.add(target);
        const rawSets = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_0__.RawSet.checkPointCreates(target, this._domRender_proxy, this._domRender_config);
        // console.log('initRender -------rawSet', rawSets)
        //    .
        this._domRender_config.eventManager.applyEvent(this._domRender_proxy, this._domRender_config.eventManager.findAttrElements(target, this._domRender_config), this._domRender_config);
        rawSets.forEach(it => {
            const variables = it.getUsingTriggerVariables(this._domRender_config);
            if (variables.size <= 0) {
                this.addRawSet('', it);
            }
            else {
                variables.forEach(sit => {
                    this.addRawSet(sit, it);
                });
            }
        });
        const targetRawSets = await this.render(this.getRawSets());
        for (let targetRawSet of targetRawSets) {
            let initParam;
            if (onCreate) {
                initParam = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_16__.ObjectUtils.Script.evaluateReturn(onCreate, this._domRender_proxy);
            }
            if ((0,_lifecycle_OnInitRender__WEBPACK_IMPORTED_MODULE_9__.isOnInitRender)(this._domRender_proxy)) {
                await this._domRender_proxy.onInitRender(initParam, rawSet ?? { dataSet: { config: this._domRender_config } });
            }
        }
    }
    getRawSets() {
        const set = new Set();
        this._rawSets.forEach((v, k) => {
            v.forEach(it => set.add(it));
        });
        return Array.from(set);
    }
    //  important
    async render(raws, fullPathStr) {
        if (typeof raws === 'string') {
            const iter = this._rawSets.get(raws);
            if (iter) {
                raws = Array.from(iter);
            }
            else {
                raws = undefined;
            }
        }
        const removeRawSets = [];
        const rawSets = raws ?? this.getRawSets();
        // console.log('Total RawSets to render:', Array.isArray(rawSets) ? rawSets.length : 0);
        // console.log('----', rawSets);
        // console.log('----', rawSets);
        const CHUNK_SIZE = 50;
        const chunks = [];
        let rawSetsArray = Array.from(rawSets);
        // console.log('--->1', JSON.stringify(rawSetsArray.map(it=>it.type)));
        // rawSetsArray = rawSetsArray.sort((a, b) => {
        //   const order = { [RawSetType.TARGET_ELEMENT]: 0, [RawSetType.TARGET_ATTR]: 1, [RawSetType.TEXT]: 2 };
        //   return (order[a.type] ?? 999) - (order[b.type] ?? 999);
        // });
        // console.log('--->2', JSON.stringify(rawSetsArray.map(it=>it.type)));
        // await Promise.all(rawSetsArray.map(rawSet => this.renderExecute(rawSet, fullPathStr, removeRawSets)));
        for (const rawSet of rawSetsArray) {
            await this.renderExecute(rawSet, fullPathStr, removeRawSets);
        }
        // .... .. .....    ....
        // const firstRawSet = rawSetsArray.shift();
        //     await Promises.sleep(0);    dr-for-of     rawSet isConnect false 
        //    .      await       .
        //    path        .
        //  renderExecute    sleep ..     ..   .
        // if (firstRawSet) {
        //   await this.renderExecute(firstRawSet, fullPathStr, removeRawSets);
        // }
        // for (let i = 0; i < rawSetsArray.length; i += (CHUNK_SIZE)) {
        //   chunks.push(rawSetsArray.slice(i, i + CHUNK_SIZE));
        // }
        //
        // for (const chunk of chunks) {
        //   const promises = chunk.map(async (it, index) => {
        //     await this.renderExecute(it, fullPathStr, removeRawSets);
        //     // console.log('----', it);
        //   });
        //   // console.log('.!')
        //   await Promise.all(promises);
        //   if (chunks.length > 1) {
        //     await new Promise(resolve => requestAnimationFrame(resolve));
        //   }
        // }
        if ((0,_lifecycle_OnChildRawSetRendered__WEBPACK_IMPORTED_MODULE_20__.isOnChildRawSetRendered)(this._domRender_proxy)) {
            await this._domRender_proxy.onChildRawSetRendered();
        }
        if (removeRawSets.length > 0) {
            this.removeRawSet(...removeRawSets);
        }
        return this.getRawSets();
    }
    async renderExecute(it, fullPathStr, removeRawSets) {
        // console.log('?')
        // await Promises.sleep(0);
        it.getUsingTriggerVariables(this._domRender_config).forEach(path => {
            // console.log('getUsingTriggerVariables->', path);
            this.addRawSet(path, it);
        });
        let renderResult;
        // console.log('isConnected?', it, it.isConnected);
        if (it.isConnected) {
            //  render targetAttribute  .
            const targetAttrMap = it.point.node?.getAttribute?.(_events_EventManager__WEBPACK_IMPORTED_MODULE_1__.EventManager.normalAttrMapAttrName);
            // console.log('sssssssssSSS?',it, targetAttrMap)
            // console.log('----2', it, fullPathStr, targetAttrMap, (it.fragment as any).render, it.isConnected, this.getRawSets());
            if (it.detect?.action) {
                it.detect.action();
                // } else if (it.type === RawSetType.TARGET_ELEMENT && it.data && fullPathStr && targetAttrMap && (it.fragment as any).render) {
            }
            else if (it.type === _rawsets_RawSetType__WEBPACK_IMPORTED_MODULE_3__.RawSetType.TARGET_ELEMENT &&
                it.dataSet?.render?.currentThis &&
                fullPathStr &&
                targetAttrMap) {
                const attrStart = performance.now();
                new Map(JSON.parse(targetAttrMap)).forEach((v, k) => {
                    // it?.data.onChangeAttrRender(k, null, v);
                    // console.log('------->?',v,k);
                    const isUsing = v.variablePaths.some(it => _events_EventManager__WEBPACK_IMPORTED_MODULE_1__.EventManager.isUsingThisVar(it.inner, `this.${fullPathStr}`));
                    // console.log('------->?',v,k, isUsing);
                    if (isUsing) {
                        const targetAttrObject = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_0__.RawSet.getAttributeObject(it.point.node, {
                            script: it.dataSet?.render?.renderScript ?? '',
                            obj: Object.assign(this._domRender_proxy ?? {}, { __render: it.dataSet?.render })
                        });
                        it.dataSet.render ??= {};
                        it.dataSet.render.attribute = targetAttrObject;
                        // const render = it.dataSet?.render;
                        // console.log('render-->!!!!!', it.dataSet.render);
                        // const script = `${render.renderScript} return ${v} `;
                        // const cval = ScriptUtils.eval(script, Object.assign(this._domRender_proxy ?? {}, { __render: render }));
                        if ((0,_lifecycle_OnChangeAttrRender__WEBPACK_IMPORTED_MODULE_11__.isOnChangeAttrRender)(it.dataSet?.render?.currentThis)) {
                            it.dataSet?.render?.currentThis?.onChangeAttrRender?.(k, targetAttrObject[k], { rawSet: it });
                        }
                    }
                    // console.log('---?', v, fullPathStr, isUsing);
                });
                const attrEnd = performance.now();
                // if (attrEnd - attrStart > 10) {
                // console.log('Slow Attr Update:', attrEnd - attrStart, it);
                // }
                // ------------------->
            }
            else {
                const renderStart = performance.now();
                const rawSets = await it.render(this._domRender_proxy, this._domRender_config);
                // console.log('!!!!!!!!!', rawSets)
                const renderEnd = performance.now();
                // if (renderEnd - renderStart > 10) {
                //   console.log('Slow RawSet Render:', renderEnd - renderStart, it);
                // }
                renderResult = rawSets;
                //   render
                if (rawSets && rawSets.raws.length > 0) {
                    await this.render(rawSets.raws);
                }
            }
        }
        else {
            removeRawSets.push(it);
        }
        const t = it.findNearThis(this._domRender_proxy);
        // TODO:        .
        if ((0,_lifecycle_OnRawSetRendered__WEBPACK_IMPORTED_MODULE_19__.isOnRawSetRendered)(t)) {
            await t.onRawSetRendered(it, { path: fullPathStr, value: _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_16__.ObjectUtils.Script.evaluateReturn(`this.${fullPathStr}`, this._domRender_proxy), root: this._domRender_proxy, renderResult });
        }
    }
    // domrender_ref  
    // public findRootDomRenderProxy(): DomRenderProxy<any> {
    //   let current:DomRenderProxy<any>  = this;
    //   while (current.parentProxy) {
    //     current = current.parentProxy;
    //   }
    //   return current;
    // }
    root(pathInfos, value, lastDoneExecute = true) {
        // console.time('root_total');
        const rootStartTime = Date.now();
        const pathKey = pathInfos.flat().map(i => i.path).join('.');
        // console.group(` DomRenderProxy root: ${pathKey}`);
        // console.log('root--->', pathInfos, value, this._domRender_ref, this._domRender_origin);
        const fullPaths = [];
        if (this._domRender_ref.size > 0) {
            this._domRender_ref.forEach((it, key) => {
                if (_rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey._DomRender_isProxy in key) {
                    it.forEach(sit => {
                        try {
                            const recursiveStartTime = Date.now();
                            const concat = pathInfos.concat([[{ path: sit, obj: key }]]);
                            const items = key._DomRender_proxy?.root(concat, value, lastDoneExecute);
                            // console.log(` Recursive root call for ${sit}: ${Date.now() - recursiveStartTime}ms`);
                            fullPaths.push(items.flat());
                            // fullPaths.push({path: items.map(it=>it.path).join(','), obj: this._domRender_proxy});
                            // fullPaths.push({path: items.map(it=>it.path).join(','), obj: this._domRender_proxy});
                        }
                        catch (e) {
                            //   Destroy  .    .
                            // console.error(e)
                            // it.delete(sit);
                        }
                    });
                }
            });
        }
        else {
            // console.time('root_recursive');
            const pathProcessStartTime = Date.now();
            // const firstPathStr = paths.slice(1).reverse().join('.');
            const shortPaths = pathInfos.reverse().map(it => it.map(it => it.path).join(','));
            // array        .
            const fullPathStr = shortPaths
                .map(it => (isNaN(Number(it)) ? '.' + it : `[${it}]`))
                .join('')
                .slice(1);
            // console.log(` Path processing time: ${Date.now() - pathProcessStartTime}ms for path: ${fullPathStr}`, lastDoneExecute);
            if (lastDoneExecute) {
                // const firstData = ScriptUtils.evalReturn('this.' + firstPathStr, this._domRender_proxy);
                // console.log('-------', firstPathStr, firstData);
                // if (firstData instanceof Dictionary) {
                // }
                const iterable = this._rawSets.get(fullPathStr);
                // array check
                const front = shortPaths
                    .slice(0, shortPaths.length - 1)
                    .map(it => (isNaN(Number(it)) ? '.' + it : `[${it}]`))
                    .join('');
                const lastPropertyName = shortPaths[shortPaths.length - 1];
                const path = 'this' + front;
                const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_16__.ObjectUtils.Script.evaluateReturn(_dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_16__.ObjectUtils.Path.toOptionalChainPath(path), this._domRender_proxy);
                // console.log('root-sub-->', this._rawSets, iterable, path, data );
                // :  undefined/null      child RawSet 
                // : users undefined  users[0].imgUrl, users[1].office.name  RawSet 
                // if (value === undefined || value === null) {
                //   this.removeChildRawSetsByPath(fullPathStr);
                // }
                // console.log('--!!!!', fullPathStr, iterable, data, front, last);
                //  promise  ........       .   promise
                const promiseStartTime = Date.now();
                // console.timeEnd('root_recursive');
                // console.time('root_render_wait');
                new Promise(async (resolve) => {
                    const promiseInnerStartTime = Date.now();
                    let rData = [];
                    const firstPathStr = front.slice(1);
                    // check dictionary
                    const dictionaryCheckStartTime = Date.now();
                    // console.log('-promise-------', firstPathStr, this)
                    const firstTargets = this._rawSets.get(firstPathStr);
                    const firstTargetDictionary = [];
                    firstTargets?.forEach(it => {
                        // console.log('----forEach---', it);
                        const type = it.point.start?.getAttribute?.('type');
                        if (type === _rawsets_RawSetOperatorType__WEBPACK_IMPORTED_MODULE_5__.RawSetOperatorType.DR_THIS_PROPERTY) {
                            firstTargetDictionary.push(it);
                        }
                    });
                    // console.log(` Dictionary check time: ${Date.now() - dictionaryCheckStartTime}ms (${firstTargetDictionary.length} found)`);
                    if (firstTargetDictionary.length > 0) {
                        // console.log('ddddddddddd', firstTargetDictionary);
                        const rawSets = [];
                        let skip = false;
                        firstTargetDictionary.forEach(it => {
                            const startElement = it.point.start;
                            const keys = startElement.getAttribute(_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_0__.RawSet.DR_HAS_KEYS_OPTIONNAME)?.split(',') ?? [];
                            if (value === undefined) {
                                const rawSet = it.getHasRawSet(lastPropertyName);
                                rawSet?.remove();
                                startElement.setAttribute(_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_0__.RawSet.DR_HAS_KEYS_OPTIONNAME, keys.filter(it => it !== lastPropertyName).join(','));
                            }
                            if (!keys.includes(lastPropertyName)) {
                                const raws = _operators_DrThisProperty__WEBPACK_IMPORTED_MODULE_4__.DrThisProperty.append(this._domRender_proxy, fullPathStr, lastPropertyName, it, this._domRender_config);
                                if (raws) {
                                    rawSets.push(...raws);
                                }
                            }
                            else {
                                skip = true;
                            }
                        });
                        if (skip === false || rawSets.length > 0) {
                            rData = await this.render(rawSets);
                        }
                    }
                    const renderStartTime = Date.now();
                    if (lastPropertyName === 'length' && Array.isArray(data)) {
                        const aIterable = this._rawSets.get(firstPathStr);
                        if (aIterable) {
                            rData = await this.render(Array.from(aIterable));
                        }
                    }
                    else if (iterable) {
                        // console.log('------------',iterable, fullPaths)
                        rData = await this.render(Array.from(iterable), fullPathStr);
                    }
                    // console.log(` Render time: ${Date.now() - renderStartTime}ms (${rData?.length || 0} rawSets)`);
                    // console.log('-----------', this, lastPropertyName );
                    // this._targets.forEach(it => {
                    //   // return;
                    //   if (it.nodeType === Node.DOCUMENT_FRAGMENT_NODE || it.nodeType === Node.ELEMENT_NODE) {
                    //     const targets = eventManager.findAttrElements((it as DocumentFragment | Element), this.config);
                    //     eventManager.changeVar(this._domRender_proxy, targets, `this.${fullPathStr}`, this.config);
                    //   }
                    // });
                    const eventProcessStartTime = Date.now();
                    const Node = (this._domRender_config.window.Node);
                    this._targets.forEach(it => {
                        // return;
                        if (it.nodeType === Node.DOCUMENT_FRAGMENT_NODE || it.nodeType === Node.ELEMENT_NODE) {
                            const findAttrStartTime = Date.now();
                            const targets = this._domRender_config.eventManager.findAttrElements(it, this._domRender_config);
                            const targetCount = targets?.size || targets?.length || 0;
                            // console.log(` findAttrElements time: ${Date.now() - findAttrStartTime}ms (${targetCount} elements)`, it);
                            const changeVarStartTime = Date.now();
                            this._domRender_config.eventManager.changeVar(this._domRender_proxy, targets, `this.${fullPathStr}`, this._domRender_config);
                            // console.log(` changeVar time: ${Date.now() - changeVarStartTime}ms`);
                        }
                    });
                    // console.log(` Event processing time: ${Date.now() - eventProcessStartTime}ms (${this._targets.size} targets)`);
                    // console.log(` Promise inner total time: ${Date.now() - promiseInnerStartTime}ms`);
                    //
                    if (rData?.length > 0 && (0,_lifecycle_OnChildRenderedByProperty__WEBPACK_IMPORTED_MODULE_15__.isOnChildRenderedByProperty)(data)) {
                        const propertyValue = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_16__.ObjectUtils.Script.evaluateReturn(`this.${lastPropertyName}`, data);
                        data.onChildRenderedByProperty(lastPropertyName, propertyValue);
                        // data
                    }
                    resolve(rData);
                }).then(it => {
                    // console.log('DonrenderProxy root RenderDone')
                    // console.timeEnd('root_render_wait');
                    // console.timeEnd('root_total');
                });
            }
            fullPaths.push([{ path: fullPathStr, obj: this._domRender_proxy }]);
        }
        // console.log(` Root method total time: ${Date.now() - rootStartTime}ms`);
        // console.log('dddddd', fullPaths.flatMap(it => it).map(it => it.path))
        // console.groupEnd();
        return fullPaths;
    }
    set(target, p, value, receiver) {
        // console.log('set------->', target, p, value, receiver, Date.now())
        // console.log('set------->', p,value)
        // console.log('set------->', target, p, value, receiver, Date.now())
        // try {
        //   const isNoProxy = Reflect.getMetadata(DomRenderNoProxyKey, target, p) || Reflect.getMetadata(DomRenderNoProxyKey, Object.getPrototypeOf(obj).constructor);
        //   if (isNoProxy) {
        //     return obj;
        //   }
        // }catch (e) {}
        // console.log('set-->', p, value, target, receiver, Reflect.getMetadata(DomRenderNoProxyKey, target, p) );
        if ((typeof p === 'string' && p !== _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderComponentMetaKey.DOMRENDER_COMPONENTS_KEY && excludeGetSetPropertys.includes(p)) ||
            Reflect.getMetadata(_decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_7__.DomRenderNoProxyKey, target, p)) {
            target[p] = value;
            return true;
        }
        // const old =  (target as any)[p];
        // console.log('set proxy-->', target, p, value, this._rawSets, this._domRender_ref);
        // if (typeof p === 'string' && '__render' === p) {
        //     (target as any)[p] = value;
        //     return true;
        // }
        // console.log('set--?', p, target, value);
        let start = performance.now();
        if (typeof p === 'string') {
            value = this.proxy(receiver, value, p);
        }
        // console.log('set proxy time', performance.now() - start, p);
        // start = performance.now();
        // console.log('set typeChecked',  (target as any)[p] instanceof ComponentSet, value instanceof ComponentSet);
        // if ((target as any)[p] instanceof ComponentSet) {
        //   (target as any)[p]?.obj?.onDrThisUnBind?.();
        // }
        // console.log('---', this._domRender_ref, p, this._domRender_proxy)
        // is ComponentSet
        if (value instanceof _components_ComponentSet__WEBPACK_IMPORTED_MODULE_6__.ComponentSet && target[p] instanceof _components_ComponentSet__WEBPACK_IMPORTED_MODULE_6__.ComponentSet) {
            value.config.beforeComponentSet = target[p];
        }
        target[p] = value;
        let fullPathInfo = [];
        if (typeof p === 'string') {
            fullPathInfo = this.root([[{ path: p, obj: this._domRender_proxy }]], value);
        }
        // console.log('set proxy root time', performance.now() - start, p);
        // start = performance.now();
        //
        // console.log('setRooot', fullPathInfo);
        //normal attribute      !!
        // const rootDomRenderProxy = this.findRootDomRenderProxy();
        // console.log('set!!!!!!!', fullPathInfo, rootDomRenderProxy)
        // console.log('--------rootDom',fullPathInfo, rootDomRenderProxy, rootDomRenderProxy._domRender_proxy)
        const rootElement = this._domRender_config.rootElement ?? this._domRender_config.window.document;
        _dooboostore_core_web_document_DocumentUtils__WEBPACK_IMPORTED_MODULE_12__.DocumentUtils.querySelectorAllByAttributeName(rootElement, _events_EventManager__WEBPACK_IMPORTED_MODULE_1__.EventManager.normalAttrMapAttrName)?.forEach(elementInfo => {
            // @ts-ignore
            // const optionalPath = ObjectUtils.Path.toOptionalChainPath(elementInfo.value);
            const targets = new Map(_dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_16__.ObjectUtils.Script.evaluateReturn(elementInfo.value));
            Array.from(targets.entries())
                .filter(_dooboostore_core_types__WEBPACK_IMPORTED_MODULE_13__.isDefined)
                .flatMap(([key, valueScript]) => {
                return fullPathInfo
                    .flat()
                    .filter(it => valueScript.variablePaths?.some(vit => vit.inner.includes(`this.${it.path}`)))
                    .flatMap(it => ({ key, valueScript: valueScript, pathInfo: it }));
            })
                .forEach(it => {
                // const optionalPaths = it.valueScript.variablePaths.map(it => ObjectUtils.Path.toOptionalChainPath(it))
                const variablePaths = it.valueScript.variablePaths;
                let targetScript = it.valueScript.originalAttrValue;
                let script;
                if (it.valueScript.isStringTemplate) {
                    variablePaths.forEach(it => {
                        let r = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_16__.ObjectUtils.Path.toOptionalChainPath(it.inner);
                        targetScript = targetScript.replaceAll(it.origin, `\${${r}}`);
                    });
                    script = '`' + targetScript + '`';
                }
                else {
                    variablePaths.forEach(it => {
                        let r = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_16__.ObjectUtils.Path.toOptionalChainPath(it.inner);
                        targetScript = targetScript.replaceAll(it.origin, `${r}`);
                    });
                    script = targetScript;
                }
                // variablePaths.forEach(it => {
                //   let r = ObjectUtils.Path.toOptionalChainPath(it.inner);
                //   targetScript = targetScript.replaceAll(it.origin,`\${${r}}`);
                // })
                const value1 = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_16__.ObjectUtils.Script.evaluateReturn(script, it.pathInfo.obj);
                // console.log('proxy set!Attribut======', it.key, value1)
                if (value1 === null || value1 === undefined) {
                    elementInfo.element.removeAttribute(it.key);
                    // elementInfo.element[it.key] = null;
                }
                else {
                    elementInfo.element.setAttribute(it.key, value1);
                    elementInfo.element[it.key] = value1;
                }
            });
        });
        // console.log('set proxy normalAttrMapAttrName time', performance.now() - start, p);
        // start = performance.now();
        //     *-link      .
        _dooboostore_core_web_document_DocumentUtils__WEBPACK_IMPORTED_MODULE_12__.DocumentUtils.querySelectorAllByAttributeName(rootElement, _events_EventManager__WEBPACK_IMPORTED_MODULE_1__.EventManager.linkTargetMapAttrName)?.forEach(elementInfo => {
            // @ts-ignore
            const targets = new Map(_dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_16__.ObjectUtils.Script.evaluateReturn(elementInfo.value));
            Array.from(targets.entries())
                .filter(([key, value]) => value.trim())
                .filter(_dooboostore_core_types__WEBPACK_IMPORTED_MODULE_13__.isDefined)
                .flatMap(([key, valueScript]) => {
                return fullPathInfo
                    .flat()
                    .filter(it => valueScript.includes(`this.${it.path}`))
                    .flatMap(it => ({ key, valueScript: valueScript, pathInfo: it }));
            })
                .forEach(info => {
                const value1 = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_16__.ObjectUtils.Script.evaluateReturn(info.valueScript, info.pathInfo.obj);
                const applyAttributeName = _events_EventManager__WEBPACK_IMPORTED_MODULE_1__.EventManager.linkAttrs.find(it => it.name === info.key);
                if (applyAttributeName) {
                    if (value1 === null) {
                        elementInfo.element.removeAttribute(applyAttributeName.property);
                    }
                    else {
                        // console.log('ppppppppppppppppppppppp', applyAttributeName, elementInfo)
                        elementInfo.element.setAttribute(applyAttributeName.property, value1);
                    }
                }
            });
            Array.from(targets.entries())
                .filter(([key, value]) => value.trim())
                .filter(_dooboostore_core_types__WEBPACK_IMPORTED_MODULE_13__.isDefined)
                .flatMap(([key, valueScript]) => {
                return fullPathInfo
                    .flat()
                    .filter(it => valueScript.includes(`this.${it.path}`))
                    .flatMap(it => ({ key, valueScript: valueScript, pathInfo: it }));
            })
                .forEach(info => {
                const linkInfo = _events_EventManager__WEBPACK_IMPORTED_MODULE_1__.EventManager.linkAttrs.find(it => it.name === info.key);
                if (linkInfo) {
                    elementInfo.element[linkInfo.property] = value;
                }
            });
        });
        // console.log('set proxy linkTargetMapAttrName time', performance.now() - start, p);
        // start = performance.now();
        // console.log('---end',receiver);
        if (_rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey.onBeforeReturnSet in receiver &&
            typeof p === 'string' &&
            !(this._domRender_config.proxyExcludeOnBeforeReturnSets ?? []).concat(excludeGetSetPropertys).includes(p)) {
            if ((0,_lifecycle_OnBeforeReturnSet__WEBPACK_IMPORTED_MODULE_14__.isOnBeforeReturnSet)(receiver)) {
                receiver.onBeforeReturnSet?.(p, value, fullPathInfo.map(it => it.map(it => it.path).join()));
            }
        }
        // console.log('done!!')
        return true;
    }
    get(target, p, receiver) {
        // console.log('get-->', target, p, receiver);
        if (p === _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey._DomRender_origin || p === _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey._domRender_origin) {
            return this._domRender_origin;
        }
        else if (p === _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey._DomRender_ref || p === _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey._domRender_ref) {
            return this._domRender_ref;
        }
        else if (p === _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey._DomRender_config || p === _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey._domRender_config) {
            return this._domRender_config;
        }
        else if (p === _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey._DomRender_proxy || p === _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey._domRender_proxy) {
            return this;
        }
        else {
            // Date -_-  
            // console.log('--->', p, target, target.bind, 'bind' in target)
            // if ((p in target) && ('bind' in target)) {
            //     try{
            //     return (target as any)[p].bind(target);
            //     }catch (e) {
            //         console.error(e)
            //     }
            // } else {
            //     return (target as any)[p]
            // }
            // return (p in target) ? (target as any)[p].bind(target) : (target as any)[p]
            // console.log('-->', p, Object.prototype.toString.call((target as any)[p]), (target as any)[p])
            // return (target as any)[p]
            let it = target[p];
            if (it &&
                typeof it === 'object' &&
                _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey._DomRender_isProxy in it &&
                Object.prototype.toString.call(it._DomRender_origin) === '[object Date]') {
                it = it._DomRender_origin;
            }
            if (_rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey.onBeforeReturnGet in receiver &&
                typeof p === 'string' &&
                !(this._domRender_config.proxyExcludeOnBeforeReturnGets ?? []).concat(excludeGetSetPropertys).includes(p)) {
                receiver?.onBeforeReturnGet?.(p, it, this.root([[{ path: p, obj: this._domRender_proxy }]], it, false));
            }
            return it;
        }
    }
    deleteProperty(target, p) {
        delete target[p];
        if (typeof p === 'string') {
            this.root([[{ path: p, obj: this._domRender_proxy }]]);
        }
        return true;
    }
    has(target, p) {
        return p === _rawsets__WEBPACK_IMPORTED_MODULE_21__.DomRenderProxyMetaKey._DomRender_isProxy || p in target;
    }
    proxy(parentProxy, obj, p) {
        try {
            // const isNoProxy = Reflect.getMetadata(DomRenderNoProxyKey, obj, p) || Reflect.getMetadata(DomRenderNoProxyKey, Object.getPrototypeOf(obj).constructor);
            const isObject = typeof obj === 'object';
            const isNoProxy = isObject && (0,_decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_7__.isDomRenderNoProxy)(obj, p);
            const isExclude = this._domRender_config.proxyExcludeTyps?.some(it => obj instanceof it) ?? false;
            const isFinal = isObject && DomRenderProxy.isFinal(obj);
            const isFrozen = Object.isFrozen(obj);
            const isShield = obj instanceof _types_Types__WEBPACK_IMPORTED_MODULE_2__.Shield;
            if (obj === undefined ||
                obj === null ||
                isNoProxy ||
                isExclude ||
                _dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_17__.ValidUtils.isNullOrUndefined(obj) ||
                !isObject ||
                isFinal ||
                isFrozen ||
                isShield) {
                return obj;
            }
        }
        catch (e) { }
        /*
        const proxyTarget = (this._domRender_config.proxyExcludeTyps?.filter(it => obj instanceof it) ?? []).length <= 0;
        if (proxyTarget && obj !== undefined && obj !== null && typeof obj === 'object' && !('_DomRender_isProxy' in obj) && !DomRenderProxy.isFinal(obj) && !Object.isFrozen(obj) && !(obj instanceof Shield)) {
          const domRender = new DomRenderProxy(obj, undefined, this._domRender_config);
          domRender.addRef(parentProxy, p);
          const proxy = new Proxy(obj, domRender);
          domRender.run(proxy);
          return proxy;
        }
        if (proxyTarget && obj !== undefined && obj !== null && typeof obj === 'object' && ('_DomRender_isProxy' in obj) && !DomRenderProxy.isFinal(obj) && !Object.isFrozen(obj) && !(obj instanceof Shield)) {
          const d = (obj as any)._DomRender_proxy as DomRenderProxy<T>;
          d.addRef(this._domRender_proxy!, p);
          return obj;
        } else {
          return obj;
        }
     */
        if (!isWrapProxyDomRenderProxy(obj)) {
            const domRender = new DomRenderProxy(obj, undefined, this._domRender_config);
            domRender.addRef(parentProxy, p);
            const proxy = new Proxy(obj, domRender);
            domRender.run(proxy);
            return proxy;
        }
        if (isWrapProxyDomRenderProxy(obj)) {
            const d = obj._DomRender_proxy;
            d.addRef(this._domRender_proxy, p);
            return obj;
        }
        else {
            return obj;
        }
    }
    addRef(parent, path) {
        if (!this._domRender_ref.get(parent)) {
            this._domRender_ref.set(parent, new Set());
        }
        this._domRender_ref.get(parent)?.add(path);
    }
    addRawSetAndRender(path, rawSet) {
        this.addRawSet(path, rawSet);
        this.render([rawSet]);
    }
    addRawSet(path, rawSet) {
        // console.log('addRawSet--> path:', path, 'rawSet:', rawSet)
        if (!this._rawSets.get(path)) {
            this._rawSets.set(path, new Set());
        }
        this._rawSets.get(path)?.add(rawSet);
    }
    // public removeRawSet(...raws: RawSet[]) {
    //     this._rawSets.forEach(it => {
    //         raws.forEach(sit => it.delete(sit));
    //     })
    //     this.garbageRawSet();
    // }
    removeRawSet(...raws) {
        // console.log('Before removeRawSet, total rawSets:', this.getRawSets().length);
        this._rawSets.forEach(it => {
            it.forEach(sit => {
                if (!sit.isConnected) {
                    it.delete(sit);
                }
                else if (raws.includes(sit)) {
                    it.delete(sit);
                }
            });
        });
        this.targetGarbageRawSet();
        // console.log('After removeRawSet, total rawSets:', this.getRawSets().length);
    }
    //     child RawSet 
    // : path 'users' 'users[0]', 'users[0].imgUrl', 'users.length'   
    removeChildRawSetsByPath(parentPath) {
        const pathsToRemove = [];
        this._rawSets.forEach((rawSetSet, path) => {
            //  ,   (users[),   (users.)  
            if (path === parentPath || path.startsWith(parentPath + '[') || path.startsWith(parentPath + '.')) {
                pathsToRemove.push(path);
            }
        });
        if (pathsToRemove.length > 0) {
            // console.log(` Removing child RawSets for path '${parentPath}':`, pathsToRemove);
            pathsToRemove.forEach(path => {
                const rawSetSet = this._rawSets.get(path);
                if (rawSetSet) {
                    rawSetSet.forEach(rawSet => {
                        // DOM 
                        rawSet.remove?.();
                    });
                    this._rawSets.delete(path);
                }
            });
        }
    }
    targetGarbageRawSet() {
        this._targets.forEach(it => {
            if (!it.isConnected) {
                this._targets.delete(it);
            }
        });
    }
    garbageRawSet() {
        this._targets.forEach(it => {
            if (!it.isConnected) {
                this._targets.delete(it);
            }
        });
        this._rawSets.forEach(it => {
            it.forEach(sit => {
                if (!sit.isConnected) {
                    it.delete(sit);
                }
            });
        });
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts":
/*!******************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ATTRIBUTE_METADATA_KEY: () => (/* binding */ ATTRIBUTE_METADATA_KEY),
/* harmony export */   ComponentBase: () => (/* binding */ ComponentBase),
/* harmony export */   EVENT_METADATA_KEY: () => (/* binding */ EVENT_METADATA_KEY),
/* harmony export */   QUERY_METADATA_KEY: () => (/* binding */ QUERY_METADATA_KEY),
/* harmony export */   attribute: () => (/* binding */ attribute),
/* harmony export */   event: () => (/* binding */ event),
/* harmony export */   query: () => (/* binding */ query)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_core_web_element_ElementUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/core-web/element/ElementUtils */ "../../packages/@dooboostore/core-web/src/element/ElementUtils.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../decorators/DomRenderNoProxy */ "../../packages/@dooboostore/dom-render/src/decorators/DomRenderNoProxy.ts");
/* harmony import */ var _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dooboostore/core/convert/ConvertUtils */ "../../packages/@dooboostore/core/src/convert/ConvertUtils.ts");
/* harmony import */ var _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @dooboostore/core/reflect/ReflectUtils */ "../../packages/@dooboostore/core/src/reflect/ReflectUtils.ts");
/* harmony import */ var _dooboostore_core_message_Subject__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @dooboostore/core/message/Subject */ "../../packages/@dooboostore/core/src/message/Subject.ts");
/* harmony import */ var _dooboostore_core_message_operators_debounceTime__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @dooboostore/core/message/operators/debounceTime */ "../../packages/@dooboostore/core/src/message/operators/debounceTime.ts");
/* harmony import */ var _dooboostore_core_message_operators_bufferTime__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @dooboostore/core/message/operators/bufferTime */ "../../packages/@dooboostore/core/src/message/operators/bufferTime.ts");
var _a, _b;









const ATTRIBUTE_METADATA_KEY = Symbol('attribute');
const QUERY_METADATA_KEY = Symbol('query');
const EVENT_METADATA_KEY = Symbol('event');
function attribute(nameOrOptions) {
    return (target, propertyKey, descriptor) => {
        const attributes = _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_5__.ReflectUtils.getMetadata(ATTRIBUTE_METADATA_KEY, target.constructor) || [];
        let name;
        let converter;
        if (typeof nameOrOptions === 'string') {
            name = nameOrOptions;
        }
        else if (nameOrOptions) {
            name = nameOrOptions.name || String(propertyKey);
            converter = nameOrOptions.converter;
        }
        else {
            name = String(propertyKey);
        }
        const attributeMetadata = {
            propertyKey: propertyKey,
            name: name,
            converter: converter,
            isMethod: !!descriptor
        };
        attributes.push(attributeMetadata);
        _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_5__.ReflectUtils.defineMetadata(ATTRIBUTE_METADATA_KEY, attributes, target.constructor);
    };
}
function query(selectorOrOptions) {
    return (target, propertyKey, descriptor) => {
        const queries = _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_5__.ReflectUtils.getMetadata(QUERY_METADATA_KEY, target.constructor) || [];
        let selector;
        let convert;
        let onDestroy;
        let refreshTime;
        let refreshRawSetRendered;
        if (typeof selectorOrOptions === 'string') {
            selector = selectorOrOptions;
        }
        else {
            selector = selectorOrOptions.selector;
            convert = selectorOrOptions.convert;
            onDestroy = selectorOrOptions.onDestroy;
            refreshTime = selectorOrOptions.refreshIntervalTime;
            refreshRawSetRendered = selectorOrOptions.refreshRawSetRendered;
        }
        const queryMetadata = {
            selector: selector,
            propertyKey: propertyKey,
            isMethod: !!descriptor,
            convert: convert,
            onDestroy: onDestroy,
            refreshTime: refreshTime,
            refreshRawSetRendered
        };
        queries.push(queryMetadata);
        _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_5__.ReflectUtils.defineMetadata(QUERY_METADATA_KEY, queries, target.constructor);
    };
}
function event(options) {
    return (target, propertyKey, descriptor) => {
        const events = _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_5__.ReflectUtils.getMetadata(EVENT_METADATA_KEY, target.constructor) || [];
        const eventMetadata = {
            query: options.query,
            eventName: options.name,
            methodName: propertyKey,
            onDestroy: options.onDestroy,
            refreshTime: options.refreshTime,
            refreshRawSetRendered: options.refreshRawSetRendered
        };
        events.push(eventMetadata);
        _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_5__.ReflectUtils.defineMetadata(EVENT_METADATA_KEY, events, target.constructor);
    };
}
class ComponentBase {
    _config;
    _rawSet;
    _children = [];
    _render;
    _attribute;
    _boundEventListeners = [];
    _queryBindings = [];
    _eventBindings = [];
    _refreshTimers = new Map();
    childrenSetSubject = new _dooboostore_core_message_Subject__WEBPACK_IMPORTED_MODULE_6__.Subject();
    createChildrenDebounceSubscription;
    onRawSetRenderedOtherDataSubject = new _dooboostore_core_message_Subject__WEBPACK_IMPORTED_MODULE_6__.Subject();
    onChildRawSetRenderedOtherDataSubject = new _dooboostore_core_message_Subject__WEBPACK_IMPORTED_MODULE_6__.Subject();
    onRawSetRenderedOtherDataSubjectSubscription;
    onChildRawSetRenderedOtherDataSubjectSubscription;
    constructor(_config) {
        this._config = _config;
        // console.log('ComponentBase created', this);
        // setTimeout(()=>{
        //   console.log('ComponentBase created', this.constructor.name, this._rawSet?.uuid);
        // }, 1000)
    }
    get componentConfig() {
        return this._config;
    }
    get render() {
        return this._render;
    }
    get rawSet() {
        return this._rawSet;
    }
    get domRenderConfig() {
        return this.rawSet?.dataSet.config;
    }
    _queryElements(selector, rawSet) {
        const e = this.getElement();
        // console.log('queryElement-->', e);
        if (e) {
            return _dooboostore_core_web_element_ElementUtils__WEBPACK_IMPORTED_MODULE_1__.ElementUtils.querySelectorAll(e, selector);
        }
        else {
            let startNode = rawSet.point?.start;
            let endNode = rawSet.point?.end;
            // console.log('-----', startNode, endNode)
            // console.log('-----', startNode?.isConnected, endNode?.isConnected)
            if (rawSet.point?.start && startNode && !startNode.isConnected && startNode instanceof HTMLElement && startNode.hasAttribute('id')) {
                rawSet.point.start = startNode = rawSet.dataSet.config.window.document.querySelector('#' + startNode.id);
            }
            if (rawSet.point?.end && endNode && !endNode.isConnected && endNode instanceof HTMLElement && endNode.hasAttribute('id')) {
                rawSet.point.end = endNode = rawSet.dataSet.config.window.document.querySelector('#' + endNode.id);
            }
            if (startNode && endNode) {
                // console.log('query!!', startNode, endNode);
                return _dooboostore_core_web_element_ElementUtils__WEBPACK_IMPORTED_MODULE_1__.ElementUtils.querySelectorAll({ start: startNode, end: endNode }, selector);
            }
        }
        return [];
    }
    _cleanupEventListeners() {
        for (const { element, eventName, listener } of this._boundEventListeners) {
            element.removeEventListener(eventName, listener);
        }
        this._boundEventListeners = [];
    }
    _cleanupQueryBindings() {
        for (const { element, metadata } of this._queryBindings) {
            if (metadata.onDestroy) {
                metadata.onDestroy(this, element);
            }
            this._clearRefreshTimer(metadata);
        }
        this._queryBindings = [];
    }
    _cleanupEventBindings() {
        for (const { element, metadata, listener } of this._eventBindings) {
            element.removeEventListener(metadata.eventName, listener);
            if (metadata.onDestroy) {
                metadata.onDestroy(this, element);
            }
            this._clearRefreshTimer(metadata);
        }
        this._eventBindings = [];
    }
    _applyQueryBinding(queryInfo, elements, newElementsOnly = elements) {
        const { propertyKey, isMethod, convert } = queryInfo;
        // Track bindings for cleanup
        elements.forEach(element => {
            this._queryBindings.push({ element, metadata: queryInfo });
        });
        // Apply convert function if provided
        const processedElements = convert ? elements.map(convert) : elements;
        const processedNewElements = convert ? newElementsOnly.map(convert) : newElementsOnly;
        if (isMethod) {
            const method = this[propertyKey];
            if (typeof method === 'function') {
                const paramTypes = _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_5__.ReflectUtils.getParameterTypes(this, propertyKey);
                if (paramTypes && paramTypes.length > 0 && paramTypes[0] === Array) {
                    // For array methods, pass only new elements
                    method.call(this, processedNewElements, { all: processedElements });
                }
                else {
                    // For single element methods, pass first new element
                    if (processedNewElements.length > 0) {
                        method.call(this, processedNewElements[0], { all: processedElements, newAll: processedNewElements });
                    }
                }
            }
        }
        else {
            // For properties, always set all elements (not just new ones)
            const propertyType = _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_5__.ReflectUtils.getType(this, propertyKey);
            if (propertyType === Array) {
                this[propertyKey] = processedElements;
            }
            else {
                this[propertyKey] = processedElements[0] || null;
            }
        }
    }
    _setupQueryDecorators(rawSet) {
        if (!rawSet)
            return;
        const queries = _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_5__.ReflectUtils.getMetadata(QUERY_METADATA_KEY, this.constructor);
        // console.group('_setupQueryDecorators')
        // console.log('queries', queries);
        if (queries && Array.isArray(queries)) {
            for (const queryInfo of queries) {
                const elements = this._queryElements(queryInfo.selector, rawSet);
                // console.log('------elements', elements);
                this._applyQueryBinding(queryInfo, elements);
                // Setup refresh timer if specified
                this._setupRefreshTimer(queryInfo);
            }
        }
        // console.groupEnd();
    }
    _updateQueryBinding(queryInfo, rawSet, forceUpdate = false) {
        const newElements = this._queryElements(queryInfo.selector, rawSet);
        // Get current bindings for this query
        const currentBindings = this._queryBindings.filter(binding => binding.metadata === queryInfo);
        const currentElements = currentBindings.map(binding => binding.element);
        // Check if elements have changed
        const elementsChanged = forceUpdate || !this._arraysEqual(currentElements, newElements);
        if (elementsChanged) {
            let addedElements = [];
            if (forceUpdate) {
                // Force update: cleanup all old bindings, treat all as new
                currentBindings.forEach(({ element, metadata }) => {
                    if (metadata.onDestroy) {
                        metadata.onDestroy(this, element);
                    }
                });
                addedElements = newElements;
            }
            else {
                // Smart update: only cleanup removed elements, find added elements
                const removedElements = currentElements.filter(element => !newElements.includes(element));
                addedElements = newElements.filter(element => !currentElements.includes(element));
                removedElements.forEach(element => {
                    if (queryInfo.onDestroy) {
                        queryInfo.onDestroy(this, element);
                    }
                });
            }
            // Remove old bindings
            this._queryBindings = this._queryBindings.filter(binding => binding.metadata !== queryInfo);
            // Apply new bindings, but pass only added elements to methods
            this._applyQueryBinding(queryInfo, newElements, addedElements);
        }
    }
    _updateQueryDecorators(rawSet) {
        if (!rawSet)
            return;
        const queries = _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_5__.ReflectUtils.getMetadata(QUERY_METADATA_KEY, this.constructor);
        if (queries && Array.isArray(queries)) {
            for (const queryInfo of queries) {
                this._updateQueryBinding(queryInfo, rawSet);
            }
        }
    }
    _arraysEqual(arr1, arr2) {
        if (arr1.length !== arr2.length)
            return false;
        return arr1.every((element, index) => element === arr2[index]);
    }
    _setupRefreshTimer(metadata) {
        if (!metadata.refreshTime || !this._rawSet)
            return;
        const timer = setInterval(() => {
            if (!this._rawSet)
                return;
            if ('selector' in metadata) {
                // QueryMetadata
                this._updateQueryBinding(metadata, this._rawSet);
            }
            else {
                // EventMetadata
                this._updateEventBinding(metadata, this._rawSet);
            }
        }, metadata.refreshTime);
        this._refreshTimers.set(metadata, timer);
    }
    _clearRefreshTimer(metadata) {
        const timer = this._refreshTimers.get(metadata);
        if (timer) {
            clearInterval(timer);
            this._refreshTimers.delete(metadata);
        }
    }
    _clearAllRefreshTimers() {
        for (const timer of Array.from(this._refreshTimers.values())) {
            clearInterval(timer);
        }
        this._refreshTimers.clear();
    }
    async onRawSetRendered(rawSet, otherData) {
        this.onRawSetRenderedOtherDataSubject.next(otherData);
        // this.onRawSetRenderedOtherDataSubjectSubscription = this.onRawSetRenderedOtherDataSubject.pipe(debounceTime(this.componentConfig?.onRawSetRenderedOtherDataDebounce??0)).subscribe(it => {
        //   this.onRawSetRenderedDebounce(it);
        // });
        const queries = _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_5__.ReflectUtils.getMetadata(QUERY_METADATA_KEY, this.constructor);
        if (queries) {
            queries.filter(it => it.refreshRawSetRendered).forEach(queryInfo => {
                this._updateQueryBinding(queryInfo, rawSet, true);
            });
        }
        const events = _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_5__.ReflectUtils.getMetadata(EVENT_METADATA_KEY, this.constructor);
        if (events) {
            events.filter(it => it.refreshRawSetRendered).forEach(eventInfo => {
                this._updateEventBinding(eventInfo, rawSet, true);
            });
        }
    }
    async onChildRawSetRendered() {
        this.onChildRawSetRenderedOtherDataSubject.next();
    }
    /**
     * Manually refresh all query and event decorators
     * Useful when DOM elements are dynamically added/removed and you want to update bindings
     */
    refreshDecorators() {
        if (this._rawSet) {
            this._updateQueryDecorators(this._rawSet);
            this._updateEventDecorators(this._rawSet);
        }
    }
    /**
     * Manually refresh specific query decorators by property key
     * @param propertyKeys - Array of property keys to refresh, or single property key
     */
    refreshQueryDecorators(propertyKeys) {
        if (!this._rawSet)
            return;
        const keys = Array.isArray(propertyKeys) ? propertyKeys : [propertyKeys];
        const queries = _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_5__.ReflectUtils.getMetadata(QUERY_METADATA_KEY, this.constructor);
        if (queries && Array.isArray(queries)) {
            for (const queryInfo of queries) {
                if (keys.includes(queryInfo.propertyKey)) {
                    this._updateQueryBinding(queryInfo, this._rawSet, true); // Force update
                }
            }
        }
    }
    /**
     * Manually refresh specific event decorators by method name
     * @param methodNames - Array of method names to refresh, or single method name
     */
    refreshEventDecorators(methodNames) {
        if (!this._rawSet)
            return;
        const names = Array.isArray(methodNames) ? methodNames : [methodNames];
        const events = _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_5__.ReflectUtils.getMetadata(EVENT_METADATA_KEY, this.constructor);
        if (events && Array.isArray(events)) {
            for (const eventInfo of events) {
                if (names.includes(eventInfo.methodName)) {
                    this._updateEventBinding(eventInfo, this._rawSet, true); // Force update
                }
            }
        }
    }
    _applyEventBinding(eventInfo, elements) {
        elements.forEach(element => {
            const listener = this[eventInfo.methodName].bind(this);
            // console.log('bind?????', element);
            element.addEventListener(eventInfo.eventName, listener);
            // Track bindings for cleanup
            this._eventBindings.push({ element, metadata: eventInfo, listener });
            this._boundEventListeners.push({ element, eventName: eventInfo.eventName, listener });
        });
    }
    _setupEventDecorators(rawSet) {
        if (!rawSet)
            return;
        const events = _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_5__.ReflectUtils.getMetadata(EVENT_METADATA_KEY, this.constructor);
        if (events && Array.isArray(events)) {
            for (const eventInfo of events) {
                const elements = this._queryElements(eventInfo.query, rawSet);
                this._applyEventBinding(eventInfo, elements);
                // Setup refresh timer if specified
                this._setupRefreshTimer(eventInfo);
            }
        }
    }
    _updateEventBinding(eventInfo, rawSet, forceUpdate = false) {
        const newElements = this._queryElements(eventInfo.query, rawSet);
        // Get current bindings for this event
        const currentBindings = this._eventBindings.filter(binding => binding.metadata === eventInfo);
        const currentElements = currentBindings.map(binding => binding.element);
        // Check if elements have changed
        const elementsChanged = forceUpdate || !this._arraysEqual(currentElements, newElements);
        if (elementsChanged) {
            if (forceUpdate) {
                // Force update: cleanup all old bindings
                currentBindings.forEach(({ element, metadata, listener }) => {
                    element.removeEventListener(metadata.eventName, listener);
                    if (metadata.onDestroy) {
                        metadata.onDestroy(this, element);
                    }
                });
            }
            else {
                // Smart update: only cleanup removed elements
                const removedElements = currentElements.filter(element => !newElements.includes(element));
                const removedBindings = currentBindings.filter(binding => removedElements.includes(binding.element));
                removedBindings.forEach(({ element, metadata, listener }) => {
                    element.removeEventListener(metadata.eventName, listener);
                    if (metadata.onDestroy) {
                        metadata.onDestroy(this, element);
                    }
                });
            }
            // Remove old bindings from tracking arrays
            this._eventBindings = this._eventBindings.filter(binding => binding.metadata !== eventInfo);
            this._boundEventListeners = this._boundEventListeners.filter(binding => !currentBindings.some(cb => cb.element === binding.element && cb.metadata.eventName === binding.eventName));
            // Apply new bindings
            this._applyEventBinding(eventInfo, newElements);
        }
    }
    _updateEventDecorators(rawSet) {
        if (!rawSet)
            return;
        const events = _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_5__.ReflectUtils.getMetadata(EVENT_METADATA_KEY, this.constructor);
        if (events && Array.isArray(events)) {
            for (const eventInfo of events) {
                this._updateEventBinding(eventInfo, rawSet);
            }
        }
    }
    getAttributeNames(attribute = this._attribute) {
        const target = attribute;
        if (!target)
            return [];
        const keys = Object.keys(target);
        const names = new Set();
        for (const k of keys) {
            names.add(k);
            // names.add(ConvertUtils.camelToSnakeCase(k));
            // names.add(ConvertUtils.snakeToCamelCase(k));
            // names.add(k.toLowerCase());
            // names.add(k.toUpperCase());
        }
        return Array.from(names);
    }
    getAttribute(name, attribute = this._attribute) {
        const target = attribute;
        if (!target) {
            return null;
        }
        const nameString = String(name);
        let p = nameString;
        if (p in target) {
            return target[p];
        }
        p = _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_4__.ConvertUtils.snakeToCamelCase(nameString);
        if (p in target) {
            return target[p];
        }
        p = _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_4__.ConvertUtils.camelToSnakeCase(nameString);
        if (p in target) {
            return target[p];
        }
        p = nameString.toUpperCase();
        if (p in target) {
            return target[p];
        }
        p = nameString.toLowerCase();
        if (p in target) {
            return target[p];
        }
        return null;
    }
    hasAttribute(name) {
        return this.getAttribute(name) !== null;
    }
    equalsAttributeName(n, name) {
        return n === name ||
            _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_4__.ConvertUtils.snakeToCamelCase(n) === name ||
            _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_4__.ConvertUtils.camelToSnakeCase(n) === name ||
            n.toUpperCase() === name.toUpperCase() ||
            n.toLowerCase() === name.toLowerCase();
    }
    get uuid() {
        return this._rawSet?.uuid;
    }
    get childrenSet() {
        return this._children;
    }
    get children() {
        return this._children.map(it => it.instance);
    }
    getElement() {
        return (this.render ?? this.rawSet?.dataSet?.render)?.getElement?.();
    }
    getFirstChild(type) {
        return this._children.find(it => it.instance instanceof type)?.instance;
    }
    getParentThis() {
        return this.render?.parentThis;
    }
    getChildren(typeOrTypes) {
        const targets = Array.isArray(typeOrTypes) ? typeOrTypes : [typeOrTypes];
        return this._children.filter(childSet => targets.some(targetConstructor => childSet.instance instanceof targetConstructor))?.map(it => it.instance);
    }
    setRawSet(rawSet) {
        this._rawSet = rawSet;
        if (this._rawSet) {
            this.setAttribute(this._rawSet.dataSet?.render?.attribute);
        }
    }
    setAttribute(attribute) {
        this._attribute = attribute;
    }
    // TODO: rawSet isConnected      .. ...
    onCreatedThisChild(child, data) {
        // console.log('onCreatedThisChild------------------------',child, data, data.render?.rawSet?.isConnected)
        const n = [...this._children];
        n.push({ instance: child, data });
        this._children = n.filter(it => it.data.render?.rawSet?.isConnected);
        this.childrenSetSubject.next(this._children);
        // Update decorators when children change (DOM might have changed)
        // Only update if elements actually changed
        if (this._rawSet) {
            this._updateQueryDecorators(this._rawSet);
            this._updateEventDecorators(this._rawSet);
        }
    }
    onCreatedThisChildDebounce(childrenSet) {
    }
    onRawSetRenderedDebounce(childrenSet) {
    }
    onChildRawSetRenderedDebounce() {
    }
    onCreateRenderData(data) {
        this._render = data.render;
        if (data.render?.rawSet) {
            this.setRawSet(data.render.rawSet);
        }
        if (this._config?.onlyParentType) {
            const isOk = Array.isArray(this._config?.onlyParentType) ? this._config?.onlyParentType : [this._config?.onlyParentType].some(it => data.render?.parentThis instanceof it);
            if (!isOk) {
                throw new Error('only my parentThis ' + this._config?.onlyParentType);
            }
        }
    }
    onChangeAttrRender(name, value, other) {
        if (other?.rawSet) {
            this.setRawSet(other.rawSet);
        }
        const attributes = _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_5__.ReflectUtils.getMetadata(ATTRIBUTE_METADATA_KEY, this.constructor);
        if (attributes && Array.isArray(attributes)) {
            for (const attrInfo of attributes) {
                if (this.equalsAttributeName(name, attrInfo.name)) {
                    const finalValue = attrInfo.converter ? attrInfo.converter(value) : value;
                    if (attrInfo.isMethod) {
                        const method = this[attrInfo.propertyKey];
                        if (typeof method === 'function') {
                            method.call(this, finalValue);
                        }
                    }
                    else {
                        this[attrInfo.propertyKey] = finalValue;
                    }
                }
            }
        }
    }
    async onInitRender(param, rawSet) {
        // console.log('onInitRender ComponentBase', this.constructor.name, rawSet?.uuid);
        const window = rawSet.dataSet?.config?.window;
        this.createChildrenDebounceSubscription = this.childrenSetSubject.pipe((0,_dooboostore_core_message_operators_debounceTime__WEBPACK_IMPORTED_MODULE_7__.debounceTime)(this.componentConfig?.createChildrenDebounce ?? 1, {
            setTimeout: window ? window.setTimeout.bind(window) : undefined,
            clearTimeout: window ? window.clearTimeout.bind(window) : undefined,
        })).subscribe(it => {
            // console.log('call onCreatedThisChildDebounce', it);
            this.onCreatedThisChildDebounce(it);
        });
        this.onRawSetRenderedOtherDataSubjectSubscription = this.onRawSetRenderedOtherDataSubject.pipe((0,_dooboostore_core_message_operators_bufferTime__WEBPACK_IMPORTED_MODULE_8__.bufferTime)(this.componentConfig?.onRawSetRenderedOtherDataDebounce ?? 1, {
            skipEmpty: true,
            setInterval: window ? window.setInterval.bind(window) : undefined,
            clearInterval: window ? window.clearInterval.bind(window) : undefined,
            setTimeout: window ? window.setTimeout.bind(window) : undefined,
            clearTimeout: window ? window.clearTimeout.bind(window) : undefined,
        })).subscribe(it => {
            this.onRawSetRenderedDebounce(it);
        });
        this.onChildRawSetRenderedOtherDataSubjectSubscription = this.onChildRawSetRenderedOtherDataSubject.pipe((0,_dooboostore_core_message_operators_debounceTime__WEBPACK_IMPORTED_MODULE_7__.debounceTime)(this.componentConfig?.onChildRawSetRenderedOtherDataDebounce ?? 10, {
            setTimeout: window ? window.setTimeout.bind(window) : undefined,
            clearTimeout: window ? window.clearTimeout.bind(window) : undefined,
        })).subscribe(it => {
            this.onChildRawSetRenderedDebounce();
        });
        if (rawSet) {
            this.setRawSet(rawSet);
            const e = this.getElement();
            if (e) {
                e.component = this;
            }
            // Setup decorators
            this._setupQueryDecorators(rawSet);
            this._setupEventDecorators(rawSet);
        }
    }
    onDrThisBind() {
        // Logic moved to onInitRender for robustness
    }
    onDrThisUnBind() {
        this.onDestroy();
    }
    onDestroyRender(data) {
        this.onDestroy();
    }
    onDestroy() {
        this._cleanupEventListeners();
        this._cleanupQueryBindings();
        this._cleanupEventBindings();
        this._clearAllRefreshTimers();
        this.createChildrenDebounceSubscription?.unsubscribe();
        this.onRawSetRenderedOtherDataSubjectSubscription?.unsubscribe();
        this.onChildRawSetRenderedOtherDataSubjectSubscription?.unsubscribe();
        // console.log('ComponentBase onDestroy', this.constructor.name, this.onRawSetRenderedOtherDataSubjectSubscription.closed);
    }
}
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_3__.DomRenderNoProxy,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", typeof (_a = typeof _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet !== "undefined" && _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet) === "function" ? _a : Object)
], ComponentBase.prototype, "_rawSet", void 0);
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_3__.DomRenderNoProxy,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Array)
], ComponentBase.prototype, "_children", void 0);
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_3__.DomRenderNoProxy,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
], ComponentBase.prototype, "_render", void 0);
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_3__.DomRenderNoProxy,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
], ComponentBase.prototype, "_attribute", void 0);
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_3__.DomRenderNoProxy,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Array)
], ComponentBase.prototype, "_boundEventListeners", void 0);
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_3__.DomRenderNoProxy,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Array)
], ComponentBase.prototype, "_queryBindings", void 0);
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_3__.DomRenderNoProxy,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Array)
], ComponentBase.prototype, "_eventBindings", void 0);
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_3__.DomRenderNoProxy,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", typeof (_b = typeof Map !== "undefined" && Map) === "function" ? _b : Object)
], ComponentBase.prototype, "_refreshTimers", void 0);
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_3__.DomRenderNoProxy,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
], ComponentBase.prototype, "childrenSetSubject", void 0);
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_3__.DomRenderNoProxy,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
], ComponentBase.prototype, "createChildrenDebounceSubscription", void 0);
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_3__.DomRenderNoProxy,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
], ComponentBase.prototype, "onRawSetRenderedOtherDataSubject", void 0);
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_3__.DomRenderNoProxy,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
], ComponentBase.prototype, "onChildRawSetRenderedOtherDataSubject", void 0);
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_3__.DomRenderNoProxy,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
], ComponentBase.prototype, "onRawSetRenderedOtherDataSubjectSubscription", void 0);
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_3__.DomRenderNoProxy,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
], ComponentBase.prototype, "onChildRawSetRenderedOtherDataSubjectSubscription", void 0);


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/ComponentRouterBase.ts":
/*!************************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/ComponentRouterBase.ts ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ComponentRouterBase: () => (/* binding */ ComponentRouterBase),
/* harmony export */   isOnCreatedOutlet: () => (/* binding */ isOnCreatedOutlet),
/* harmony export */   isOnCreatedOutletDebounce: () => (/* binding */ isOnCreatedOutletDebounce)
/* harmony export */ });
/* harmony import */ var _ComponentBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _lifecycle_dr_this_OnDrThisUnBind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../lifecycle/dr-this/OnDrThisUnBind */ "../../packages/@dooboostore/dom-render/src/lifecycle/dr-this/OnDrThisUnBind.ts");
/* harmony import */ var _components_router_RouterOutlet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/router/RouterOutlet */ "../../packages/@dooboostore/dom-render/src/components/router/RouterOutlet.ts");



const isOnCreatedOutlet = (obj) => typeof obj?.onCreatedOutlet === 'function';
const isOnCreatedOutletDebounce = (obj) => typeof obj?.onCreatedOutletDebounce === 'function';
class ComponentRouterBase extends _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ComponentBase {
    // OnDrThisBind
    child;
    constructor(_config) {
        super(_config);
    }
    // get child() {
    //   return this._child;
    // }
    setChild(child) {
        console.log('setChild!!', child, this.name);
        if (child) {
            this.child = child;
        }
        else {
            this.child = undefined;
        }
        const routerOutletChildren = this.getChildren(_components_router_RouterOutlet__WEBPACK_IMPORTED_MODULE_2__.RouterOutlet.RouterOutlet);
        routerOutletChildren.forEach(it => {
            it.setValue(this.child);
        });
    }
    onDrThisUnBind() {
        super.onDrThisUnBind();
        if (this.child && (0,_lifecycle_dr_this_OnDrThisUnBind__WEBPACK_IMPORTED_MODULE_1__.isOnDrThisUnBind)(this.child?.obj)) {
            this.child.obj.onDrThisUnBind();
        }
    }
    onCreatedThisChildDebounce(childrenSet) {
        super.onCreatedThisChildDebounce(childrenSet);
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/ComponentSet.ts":
/*!*****************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/ComponentSet.ts ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ComponentSet: () => (/* binding */ ComponentSet)
/* harmony export */ });
/* harmony import */ var _types_Types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../types/Types */ "../../packages/@dooboostore/dom-render/src/types/Types.ts");

class ComponentSet {
    obj;
    _config;
    _template;
    _styles;
    constructor(obj, source, config) {
        this.obj = obj;
        this._template = source.template;
        this._styles = source.styles;
        this._config = _types_Types__WEBPACK_IMPORTED_MODULE_0__.DomRenderFinalProxy.final(Object.assign({ objPath: 'obj' }, config));
    }
    get template() {
        return this._template;
    }
    get styles() {
        return this._styles;
    }
    get config() {
        return this._config;
    }
    setTemplateStyle(set) {
        this._template = set.template;
        this._styles = set.styles;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/a/A.ts":
/*!********************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/a/A.ts ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (/* binding */ A),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _ComponentBase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _DomRender__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../DomRender */ "../../packages/@dooboostore/dom-render/src/DomRender.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");




var A;
(function (A_1) {
    A_1.selector = 'dr-a';
    class A extends _ComponentBase__WEBPACK_IMPORTED_MODULE_1__.ComponentBase {
        href = null;
        target = null;
        style = null;
        classAttr = null;
        drClass = null;
        click = null;
        replace = false;
        scrollToTop = true;
        element;
        onClick(event) {
            if (this.click) {
                const attributes = {
                    href: this.href,
                    target: this.target,
                    style: this.style,
                    class: this.classAttr,
                    replace: this.replace,
                    scrollToTop: this.scrollToTop
                };
                this.click({ event, attributes });
            }
            if (event.defaultPrevented) {
                return;
            }
            if (this.target !== '_blank' && this.href) {
                event.preventDefault();
                // console.log('scrollTop', this.scrollToTop);
                this.domRenderConfig?.router?.go({ path: this.href, replace: this.replace, scrollToTop: this.scrollToTop });
            }
        }
        onChangeAttrRender(name, value, other) {
            super.onChangeAttrRender(name, value, other);
            if (this.element && name.startsWith('attribute-')) {
                this.element.setAttribute(name, value);
            }
        }
        onAElementInit($element) {
            this.element = $element;
            this.getAttribute('onInit')?.($element);
            this.getAttributeNames()
                .filter(it => it.startsWith('attribute-'))
                .forEach(it => {
                const attrName = it.replace(/^attribute-/, '');
                const attrValue = this.getAttribute(it);
                this.element.setAttribute(attrName, attrValue);
            });
        }
    }
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({ converter: v => v || null }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], A.prototype, "href", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({ converter: v => v || null }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], A.prototype, "target", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({ converter: v => v || null }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], A.prototype, "style", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({ name: 'class', converter: v => v || null }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], A.prototype, "classAttr", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({ name: 'dr-class', converter: v => v || null }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], A.prototype, "drClass", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)(),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], A.prototype, "click", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({ converter: v => v !== null && String(v) !== 'false' }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], A.prototype, "replace", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({ converter: v => v !== null && String(v) !== 'false' }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], A.prototype, "scrollToTop", void 0);
    A_1.A = A;
})(A || (A = {}));
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
    a: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_3__.RawSet.createComponentTargetElement({
            name: A.selector,
            template: `<a
        href="\${@this@.href}$"
        target="\${@this@.target}$"
        style="\${@this@.style}$"
        class="\${@this@.classAttr}$"
        dr-event-click="@this@.onClick($event)"
        dr-class="\${@this@.drClass}$"
        dr-on-init="@this@.onAElementInit($element)"
      >#innerHTML#</a>`,
            objFactory: (e, o, r2, constructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_2__.DomRender.run({ rootObject: new A.A(...constructorParam), config });
            },
        });
    },
});


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/a/index.ts":
/*!************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/a/index.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (/* reexport safe */ _A__WEBPACK_IMPORTED_MODULE_0__.A)
/* harmony export */ });
/* harmony import */ var _A__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./A */ "../../packages/@dooboostore/dom-render/src/components/a/A.ts");



/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/appender/Appender.ts":
/*!**********************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/appender/Appender.ts ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Appender: () => (/* binding */ Appender),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _ComponentBase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _DomRender__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../DomRender */ "../../packages/@dooboostore/dom-render/src/DomRender.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");




var Appender;
(function (Appender_1) {
    Appender_1.selector = 'dr-appender';
    // @Component({
    //   template: '<div dr-appender="@this@.appender" dr-option-strip="true">#innerHTML#</div>',
    //   selector: `${selector}`
    // })
    class Appender extends _ComponentBase__WEBPACK_IMPORTED_MODULE_1__.ComponentBase {
        value;
        drOptionItemVariableName = null;
        // onCreateRender(...param: any) {
        //   console.log('--onCreateRender')
        // }
        // test() {
        //   console.log('t', this.getAttribute('appender'))
        // }
        // push(...data:D[]) {
        //   console.log('push/////', data);
        //   this.appender.push(...data);
        // }
        //
        // set(key: string, v: D): void {
        //   this.appender.set(key, v)
        // }
        //
        // delete(key: string): void {
        //   this.appender.delete(key);
        // }
        //
        // clear(): void {
        //   this.appender.clear();
        // }
        onChangeAttrRender(name, value, other) {
            super.onChangeAttrRender(name, value, other);
            if (this.equalsAttributeName(name, 'value')) {
                this.value = value;
            }
            // console.log('------>appender', name, value);
        }
    }
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({ name: 'dr-option-item-variable-name', converter: v => v || null }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], Appender.prototype, "drOptionItemVariableName", void 0);
    Appender_1.Appender = Appender;
})(Appender || (Appender = {}));
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
    appender: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_3__.RawSet.createComponentTargetElement({
            name: Appender.selector,
            template: '<div dr-appender="@this@.value" dr-option-item-variable-name="${@this@.drOptionItemVariableName}$" dr-option-strip="true">#innerHTML#</div>',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_2__.DomRender.run({ rootObject: new Appender.Appender(...counstructorParam), config: config });
            }
        });
    },
});


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/appender/index.ts":
/*!*******************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/appender/index.ts ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Appender: () => (/* reexport safe */ _Appender__WEBPACK_IMPORTED_MODULE_0__.Appender)
/* harmony export */ });
/* harmony import */ var _Appender__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Appender */ "../../packages/@dooboostore/dom-render/src/components/appender/Appender.ts");



/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/checkbox/CheckBox.ts":
/*!**********************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/checkbox/CheckBox.ts ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   CheckBox: () => (/* binding */ CheckBox),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _ComponentBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _DomRender__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../DomRender */ "../../packages/@dooboostore/dom-render/src/DomRender.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");



var CheckBox;
(function (CheckBox_1) {
    CheckBox_1.selector = 'dr-checkbox';
    class CheckBoxBase extends _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ComponentBase {
        hidden = true;
    }
    // @Component({
    //   template: '<div dr-if="!@this@.hidden" dr-strip="true">#innerHTML#</div>',
    //   styles: '',
    //   selector: `${selector}.Checked`
    // })
    class Checked extends CheckBoxBase {
        name = 'checked';
        constructor() {
            super({ onlyParentType: CheckBox });
        }
    }
    CheckBox_1.Checked = Checked;
    // @Component({
    //   template: '<div dr-if="!@this@.hidden" dr-strip="true">#innerHTML#</div>',
    //   styles: '',
    //   selector: `${selector}.UnChecked`
    // })
    class UnChecked extends CheckBoxBase {
        name = 'unChecked';
        constructor() {
            super({ onlyParentType: CheckBox });
        }
    }
    CheckBox_1.UnChecked = UnChecked;
    // @Component({
    //   template: template,
    //   styles: style,
    //   selector: `${selector}`
    // })
    class CheckBox extends _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ComponentBase {
        checked = false;
        inputElement;
        change(option, checked) {
            checked = checked ?? this.checked;
            this.checked = checked;
            this.setChildrenHidden(checked);
            this.getAttribute('change')?.(checked, option);
        }
        setChildrenHidden(checked) {
            this.getChildren(Checked).forEach(it => {
                it.hidden = !checked;
            });
            this.getChildren(UnChecked).forEach(it => {
                it.hidden = checked;
            });
        }
        onCreatedThisChild(child, childData) {
            super.onCreatedThisChild(child, childData);
            this.setChildrenHidden(this.checked);
        }
        onInitInputElement(element) {
            // console.log('---cr', element)
            this.inputElement = element;
            this.inputElement.checked = !!this.getAttribute('checked');
            this.change({ type: 'initialize' }, !!this.getAttribute('checked'));
        }
        onChangeAttrRender(name, val, other) {
            super.onChangeAttrRender(name, val, other);
            // console.log('Checkbox ChangeAttr------', name, val, this.inputElement)
            if (this.inputElement && this.getAttribute('checked') !== this.checked) {
                this.inputElement.checked = !!this.getAttribute('checked');
                this.change({ type: 'attributeChange' }, !!this.getAttribute('checked'));
            }
        }
    }
    CheckBox_1.CheckBox = CheckBox;
})(CheckBox || (CheckBox = {}));
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
    checkBoxChecked: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: `${CheckBox.selector}-checked`,
            template: '<div dr-if="!@this@.hidden" dr-option-strip="true">#innerHTML#</div>',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new CheckBox.Checked(), config: config });
            }
        });
    },
    checkBoxUnchecked: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: `${CheckBox.selector}-unchecked`,
            template: '<div dr-if="!@this@.hidden" dr-option-strip="true" >#innerHTML#</div>',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new CheckBox.UnChecked(), config: config });
            }
        });
    },
    checkBox: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: `${CheckBox.selector}`,
            template: '<label class="${@this@.getAttribute(\'class\')}$">\n' +
                '  <input\n' +
                '    name="${@this@.getAttribute(\'name\')}$"\n' +
                '    dr-on-init="@this@.onInitInputElement($element)"\n' +
                '    dr-event-change="@this@.change({type: \'event\'},$element.checked);"\n' +
                '    type="checkbox" hidden="hidden"/>\n' +
                '  #innerHTML#\n' +
                '</label>',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new CheckBox.CheckBox(...counstructorParam), config: config });
            }
        });
    }
});


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/checkbox/index.ts":
/*!*******************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/checkbox/index.ts ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   CheckBox: () => (/* reexport safe */ _CheckBox__WEBPACK_IMPORTED_MODULE_0__.CheckBox)
/* harmony export */ });
/* harmony import */ var _CheckBox__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CheckBox */ "../../packages/@dooboostore/dom-render/src/components/checkbox/CheckBox.ts");



/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/choose/Choose.ts":
/*!******************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/choose/Choose.ts ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Choose: () => (/* binding */ Choose),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _ComponentBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _DomRender__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../DomRender */ "../../packages/@dooboostore/dom-render/src/DomRender.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");



var Choose;
(function (Choose_1) {
    Choose_1.selector = 'dr-choose';
    class ChildOtherWiseBase extends _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ComponentBase {
        hidden = true;
    }
    class ChildBase extends ChildOtherWiseBase {
        data;
    }
    class When extends ChildBase {
        constructor() {
            super({ onlyParentType: (Choose) });
        }
    }
    Choose_1.When = When;
    class OtherWise extends ChildBase {
        constructor() {
            super({ onlyParentType: (Choose) });
        }
    }
    Choose_1.OtherWise = OtherWise;
    class Choose extends _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ComponentBase {
        choose;
        onCreatedThisChild(child, data) {
            super.onCreatedThisChild(child, data);
            this.setChange(child);
        }
        onChangeAttrRender(name, value, other) {
            super.onChangeAttrRender(name, value, other);
            if (this.equalsAttributeName(name, 'data')) {
                this.choose = undefined;
                const children = this.getChildren([When, OtherWise]).sort((a, b) => (a instanceof OtherWise ? 1 : 0) - (b instanceof OtherWise ? 1 : 0));
                children.forEach(it => this.setChange(it));
            }
        }
        setChange(child) {
            child.data = this.getAttribute('data');
            // when.hidden = true;
            console.log('eeeeeee?', child, child.getAttribute('test'), this.getAttribute('data'));
            if (!this.choose && child instanceof When && child.getAttribute('test')?.(this.getAttribute('data'))) {
                console.log('eeeeeee?2');
                // console.log('------------', child.attribute?.test?.(this.attribute?.data))
                this.choose = child;
                if (child.hidden) {
                    child.hidden = false;
                }
                // console.log('--------', when)
            }
            else if (this.choose !== child) {
                child.hidden = true;
            }
            console.log('eeeeeee?3');
            if (!this.choose && child instanceof OtherWise) {
                this.choose = child;
                if (child.hidden) {
                    child.hidden = false;
                }
            }
            console.log('eeeeeee?34');
        }
    }
    Choose_1.Choose = Choose;
})(Choose || (Choose = {}));
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
    chooseWhen: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: `${Choose.selector}-when`,
            template: '<div dr-if="!@this@.hidden" dr-option-strip="true" >#innerHTML#</div>',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new Choose.When(), config: config });
            }
        });
    },
    chooseOtherWise: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: `${Choose.selector}-other-wise`,
            template: '<div dr-if="!@this@.hidden" dr-option-strip="true" >#innerHTML#</div>',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new Choose.OtherWise(), config: config });
            }
        });
    },
    choose: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: `${Choose.selector}`,
            template: '#innerHTML#',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new Choose.Choose(...counstructorParam), config: config });
            }
        });
    }
});


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/choose/index.ts":
/*!*****************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/choose/index.ts ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Choose: () => (/* reexport safe */ _Choose__WEBPACK_IMPORTED_MODULE_0__.Choose)
/* harmony export */ });
/* harmony import */ var _Choose__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Choose */ "../../packages/@dooboostore/dom-render/src/components/choose/Choose.ts");



/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/details/Details.ts":
/*!********************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/details/Details.ts ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Details: () => (/* binding */ Details),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _ComponentBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _DomRender__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../DomRender */ "../../packages/@dooboostore/dom-render/src/DomRender.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/core-web/valid/ValidUtils */ "../../packages/@dooboostore/core-web/src/valid/ValidUtils.ts");
/* harmony import */ var _dooboostore_core_web_event_EventUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dooboostore/core-web/event/EventUtils */ "../../packages/@dooboostore/core-web/src/event/EventUtils.ts");





var Details;
(function (Details_1) {
    Details_1.selector = 'dr-details';
    // @Component({
    //   template: '<summary class="${`${@this@.getAttribute(\'class\')} details-summary-container`}$">#innerHTML#</summary>',
    //   styles: '',
    //   selector: `${selector}.Summary`
    // })
    class Summary extends _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ComponentBase {
        constructor() {
            super({ onlyParentType: [Details] });
        }
    }
    Details_1.Summary = Summary;
    // @Component({
    //   template: '<div class="${`${@this@.getAttribute(\'class\')} details-body-container details-body-${@this@.getAttribute(\'float\')}-container`}$" dr-on-init="@this@.$element = $element;">#innerHTML#</div>',
    //   selector: `${selector}.Body`
    // })
    class Body extends _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ComponentBase {
        $element;
        constructor() {
            super({ onlyParentType: [Details] });
        }
    }
    Details_1.Body = Body;
    Details_1.isBody = (instance) => {
        return instance instanceof Body;
    };
    // @Component({
    //   template: '<form class="${`${@this@.getAttribute(\'class\')} details-body-container details-body-${@this@.getAttribute(\'float\')}-container details-form-container`}$" dr-on-init="@this@.$element = $element;" dr-event-submit="@this@.submit($element,$event);">#innerHTML#</form>',
    //   styles: detailsFormStyle,
    //   selector: `${selector}.Form`
    // })
    class Form extends _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ComponentBase {
        $element;
        constructor() {
            super({ onlyParentType: [Details] });
        }
        submit(element, event) {
            if (this.hasAttribute('disabledSubmit')) {
                event.preventDefault();
            }
            if (this.hasAttribute('submit')) {
                this.getAttribute('submit')?.(event, element);
            }
        }
        reset() {
            this.$element?.reset();
        }
    }
    Details_1.Form = Form;
    Details_1.isForm = (instance) => {
        return instance instanceof Form;
    };
    // @Component({
    //   template: template,
    //   styles: style,
    //   // noStrip: true,
    //   selector: `${selector}`
    // })
    class Details extends _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ComponentBase {
        // private detailsElement?: HTMLDetailsElement;
        documentClickSubscription;
        toggleSubscription;
        element;
        onCreateRenderData(data) {
            super.onCreateRenderData(data);
        }
        onCreateRender(...param) { }
        toggle(element) {
            const toggleAttribute = this.getAttribute('toggle');
            if (toggleAttribute) {
                toggleAttribute?.(element.open);
            }
            if (element.open) {
                this.getAttribute('onOpen')?.();
            }
            else {
                this.getAttribute('onClose')?.();
            }
        }
        async onInitRender(param, rawSet) {
            await super.onInitRender(param, rawSet);
            if (_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_3__.ValidUtils.isBrowser() && this.rawSet?.dataSet.config.window) {
                const detailsElement = this.element;
                const document = this.rawSet.dataSet.config.window.document;
                this.documentClickSubscription = _dooboostore_core_web_event_EventUtils__WEBPACK_IMPORTED_MODULE_4__.EventUtils.htmlElementEventObservable(document, 'click').subscribe(event => {
                    if (this.getAttribute('disableOtherClickClose')) {
                        return;
                    }
                    if (detailsElement && !detailsElement?.contains(event?.target)) {
                        detailsElement.open = false;
                    }
                });
                if (detailsElement) {
                    this.toggleSubscription = _dooboostore_core_web_event_EventUtils__WEBPACK_IMPORTED_MODULE_4__.EventUtils.htmlElementEventObservable(detailsElement, 'toggle').subscribe(it => {
                        if (_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_3__.ValidUtils.coreValidUtils.isNotNullUndefined(this.getAttribute('toggle_form_reset'))) {
                            this.children?.filter(Details_1.isForm).forEach(it => {
                                it.reset();
                            });
                        }
                    });
                }
            }
            // console.log('aaaaaaaaaaaaaaaaaaaaa', rawSet);
        }
        onChangeAttrRender(name, value, other) {
            super.onChangeAttrRender(name, value, other);
        }
        onDestroyRender(...metaData) {
            this.toggleSubscription?.unsubscribe();
            this.documentClickSubscription?.unsubscribe();
            // console.log('onDestroyRender', metaData);
            // if (ValidUtils.isBrowser()) {
            //   document.removeEventListener('click', this.ccc)
            // }
        }
    }
    Details_1.Details = Details;
})(Details || (Details = {}));
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
    detailsSummary: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: `${Details.selector}-summary`,
            template: '<summary class="${`${@this@.getAttribute(\'class\')} details-summary-container`}$">#innerHTML#</summary>',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new Details.Summary(), config: config });
            }
        });
    },
    detailsBody: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: `${Details.selector}-body`,
            template: '<div class="${`${@this@.getAttribute(\'class\')} details-body-container details-body-${@this@.getAttribute(\'float\')}-container`}$" dr-on-init="@this@.$element = $element;">#innerHTML#</div>',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new Details.Body(), config: config });
            }
        });
    },
    detailsForm: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: `${Details.selector}-form`,
            template: '<form class="${`${@this@.getAttribute(\'class\')} details-body-container details-body-${@this@.getAttribute(\'float\')}-container details-form-container`}$" dr-on-init="@this@.$element = $element;" dr-event-submit="@this@.submit($element,$event);">#innerHTML#</form>',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new Details.Form(), config: config });
            }
        });
    },
    details: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: `${Details.selector}`,
            styles: `
        .details-container {
            position: relative;
        }

        .details-container .details-body-container {
            position: absolute;
        }


        .details-container .details-body-bottom-left-container {
            position: absolute;
            left: 0;
            top: 100%;
            /*margin-top: 0px;*/
            /*width: max-content;*/
        }

        .details-container .details-body-bottom-right-container {
            position: absolute;
            right: 0;
            top: 100%;
            /*margin-top: 0px;*/
            /*width: max-content;*/
        }

        .details-container .details-body-top-left-container {
            position: absolute;
            left: 0;
            bottom: 100%;
            /*margin-bottom: 0px;*/
            /*width: max-content;*/
        }

        .details-container .details-body-top-right-container {
            position: absolute;
            right: 0;
            bottom: 100%;
            /*margin-bottom: 0px;*/
        }
      `,
            template: '<details class="${`${@this@.getAttribute(\'class\')} details-container`}$" dr-on-init="@this@.element = $element;" dr-event-toggle="@this@.toggle($element)"> #innerHTML# </details>',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new Details.Details(...counstructorParam), config: config });
            }
        });
    }
});


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/details/index.ts":
/*!******************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/details/index.ts ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Details: () => (/* reexport safe */ _Details__WEBPACK_IMPORTED_MODULE_0__.Details)
/* harmony export */ });
/* harmony import */ var _Details__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Details */ "../../packages/@dooboostore/dom-render/src/components/details/Details.ts");



/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/forOf/ForOf.ts":
/*!****************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/forOf/ForOf.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ForOf: () => (/* binding */ ForOf),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _ComponentBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _DomRender__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../DomRender */ "../../packages/@dooboostore/dom-render/src/DomRender.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");



var ForOf;
(function (ForOf_1) {
    ForOf_1.selector = 'dr-for-of';
    // @Component({
    //   template: '<div dr-for-of="@this@.data" dr-option-strip="true">#innerHTML#</div>',
    //   selector: `${selector}`
    // })
    class ForOf extends _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ComponentBase {
        value;
        onChangeAttrRender(name, value, other) {
            super.onChangeAttrRender(name, value, other);
            if (this.equalsAttributeName(name, 'value')) {
                this.value = value;
            }
        }
    }
    ForOf_1.ForOf = ForOf;
})(ForOf || (ForOf = {}));
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
    forOf: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: ForOf.selector,
            template: '<div dr-for-of="@this@.value" >#innerHTML#</div>',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new ForOf.ForOf(...counstructorParam), config: config });
            }
        });
    }
});


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/forOf/index.ts":
/*!****************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/forOf/index.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ForOf: () => (/* reexport safe */ _ForOf__WEBPACK_IMPORTED_MODULE_0__.ForOf)
/* harmony export */ });
/* harmony import */ var _ForOf__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ForOf */ "../../packages/@dooboostore/dom-render/src/components/forOf/ForOf.ts");



/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/if/If.ts":
/*!**********************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/if/If.ts ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   If: () => (/* binding */ If),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _ComponentBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _DomRender__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../DomRender */ "../../packages/@dooboostore/dom-render/src/DomRender.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");



var If;
(function (If_1) {
    If_1.selector = 'dr-if';
    class If extends _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ComponentBase {
        sw = false;
        async onInitRender(param, rawSet) {
            super.onInitRender(param, rawSet);
        }
        onChangeAttrRender(name, value, other) {
            super.onChangeAttrRender(name, value, other);
            if (this.equalsAttributeName(name, 'value')) {
                // console.log('--', value, typeof value);
                this.sw = value;
            }
        }
    }
    If_1.If = If;
})(If || (If = {}));
// const iif = DomRender.createComponent({
//   type: If.If,
//   tagName: If.selector,
//   template: '<div dr-if="@this@.sw" dr-option-strip="true">#innerHTML#</div>' });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
    if: (config) => {
        // if (!customElements.get(If.selector)) {
        //   customElements.define(If.selector, class extends HTMLElement {
        //     constructor() {
        //       super();
        //       this.hidden = true;
        //     }
        //   });
        // }
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: If.selector,
            template: '<div dr-if="@this@.sw" dr-option-strip="true" >#innerHTML#</div>',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new If.If(...counstructorParam), config: config });
            }
        });
    }
});


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/if/index.ts":
/*!*************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/if/index.ts ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   If: () => (/* reexport safe */ _If__WEBPACK_IMPORTED_MODULE_0__.If)
/* harmony export */ });
/* harmony import */ var _If__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./If */ "../../packages/@dooboostore/dom-render/src/components/if/If.ts");



/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/index.ts":
/*!**********************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/index.ts ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (/* reexport safe */ _a__WEBPACK_IMPORTED_MODULE_3__.A),
/* harmony export */   ATTRIBUTE_METADATA_KEY: () => (/* reexport safe */ _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ATTRIBUTE_METADATA_KEY),
/* harmony export */   Appender: () => (/* reexport safe */ _appender__WEBPACK_IMPORTED_MODULE_4__.Appender),
/* harmony export */   CheckBox: () => (/* reexport safe */ _checkbox__WEBPACK_IMPORTED_MODULE_5__.CheckBox),
/* harmony export */   Choose: () => (/* reexport safe */ _choose__WEBPACK_IMPORTED_MODULE_6__.Choose),
/* harmony export */   ComponentBase: () => (/* reexport safe */ _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ComponentBase),
/* harmony export */   ComponentRouterBase: () => (/* reexport safe */ _ComponentRouterBase__WEBPACK_IMPORTED_MODULE_1__.ComponentRouterBase),
/* harmony export */   ComponentSet: () => (/* reexport safe */ _ComponentSet__WEBPACK_IMPORTED_MODULE_2__.ComponentSet),
/* harmony export */   Details: () => (/* reexport safe */ _details__WEBPACK_IMPORTED_MODULE_7__.Details),
/* harmony export */   EVENT_METADATA_KEY: () => (/* reexport safe */ _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.EVENT_METADATA_KEY),
/* harmony export */   ForOf: () => (/* reexport safe */ _forOf__WEBPACK_IMPORTED_MODULE_8__.ForOf),
/* harmony export */   If: () => (/* reexport safe */ _if__WEBPACK_IMPORTED_MODULE_9__.If),
/* harmony export */   Input: () => (/* reexport safe */ _input__WEBPACK_IMPORTED_MODULE_10__.Input),
/* harmony export */   PromiseSwitch: () => (/* reexport safe */ _promise__WEBPACK_IMPORTED_MODULE_11__.PromiseSwitch),
/* harmony export */   QUERY_METADATA_KEY: () => (/* reexport safe */ _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.QUERY_METADATA_KEY),
/* harmony export */   Radio: () => (/* reexport safe */ _radio__WEBPACK_IMPORTED_MODULE_12__.Radio),
/* harmony export */   Route: () => (/* reexport safe */ _router__WEBPACK_IMPORTED_MODULE_13__.Route),
/* harmony export */   RouterOutlet: () => (/* reexport safe */ _router__WEBPACK_IMPORTED_MODULE_13__.RouterOutlet),
/* harmony export */   Select: () => (/* reexport safe */ _select__WEBPACK_IMPORTED_MODULE_14__.Select),
/* harmony export */   This: () => (/* reexport safe */ _this__WEBPACK_IMPORTED_MODULE_15__.This),
/* harmony export */   Timer: () => (/* reexport safe */ _timer__WEBPACK_IMPORTED_MODULE_16__.Timer),
/* harmony export */   attribute: () => (/* reexport safe */ _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.attribute),
/* harmony export */   drComponent: () => (/* binding */ drComponent),
/* harmony export */   event: () => (/* reexport safe */ _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.event),
/* harmony export */   isOnCreatedOutlet: () => (/* reexport safe */ _ComponentRouterBase__WEBPACK_IMPORTED_MODULE_1__.isOnCreatedOutlet),
/* harmony export */   isOnCreatedOutletDebounce: () => (/* reexport safe */ _ComponentRouterBase__WEBPACK_IMPORTED_MODULE_1__.isOnCreatedOutletDebounce),
/* harmony export */   query: () => (/* reexport safe */ _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.query)
/* harmony export */ });
/* harmony import */ var _ComponentBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _ComponentRouterBase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ComponentRouterBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentRouterBase.ts");
/* harmony import */ var _ComponentSet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ComponentSet */ "../../packages/@dooboostore/dom-render/src/components/ComponentSet.ts");
/* harmony import */ var _a__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./a */ "../../packages/@dooboostore/dom-render/src/components/a/index.ts");
/* harmony import */ var _appender__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./appender */ "../../packages/@dooboostore/dom-render/src/components/appender/index.ts");
/* harmony import */ var _checkbox__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./checkbox */ "../../packages/@dooboostore/dom-render/src/components/checkbox/index.ts");
/* harmony import */ var _choose__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./choose */ "../../packages/@dooboostore/dom-render/src/components/choose/index.ts");
/* harmony import */ var _details__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./details */ "../../packages/@dooboostore/dom-render/src/components/details/index.ts");
/* harmony import */ var _forOf__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./forOf */ "../../packages/@dooboostore/dom-render/src/components/forOf/index.ts");
/* harmony import */ var _if__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./if */ "../../packages/@dooboostore/dom-render/src/components/if/index.ts");
/* harmony import */ var _input__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./input */ "../../packages/@dooboostore/dom-render/src/components/input/index.ts");
/* harmony import */ var _promise__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./promise */ "../../packages/@dooboostore/dom-render/src/components/promise/index.ts");
/* harmony import */ var _radio__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./radio */ "../../packages/@dooboostore/dom-render/src/components/radio/index.ts");
/* harmony import */ var _router__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./router */ "../../packages/@dooboostore/dom-render/src/components/router/index.ts");
/* harmony import */ var _select__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./select */ "../../packages/@dooboostore/dom-render/src/components/select/index.ts");
/* harmony import */ var _this__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./this */ "../../packages/@dooboostore/dom-render/src/components/this/index.ts");
/* harmony import */ var _timer__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./timer */ "../../packages/@dooboostore/dom-render/src/components/timer/index.ts");
/* harmony import */ var _if_If__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./if/If */ "../../packages/@dooboostore/dom-render/src/components/if/If.ts");
/* harmony import */ var _this_This__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./this/This */ "../../packages/@dooboostore/dom-render/src/components/this/This.ts");
/* harmony import */ var _appender_Appender__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./appender/Appender */ "../../packages/@dooboostore/dom-render/src/components/appender/Appender.ts");
/* harmony import */ var _promise_PromiseSwitch__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./promise/PromiseSwitch */ "../../packages/@dooboostore/dom-render/src/components/promise/PromiseSwitch.ts");
/* harmony import */ var _choose_Choose__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./choose/Choose */ "../../packages/@dooboostore/dom-render/src/components/choose/Choose.ts");
/* harmony import */ var _checkbox_CheckBox__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./checkbox/CheckBox */ "../../packages/@dooboostore/dom-render/src/components/checkbox/CheckBox.ts");
/* harmony import */ var _radio_Radio__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./radio/Radio */ "../../packages/@dooboostore/dom-render/src/components/radio/Radio.ts");
/* harmony import */ var _router_RouterOutlet__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./router/RouterOutlet */ "../../packages/@dooboostore/dom-render/src/components/router/RouterOutlet.ts");
/* harmony import */ var _select_Select__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./select/Select */ "../../packages/@dooboostore/dom-render/src/components/select/Select.ts");
/* harmony import */ var _timer_Timer__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ./timer/Timer */ "../../packages/@dooboostore/dom-render/src/components/timer/Timer.ts");
/* harmony import */ var _details_Details__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./details/Details */ "../../packages/@dooboostore/dom-render/src/components/details/Details.ts");
/* harmony import */ var _input_Input__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./input/Input */ "../../packages/@dooboostore/dom-render/src/components/input/Input.ts");
/* harmony import */ var _router_Route__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./router/Route */ "../../packages/@dooboostore/dom-render/src/components/router/Route.ts");
/* harmony import */ var _a_A__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./a/A */ "../../packages/@dooboostore/dom-render/src/components/a/A.ts");
/* harmony import */ var _forOf_ForOf__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./forOf/ForOf */ "../../packages/@dooboostore/dom-render/src/components/forOf/ForOf.ts");
































const drComponent = {
    ..._if_If__WEBPACK_IMPORTED_MODULE_17__["default"],
    ..._this_This__WEBPACK_IMPORTED_MODULE_18__["default"],
    ..._appender_Appender__WEBPACK_IMPORTED_MODULE_19__["default"],
    ..._promise_PromiseSwitch__WEBPACK_IMPORTED_MODULE_20__["default"],
    ..._choose_Choose__WEBPACK_IMPORTED_MODULE_21__["default"],
    ..._checkbox_CheckBox__WEBPACK_IMPORTED_MODULE_22__["default"],
    ..._radio_Radio__WEBPACK_IMPORTED_MODULE_23__["default"],
    ..._select_Select__WEBPACK_IMPORTED_MODULE_25__["default"],
    ..._timer_Timer__WEBPACK_IMPORTED_MODULE_26__["default"],
    ..._details_Details__WEBPACK_IMPORTED_MODULE_27__["default"],
    ..._input_Input__WEBPACK_IMPORTED_MODULE_28__["default"],
    ..._router_Route__WEBPACK_IMPORTED_MODULE_29__["default"],
    ..._router_RouterOutlet__WEBPACK_IMPORTED_MODULE_24__["default"],
    ..._a_A__WEBPACK_IMPORTED_MODULE_30__["default"],
    ..._forOf_ForOf__WEBPACK_IMPORTED_MODULE_31__["default"]
};


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/input/Input.ts":
/*!****************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/input/Input.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Input: () => (/* binding */ Input),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _ComponentBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _DomRender__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../DomRender */ "../../packages/@dooboostore/dom-render/src/DomRender.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/core/valid/ValidUtils */ "../../packages/@dooboostore/core/src/valid/ValidUtils.ts");
/* harmony import */ var _dooboostore_core_message_operators_map__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dooboostore/core/message/operators/map */ "../../packages/@dooboostore/core/src/message/operators/map.ts");
/* harmony import */ var _dooboostore_core_web_event_EventUtils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @dooboostore/core-web/event/EventUtils */ "../../packages/@dooboostore/core-web/src/event/EventUtils.ts");
/* harmony import */ var _dooboostore_core_message_operators_debounceTime__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @dooboostore/core/message/operators/debounceTime */ "../../packages/@dooboostore/core/src/message/operators/debounceTime.ts");
/* harmony import */ var _dooboostore_core_message_operators_distinctUntilChanged__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @dooboostore/core/message/operators/distinctUntilChanged */ "../../packages/@dooboostore/core/src/message/operators/distinctUntilChanged.ts");








var Input;
(function (Input_1) {
    Input_1.selector = `dr-input`;
    class Base extends _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ComponentBase {
    }
    Input_1.Base = Base;
    // @Component({
    //   selector: `${selector}`,
    //   template,
    //   styles,
    // })
    class Input extends Base {
        element;
        inputSubscription;
        resetSubscripton;
        onCreateRender(...param) { }
        async onInitRender(param, rawSet) {
            await super.onInitRender(param, rawSet);
            // console.log('dr-input, rawSet', rawSet)
            const inputElement = this.element;
            const debounceTimeAttribute = this.getAttribute('debounceTime');
            const debounceTimeValue = _dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_3__.ValidUtils.isNotNullUndefined(debounceTimeAttribute)
                ? Number(debounceTimeAttribute)
                : 0;
            const distinct = _dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_3__.ValidUtils.isNotNullUndefined(this.getAttribute('distinct'));
            if (inputElement) {
                const makeDeboundceDistinctUtilChanged = () => {
                    // let result$ = EventUtils.htmlElementEventObservable(inputElement,'input');
                    let result$ = _dooboostore_core_web_event_EventUtils__WEBPACK_IMPORTED_MODULE_5__.EventUtils.htmlElementEventObservable(inputElement, 'input').pipe((0,_dooboostore_core_message_operators_map__WEBPACK_IMPORTED_MODULE_4__.map)((event) => {
                        const target = event.target;
                        if (target instanceof HTMLInputElement) {
                            return target.value.trim();
                        }
                        console.warn('Input event target is not an HTMLInputElement:', target);
                        return '';
                    }));
                    if (_dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_3__.ValidUtils.isNotNullUndefined(debounceTimeValue) && debounceTimeValue > 0) {
                        result$ = result$.pipe((0,_dooboostore_core_message_operators_debounceTime__WEBPACK_IMPORTED_MODULE_6__.debounceTime)(debounceTimeValue));
                    }
                    if (_dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_3__.ValidUtils.isNotNullUndefined(distinct) && distinct === true) {
                        result$ = result$.pipe((0,_dooboostore_core_message_operators_distinctUntilChanged__WEBPACK_IMPORTED_MODULE_7__.distinctUntilChanged)());
                    }
                    return result$;
                };
                this.inputSubscription = makeDeboundceDistinctUtilChanged().subscribe(it => {
                    // console.log('change?????????????', it);
                    this.getAttribute('input')?.(it, inputElement);
                });
                if (inputElement.form) {
                    this.resetSubscripton = _dooboostore_core_web_event_EventUtils__WEBPACK_IMPORTED_MODULE_5__.EventUtils.htmlElementEventObservable(inputElement.form, 'reset').subscribe(it => {
                        // console.log('rrrraaa?,', this.inputSubscription, it)
                        this.inputSubscription?.unsubscribe();
                        this.inputSubscription = makeDeboundceDistinctUtilChanged().subscribe(it => {
                            // console.log('rrrr?')
                            this.getAttribute('input')?.(it, inputElement);
                        });
                    });
                }
            }
        }
        onChangeAttrRender(name, value, other) {
            super.onChangeAttrRender(name, value, other);
            // console.log('-------->',name, value)
            if (name === 'value') {
                // console.log('changeAttribu', name, value)
                // this.wow = {value: value};
                // this.name = value;
            }
        }
        onDestroyRender(metaData) {
            this.resetSubscripton?.unsubscribe();
            this.inputSubscription?.unsubscribe();
        }
    }
    Input_1.Input = Input;
})(Input || (Input = {}));
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
    input: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: `${Input.selector}`,
            template: '<Input type="${@this@.getAttribute(\'type\')}$" class="${@this@.getAttribute(\'class\')}$" id="${@this@.getAttribute(\'id\')}$" name="${@this@.getAttribute(\'name\')}$" dr-on-init="@this@.element=$element" >#innerHTML#',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new Input.Input(...counstructorParam), config: config });
            }
        });
    }
});


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/input/index.ts":
/*!****************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/input/index.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Input: () => (/* reexport safe */ _Input__WEBPACK_IMPORTED_MODULE_0__.Input)
/* harmony export */ });
/* harmony import */ var _Input__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Input */ "../../packages/@dooboostore/dom-render/src/components/input/Input.ts");



/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/promise/PromiseSwitch.ts":
/*!**************************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/promise/PromiseSwitch.ts ***!
  \**************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   PromiseSwitch: () => (/* binding */ PromiseSwitch),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _ComponentBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _DomRender__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../DomRender */ "../../packages/@dooboostore/dom-render/src/DomRender.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/core/valid/ValidUtils */ "../../packages/@dooboostore/core/src/valid/ValidUtils.ts");
/* harmony import */ var _dooboostore_core_promise_Promises__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dooboostore/core/promise/Promises */ "../../packages/@dooboostore/core/src/promise/Promises.ts");





var PromiseSwitch;
(function (PromiseSwitch_1) {
    PromiseSwitch_1.selector = 'dr-promise-switch';
    class ChildBase extends _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ComponentBase {
        hidden = true;
    }
    // @Component({
    //   template: '<div dr-if="!@this@.hidden" dr-strip="true">#innerHTML#</div>',
    //   selector: `${selector}.Default`
    // })
    class Default extends ChildBase {
    }
    PromiseSwitch_1.Default = Default;
    // @Component({
    //   template: '<div dr-if="!@this@.hidden" dr-strip="true">#innerHTML#</div>',
    //   selector: `${selector}.Pending`
    //   // selector: `System-PromiseSwitch.Pending`
    // })
    class Pending extends ChildBase {
    }
    PromiseSwitch_1.Pending = Pending;
    // @Component({
    //   template: '<div dr-if="!@this@.hidden" dr-strip="true">#innerHTML#</div>',
    //   selector: `${selector}.Fulfilled`
    // })
    class Fulfilled extends ChildBase {
        data;
        setData(data) {
            this.data = data;
        }
    }
    PromiseSwitch_1.Fulfilled = Fulfilled;
    // @Component({
    //   template: '<div dr-if="!@this@.hidden" dr-strip="true">#innerHTML#</div>',
    //   selector: `${selector}.Rejected`
    // })
    class Rejected extends ChildBase {
        data;
        setData(data) {
            this.data = data;
        }
    }
    PromiseSwitch_1.Rejected = Rejected;
    /*
        <dr-promise-switch data="${@this@.pickWorldPromise}$">
          ${@nearThis@.promiseState.status}$
          <dr-promise-switch-default>
              <button class="random-world-button" dr-event-click="@this@.pickWorld()">
                  <i class="fa-solid fa-dice"></i>
              </button>
          </dr-promise-switch-default>
          <dr-promise-switch-pending>
              <button class="random-world-button disabled spin" >
                  <i class="fa-solid fa-dice"></i>
              </button>
          </dr-promise-switch-pending>
      </dr-promise-switch>
     */
    // @Component({
    //   template: '#innerHTML#',
    //   selector: `${selector}`
    // })
    class PromiseSwitch extends _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ComponentBase {
        // private promise?:  {
        //   state: 'reject' | 'resolve',
        //
        // }
        promiseState;
        state;
        onCreatedThisChild(child, data) {
            super.onCreatedThisChild(child, data);
            this.childStateChange();
        }
        childStateChange() {
            const defaults = this.getChildren(Default);
            const pendings = this.getChildren(Pending);
            const fulfilleds = this.getChildren(Fulfilled);
            const rejecteds = this.getChildren(Rejected);
            const full = [...fulfilleds, ...rejecteds, ...pendings, ...defaults];
            // console.log('----!!!!!!-------', this.promiseState, full)
            if (this.promiseState === undefined) {
                this.state = undefined;
                full.filter(it => !it.hidden).forEach(it => (it.hidden = true));
                defaults.filter(it => it.hidden).forEach(it => (it.hidden = false));
                pendings.filter(it => it.getAttribute('defaultView') && it.hidden).forEach(it => (it.hidden = false));
            }
            else if (this.promiseState.status === 'pending') {
                this.state = 'pending';
                full.filter(it => !it.hidden).forEach(it => (it.hidden = true));
                pendings.filter(it => it.hidden).forEach(it => (it.hidden = false));
            }
            else if (this.promiseState.status === 'fulfilled') {
                this.state = 'fulfilled';
                const value = this.promiseState.value;
                // console.log('-----------fulfilled promises', value);
                full.filter(it => !it.hidden).forEach(it => (it.hidden = true));
                fulfilleds.forEach(it => {
                    it.setData(value);
                });
                fulfilleds.filter(it => it.hidden).forEach(it => (it.hidden = false));
            }
            else if (this.promiseState.status === 'rejected') {
                this.state = 'rejected';
                const value = this.promiseState.reason;
                full.filter(it => !it.hidden).forEach(it => (it.hidden = true));
                rejecteds.forEach(it => {
                    it.setData(value);
                });
                rejecteds.filter(it => it.hidden).forEach(it => (it.hidden = false));
            }
            return this.state;
            // console.log('----!!!!!!-end------', this.promiseState, full.map(it=>it.hidden))
        }
        onChangeAttrRender(name, value, other) {
            super.onChangeAttrRender(name, value, other);
            // console.log('-----------changer promises', name, value, this.getChildren(Default));
            if (this.equalsAttributeName(name, 'data') && value) {
                // this.childStateChange();
                this.promiseState = undefined;
                this.state = undefined;
                this.promiseState = _dooboostore_core_promise_Promises__WEBPACK_IMPORTED_MODULE_4__.Promises.Result.wrap(typeof value === 'function' ? value() : value);
                this.getAttribute('change')?.({ status: 'pending' });
                this.childStateChange();
                // console.log('----?', this.promiseState)
                this.promiseState
                    .then(data => {
                    // console.log('------------then', data);
                    this.childStateChange();
                    this.getAttribute('change')?.({ status: 'fulfilled', data: data });
                    return data;
                })
                    .catch(e => {
                    // console.log('catch', e)
                    this.childStateChange();
                    this.getAttribute('change')?.({ status: 'rejected', data: e });
                    throw e;
                })
                    .finally(() => {
                    // console.log('-------------finally--------rrrrrrrrrrr', this.promiseState)
                    // this.childStateChange();
                    this.getAttribute('change')?.({ status: 'finally' });
                });
                // await this.promiseState;
                // console.log('---------------------rrrrrrrrrrr', this.promiseState)
            }
            else if (this.equalsAttributeName(name, 'data') && _dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_3__.ValidUtils.isNullOrUndefined(value)) {
                this.promiseState = undefined;
                this.childStateChange();
            }
        }
    }
    PromiseSwitch_1.PromiseSwitch = PromiseSwitch;
})(PromiseSwitch || (PromiseSwitch = {}));
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
    promiseDefault: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: `${PromiseSwitch.selector}-default`,
            template: '<div dr-if="!@this@.hidden" dr-option-strip="true">#innerHTML#</div>',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new PromiseSwitch.Default(...counstructorParam), config: config });
            }
        });
    },
    promisePending: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: `${PromiseSwitch.selector}-pending`,
            template: '<div dr-if="!@this@.hidden" dr-option-strip="true">#innerHTML#</div>',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new PromiseSwitch.Pending(...counstructorParam), config: config });
            }
        });
    },
    promiseFulfilled: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: `${PromiseSwitch.selector}-fulfilled`,
            template: '<div dr-if="!@this@.hidden" dr-option-strip="true">#innerHTML#</div>',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new PromiseSwitch.Fulfilled(...counstructorParam), config: config });
            }
        });
    },
    promiseRejected: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: `${PromiseSwitch.selector}-rejected`,
            template: '<div dr-if="!@this@.hidden" dr-option-strip="true">#innerHTML#</div>',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new PromiseSwitch.Rejected(...counstructorParam), config: config });
            }
        });
    },
    promiseSwitch: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: `${PromiseSwitch.selector}`,
            template: '#innerHTML#',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new PromiseSwitch.PromiseSwitch(...counstructorParam), config: config });
            }
        });
    }
});


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/promise/index.ts":
/*!******************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/promise/index.ts ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   PromiseSwitch: () => (/* reexport safe */ _PromiseSwitch__WEBPACK_IMPORTED_MODULE_0__.PromiseSwitch)
/* harmony export */ });
/* harmony import */ var _PromiseSwitch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./PromiseSwitch */ "../../packages/@dooboostore/dom-render/src/components/promise/PromiseSwitch.ts");



/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/radio/Radio.ts":
/*!****************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/radio/Radio.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Radio: () => (/* binding */ Radio),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _ComponentBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _DomRender__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../DomRender */ "../../packages/@dooboostore/dom-render/src/DomRender.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");



var Radio;
(function (Radio_1) {
    Radio_1.selector = 'System:Radio';
    class RadioBase extends _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ComponentBase {
        hidden = true;
    }
    class Checked extends RadioBase {
        name = 'Checked';
        constructor() {
            super({ onlyParentType: Radio });
        }
    }
    Radio_1.Checked = Checked;
    class UnChecked extends RadioBase {
        name = 'unChecked';
        constructor() {
            super({ onlyParentType: Radio });
        }
    }
    Radio_1.UnChecked = UnChecked;
    class Radio extends _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ComponentBase {
        checked = false;
        inputElement;
        change(checked) {
            checked = checked ?? this.checked;
            this.checked = checked;
            this.setChildrenHidden(checked);
            console.log('radio checked!!!!!!!', checked, this.checked, this.inputElement?.checked);
            if (this.getAttribute('on_change_checked')) {
                this.getAttribute('on_change_checked')?.(checked, this.inputElement);
            }
        }
        setChildrenHidden(checked) {
            this.getChildren(Checked).forEach(it => {
                it.hidden = !checked;
            });
            this.getChildren(UnChecked).forEach(it => {
                it.hidden = checked;
            });
        }
        onCreatedThisChild(child, childData) {
            super.onCreatedThisChild(child, childData);
            this.setChildrenHidden(this.checked);
        }
        onInitInputElement(element) {
            this.inputElement = element;
        }
        onChangeAttrRender(name, val, other) {
            super.onChangeAttrRender(name, val, other);
            if (this.inputElement && this.getAttribute('checked') !== this.checked) {
                this.inputElement.checked = !!this.getAttribute('checked');
                console.log('----changeAttribute', this.getAttribute('checked'));
                this.change(!!this.getAttribute('checked'));
            }
        }
    }
    Radio_1.Radio = Radio;
})(Radio || (Radio = {}));
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
    radioChecked: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: `${Radio.selector}-checked`,
            template: '<div dr-if="!@this@.hidden" dr-option-strip="true" >#innerHTML#</div>',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new Radio.Checked(), config: config });
            }
        });
    },
    radioUnChecked: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: `${Radio.selector}-unchecked`,
            template: '<div dr-if="!@this@.hidden" dr-option-strip="true" >#innerHTML#</div>',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new Radio.UnChecked(), config: config });
            }
        });
    },
    radio: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: `${Radio.selector}`,
            template: '<label class="${@this@.getAttribute(\'class\')}$">\n' +
                '  <input\n' +
                '    name="${@this@.getAttribute(\'name\')}$"\n' +
                '    checked="${@this@.getAttribute(\'checked\')}$"\n' +
                '    value="${@this@.getAttribute(\'value\')}$"\n' +
                '    dr-on-init="@this@.onInitInputElement($element)"\n' +
                '    dr-event-change="@this@.change($element.checked);"\n' +
                '    type="radio"\n' +
                '\n' +
                '  />\n' +
                "  ${@this@.getAttribute('checked')}$\n" +
                '  #innerHTML#\n' +
                '</label>',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new Radio.Radio(...counstructorParam), config: config });
            }
        });
    }
});


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/radio/index.ts":
/*!****************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/radio/index.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Radio: () => (/* reexport safe */ _Radio__WEBPACK_IMPORTED_MODULE_0__.Radio)
/* harmony export */ });
/* harmony import */ var _Radio__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Radio */ "../../packages/@dooboostore/dom-render/src/components/radio/Radio.ts");



/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/router/Route.ts":
/*!*****************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/router/Route.ts ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Route: () => (/* binding */ Route),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _ComponentBase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _DomRender__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../DomRender */ "../../packages/@dooboostore/dom-render/src/DomRender.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../decorators/DomRenderNoProxy */ "../../packages/@dooboostore/dom-render/src/decorators/DomRenderNoProxy.ts");





var Route;
(function (Route) {
    Route.selector = 'dr-route';
    class CheckerBase extends _ComponentBase__WEBPACK_IMPORTED_MODULE_1__.ComponentBase {
        sw = false;
        value;
        inputDomRenderConfig;
        routerSubscription;
        constructor(domRenderConfig) {
            super();
            this.inputDomRenderConfig = domRenderConfig;
        }
        async onInitRender(param, rawSet) {
            await super.onInitRender(param, rawSet);
            this.routerSubscription = this.inputDomRenderConfig?.router?.observable.subscribe(it => {
                if (this.value && this.inputDomRenderConfig) {
                    this.sw = this.check(this.inputDomRenderConfig);
                }
                else {
                    this.sw = false;
                }
            });
        }
        onDrThisBind() {
            super.onDrThisBind();
        }
        onDrThisUnBind() {
            super.onDrThisUnBind();
        }
        onDestroyRender(data) {
            super.onDestroyRender(data);
            this.routerSubscription?.unsubscribe();
        }
    }
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({ name: 'value' }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", String)
    ], CheckerBase.prototype, "value", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_4__.DomRenderNoProxy,
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], CheckerBase.prototype, "inputDomRenderConfig", void 0);
    class Match extends CheckerBase {
        check(config) {
            return !!config?.router?.test(this.value);
        }
    }
    Route.Match = Match;
    class Regexp extends CheckerBase {
        check(config) {
            return !!config?.router?.testRegexp(this.value);
        }
    }
    Route.Regexp = Regexp;
})(Route || (Route = {}));
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
    match: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_3__.RawSet.createComponentTargetElement({
            name: `${Route.selector}-match`,
            template: '<div dr-if="@this@.sw" dr-option-strip="true">#innerHTML#</div>',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_2__.DomRender.run({ rootObject: new Route.Match(config), config: config });
            }
        });
    },
    regexp: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_3__.RawSet.createComponentTargetElement({
            name: `${Route.selector}-regexp`,
            template: '<div dr-if="@this@.sw" dr-option-strip="true">#innerHTML#</div>',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_2__.DomRender.run({ rootObject: new Route.Regexp(config), config: config });
            }
        });
    }
});


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/router/RouterOutlet.ts":
/*!************************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/router/RouterOutlet.ts ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   RouterOutlet: () => (/* binding */ RouterOutlet),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _ComponentBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _lifecycle_OnChangeAttrRender__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../lifecycle/OnChangeAttrRender */ "../../packages/@dooboostore/dom-render/src/lifecycle/OnChangeAttrRender.ts");
/* harmony import */ var _components_ComponentSet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../components/ComponentSet */ "../../packages/@dooboostore/dom-render/src/components/ComponentSet.ts");
/* harmony import */ var _components_ComponentRouterBase__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../components/ComponentRouterBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentRouterBase.ts");





var RouterOutlet;
(function (RouterOutlet_1) {
    RouterOutlet_1.selector = 'dr-router-outlet';
    class RouterOutlet extends _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ComponentBase {
        value;
        if = null;
        createArguments;
        childObject;
        childRawSet;
        sw = false;
        setValue(value) {
            this.sw = false;
            setTimeout(() => {
                this.value = value;
            }, 0);
            setTimeout(() => {
                this.sw = true;
            }, 0);
            // console.log('sssssssssss');
        }
        async onInitRender(param, rawSet) {
            await super.onInitRender(param, rawSet);
            const c = this.getParentThis();
            const userValue = this.getAttribute('value');
            if (typeof userValue === 'string') {
                this.setValue(c[userValue]);
            }
            else if (userValue instanceof _components_ComponentSet__WEBPACK_IMPORTED_MODULE_3__.ComponentSet) {
                this.setValue(userValue);
            }
            else if (!userValue && c instanceof _components_ComponentRouterBase__WEBPACK_IMPORTED_MODULE_4__.ComponentRouterBase) {
                this.setValue(c.child);
            }
            // console.log('------',c);
        }
        onDestroyRender(data) {
            super.onDestroyRender(data);
        }
        onDestroy() {
            super.onDestroy();
        }
        onChangeAttrRender(name, value, other) {
            super.onChangeAttrRender(name, value, other);
            // console.log('--------------', name, value);
            if (this.equalsAttributeName(name, 'value')) {
                this.setValue(value);
            }
            if (this.equalsAttributeName(name, 'if')) {
                this.if = value;
            }
            if (this.equalsAttributeName(name, 'createArguments')) {
                this.createArguments = value;
            }
            if (this.childObject && this.childRawSet && (0,_lifecycle_OnChangeAttrRender__WEBPACK_IMPORTED_MODULE_2__.isOnChangeAttrRender)(this.childObject)) {
                this.childObject.onChangeAttrRender(name, value, { rawSet: this.childRawSet });
            }
        }
        onCreatedThisChild(child, data) {
            super.onCreatedThisChild(child, data);
            // console.log('outlet--oncreatedThisChild',child);
        }
        onCreatedThisChildDebounce(childrenSet) {
            super.onCreatedThisChildDebounce(childrenSet);
            let parentThis = this.getParentThis();
            // console.log('---', parentThis);
            if ((0,_components_ComponentRouterBase__WEBPACK_IMPORTED_MODULE_4__.isOnCreatedOutletDebounce)(parentThis)) {
                parentThis.onCreatedOutletDebounce(this.value?.obj);
            }
            this.getAttribute('onCreatedDebounce')?.(this.value?.obj);
        }
        onCreateDrThis($component, $rawSet) {
            this.childObject = $component ??= this.value?.obj;
            this.childRawSet = $rawSet;
            if ($component) {
                this.getAttribute('onCreated')?.($component);
                // console.log('21222');
                if ((0,_lifecycle_OnChangeAttrRender__WEBPACK_IMPORTED_MODULE_2__.isOnChangeAttrRender)($component)) {
                    this.getAttributeNames()
                        .filter(it => it.startsWith('attribute-'))
                        .forEach(it => {
                        const attrName = it.replace(/^attribute-/, '');
                        const attrValue = this.getAttribute(it);
                        $rawSet.dataSet.render.attribute ??= {};
                        $rawSet.dataSet.render.attribute[attrName] = attrValue;
                        $component.onChangeAttrRender(attrName, attrValue, { rawSet: $rawSet });
                    });
                }
            }
        }
    }
    RouterOutlet_1.RouterOutlet = RouterOutlet;
})(RouterOutlet || (RouterOutlet = {}));
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
    // TODO:   webpack  ..  ..   .
    routerOutlet: (config, executer) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.createComponentTargetElement({
            name: RouterOutlet.selector,
            template: `
        <dr-if value="\${@this@.sw}$">
            <div dr-this="@this@.value" dr-detect-option-if="@this@?.value && @this@?.if" dr-option-strip="true" dr-on-create:arguments="@this@.createArguments" dr-on-create:callback="@this@?.onCreateDrThis?.($component, $rawSet)">#innerHTML#</div>
        </dr-if>
        `,
            objFactory: (e, o, r2, counstructorParam) => {
                return executer?.run({ rootObject: new RouterOutlet.RouterOutlet(...counstructorParam), config: config });
            }
        });
    }
});


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/router/index.ts":
/*!*****************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/router/index.ts ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Route: () => (/* reexport safe */ _Route__WEBPACK_IMPORTED_MODULE_0__.Route),
/* harmony export */   RouterOutlet: () => (/* reexport safe */ _RouterOutlet__WEBPACK_IMPORTED_MODULE_1__.RouterOutlet)
/* harmony export */ });
/* harmony import */ var _Route__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Route */ "../../packages/@dooboostore/dom-render/src/components/router/Route.ts");
/* harmony import */ var _RouterOutlet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./RouterOutlet */ "../../packages/@dooboostore/dom-render/src/components/router/RouterOutlet.ts");




/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/select/Select.ts":
/*!******************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/select/Select.ts ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Select: () => (/* binding */ Select),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _ComponentBase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _DomRender__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../DomRender */ "../../packages/@dooboostore/dom-render/src/DomRender.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _dooboostore_core_web_event_EventUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dooboostore/core-web/event/EventUtils */ "../../packages/@dooboostore/core-web/src/event/EventUtils.ts");
/* harmony import */ var _dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @dooboostore/core-web/valid/ValidUtils */ "../../packages/@dooboostore/core-web/src/valid/ValidUtils.ts");
/* harmony import */ var _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../decorators/DomRenderNoProxy */ "../../packages/@dooboostore/dom-render/src/decorators/DomRenderNoProxy.ts");
/* harmony import */ var _dooboostore_core_web_window_WindowUtils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @dooboostore/core-web/window/WindowUtils */ "../../packages/@dooboostore/core-web/src/window/WindowUtils.ts");








/** 
 <dr-select class="card-select-container" changeSelected="${(data) => @this@.changeSelected(data)}$">  <!-- multiple attribute optional-->
 <dr-select-summary class="card-select-summary-container">
 <dr-select-summary-placeholder>
 <div class="card-select-summary-placeholder-container">    </div>
 </dr-select-summary-placeholder>
 <dr-select-summary-selected>
 <div dr-if="@this@.selectedCard" class="card-select-summary-selected-container">
 <img dr-attr="{src:@this@.selectedCard?.iconImg}"> ${@this@.selectedCard?.name}$
 </div>
 </dr-select-summary-selected>
 </dr-select-summary>

 <dr-select-body float="bottom-left" class="card-select-body-container">
 <dr-select-option dr-for-of="@this@.cards" value="${#it#.name}$" selected="${#nearForOfIndex# === 0}$" class="card-select-body-option-container">
 <img dr-attr="{src:#it#.iconImg}"> ${#it#.name}$
 </dr-select-option>
 </dr-select-body>
 </dr-select>
 */
var Select;
(function (Select_1) {
    var _a;
    Select_1.selector = 'dr-select';
    // Base for simple hide/show components
    class StateComponent extends _ComponentBase__WEBPACK_IMPORTED_MODULE_1__.ComponentBase {
        hidden = true;
        value = null;
        constructor(config) {
            super(config);
        }
        setValue(value) {
            this.value = value;
        }
    }
    // --- Option Child Components ---
    class OptionSelected extends StateComponent {
        constructor() {
            super({ onlyParentType: Option });
        }
    }
    Select_1.OptionSelected = OptionSelected;
    class OptionUnselected extends StateComponent {
        constructor() {
            super({ onlyParentType: Option });
        }
    }
    Select_1.OptionUnselected = OptionUnselected;
    class OptionDisabled extends StateComponent {
        constructor() {
            super({ onlyParentType: Option });
        }
    }
    Select_1.OptionDisabled = OptionDisabled;
    // --- Summary Child Components ---
    class SummaryPlaceholder extends StateComponent {
        constructor() {
            super({ onlyParentType: Summary });
        }
    }
    Select_1.SummaryPlaceholder = SummaryPlaceholder;
    class SummarySelected extends StateComponent {
        selectedOptions = [];
        constructor() {
            super({ onlyParentType: Summary });
        }
        setOptions(options = []) {
            this.selectedOptions = options.filter(it => it.selected);
        }
    }
    Select_1.SummarySelected = SummarySelected;
    class SummaryDisabled extends StateComponent {
        selectedOptions = [];
        constructor() {
            super({ onlyParentType: Summary });
        }
        setOptions(options = []) {
            this.selectedOptions = options.filter(it => it.selected);
        }
    }
    Select_1.SummaryDisabled = SummaryDisabled;
    class Option extends _ComponentBase__WEBPACK_IMPORTED_MODULE_1__.ComponentBase {
        hidden = true;
        value = null;
        selected = false;
        disabled = false;
        classAttr = null;
        // public status: 'selected' | 'unselected' | 'disabled' = 'unselected';
        constructor() {
            super({ onlyParentType: SelectBody });
        }
        async onInitRender(param, rawSet) {
            await super.onInitRender(param, rawSet);
            // console.log('-----', this.value, this.selected)
            // this.getElement()?.addEventListener('click', (e) => {
            //   e.stopPropagation();
            //   if (!this.disabled) {
            //     this.getParentThis<Select>().handleOptionClick(this);
            //   }
            // });
            this.updateStatus();
        }
        // onCreatedThisChild(child: any, data: OnCreateRenderDataParams) {
        //   super.onCreatedThisChild(child, data);
        //   this.updateStatus();
        // }
        // async onRawSetRendered(rawSet:RawSet, otherData:OnRawSetRenderedOtherData):Promise<void>{
        //   await super.onRawSetRendered(rawSet, otherData);
        // }
        onCreatedThisChildDebounce(childrenSet) {
            super.onCreatedThisChildDebounce(childrenSet);
            this.updateStatus();
        }
        toggleSelected(event) {
            // console.log('isMultiple', this.isMultiple())
            if (!this.disabled) {
                this.selected = this.isMultiple() ? !this.selected : true;
                // this.selected =  !this.selected;
                this.updateStatus();
                this.getParentThis().changeOptionState(this);
            }
            else {
                event.stopPropagation();
                event.preventDefault();
            }
        }
        isMultiple() {
            return this.getParentThis()?.getParentThis().multiple;
        }
        updateStatus() {
            if (this.disabled) {
                this.getChildren(OptionSelected).forEach(c => {
                    c.hidden = true;
                    c.setValue(this.value);
                });
                this.getChildren(OptionUnselected).forEach(c => {
                    c.hidden = true;
                    c.setValue(this.value);
                });
                this.getChildren(OptionDisabled).forEach(c => {
                    c.hidden = false;
                    c.setValue(this.value);
                });
                return;
            }
            if (this.selected) {
                this.getChildren(OptionSelected).forEach(c => {
                    c.hidden = false;
                    c.setValue(this.value);
                });
                this.getChildren(OptionUnselected).forEach(c => {
                    c.hidden = true;
                    c.setValue(this.value);
                });
                this.getChildren(OptionDisabled).forEach(c => {
                    c.hidden = true;
                    c.setValue(this.value);
                });
            }
            if (!this.selected) {
                this.getChildren(OptionSelected).forEach(c => {
                    c.hidden = true;
                    c.setValue(this.value);
                });
                this.getChildren(OptionUnselected).forEach(c => {
                    c.hidden = false;
                    c.setValue(this.value);
                });
                this.getChildren(OptionDisabled).forEach(c => {
                    c.hidden = true;
                    c.setValue(this.value);
                });
            }
        }
    }
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({ name: 'value' }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], Option.prototype, "value", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({ name: 'selected', converter: v => v !== null && v === true }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], Option.prototype, "selected", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({ name: 'disabled', converter: v => v !== null && v === true }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], Option.prototype, "disabled", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({ name: 'class', converter: v => (v ? v : null) }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], Option.prototype, "classAttr", void 0);
    Select_1.Option = Option;
    // --- Summary Component ---
    class Summary extends _ComponentBase__WEBPACK_IMPORTED_MODULE_1__.ComponentBase {
        classAttr = null;
        options = [];
        disabled = false;
        element;
        // constructor() {
        //   super({ onlyParentType: Select });
        // }
        setDisabled(disabled) {
            this.disabled = disabled;
            this.getChildren(SummaryPlaceholder).forEach(it => (it.hidden = true));
            this.getChildren(SummarySelected).forEach(it => (it.hidden = true));
            this.getChildren(SummaryDisabled).forEach(it => (it.hidden = false));
        }
        setOptions(options = []) {
            this.options = options;
            const selectedOptions = this.options.filter(it => it.selected && !it.disabled);
            if (!this.disabled) {
                if (selectedOptions.length > 0) {
                    this.getChildren(SummaryPlaceholder).forEach(it => (it.hidden = true));
                    this.getChildren(SummarySelected).forEach(c => {
                        c.setOptions(options);
                        c.hidden = false;
                    });
                    this.getChildren(SummaryDisabled).forEach(it => (it.hidden = true));
                }
                else {
                    this.getChildren(SummaryDisabled).forEach(it => (it.hidden = true));
                    this.getChildren(SummaryPlaceholder).forEach(it => (it.hidden = false));
                    this.getChildren(SummarySelected).forEach(c => (c.hidden = true));
                }
            }
        }
        async onInitRender(param, rawSet) {
            await super.onInitRender(param, rawSet);
            // this.getElement()?.addEventListener('click', (e) => {
            //   e.stopPropagation();
            //   this.getParentThis<Select>().toggle();
            // });
        }
        onInitSummaryElement(element, event) {
            this.element = element;
        }
        updateView(hasSelection) {
            this.getChildren(SummaryPlaceholder).forEach(c => (c.hidden = hasSelection));
            this.getChildren(SummarySelected).forEach(c => (c.hidden = !hasSelection));
        }
        // onCreatedThisChild(child: any, data: OnCreateRenderDataParams) {
        //   super.onCreatedThisChild(child, data);
        // }
        // async onRawSetRendered(rawSet: RawSet, otherData: OnRawSetRenderedOtherData): Promise<void> {
        //   await super.onRawSetRendered(rawSet, otherData);
        // }
        onCreatedThisChildDebounce(childrenSet) {
            super.onCreatedThisChildDebounce(childrenSet);
            this.updateView(this.getParentThis()?.selectedValues?.length > 0);
        }
        onSummaryClick(element, event) {
            if (this.getParentThis()?.disabled) {
                event.stopPropagation();
                event.preventDefault();
                return;
            }
        }
    }
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({ name: 'class', converter: v => (v === '' ? null : v) }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], Summary.prototype, "classAttr", void 0);
    Select_1.Summary = Summary;
    class SelectBody extends _ComponentBase__WEBPACK_IMPORTED_MODULE_1__.ComponentBase {
        classAttr = null;
        float = null;
        constructor() {
            super({ onlyParentType: Select });
        }
        async onRawSetRendered(rawSet, otherData) {
            await super.onRawSetRendered(rawSet, otherData);
            // }
            // onCreatedThisChildDebounce(childrenSet: ChildrenSet[]) {
            //   super.onCreatedThisChildDebounce(childrenSet);
            this.changeOptionState();
        }
        changeOptionState(option) {
            const options = this.getChildren(Option);
            const select = this.getParentThis();
            // console.log('------opti',option, select);
            // //     
            if (!select.multiple) {
                //   
                if (option && option.selected) {
                    options.filter(it => it !== option).forEach(it => {
                        it.selected = false;
                        it.updateStatus();
                    });
                }
                else {
                    const selectedOptions = options.filter(it => it.selected && !it.disabled);
                    selectedOptions.forEach((opt, idx) => {
                        const isLast = idx === selectedOptions.length - 1;
                        if (!isLast) {
                            opt.selected = false;
                            opt.updateStatus();
                        }
                    });
                }
            }
            // console.log('--------', options.map(it=>it.selected))
            select?.setOptions(options);
        }
    }
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({ name: 'class', converter: v => (v === '' ? null : v) }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], SelectBody.prototype, "classAttr", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({ name: 'float' }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], SelectBody.prototype, "float", void 0);
    Select_1.SelectBody = SelectBody;
    class Select extends _ComponentBase__WEBPACK_IMPORTED_MODULE_1__.ComponentBase {
        multiple = false;
        disabled = false;
        classAttr = null;
        name = null;
        // public isOpen = false;
        selectedValues = [];
        selectedOptions = [];
        value;
        element;
        documentClickSubscription;
        windowBlurSubscription;
        summaryComponent;
        selectBodyComponent;
        options;
        constructor(config) {
            super();
            // console.log('----Select constructor')
        }
        // get value(): string | (string | null)[] | null | undefined {
        //   return this._value;
        // }
        // set value(val: string | (string | null)[] | null | undefined) {
        //   console.log('value set', val)
        //   this._value = val;
        // }
        get optionComponents() {
            return this.getChildren(Option);
        }
        onCreateRender() {
        }
        onCreateRenderData() {
        }
        async onInitRender(param, rawSet) {
            await super.onInitRender(param, rawSet);
            // console.log('select onInitRender', this.multiple)
            if (_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_5__.ValidUtils.isBrowser() && this.rawSet?.dataSet.config.window) {
                const detailsElement = this.element;
                const window = this.rawSet.dataSet.config.window;
                const document = window.document;
                this.documentClickSubscription = _dooboostore_core_web_event_EventUtils__WEBPACK_IMPORTED_MODULE_4__.EventUtils.htmlElementEventObservable(document, 'click').subscribe(event => {
                    const isSummaryClick = this.getChildren(Summary).some(it => event.target && it.element?.contains(event.target) || it.element === event.target);
                    if (!isSummaryClick && this.getAttribute('disableOtherClickClose')) {
                        return;
                    }
                    if (!isSummaryClick && !this.multiple && detailsElement) {
                        detailsElement.open = false;
                        return;
                    }
                    if (!isSummaryClick && detailsElement && !detailsElement?.contains(event?.target)) {
                        detailsElement.open = false;
                    }
                });
                this.windowBlurSubscription = _dooboostore_core_web_window_WindowUtils__WEBPACK_IMPORTED_MODULE_7__.WindowUtils.eventObservable(window, 'blur').subscribe(() => {
                    if (detailsElement?.open && window.document.activeElement?.tagName === 'IFRAME') {
                        detailsElement.open = false;
                    }
                });
            }
        }
        toggle(element, event) {
            // console.log('------>', this.disabled, event)
            // if (this.disabled) {
            //   event.stopPropagation();
            //   event.preventDefault();
            //   return;
            // }
            const toggleAttribute = this.getAttribute('toggle');
            if (toggleAttribute) {
                toggleAttribute?.(element.open);
            }
        }
        setOptions(options) {
            const summaries = this.getChildren(Summary);
            this.options = options;
            const values = this.options.filter(it => it.selected && !it.disabled).map(it => it.value);
            summaries?.forEach(it => {
                it.setDisabled(this.disabled);
                if (!this.disabled) {
                    it.setOptions(options);
                }
            });
            this.selectedValues = values;
            this.selectedOptions = this.options.filter(it => it.selected && !it.disabled);
            this.value = this.selectedValues[0];
            this.getAttribute('onchange')?.(this.value);
            this.getAttribute('onchangeValues')?.(values);
        }
        onInitDetailsElement(detailsElement) {
            // console.log('detailsElement oninit', detailsElement);
            this.element = detailsElement;
        }
        onDrThisUnBind() {
            super.onDrThisUnBind();
            this.onDestroyRender();
        }
        onDestroyRender() {
            super.onDestroyRender();
            this.documentClickSubscription?.unsubscribe();
            this.windowBlurSubscription?.unsubscribe();
        }
        setValue(value) {
            this.value = value;
            if (this.options) {
                // clear
                this.options.forEach(it => {
                    it.selected = false;
                    it.updateStatus();
                });
                for (let option of this.options) {
                    if (option.value === value) {
                        option.selected = true;
                        if (!this.multiple) {
                            //  
                            break;
                        }
                    }
                    else {
                        option.selected = false;
                    }
                    option.updateStatus();
                }
            }
            console.log('value set', value);
        }
        test() {
            console.log('tttttttt');
        }
    }
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({ name: 'multiple', converter: v => v !== null }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], Select.prototype, "multiple", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({ name: 'disabled', converter: v => v !== null }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], Select.prototype, "disabled", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({ name: 'class', converter: v => (v === '' ? null : v) }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], Select.prototype, "classAttr", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({ name: 'name', converter: v => (v === '' ? null : v) }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], Select.prototype, "name", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_6__.DomRenderNoProxy,
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", typeof (_a = typeof HTMLDetailsElement !== "undefined" && HTMLDetailsElement) === "function" ? _a : Object)
    ], Select.prototype, "element", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_6__.DomRenderNoProxy,
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], Select.prototype, "documentClickSubscription", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_6__.DomRenderNoProxy,
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Object)
    ], Select.prototype, "windowBlurSubscription", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_6__.DomRenderNoProxy,
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Summary)
    ], Select.prototype, "summaryComponent", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        _decorators_DomRenderNoProxy__WEBPACK_IMPORTED_MODULE_6__.DomRenderNoProxy,
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", SelectBody)
    ], Select.prototype, "selectBodyComponent", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)('value'),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Function),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [Object]),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:returntype", void 0)
    ], Select.prototype, "setValue", null);
    Select_1.Select = Select;
})(Select || (Select = {}));
const stateComponentFactory = (name, type) => {
    return (config) => _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_3__.RawSet.createComponentTargetElement({
        name,
        template: '<div dr-if="!@this@.hidden" dr-option-strip="true">#innerHTML#</div>\n',
        objFactory: (e, o, r2, constructorParam) => _DomRender__WEBPACK_IMPORTED_MODULE_2__.DomRender.run({ rootObject: new type(), config })
    });
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
    select: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_3__.RawSet.createComponentTargetElement({
            name: Select.selector,
            styles: '.dr-select-container {\n' +
                '  position: relative;\n' +
                '\n' +
                '}\n' +
                '.dr-select-options-container {\n' +
                '  display: none;\n' +
                '  position: absolute;\n' +
                '  top: 100%;\n' +
                '  left: 0;\n' +
                '  right: 0;\n' +
                '  z-index: 10;\n' +
                '}\n' +
                '.dr-select-container.is-open .dr-select-options-container {\n' +
                '  display: block;\n' +
                '}\n' +
                'summary::-webkit-details-marker {\n' +
                '    display: none;\n' +
                '}\n' +
                '/* Floating styles for dr-select-body */\n' +
                '.dr-select-body-container {\n' +
                '    position: absolute;\n' +
                '}\n' +
                '\n' +
                '.dr-select-body-bottom-left-container {\n' +
                '    position: absolute;\n' +
                '    left: 0;\n' +
                '    top: 100%;\n' +
                '}\n' +
                '\n' +
                '.dr-select-body-bottom-right-container {\n' +
                '    position: absolute;\n' +
                '    right: 0;\n' +
                '    top: 100%;\n' +
                '}\n' +
                '\n' +
                '.dr-select-body-top-left-container {\n' +
                '    position: absolute;\n' +
                '    left: 0;\n' +
                '    bottom: 100%;\n' +
                '}\n' +
                '\n' +
                '.dr-select-body-top-right-container {\n' +
                '    position: absolute;\n' +
                '    right: 0;\n' +
                '    bottom: 100%;\n' +
                '}\n' +
                '\n' +
                '/* Reset default details/summary styles */\n' +
                '.dr-select-container details {\n' +
                '  display: block; /* Ensure it behaves like a block element */\n' +
                '}\n' +
                '\n' +
                '.dr-select-container summary {\n' +
                '  display: block; /* Ensure it behaves like a block element */\n' +
                '  list-style: none; /* Remove default marker */\n' +
                "  cursor: pointer; /* Indicate it's clickable */\n" +
                '}\n' +
                '\n' +
                '.dr-select-container summary::-webkit-details-marker,\n' +
                '.dr-select-container summary::marker {\n' +
                '  display: none; /* Hide marker for Webkit and standard */\n' +
                '}',
            template: '<details dr-class="{\n' +
                "        'dr-select-container': true,\n" +
                "        'is-open': @this@.isOpen,\n" +
                '        [@this@.classAttr]: @this@.classAttr\n' +
                '     }" dr-on-init="@this@.onInitDetailsElement($element)" dr-option-complete="@this@.test()"  dr-event-toggle="@this@.toggle($element, $event)">\n' +
                '\n' +
                '    #innerHTML#\n' +
                '</details>\n' +
                '<select hidden="hidden" name="${@this@.name}$" disabled="${@this@.disabled ? \'disabled\' : null}$"  style="width: 1500px; height:500px"  multiple>\n' +
                '    <option dr-for-of="@this@.options" value="${#it#.value}$" selected="${#it#.selected ? \'selected\' : null}$">#it# ${#it#.value}$</option>\n' +
                '</select>',
            objFactory: (e, o, r2, constructorParam) => _DomRender__WEBPACK_IMPORTED_MODULE_2__.DomRender.run({ rootObject: new Select.Select(config), config })
        });
    },
    selectSummary: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_3__.RawSet.createComponentTargetElement({
            name: `${Select.selector}-summary`,
            template: '<summary dr-class="{[@this@.classAttr]: @this@.classAttr}"\n' +
                '         dr-on-init="@this@.onInitSummaryElement($element, $event)"\n' +
                '         dr-event-click="@this@.onSummaryClick($element, $event)"\n' +
                '>\n' +
                '#innerHTML#\n' +
                '</summary>',
            objFactory: (e, o, r2, constructorParam) => _DomRender__WEBPACK_IMPORTED_MODULE_2__.DomRender.run({ rootObject: new Select.Summary(), config })
        });
    },
    selectSummaryPlaceholder: stateComponentFactory(`${Select.selector}-summary-placeholder`, Select.SummaryPlaceholder),
    selectSummarySelected: stateComponentFactory(`${Select.selector}-summary-selected`, Select.SummarySelected),
    selectSummaryDisabled: stateComponentFactory(`${Select.selector}-summary-disabled`, Select.SummaryDisabled),
    selectBody: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_3__.RawSet.createComponentTargetElement({
            name: `${Select.selector}-body`,
            template: '<div dr-class="{[@this@.classAttr]: @this@.classAttr, \'dr-select-body-container\': true,  [\'dr-select-body-\'+@this@.float+\'-container\']: @this@.float}">#innerHTML#</div>',
            objFactory: (e, o, r2, constructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_2__.DomRender.run({ rootObject: new Select.SelectBody(), config: config });
            }
        });
    },
    selectOption: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_3__.RawSet.createComponentTargetElement({
            name: `${Select.selector}-option`,
            template: '<a dr-class="{[@this@.classAttr]: @this@.classAttr}" dr-event-click="@this@.toggleSelected($event)">#innerHTML#</a>\n',
            objFactory: (e, o, r2, constructorParam) => _DomRender__WEBPACK_IMPORTED_MODULE_2__.DomRender.run({ rootObject: new Select.Option(), config })
        });
    },
    selectOptionSelected: stateComponentFactory(`${Select.selector}-option-selected`, Select.OptionSelected),
    selectOptionUnselected: stateComponentFactory(`${Select.selector}-option-unselected`, Select.OptionUnselected),
    selectOptionDisabled: stateComponentFactory(`${Select.selector}-option-disabled`, Select.OptionDisabled),
});


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/select/index.ts":
/*!*****************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/select/index.ts ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Select: () => (/* reexport safe */ _Select__WEBPACK_IMPORTED_MODULE_0__.Select)
/* harmony export */ });
/* harmony import */ var _Select__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Select */ "../../packages/@dooboostore/dom-render/src/components/select/Select.ts");



/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/this/This.ts":
/*!**************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/this/This.ts ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   This: () => (/* binding */ This),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _ComponentBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _DomRender__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../DomRender */ "../../packages/@dooboostore/dom-render/src/DomRender.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _lifecycle_OnChangeAttrRender__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../lifecycle/OnChangeAttrRender */ "../../packages/@dooboostore/dom-render/src/lifecycle/OnChangeAttrRender.ts");




var This;
(function (This_1) {
    This_1.selector = 'dr-this';
    class This extends _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ComponentBase {
        value;
        if = null;
        createArguments;
        childObject;
        childRawSet;
        sw = false;
        setValue(value) {
            this.sw = false;
            setTimeout(() => {
                this.value = value;
            }, 0);
            setTimeout(() => {
                this.sw = true;
            }, 0);
        }
        async onInitRender(param, rawSet) {
            await super.onInitRender(param, rawSet);
        }
        onDestroyRender(data) {
            super.onDestroyRender(data);
        }
        onDestroy() {
            super.onDestroy();
        }
        onChangeAttrRender(name, value, other) {
            super.onChangeAttrRender(name, value, other);
            if (this.equalsAttributeName(name, 'value')) {
                this.setValue(value);
            }
            if (this.equalsAttributeName(name, 'if')) {
                this.if = value;
            }
            if (this.equalsAttributeName(name, 'createArguments')) {
                this.createArguments = value;
            }
        }
        created($component, $rawSet) {
            this.childObject = $component ??= this.value?.obj;
            this.childRawSet = $rawSet;
            if ($component) {
                this.getAttribute('onCreated')?.($component);
                // attribute  
                if ((0,_lifecycle_OnChangeAttrRender__WEBPACK_IMPORTED_MODULE_3__.isOnChangeAttrRender)($component)) {
                    this.getAttributeNames()
                        .filter(it => it.startsWith('attribute-'))
                        .forEach(it => {
                        const attrName = it.replace(/^attribute-/, '');
                        const attrValue = this.getAttribute(it);
                        $rawSet.dataSet.render.attribute ??= {};
                        $rawSet.dataSet.render.attribute[attrName] = attrValue;
                        $component.onChangeAttrRender(attrName, attrValue, { rawSet: $rawSet });
                    });
                }
            }
        }
    }
    This_1.This = This;
})(This || (This = {}));
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
    this: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: This.selector,
            template: `
        <dr-if value="\${@this@.sw}$">
            <div dr-this="@this@.value" dr-detect-option-if="@this@?.value && @this@?.if" dr-option-strip="true" dr-on-create:arguments="@this@.createArguments" dr-on-create:callback="@this@?.created?.($component, $rawSet)">#innerHTML#</div>
        </dr-if>
        `,
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new This.This(...counstructorParam), config: config });
            }
        });
    }
});


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/this/index.ts":
/*!***************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/this/index.ts ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   This: () => (/* reexport safe */ _This__WEBPACK_IMPORTED_MODULE_0__.This)
/* harmony export */ });
/* harmony import */ var _This__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./This */ "../../packages/@dooboostore/dom-render/src/components/this/This.ts");



/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/timer/Timer.ts":
/*!****************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/timer/Timer.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Timer: () => (/* binding */ Timer),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _ComponentBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _DomRender__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../DomRender */ "../../packages/@dooboostore/dom-render/src/DomRender.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");



var Timer;
(function (Timer_1) {
    Timer_1.selector = 'dr-timer';
    class Timer extends _ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ComponentBase {
        interval;
        value;
        async onInitRender(param, rawSet) {
            await super.onInitRender(param, rawSet);
            this.getAttribute('onCreated')?.(this);
            // console.log('---2', this.getElement()?.isConnected)
            // const element = this.getElement();
            // if(element){
            //   (element as any).component = this;
            // }
        }
        isRunning() {
            return this.value !== undefined;
        }
        start() {
            const timems = this.getAttribute('value');
            if (timems) {
                this.value = parseInt(timems);
                const intervalValue = this.getAttribute('interval') ?? 1000;
                console.log('int', this.value, intervalValue);
                this.interval = setInterval(() => {
                    // console.log('--------->', this.value);
                    if (this.value) {
                        this.value--;
                    }
                    else {
                        clearInterval(this.interval);
                        this.value = undefined;
                        this.interval = undefined;
                    }
                }, intervalValue);
            }
        }
        stop() {
            if (this.interval) {
                clearInterval(this.interval);
                this.interval = undefined;
                this.value = undefined;
            }
        }
        onChangeAttrRender(name, val, other) {
            super.onChangeAttrRender(name, val, other);
            console.log('-----', name, val, this.getElement());
        }
        onDestroyRender(data) {
            super.onDestroyRender(data);
            if (this.interval) {
                clearInterval(this.interval);
            }
        }
    }
    Timer_1.Timer = Timer;
})(Timer || (Timer = {}));
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({
    timer: (config) => {
        return _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.createComponentTargetElement({
            name: `${Timer.selector}`,
            template: '#innerHTML#',
            objFactory: (e, o, r2, counstructorParam) => {
                return _DomRender__WEBPACK_IMPORTED_MODULE_1__.DomRender.run({ rootObject: new Timer.Timer(...counstructorParam), config: config });
            }
        });
    }
});


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/components/timer/index.ts":
/*!****************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/components/timer/index.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Timer: () => (/* reexport safe */ _Timer__WEBPACK_IMPORTED_MODULE_0__.Timer)
/* harmony export */ });
/* harmony import */ var _Timer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Timer */ "../../packages/@dooboostore/dom-render/src/components/timer/Timer.ts");



/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/decorators/DomRenderNoProxy.ts":
/*!*********************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/decorators/DomRenderNoProxy.ts ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DomRenderNoProxy: () => (/* binding */ DomRenderNoProxy),
/* harmony export */   DomRenderNoProxyKey: () => (/* binding */ DomRenderNoProxyKey),
/* harmony export */   getDomRenderNoProxy: () => (/* binding */ getDomRenderNoProxy),
/* harmony export */   isDomRenderNoProxy: () => (/* binding */ isDomRenderNoProxy)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/valid/ValidUtils */ "../../packages/@dooboostore/core/src/valid/ValidUtils.ts");
/* harmony import */ var _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/core/reflect/ReflectUtils */ "../../packages/@dooboostore/core/src/reflect/ReflectUtils.ts");


const DomRenderNoProxyKey = 'DomRender:NoProxy';
const DomRenderNoProxy = (target, propertyKey) => {
    _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_1__.ReflectUtils.defineMetadata(DomRenderNoProxyKey, true, target, propertyKey);
    //    
    // if (propertyKey === undefined) {
    //   // target  
    //   Reflect.defineMetadata(DomRenderNoProxyKey, true, target);
    //   return;
    // }
    //
    // //    
    // // target , propertyKey  
    // Reflect.defineMetadata(DomRenderNoProxyKey, true, target, propertyKey);
};
const getDomRenderNoProxy = (target, propertyKey) => {
    // if (ValidUtils.isNotNullUndefined(target)) {
    return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_1__.ReflectUtils.getMetadata(DomRenderNoProxyKey, target, propertyKey);
    //  
    // if (propertyKey === undefined) {
    //   return Reflect.getMetadata(DomRenderNoProxyKey, target);
    // }
    // //  
    // return Reflect.getMetadata(DomRenderNoProxyKey, target, propertyKey);
    // } else {
    //   return undefined;
    // }
};
const isDomRenderNoProxy = (target, propertyKey) => {
    return _dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_0__.ValidUtils.isNullOrUndefined(target) || getDomRenderNoProxy(target, propertyKey) === true;
};


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/events/EventManager.ts":
/*!*************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/events/EventManager.ts ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   EventManager: () => (/* binding */ EventManager)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_web_script_ScriptUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core-web/script/ScriptUtils */ "../../packages/@dooboostore/core-web/src/script/ScriptUtils.ts");
/* harmony import */ var _dooboostore_core_web_element_ElementUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/core-web/element/ElementUtils */ "../../packages/@dooboostore/core-web/src/element/ElementUtils.ts");
/* harmony import */ var _iterators_Range__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../iterators/Range */ "../../packages/@dooboostore/dom-render/src/iterators/Range.ts");
/* harmony import */ var _DomRenderProxy__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../DomRenderProxy */ "../../packages/@dooboostore/dom-render/src/DomRenderProxy.ts");
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");





class EventManager {
    window;
    static attrPrefix = 'dr-';
    eventNames = [
        'click', 'mousedown', 'mouseup', 'dblclick', 'mouseover', 'mouseout', 'mousemove', 'mouseenter', 'mouseleave', 'contextmenu',
        'keyup', 'keydown', 'keypress', 'toggle',
        'change', 'input', 'submit', 'resize', 'focus', 'blur',
        'close', 'cancel'
    ];
    delegatableEventMap = {
        mouseleave: 'mouseout',
        mouseenter: 'mouseover',
        focus: 'focusin',
        blur: 'focusout'
    };
    directAttachEvents = new Set(['close']);
    static ownerVariablePathAttrName = EventManager.attrPrefix + 'owner-variable-path';
    static eventParam = EventManager.attrPrefix + 'event';
    static onInitAttrName = EventManager.attrPrefix + 'on-init';
    static valueAttrName = EventManager.attrPrefix + 'value';
    static checkedAttrName = EventManager.attrPrefix + 'checked';
    static selectedAttrName = EventManager.attrPrefix + 'selected';
    static readonlyAttrName = EventManager.attrPrefix + 'readonly';
    static disabledAttrName = EventManager.attrPrefix + 'disabled';
    static hiddenAttrName = EventManager.attrPrefix + 'hidden';
    static requiredAttrName = EventManager.attrPrefix + 'required';
    static openAttrName = EventManager.attrPrefix + 'open';
    // link           
    static linkAttrs = [
        { name: EventManager.attrPrefix + 'value-link', property: 'value', event: 'input' },
        { name: EventManager.attrPrefix + 'hidden-link', property: 'value', event: 'input' },
        { name: EventManager.attrPrefix + 'required-link', property: 'value', event: 'input' },
        { name: EventManager.attrPrefix + 'checked-link', property: 'checked', event: 'change' },
        { name: EventManager.attrPrefix + 'open-link', property: 'open', event: 'toggle' }
    ];
    // @ts-ignore  (Synthetic)   
    static linkTargetMapAttrName = EventManager.attrPrefix + 'link-variables';
    static onRenderedInitAttrName = EventManager.attrPrefix + 'on-rendered-init';
    static attrAttrName = EventManager.attrPrefix + 'attr';
    static normalAttrMapAttrName = EventManager.attrPrefix + 'normal-attr-map';
    static styleAttrName = EventManager.attrPrefix + 'style';
    static classAttrName = EventManager.attrPrefix + 'class';
    static VALUE_VARNAME = '$value';
    static SCRIPTS_VARNAME = '$scripts';
    static FAG_VARNAME = '$fag';
    static RAWSET_VARNAME = '$rawSet';
    static RENDER_VARNAME = '$render';
    static NEAR_THIS_VARNAME = '$nearThis';
    static PARENT_THIS_VARNAME = '$parentThis';
    static ROOT_OBJECT_VARNAME = '$rootObject';
    static SCRIPT_UTILS_VARNAME = '$scriptUtils';
    static RANGE_VARNAME = '$range';
    static ROUTER_VARNAME = '$router';
    static INNER_HTML_VARNAME = '$innerHTML';
    static ELEMENT_VARNAME = '$element';
    static TARGET_VARNAME = '$target';
    static EVENT_VARNAME = '$event';
    static COMPONENT_VARNAME = '$component';
    static INNERHTML_VARNAME = '$innerHTML';
    static ATTRIBUTE_VARNAME = '$attribute';
    static CREATOR_META_DATA_VARNAME = '$creatorMetaData';
    static PARENT_THIS_PATH_VARNAME = '$parentPath';
    static CURRENT_THIS_VARNAME = '$currentThis';
    static CURRENT_THIS_PATH_VARNAME = '$currentThisPath';
    static NEAR_THIS_PATH_VARNAME = '$nearThisPath';
    static VARNAMES = [EventManager.SCRIPTS_VARNAME, EventManager.FAG_VARNAME, EventManager.RAWSET_VARNAME, EventManager.RANGE_VARNAME, EventManager.ROUTER_VARNAME, EventManager.ELEMENT_VARNAME, EventManager.TARGET_VARNAME, EventManager.EVENT_VARNAME, EventManager.COMPONENT_VARNAME, EventManager.INNERHTML_VARNAME, EventManager.ATTRIBUTE_VARNAME, EventManager.ATTRIBUTE_VARNAME, EventManager.CREATOR_META_DATA_VARNAME, EventManager.PARENT_THIS_PATH_VARNAME, EventManager.PARENT_THIS_VARNAME];
    static WINDOW_EVENT_POPSTATE = 'popstate';
    static WINDOW_EVENT_RESIZE = 'resize';
    static WINDOW_EVENTS = [EventManager.WINDOW_EVENT_POPSTATE, EventManager.WINDOW_EVENT_RESIZE];
    static noDetectAttr = [EventManager.normalAttrMapAttrName];
    static attrNames = [
        EventManager.valueAttrName,
        EventManager.checkedAttrName,
        EventManager.selectedAttrName,
        EventManager.readonlyAttrName,
        EventManager.disabledAttrName,
        EventManager.hiddenAttrName,
        EventManager.requiredAttrName,
        EventManager.openAttrName,
        EventManager.attrAttrName,
        EventManager.normalAttrMapAttrName,
        EventManager.styleAttrName,
        EventManager.classAttrName,
        EventManager.attrPrefix + 'window-event-' + EventManager.WINDOW_EVENT_POPSTATE,
        EventManager.attrPrefix + 'window-event-' + EventManager.WINDOW_EVENT_RESIZE,
        EventManager.onInitAttrName,
        ...EventManager.linkAttrs.map(it => it.name),
        this.eventParam
    ];
    bindScript = `
        const ${EventManager.VALUE_VARNAME} = this.__render.value;
        const ${EventManager.SCRIPTS_VARNAME} = this.__render.scripts;
        const ${EventManager.RANGE_VARNAME} = this.__render.range;
        const ${EventManager.ROUTER_VARNAME} = this.__render.router;
        const ${EventManager.ATTRIBUTE_VARNAME} = this.__render.attribute;
        const ${EventManager.ELEMENT_VARNAME} = this.__render.element;
        const ${EventManager.COMPONENT_VARNAME} = this.__render.element.component;
        const ${EventManager.TARGET_VARNAME} = this.__render.target;
        const ${EventManager.EVENT_VARNAME} = this.__render.event;
    `;
    constructor(window) {
        this.window = window;
        this.eventNames.forEach(it => {
            EventManager.attrNames.push(EventManager.attrPrefix + 'event-' + it);
        });
        EventManager.attrNames.push(EventManager.onRenderedInitAttrName);
        if (typeof window !== 'undefined') {
            EventManager.WINDOW_EVENTS.forEach(eventName => {
                window?.addEventListener(eventName, (event) => {
                    const targetAttr = `dr-window-event-${eventName}`;
                    document.querySelectorAll(`[${targetAttr}]`).forEach(it => {
                        const script = it.getAttribute(targetAttr);
                        if (script) {
                            const obj = this.findComponentInstance(it);
                            const config = (0,_DomRenderProxy__WEBPACK_IMPORTED_MODULE_3__.getDomRenderConfig)(obj);
                            _dooboostore_core_web_script_ScriptUtils__WEBPACK_IMPORTED_MODULE_0__.ScriptUtils.evaluate(`${this.bindScript} ${script} `, this.createExecutionContext(event, it, obj, config));
                        }
                    });
                });
            });
            const rootElement = this.window.document;
            const listeningEvents = new Set();
            this.eventNames.forEach(eventName => {
                if (this.directAttachEvents.has(eventName)) {
                    return;
                }
                const delegatedEventName = this.delegatableEventMap[eventName] || eventName;
                if (listeningEvents.has(delegatedEventName)) {
                    return;
                }
                listeningEvents.add(delegatedEventName);
                rootElement.addEventListener(delegatedEventName, this.handleEvent.bind(this), true);
            });
        }
    }
    handleEvent(event) {
        const handlers = this.collectHandlers(event);
        // console.log('handlers', handlers, event);
        for (const handler of handlers) {
            if (event.cancelBubble) {
                break;
            }
            const componentInstance = this.findComponentInstance(handler.element);
            if (!componentInstance) {
                continue;
            }
            // console.log('executeHandler', event,handler,componentInstance)
            this.executeHandler(event, handler, componentInstance);
        }
    }
    collectHandlers(event) {
        const handlers = [];
        const root = this.window.document;
        if (!root)
            return handlers;
        const initialTarget = event.target;
        let currentTarget = (initialTarget.nodeType === 1)
            ? initialTarget
            : initialTarget.parentElement;
        const collectedElements = new Set();
        const eventMap = {
            mouseout: 'mouseleave',
            mouseover: 'mouseenter',
            focusout: 'blur',
            focusin: 'focus'
        };
        const mappedEventName = eventMap[event.type] || event.type;
        while (currentTarget) {
            if (collectedElements.has(currentTarget)) {
                break;
            }
            // Priority 1: Link attributes
            const matchingLinkAttr = EventManager.linkAttrs.find(la => la.event === mappedEventName && currentTarget?.hasAttribute(la.name));
            if (matchingLinkAttr) {
                handlers.push({
                    element: currentTarget,
                    attr: matchingLinkAttr.name,
                    type: 'link',
                    priority: 1,
                    property: matchingLinkAttr.property
                });
            }
            // Priority 2: dr-event-* attributes
            const eventAttr = `${EventManager.attrPrefix}event-${mappedEventName}`;
            if (currentTarget.hasAttribute(eventAttr)) {
                handlers.push({
                    element: currentTarget,
                    attr: eventAttr,
                    type: 'event',
                    priority: 2
                });
            }
            // Priority 3: dr-event with params
            const eventParamAttr = EventManager.eventParam;
            if (currentTarget.hasAttribute(eventParamAttr)) {
                const bindEvents = currentTarget.getAttribute(`${eventParamAttr}:bind`);
                if (bindEvents && bindEvents.split(',').map(s => s.trim()).includes(mappedEventName)) {
                    handlers.push({
                        element: currentTarget,
                        attr: eventParamAttr,
                        type: 'event-param',
                        priority: 3
                    });
                }
            }
            collectedElements.add(currentTarget);
            if (currentTarget === root.documentElement) {
                break;
            }
            currentTarget = currentTarget.parentElement;
        }
        return handlers.sort((a, b) => a.priority - b.priority);
    }
    findComponentInstance(element) {
        let current = element;
        const root = this.window.document;
        while (current) {
            if (current.obj) {
                return current.obj;
            }
            if (current === root.documentElement) {
                break;
            }
            current = current.parentElement;
        }
        return this.window;
    }
    createExecutionContext(event, element, componentInstance, config, extraVars = {}) {
        // console.log('---------->', config?.eventVariables)
        return Object.assign(componentInstance, {
            __render: Object.freeze({
                event,
                element,
                target: event.target,
                attribute: _dooboostore_core_web_element_ElementUtils__WEBPACK_IMPORTED_MODULE_1__.ElementUtils.getAttributeToObject(element),
                router: config?.router,
                range: _iterators_Range__WEBPACK_IMPORTED_MODULE_2__.Range.range,
                scripts: EventManager.setBindProperty(config?.scripts, componentInstance),
                ...config?.eventVariables,
                ...extraVars
            })
        });
    }
    executeHandler(event, handler, componentInstance) {
        const { element, type, attr } = handler;
        const config = (0,_DomRenderProxy__WEBPACK_IMPORTED_MODULE_3__.getDomRenderConfig)(componentInstance);
        switch (type) {
            case 'link':
                const varName = element.getAttribute(attr);
                if (!varName || !handler.property)
                    return;
                if (attr.includes('leave') || attr.includes('enter') || attr.includes('focus') || attr.includes('blur')) {
                    const relatedTarget = event.relatedTarget;
                    if (relatedTarget && element.contains(relatedTarget)) {
                        return;
                    }
                }
                const ownerVariablePath = element.getAttribute(EventManager.ownerVariablePathAttrName);
                let bindObj = componentInstance;
                if (ownerVariablePath) {
                    bindObj = _dooboostore_core_web_script_ScriptUtils__WEBPACK_IMPORTED_MODULE_0__.ScriptUtils.evaluateReturn(ownerVariablePath, componentInstance);
                }
                const mapScript = element.getAttribute(`${attr}:map`);
                let value = element[handler.property];
                if (mapScript) {
                    const context = this.createExecutionContext(event, element, bindObj, config, { value });
                    value = _dooboostore_core_web_script_ScriptUtils__WEBPACK_IMPORTED_MODULE_0__.ScriptUtils.evaluate(`return ${mapScript}`, context);
                }
                if (typeof this.getValue(componentInstance, varName, bindObj) === 'function') {
                    this.getValue(componentInstance, varName, bindObj)(value, event);
                }
                else {
                    this.setValue(componentInstance, varName, value);
                }
                break;
            case 'event':
                const script = element.getAttribute(attr);
                if (!script)
                    return;
                if (attr.endsWith('mouseleave') || attr.endsWith('mouseenter') || attr.endsWith('blur') || attr.endsWith('focus')) {
                    const relatedTarget = event.relatedTarget;
                    if (relatedTarget && element.contains(relatedTarget)) {
                        return;
                    }
                }
                const context = this.createExecutionContext(event, element, componentInstance, config);
                const filterScript = element.getAttribute(`${attr}:filter`);
                let filter = true;
                //    ()       .
                // if (filterScript) {
                //     filter = ScriptUtils.eval<boolean>(`${this.getBindScript(config)} return ${filterScript}`, context) ?? false;
                // }
                if (filter) {
                    _dooboostore_core_web_script_ScriptUtils__WEBPACK_IMPORTED_MODULE_0__.ScriptUtils.evaluate(`${this.getBindScript(config)} ${script}`, context);
                }
                //    ()       .
                // const hasDispatch = element.hasAttribute(`${attr}:dispatch`);
                // if (hasDispatch) {
                //   element.dispatchEvent(new Event(event.type));
                // }
                break;
            case 'event-param':
                const paramScript = element.getAttribute(attr);
                if (!paramScript)
                    return;
                if (attr.endsWith('mouseleave') || attr.endsWith('mouseenter') || attr.endsWith('blur') || attr.endsWith('focus')) {
                    const relatedTarget = event.relatedTarget;
                    if (relatedTarget && element.contains(relatedTarget)) {
                        return;
                    }
                }
                const attributes = _dooboostore_core_web_element_ElementUtils__WEBPACK_IMPORTED_MODULE_1__.ElementUtils.getAttributeToObject(element);
                const params = {};
                const prefix = attr + ':';
                Object.entries(attributes).filter(([k, v]) => k.startsWith(prefix)).forEach(([k, v]) => {
                    params[k.slice(prefix.length)] = v;
                });
                const paramContext = this.createExecutionContext(event, element, componentInstance, config, { params });
                _dooboostore_core_web_script_ScriptUtils__WEBPACK_IMPORTED_MODULE_0__.ScriptUtils.evaluate(`${this.getBindScript(config)} ${paramScript}`, paramContext);
                break;
        }
    }
    findAttrElements(fragment, config) {
        // const t0 = performance.now();
        const elements = new Set();
        const addAttributes = config?.applyEvents?.map(it => it.attrName) ?? [];
        const attrs = addAttributes.concat([...EventManager.attrNames]).filter(Boolean);
        if (attrs.length) {
            const selector = attrs.map(a => `[${a}]`).join(',');
            fragment?.querySelectorAll(selector).forEach(it => elements.add(it));
        }
        // console.log('findAttrElements time', performance.now() - t0);
        return elements;
    }
    applyEvent(obj, childNodes, config) {
        childNodes.forEach(node => {
            if (node.nodeType === 1) {
                node.obj = obj;
            }
        });
        // let t0 = performance.now();
        this.procAttr(childNodes, EventManager.valueAttrName, (it, attribute) => {
            const script = attribute;
            if (script) {
                const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluateReturn(script, obj);
                if (it.value !== data) {
                    it.value = data;
                }
            }
        });
        // console.log('applyEvent value time', performance.now() - t0);
        // t0 = performance.now();
        this.procAttr(childNodes, EventManager.checkedAttrName, (it, attribute) => {
            const script = attribute;
            if (script) {
                const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluateReturn(script, obj);
                if (it.checked !== data) {
                    it.checked = data;
                }
            }
        });
        // console.log('applyEvent value time', performance.now() - t0);
        // t0 = performance.now();
        this.procAttr(childNodes, EventManager.selectedAttrName, (it, attribute) => {
            const script = attribute;
            if (script) {
                const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluateReturn(script, obj);
                if (it.selected !== data) {
                    it.selected = data;
                }
            }
        });
        // console.log('applyEvent value time', performance.now() - t0);
        // t0 = performance.now();
        this.procAttr(childNodes, EventManager.readonlyAttrName, (it, attribute) => {
            const script = attribute;
            if (script) {
                const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluateReturn(script, obj);
                if (it.readOnly !== data) {
                    it.readOnly = data;
                }
            }
        });
        // console.log('applyEvent value time', performance.now() - t0);
        // t0 = performance.now();
        this.procAttr(childNodes, EventManager.disabledAttrName, (it, attribute) => {
            const script = attribute;
            if (script) {
                const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluateReturn(script, obj);
                if (it.disabled !== data) {
                    it.disabled = data;
                }
            }
        });
        // console.log('applyEvent value time', performance.now() - t0);
        // t0 = performance.now();
        this.procAttr(childNodes, EventManager.hiddenAttrName, (it, attribute) => {
            const script = attribute;
            if (script) {
                const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluateReturn(script, obj);
                if (it.hidden !== data) {
                    it.hidden = data;
                }
            }
        });
        // console.log('applyEvent value time', performance.now() - t0);
        // t0 = performance.now();
        this.procAttr(childNodes, EventManager.requiredAttrName, (it, attribute) => {
            const script = attribute;
            if (script) {
                const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluateReturn(script, obj);
                if (it.required !== data) {
                    it.required = data;
                }
            }
        });
        // console.log('applyEvent value time', performance.now() - t0);
        // t0 = performance.now();
        this.procAttr(childNodes, EventManager.openAttrName, (it, attribute) => {
            const script = attribute;
            if (script) {
                const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluateReturn(script, obj);
                if (it.open !== data) {
                    it.open = data;
                }
            }
        });
        // console.log('applyEvent value time', performance.now() - t0);
        // t0 = performance.now();
        this.procAttr(childNodes, EventManager.normalAttrMapAttrName, (it, attribute) => {
            const map = new Map(JSON.parse(attribute));
            map.forEach((v, k) => {
                const variablePaths = v.variablePaths;
                let targetScript = v.originalAttrValue; //typeof v.originalAttrValue === 'string' ? JSON.parse(v.originalAttrValue) : v.originalAttrValue;
                let script;
                if (v.isStringTemplate) {
                    variablePaths.forEach(it => {
                        let r = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Path.toOptionalChainPath(it.inner);
                        targetScript = targetScript.replaceAll(it.origin, `\${${r}}`);
                    });
                    script = '`' + targetScript + '`';
                }
                else {
                    variablePaths.forEach(it => {
                        let r = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Path.toOptionalChainPath(it.inner);
                        targetScript = targetScript.replaceAll(it.origin, `${r}`);
                    });
                    script = targetScript;
                }
                const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluate(`const $element = this.element;  return ${script}`, Object.assign(obj, {
                    __render: Object.freeze({
                        element: it,
                        attribute: _dooboostore_core_web_element_ElementUtils__WEBPACK_IMPORTED_MODULE_1__.ElementUtils.getAttributeToObject(it)
                    })
                }));
                // console.log('!!!!!!!!!!!', k, data, script, variablePaths, v)
                if (data === null || data === undefined) {
                    it.removeAttribute(k);
                }
                else {
                    it.setAttribute(k, data);
                }
            });
        });
        // console.log('applyEvent value time', performance.now() - t0);
        // t0 = performance.now();
        EventManager.WINDOW_EVENTS.forEach(it => {
            this.procAttr(childNodes, EventManager.attrPrefix + 'window-event-' + it, (it, attribute) => {
                it.obj = obj;
            });
        });
        // console.log('applyEvent value time', performance.now() - t0);
        // t0 = performance.now();
        EventManager.linkAttrs.forEach(linkInfo => {
            this.procAttr(childNodes, linkInfo.name, (it, varName) => {
                if (varName) {
                    const ownerVariablePathName = it.getAttribute(EventManager.ownerVariablePathAttrName);
                    const mapScript = it.getAttribute(`${linkInfo.name}:map`);
                    let bindObj = obj;
                    if (ownerVariablePathName) {
                        bindObj = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluateReturn(ownerVariablePathName, obj);
                    }
                    const getValue = this.getValue(obj, varName, bindObj);
                    if (typeof getValue === 'function' && getValue) {
                        let setValue = it[linkInfo.property];
                        if (mapScript) {
                            setValue = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluate(`${this.getBindScript(config)} return ${mapScript}`, Object.assign(bindObj, { __render: Object.freeze({ element: it, target: bindObj, range: _iterators_Range__WEBPACK_IMPORTED_MODULE_2__.Range.range, value: setValue, scripts: EventManager.setBindProperty(config?.scripts, obj), ...config?.eventVariables }) }));
                        }
                        getValue(setValue);
                    }
                    else if (getValue) {
                        let setValue = getValue;
                        if (mapScript) {
                            setValue = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluate(`${this.getBindScript(config)} return ${mapScript}`, Object.assign(bindObj, { __render: Object.freeze({ element: it, target: bindObj, range: _iterators_Range__WEBPACK_IMPORTED_MODULE_2__.Range.range, value: setValue, scripts: EventManager.setBindProperty(config?.scripts, obj), ...config?.eventVariables }) }));
                        }
                        if (setValue === null) {
                            it.removeAttribute(linkInfo.property);
                        }
                        else {
                            it[linkInfo.property] = setValue;
                        }
                    }
                    else if (getValue === undefined) {
                        this.setValue(obj, varName, it[linkInfo.property]);
                    }
                }
            });
        });
        // console.log('applyEvent value time', performance.now() - t0);
        // t0 = performance.now();
        this.directAttachEvents.forEach(eventName => {
            const attr = `${EventManager.attrPrefix}event-${eventName}`;
            this.procAttr(childNodes, attr, (element, script) => {
                const handler = (event) => {
                    const componentInstance = this.findComponentInstance(element);
                    if (!componentInstance)
                        return;
                    const context = this.createExecutionContext(event, element, componentInstance, config);
                    const filterScript = element.getAttribute(`${attr}:filter`);
                    let filter = true;
                    if (filterScript) {
                        filter = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluate(`${this.getBindScript(config)} return ${filterScript}`, context) ?? false;
                    }
                    if (filter) {
                        _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluate(`${this.getBindScript(config)} ${script}`, context);
                    }
                };
                element.addEventListener(eventName, handler);
                // TODO: Add logic to remove this listener when the element is destroyed.
            });
        });
        // console.log('applyEvent value time', performance.now() - t0);
        // t0 = performance.now();
        this.procAttr(childNodes, EventManager.onInitAttrName, (it, attribute) => {
            let script = attribute;
            if (script) {
                script = 'return ' + script;
            }
            if (script) {
                _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluate(`${this.getBindScript(config)}; ${script} `, Object.assign(obj, {
                    __render: Object.freeze({
                        element: it,
                        attribute: _dooboostore_core_web_element_ElementUtils__WEBPACK_IMPORTED_MODULE_1__.ElementUtils.getAttributeToObject(it),
                        ...config?.eventVariables
                    })
                }));
            }
        });
        // console.log('applyEvent value time', performance.now() - t0);
        // t0 = performance.now();
        this.onRenderedEvent(obj, childNodes, config);
        this.changeVar(obj, childNodes, undefined, config);
        const elements = Array.from(childNodes).filter(it => it.nodeType === 1).map(it => it);
        elements.forEach(it => {
            config?.applyEvents?.filter(ta => it.getAttribute(ta.attrName) !== null).forEach(ta => ta.callBack(it, it.getAttribute(ta.attrName), obj));
        });
    }
    onRenderedEvent(obj, childNodes, config) {
        this.procAttr(childNodes, EventManager.onRenderedInitAttrName, (it, attribute) => {
            if (!it.isConnected) {
                return;
            }
            let script = attribute;
            if (script) {
                script = 'return ' + script;
            }
            if (script) {
                _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluate(`${this.getBindScript(config)}; ${script} `, Object.assign(obj, {
                    __render: Object.freeze({
                        element: it,
                        attribute: _dooboostore_core_web_element_ElementUtils__WEBPACK_IMPORTED_MODULE_1__.ElementUtils.getAttributeToObject(it),
                        ...config?.eventVariables
                    })
                }));
            }
        });
    }
    changeVar(obj, elements, varName, config) {
        //    ......   timeout .. ..
        // console.log('changeVar', obj, elements, varName)
        this.procAttr(elements, EventManager.styleAttrName, (it, attribute) => {
            let script = attribute;
            if (script) {
                script = 'return ' + script;
            }
            if (EventManager.isUsingThisVar(script, varName) || varName === undefined) {
                const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluate(`const $element = this.__render.element;  ${script} `, Object.assign(obj, {
                    __render: Object.freeze({
                        element: it,
                        attribute: _dooboostore_core_web_element_ElementUtils__WEBPACK_IMPORTED_MODULE_1__.ElementUtils.getAttributeToObject(it)
                    })
                }));
                if (typeof data === 'string') {
                    data.split(';').forEach(sit => {
                        const [key, value] = sit.split(':').map(s => s.trim());
                        if (key && value) {
                            it.style[key] = value;
                        }
                    });
                    // it.setAttribute('style', data);
                }
                else if (Array.isArray(data)) {
                    data.forEach(sit => {
                        const [key, value] = sit.split(':').map(s => s.trim());
                        if (key && value) {
                            it.style[key] = value;
                        }
                    });
                    // it.setAttribute('style', data.join(';'));
                }
                else if (data) {
                    for (const [key, value] of Object.entries(data)) {
                        // if (it instanceof HTMLElement) {
                        it.style[key] = value === null ? null : String(value);
                        // }
                    }
                }
            }
        });
        this.procAttr(elements, EventManager.classAttrName, (it, attribute) => {
            let script = attribute;
            if (script) {
                script = 'return ' + script;
            }
            if (EventManager.isUsingThisVar(script, varName) || varName === undefined) {
                const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluate(`const $element = this.element;  ${script} `, Object.assign(obj, {
                    __render: Object.freeze({
                        element: it,
                        attribute: _dooboostore_core_web_element_ElementUtils__WEBPACK_IMPORTED_MODULE_1__.ElementUtils.getAttributeToObject(it)
                    })
                }));
                // alert(1)
                if (typeof data === 'string') {
                    data.split(' ').map(it => it.trim()).filter(it => it.length > 0).forEach(cit => it.classList.add(cit.trim()));
                }
                else if (Array.isArray(data)) {
                    data.map(it => it.trim()).filter(it => it.length > 0).forEach(cit => it.classList.add(cit.trim()));
                }
                else if (data) {
                    for (const [key, value] of Object.entries(data)) {
                        if (it instanceof HTMLElement) {
                            const v = key.trim();
                            if (value && v) {
                                it.classList.add(v);
                            }
                            else if (v) {
                                it.classList.remove(v);
                            }
                        }
                    }
                }
            }
        });
        this.procAttr(elements, EventManager.valueAttrName, (it, attribute) => {
            if (EventManager.isUsingThisVar(attribute, varName) || varName === undefined) {
                const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluateReturn(attribute, obj);
                if (it.value !== data)
                    it.value = data;
            }
        });
        this.procAttr(elements, EventManager.checkedAttrName, (it, attribute) => {
            if (EventManager.isUsingThisVar(attribute, varName) || varName === undefined) {
                const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluateReturn(attribute, obj);
                if (it.checked !== data)
                    it.checked = data;
            }
        });
        this.procAttr(elements, EventManager.selectedAttrName, (it, attribute) => {
            if (EventManager.isUsingThisVar(attribute, varName) || varName === undefined) {
                const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluateReturn(attribute, obj);
                if (it.selected !== data)
                    it.selected = data;
            }
        });
        this.procAttr(elements, EventManager.readonlyAttrName, (it, attribute) => {
            if (EventManager.isUsingThisVar(attribute, varName) || varName === undefined) {
                const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluateReturn(attribute, obj);
                if (it.readOnly !== data)
                    it.readOnly = data;
            }
        });
        this.procAttr(elements, EventManager.disabledAttrName, (it, attribute) => {
            if (EventManager.isUsingThisVar(attribute, varName) || varName === undefined) {
                const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluateReturn(attribute, obj);
                if (it.disabled !== data)
                    it.disabled = data;
            }
        });
        this.procAttr(elements, EventManager.hiddenAttrName, (it, attribute) => {
            if (EventManager.isUsingThisVar(attribute, varName) || varName === undefined) {
                const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluateReturn(attribute, obj);
                if (it.hidden !== data)
                    it.hidden = data;
            }
        });
        this.procAttr(elements, EventManager.requiredAttrName, (it, attribute) => {
            if (EventManager.isUsingThisVar(attribute, varName) || varName === undefined) {
                const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluateReturn(attribute, obj);
                if (it.required !== data)
                    it.required = data;
            }
        });
        this.procAttr(elements, EventManager.openAttrName, (it, attribute) => {
            if (EventManager.isUsingThisVar(attribute, varName) || varName === undefined) {
                const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluateReturn(attribute, obj);
                if (it.open !== data)
                    it.open = data;
            }
        });
    }
    deepAttributeElements(elements = new Set(), attrName) {
        const sets = new Set();
        elements.forEach(it => {
            if (!it) {
                return;
            }
            if (it.nodeType === 1) {
                const e = it;
                if (e.hasAttribute(attrName)) {
                    sets.add(e);
                }
                e.querySelectorAll(`[${attrName}]`).forEach(it => {
                    sets.add(it);
                });
            }
        });
        return sets;
    }
    procAttr(elements = new Set(), attrName, callBack) {
        const sets = this.deepAttributeElements(elements, attrName);
        sets.forEach(it => {
            const attr = it.getAttribute(attrName);
            const attrs = _dooboostore_core_web_element_ElementUtils__WEBPACK_IMPORTED_MODULE_1__.ElementUtils.getAttributeToObject(it);
            if (attr) {
                // setTimeout(() => {
                callBack(it, attr, attrs);
                // }, 0)
            }
        });
    }
    getValue(obj, name, bindObj) {
        let r = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluateReturn(name, obj);
        if (typeof r === 'function') {
            r = r.bind(bindObj ?? obj);
        }
        return r;
    }
    setValue(obj, name, value) {
        name = name.replaceAll('this.', 'this.this.');
        _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluate(`${name} = this.value;`, {
            this: obj,
            value: value
        });
    }
    static decodeScriptVar(raws) {
        if (raws) {
            // TODO: .. ..?     ?
            EventManager.VARNAMES.forEach(it => {
                // raws = raws!.replace(RegExp(it.replace('$', '\\$'), 'g'), `this?.___${it}`);
                raws = raws.replace(RegExp(it.replace('$', '\\$'), 'g'), `this.___${it}`);
            });
            return raws;
        }
        return undefined;
    }
    static isUsingThisVar(raws, varName) {
        raws = EventManager.decodeScriptVar(raws);
        if (varName && raws) {
            if (varName.startsWith('this.')) {
                varName = varName.replace(/this\./, '');
            }
            const variablePaths = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Path.detectPathFromScript(raws, { excludeThis: true });
            return variablePaths.has(varName);
        }
        return false;
    }
    static setBindProperty(scripts, obj) {
        if (scripts) {
            const newScripts = Object.assign({}, scripts);
            for (const [key, value] of Object.entries(newScripts)) {
                if (typeof value === 'function') {
                    newScripts[key] = value.bind(obj);
                }
            }
            return newScripts;
        }
    }
    getBindScript(config) {
        if (config?.eventVariables) {
            const bindScript = Object.entries(config.eventVariables).filter(([key, value]) => !this.bindScript.includes(`const ${key}`)).map(([key, value]) => {
                return `const ${key} = this.__render.${key};`;
            }).join(';');
            return this.bindScript + '' + bindScript;
        }
        else {
            return this.bindScript;
        }
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/iterators/Range.ts":
/*!*********************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/iterators/Range.ts ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Range: () => (/* binding */ Range),
/* harmony export */   RangeIterator: () => (/* binding */ RangeIterator),
/* harmony export */   RangeResult: () => (/* binding */ RangeResult)
/* harmony export */ });
// within rangeResult.ts
// @ts-ignore
class RangeResult {
    done;
    value;
    constructor(value, done) {
        this.done = done;
        this.value = value ?? 0;
    }
}
class RangeIterator {
    _first;
    _current;
    _last;
    _step;
    constructor(first, last, step) {
        this._current = this._first = first;
        this._last = last;
        this._step = step;
    }
    next(value) {
        let r;
        if (this._first < this._last && this._current < this._last) {
            r = new RangeResult(this._current, false);
            this._current += this._step;
        }
        else if (this._first < this._last && this._current === this._last) {
            r = new RangeResult(this._current, false);
            this._current += this._step;
        }
        else if (this._first > this._last && this._current > this._last) {
            r = new RangeResult(this._current, false);
            this._current -= this._step;
        }
        else if (this._first > this._last && this._current === this._last) {
            r = new RangeResult(this._current, false);
            this._current -= this._step;
        }
        else if (this._current === this._last) {
            r = new RangeResult(this._current, false);
            this._current -= this._step;
        }
        else {
            r = new RangeResult(undefined, true);
        }
        return r;
    }
}
class Range {
    first;
    last;
    step;
    isRange = true;
    constructor(first, last, step = 1) {
        this.first = first;
        this.last = last;
        this.step = step;
    }
    [Symbol.iterator]() {
        return new RangeIterator(this.first, this.last, this.step);
    }
    map(callbackfn, thisArg) {
        return Array.from(this).map(callbackfn);
    }
    static range(first, last, step = 1) {
        if (typeof first === 'number' && last === undefined) {
            return new Range(0, first, step);
        }
        else if (typeof first === 'string') {
            const [_first, _last = '0'] = first.split('..');
            const [__last, _step = '1'] = _last.split(',');
            return new Range(Number(_first.trim()), Number(__last.trim()), Number(_step.trim()));
        }
        else {
            return new Range(first, last ?? 0, step);
        }
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/lifecycle/OnBeforeReturnSet.ts":
/*!*********************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/lifecycle/OnBeforeReturnSet.ts ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isOnBeforeReturnSet: () => (/* binding */ isOnBeforeReturnSet)
/* harmony export */ });
function isOnBeforeReturnSet(obj) {
    return typeof obj?.onBeforeReturnSet === 'function';
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/lifecycle/OnChangeAttrRender.ts":
/*!**********************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/lifecycle/OnChangeAttrRender.ts ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isOnChangeAttrRender: () => (/* binding */ isOnChangeAttrRender)
/* harmony export */ });
const isOnChangeAttrRender = (obj) => {
    return typeof obj?.onChangeAttrRender === 'function';
};


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/lifecycle/OnChildRawSetRendered.ts":
/*!*************************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/lifecycle/OnChildRawSetRendered.ts ***!
  \*************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isOnChildRawSetRendered: () => (/* binding */ isOnChildRawSetRendered)
/* harmony export */ });
const isOnChildRawSetRendered = (obj) => {
    return typeof obj?.onChildRawSetRendered === 'function';
};


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/lifecycle/OnChildRenderedByProperty.ts":
/*!*****************************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/lifecycle/OnChildRenderedByProperty.ts ***!
  \*****************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isOnChildRenderedByProperty: () => (/* binding */ isOnChildRenderedByProperty)
/* harmony export */ });
function isOnChildRenderedByProperty(obj) {
    return typeof obj?.onChildRenderedByProperty === 'function';
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/lifecycle/OnCreateRender.ts":
/*!******************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/lifecycle/OnCreateRender.ts ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isOnCreateRender: () => (/* binding */ isOnCreateRender)
/* harmony export */ });
const isOnCreateRender = (obj) => {
    return typeof obj?.onCreateRender === 'function';
};


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/lifecycle/OnCreateRenderData.ts":
/*!**********************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/lifecycle/OnCreateRenderData.ts ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isOnCreateRenderData: () => (/* binding */ isOnCreateRenderData)
/* harmony export */ });
const isOnCreateRenderData = (obj) => {
    return typeof obj?.onCreateRenderData === 'function';
};


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/lifecycle/OnCreatedThisChild.ts":
/*!**********************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/lifecycle/OnCreatedThisChild.ts ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isOnCreatedThisChild: () => (/* binding */ isOnCreatedThisChild)
/* harmony export */ });
const isOnCreatedThisChild = (obj) => {
    return typeof obj?.onCreatedThisChild === 'function';
};


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/lifecycle/OnDestroyRender.ts":
/*!*******************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/lifecycle/OnDestroyRender.ts ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isOnDestroyRender: () => (/* binding */ isOnDestroyRender)
/* harmony export */ });
const isOnDestroyRender = (obj) => {
    return typeof obj?.onDestroyRender === 'function';
};


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/lifecycle/OnInitRender.ts":
/*!****************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/lifecycle/OnInitRender.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isOnInitRender: () => (/* binding */ isOnInitRender)
/* harmony export */ });
function isOnInitRender(obj) {
    return typeof obj?.onInitRender === 'function';
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/lifecycle/OnProxyDomRender.ts":
/*!********************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/lifecycle/OnProxyDomRender.ts ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isOnProxyDomRender: () => (/* binding */ isOnProxyDomRender)
/* harmony export */ });
const isOnProxyDomRender = (obj) => typeof obj?.onProxyDomRender === 'function';


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/lifecycle/OnRawSetRendered.ts":
/*!********************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/lifecycle/OnRawSetRendered.ts ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isOnRawSetRendered: () => (/* binding */ isOnRawSetRendered)
/* harmony export */ });
const isOnRawSetRendered = (obj) => {
    return typeof obj?.onRawSetRendered === 'function';
};


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/lifecycle/dr-this/OnDrThisBind.ts":
/*!************************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/lifecycle/dr-this/OnDrThisBind.ts ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isOnDrThisBind: () => (/* binding */ isOnDrThisBind)
/* harmony export */ });
const isOnDrThisBind = (obj) => {
    return typeof obj?.onDrThisBind === 'function';
};


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/lifecycle/dr-this/OnDrThisUnBind.ts":
/*!**************************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/lifecycle/dr-this/OnDrThisUnBind.ts ***!
  \**************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isOnDrThisUnBind: () => (/* binding */ isOnDrThisUnBind)
/* harmony export */ });
const isOnDrThisUnBind = (obj) => {
    return typeof obj?.onDrThisUnBind === 'function';
};


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/messenger/DefaultMessenger.ts":
/*!********************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/messenger/DefaultMessenger.ts ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DefaultMessenger: () => (/* binding */ DefaultMessenger)
/* harmony export */ });
/* harmony import */ var _Messenger__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Messenger */ "../../packages/@dooboostore/dom-render/src/messenger/Messenger.ts");

class DefaultMessenger extends _Messenger__WEBPACK_IMPORTED_MODULE_0__.Messenger {
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/messenger/Messenger.ts":
/*!*************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/messenger/Messenger.ts ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Channel: () => (/* binding */ Channel),
/* harmony export */   ChannelSubscriber: () => (/* binding */ ChannelSubscriber),
/* harmony export */   ChannelSubscription: () => (/* binding */ ChannelSubscription),
/* harmony export */   Messenger: () => (/* binding */ Messenger)
/* harmony export */ });
/* harmony import */ var _types_Types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../types/Types */ "../../packages/@dooboostore/dom-render/src/types/Types.ts");

var CallBackType;
(function (CallBackType) {
    CallBackType[CallBackType["FILTER"] = 0] = "FILTER";
    CallBackType[CallBackType["MAP"] = 1] = "MAP";
    CallBackType[CallBackType["SUBSCRIBE"] = 2] = "SUBSCRIBE";
})(CallBackType || (CallBackType = {}));
class ChannelSubscription {
    channel;
    subscriber;
    constructor(channel, subscriber) {
        this.channel = channel;
        this.subscriber = subscriber;
    }
    unsubscribe() {
        this.subscriber.unsubscribe();
    }
}
class ChannelSubscriber {
    channel;
    parentSubscriber;
    callbacks = [];
    constructor(channel) {
        this.channel = channel;
    }
    exeCallback(data, metaData) {
        for (const callback of this.callbacks) {
            if (callback.type === CallBackType.FILTER && !callback.callback(data, metaData)) {
                break;
            }
            else if (callback.type === CallBackType.MAP) {
                data = callback.callback(data, metaData);
            }
            else if (callback.type === CallBackType.SUBSCRIBE) {
                data = callback.callback(data, metaData);
                break;
            }
        }
        return data;
    }
    // chaining point
    filter(callback) {
        this.callbacks.push({ type: CallBackType.FILTER, callback });
        return this;
    }
    map(callback) {
        this.callbacks.push({ type: CallBackType.MAP, callback });
        return this;
    }
    subscribe(callback) {
        this.callbacks.push({ type: CallBackType.SUBSCRIBE, callback });
        this.channel.subscribers.add(this);
        return new ChannelSubscription(this.channel, this);
    }
    unsubscribe() {
        this.channel.subscribers.delete(this);
    }
    deleteSubscriber() {
        this.unsubscribe();
        this.channel.subscribers.delete(this);
    }
}
class Channel {
    messenger;
    obj;
    key;
    subscribers = new Set();
    constructor(messenger, obj, key) {
        this.messenger = messenger;
        this.obj = obj;
        this.key = key;
    }
    publish(key, data, action) {
        const rtns = [];
        this.messenger.getChannels(key)?.forEach(it => {
            try {
                it.subscribers.forEach(its => {
                    const rdata = its.exeCallback(data, { channel: this, action });
                    rtns.push({ channel: it, data: rdata });
                });
            }
            catch (e) {
                console.error(e);
            }
        });
        return rtns;
    }
    allPublish(data, action) {
        const rtns = [];
        this.messenger.getAllChannelKeys().forEach(it => {
            rtns.push(this.publish(it, data));
        });
        return rtns.flat();
    }
    // string point
    filter(filterF) {
        const subscriber = new ChannelSubscriber(this);
        subscriber.filter(filterF);
        return subscriber;
    }
    map(filterF) {
        const subscriber = new ChannelSubscriber(this);
        subscriber.map(filterF);
        return subscriber;
    }
    subscribe(subscribeCallback) {
        const subscriber = new ChannelSubscriber(this);
        return subscriber.subscribe(subscribeCallback);
    }
    ;
    deleteChannel() {
        this.messenger.deleteChannel(this);
    }
    ;
}
class Messenger {
    config;
    channels = new Set();
    static EVENT_PUBLISH_KEY = 'domRenderMessenger_publish';
    static EVENT_SUBSCRIBE_KEY = 'domRenderMessenger_subscribe';
    constructor(config) {
        this.config = config;
        this.config.window.addEventListener(Messenger.EVENT_PUBLISH_KEY, (e) => {
            const detail = e.detail;
            // console.log('--->', detail)
            const rtns = [];
            this.getChannels(detail.key)?.forEach(it => {
                try {
                    it.subscribers.forEach(its => {
                        const rdata = its.exeCallback(detail.data, { action: detail.action });
                        rtns.push({ channel: it, data: rdata });
                    });
                }
                catch (e) {
                    console.error(e);
                }
            });
            detail.result?.(rtns);
        });
        this.config.window.addEventListener(Messenger.EVENT_SUBSCRIBE_KEY, (e) => {
            const detail = e.detail;
            // console.log('--->', detail)
            const channel = this.createChannel(detail.obj, detail.key);
            detail.init(channel, channel.subscribe(detail.subscribe));
        });
    }
    static publish(window, detail) {
        window.dispatchEvent(new CustomEvent(Messenger.EVENT_PUBLISH_KEY, { detail }));
    }
    static subscribe(window, detail) {
        window.dispatchEvent(new CustomEvent(Messenger.EVENT_SUBSCRIBE_KEY, { detail }));
    }
    createChannel(obj, key = obj.constructor.name) {
        const channel = _types_Types__WEBPACK_IMPORTED_MODULE_0__.DomRenderFinalProxy.final(new Channel(this, obj, key));
        this.channels.add(channel);
        // this.channels.get(key) ? this.channels.get(key)!.push(channel) : this.channels.set(key, [channel]);
        return channel;
    }
    deleteChannel(channel) {
        this.channels.delete(channel);
    }
    deleteChannelFromObj(obj) {
        if (obj) {
            this.channels.forEach(it => {
                if (it.obj === obj) {
                    // console.log('dddddddddddd', obj)
                    this.deleteChannel(it);
                }
            });
        }
    }
    addChannel(channel) {
        this.channels.add(channel);
    }
    getChannels(key) {
        if (typeof key === 'object') {
            key = key.constructor.name;
        }
        else if (typeof key === 'function') {
            key = key.name;
        }
        return Array.from(this.channels.values()).filter(it => it.key === key);
    }
    getAllChannels() {
        return Array.from(this.channels.values());
    }
    getAllChannelKeys() {
        return Array.from(this.channels.values()).map(it => it.key);
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/operators/Appender.ts":
/*!************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/operators/Appender.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Appender: () => (/* binding */ Appender)
/* harmony export */ });
class Appender {
    length = 0;
    keyMap = new Map();
    isAppender = true;
    constructor(...defaultDatas) {
        // console.log('defaultDatas', defaultDatas);
        this.push(...defaultDatas);
        // (this.childs as any).isAppender = true;
    }
    [Symbol.iterator]() {
        const items = this.getAll();
        let idx = 0;
        return {
            next(value) {
                let r = { value: undefined, done: true };
                if (items.length > idx) {
                    r = { value: items[idx], done: false };
                }
                idx++;
                return r;
            }
        };
    }
    get(key) {
        const o = this.keyMap.get(key);
        if (o !== undefined) {
            return this[o];
        }
        return undefined;
    }
    set(key, ...v) {
        const o = this.keyMap.get(key);
        // console.log('set!!', o);
        if (o !== undefined) {
            this[o] = v;
        }
        else {
            this.keyMap.set(key, this.length);
            // console.log('setPush', v)
            this.push(...v);
        }
    }
    delete(key) {
        const o = this.keyMap.get(key);
        if (o !== undefined) {
            this[o] = this[o].map(it => undefined);
            this.keyMap.delete(key);
            // this.length--;
        }
    }
    getAll() {
        return this.getAlls().flat();
    }
    getAlls() {
        const map = Array.from({ length: this.length }).filter((it, idx) => this[idx]).map((it, idx) => this[idx]);
        return map;
    }
    push(...items) {
        // console.log('----1>', items, items.length, this.length);
        if (items && items.length > 0) {
            items.index = this.length;
            this[this.length++] = items;
            // this[this.length] = [];
        }
        // console.log('----2>', items, items.length, this.length);
        // console.log('---22->', this.length)
        // const appender = this.childs[this.lastIndex];
        // appender.values = items;
        // this.childs.push(new Appender(appender.index + 1));
    }
    // delete(idx: number): void {
    //     // if (idx in this) {
    //     //     console.log('---------dele',idx)
    //     //     delete this[idx];
    //     //     this.length = this.length - 1;
    //     // }
    //     this.length = this.length - 1;
    // }
    //    getter setter 
    // get(index: number): T | undefined {
    //     return this.storage[index];
    // }
    //
    // set(index: number, value: T): void {
    //     this.storage[index] = value;
    //     this.length = Math.max(this.length, index + 1);
    // }
    clear() {
        // console.log('length', this.length);
        for (let i = 0; i < this.length; i++) {
            delete this[i];
        }
        this.keyMap.clear();
        this.length = 0;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/operators/Dr.ts":
/*!******************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/operators/Dr.ts ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Dr: () => (/* binding */ Dr)
/* harmony export */ });
/* harmony import */ var _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./OperatorExecuterAttrRequire */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuterAttrRequire.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _OperatorExecuter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OperatorExecuter */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuter.ts");
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");




class Dr extends _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__.OperatorExecuterAttrRequire {
    constructor(rawSet, render, returnContainer, elementSource, source, afterCallBack) {
        super(rawSet, render, returnContainer, elementSource, source, afterCallBack);
    }
    async executeAttrRequire(data) {
        const itRandom = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drItOtherEncoding(this.elementSource.element);
        const vars = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drVarEncoding(this.elementSource.element, this.elementSource.attrs.drVarOption ?? '');
        const newTemp = this.source.config.window.document.createElement('temp');
        _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_3__.ObjectUtils.Script.evaluate(`
                    ${this.render.bindScript}
                    const n = $element.cloneNode(true);
                    var destIt = ${this.elementSource.attrs.drItOption};
                    if (destIt !== undefined) {
                        n.getAttributeNames().forEach(it => n.setAttribute(it, n.getAttribute(it).replace(/\\#it\\#/g, destIt)))
                        // console.log('----', n.innerHTML);
                        n.innerHTML = n.innerHTML.replace(/\\#it\\#/g, destIt);
                        // console.log('----', n.innerHTML);
                    }
                    if (this.__render.drStripOption === 'true') {
                        Array.from(n.childNodes).forEach(it => this.__fag.append(it));
                    } else {
                        this.__render.fag.append(n);
                    }`, Object.assign(this.source.obj, {
            __render: Object.freeze({
                fag: newTemp,
                drStripOption: this.elementSource.attrs.drStripOption,
                ...this.render
            })
        }));
        _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drVarDecoding(newTemp, vars);
        _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drItOtherDecoding(newTemp, itRandom);
        const tempalte = this.source.config.window.document.createElement('template');
        tempalte.innerHTML = newTemp.innerHTML;
        this.returnContainer.fag.append(tempalte.content);
        const rr = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.checkPointCreates(this.returnContainer.fag, this.source.obj, this.source.config);
        this.elementSource.element.parentNode?.replaceChild(this.returnContainer.fag, this.elementSource.element);
        this.returnContainer.raws.push(...rr);
        return _OperatorExecuter__WEBPACK_IMPORTED_MODULE_2__.ExecuteState.EXECUTE;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/operators/DrAppender.ts":
/*!**************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/operators/DrAppender.ts ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DrAppender: () => (/* binding */ DrAppender)
/* harmony export */ });
/* harmony import */ var _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./OperatorExecuterAttrRequire */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuterAttrRequire.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _OperatorExecuter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OperatorExecuter */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuter.ts");
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");




class DrAppender extends _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__.OperatorExecuterAttrRequire {
    constructor(rawSet, render, returnContainer, elementSource, source, afterCallBack) {
        source.operatorAround = undefined;
        super(rawSet, render, returnContainer, elementSource, source, afterCallBack, false);
    }
    async executeAttrRequire(attr) {
        const itRandom = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drItOtherEncoding(this.elementSource.element);
        const vars = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drVarEncoding(this.elementSource.element, this.elementSource.attrs.drVarOption ?? '');
        const newTemp = this.source.config.window.document.createElement('temp');
        _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_3__.ObjectUtils.Script.evaluate(`
                    try{
                    ${this.render.bindScript}
                    ${this.elementSource.attrs.drBeforeOption ?? ''}
                        const ifWrap = document.createElement('div');
                        // ifWrap.setAttribute('${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_STRIP_OPTIONNAME}', 'true');
                        // ifWrap.setAttribute('${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_IF_NAME}', '${this.elementSource.attrs.drAppender} && ${this.elementSource.attrs.drAppender}.length > 0');
                        const n = this.__render.element.cloneNode(true);
                        Object.entries(this.__render.drAttr).filter(([k,v]) => k !== 'drAppender' && v).forEach(([k, v]) => n.setAttribute(this.__render.drAttrsOriginName[k], v));
                        const length = ${this.elementSource.attrs.drAppender}.length;
                        if (length > 0) {
                            n.setAttribute('${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_FOR_OF_NAME}', '${this.elementSource.attrs.drAppender}[' + (length-1) + ']');
                            n.setAttribute('${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_NEXT_OPTIONNAME}', '${this.elementSource.attrs.drAppender},' + length);
                        } else {
                            n.setAttribute('${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_FOR_OF_NAME}', '${this.elementSource.attrs.drAppender}[0]');
                            n.setAttribute('${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_NEXT_OPTIONNAME}', '${this.elementSource.attrs.drAppender},' + 1);
                        }
                        // console.log('appender--->', Array.from(n.getAttributeNames()).map(it=>({name:it,attr: n.getAttribute(it)})));
                        // const drOptionThis = n.getAttribute('${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_THIS_OPTIONNAME}');
                        // if (drOptionThis) {
                        // }
                        // ifWrap.append(n);
                        // this.__render.fag.append(ifWrap);
                        this.__render.fag.append(n);
                    ${this.elementSource.attrs.drAfterOption ?? ''}
                    }catch(e){}
                    `, Object.assign(this.source.obj, {
            __render: Object.freeze({
                drStripOption: this.elementSource.attrs.drStripOption,
                drAttr: this.elementSource.attrs,
                drAttrsOriginName: _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drAttrsOriginName,
                fag: newTemp,
                ...this.render
                // eslint-disable-next-line no-use-before-define
            })
        }));
        _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drVarDecoding(newTemp, vars);
        _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drItOtherDecoding(newTemp, itRandom);
        const tempalte = this.source.config.window.document.createElement('template');
        tempalte.innerHTML = newTemp.innerHTML;
        this.returnContainer.fag.append(tempalte.content);
        const rr = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.checkPointCreates(this.returnContainer.fag, this.source.obj, this.source.config);
        this.elementSource.element.parentNode?.replaceChild(this.returnContainer.fag, this.elementSource.element);
        // const rrr = rr.flatMap(it => it.render(obj, config));// .flat();
        this.returnContainer.raws.push(...rr);
        return _OperatorExecuter__WEBPACK_IMPORTED_MODULE_2__.ExecuteState.EXECUTE;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/operators/DrFor.ts":
/*!*********************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/operators/DrFor.ts ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DrFor: () => (/* binding */ DrFor)
/* harmony export */ });
/* harmony import */ var _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./OperatorExecuterAttrRequire */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuterAttrRequire.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _OperatorExecuter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OperatorExecuter */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuter.ts");
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");




class DrFor extends _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__.OperatorExecuterAttrRequire {
    constructor(rawSet, render, returnContainer, elementSource, source, afterCallBack) {
        source.operatorAround = undefined;
        super(rawSet, render, returnContainer, elementSource, source, afterCallBack, false);
    }
    async executeAttrRequire(attr) {
        const itRandom = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drItOtherEncoding(this.elementSource.element);
        const vars = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drVarEncoding(this.elementSource.element, this.elementSource.attrs.drVarOption ?? '');
        const newTemp = this.source.config.window.document.createElement('temp');
        // console.log('-----asdad',attr , this.elementSource.attrs.drItOption);
        _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_3__.ObjectUtils.Script.evaluate(`
                    ${this.render.bindScript}
                    ${this.elementSource.attrs.drBeforeOption ?? ''}
                    for(${attr}) {
                        const n = this.__render.element.cloneNode(true);
                        var destIt = ${this.elementSource.attrs.drItOption};
                        if (destIt !== undefined) {
                            n.getAttributeNames().forEach(it => n.setAttribute(it, n.getAttribute(it).replace(/\\#it\\#/g, destIt).replace(/\\#nearForIt\\#/g, destIt).replace(/\\#nearForIndex\\#/g, destIt))) 
                            n.innerHTML = n.innerHTML.replace(/\\#it\\#/g, destIt).replace(/\\#index\\#/g, destIt);
                        }
                        if (this.__render.drStripOption === 'true') {
                            Array.from(n.childNodes).forEach(it => this.__render.fag.append(it));
                        } else {
                            this.__render.fag.append(n);
                        }
                    }
                    ${this.elementSource.attrs.drAfterOption ?? ''}
                    `, Object.assign(this.source.obj, {
            __render: Object.freeze({
                fag: newTemp,
                drStripOption: this.elementSource.attrs.drStripOption,
                ...this.render
            })
        }));
        _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drVarDecoding(newTemp, vars);
        _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drItOtherDecoding(newTemp, itRandom);
        const tempalte = this.source.config.window.document.createElement('template');
        tempalte.innerHTML = newTemp.innerHTML;
        this.returnContainer.fag.append(tempalte.content);
        const rr = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.checkPointCreates(this.returnContainer.fag, this.source.obj, this.source.config);
        this.elementSource.element.parentNode?.replaceChild(this.returnContainer.fag, this.elementSource.element);
        this.returnContainer.raws.push(...rr);
        return _OperatorExecuter__WEBPACK_IMPORTED_MODULE_2__.ExecuteState.EXECUTE;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/operators/DrForOf.ts":
/*!***********************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/operators/DrForOf.ts ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DrForOf: () => (/* binding */ DrForOf)
/* harmony export */ });
/* harmony import */ var _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./OperatorExecuterAttrRequire */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuterAttrRequire.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _OperatorExecuter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OperatorExecuter */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuter.ts");
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");




class DrForOf extends _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__.OperatorExecuterAttrRequire {
    constructor(rawSet, render, returnContainer, elementSource, source, afterCallBack) {
        source.operatorAround = undefined;
        super(rawSet, render, returnContainer, elementSource, source, afterCallBack, false);
    }
    async executeAttrRequire(attr) {
        // console.log('?')
        const itRandom = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drItOtherEncoding(this.elementSource.element, 'DrForOf');
        const vars = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drVarEncoding(this.elementSource.element, this.elementSource.attrs.drVarOption ?? '');
        const newTemp = this.source.config.window.document.createElement('temp');
        const variableName = this.elementSource.element.getAttribute(_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_VARIABLE_NAME_OPTIONNAME);
        const itemVariableName = this.elementSource.element.getAttribute(_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_ITEM_VARIABLE_NAME_OPTIONNAME);
        // const drAttrOption = this.elementSource.element.getAttribute(RawSet.DR_ATTR_OPTIONNAME);
        const itemIndexVariableName = this.elementSource.element.getAttribute(_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_ITEM_INDEX_VARIABLE_NAME_OPTIONNAME);
        const hasVariableName = this.elementSource.element.hasAttribute(_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_VARIABLE_NAME_OPTIONNAME);
        const hasItemVariableName = this.elementSource.element.hasAttribute(_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_ITEM_VARIABLE_NAME_OPTIONNAME);
        const hasItemIndexVariableName = this.elementSource.element.hasAttribute(_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_ITEM_INDEX_VARIABLE_NAME_OPTIONNAME);
        // console.log('----!', this.elementSource.attrs)
        // ScriptUtils.evalReturn()
        const t0 = performance.now();
        _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_3__.ObjectUtils.Script.evaluate(`
                    ${this.render.bindScript}
                    ${this.elementSource.attrs.drBeforeOption ?? ''}
                    var i = -1; 
                    const forOf = ${_dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_3__.ObjectUtils.Path.toOptionalChainPath(attr)};
                    const forOfStr = '('+\`${attr}\`.trim() + ')';
                    // console.log('forOf---',forOf);
                    // debugger;
                    if (forOf) {
                        for(const it of forOf) {
                          // console.log('forOf---it',it);
                            i++;
                            var destIt = it;
                            if (/\\[(.*,?)\\],/g.test(forOfStr)) {
                                if (typeof it === 'string') {
                                    destIt = it;
                                } else {
                                    destIt = forOfStr.substring(1, forOfStr.length-1).split(',')[i];
                                }
                            } else if (forOf.isRange) {
                                    destIt = it;
                            } else {
                                destIt = forOfStr + '[' + i +']'
                            }
                            destIt = '(' + destIt + ')';
                            
                            const n = this.__render.element.cloneNode(true);
                            Object.entries(this.__render.drAttr).filter(([k,v]) => k !== 'drForOf' && k !== 'drNextOption' && v).forEach(([k, v]) => n.setAttribute(this.__render.drAttrsOriginName[k], v));
                            n.getAttributeNames().forEach(it => n.setAttribute(it, n.getAttribute(it).replace(/\\#it\\#/g, destIt).replace(/\\#nearForOfIt\\#/g, destIt).replace(/\\#it\\#/g, destIt).replace(/\\#nearForOfIndex\\#/g, i)))
                            if (${hasVariableName} && '${variableName}') {
                              n.getAttributeNames().forEach(it => n.setAttribute(it, n.getAttribute(it).replaceAll('#${variableName}#', forOfStr)));
                            }
                            if (${hasItemVariableName} && '${itemVariableName}') {
                              n.getAttributeNames().forEach(it => n.setAttribute(it, n.getAttribute(it).replaceAll('#${itemVariableName}#', destIt)));
                            }
                            if (${hasItemIndexVariableName} && '${itemIndexVariableName}') {
                              n.getAttributeNames().forEach(it => n.setAttribute(it, n.getAttribute(it).replaceAll('#${itemIndexVariableName}#', i)));
                            }
                            
                            const hasDrOptionAttr = n.hasAttribute('${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_ATTR_OPTIONNAME}');
                            if (hasDrOptionAttr) {
                              const drOptionAttr = n.getAttribute('${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_ATTR_OPTIONNAME}');
                              const drOptionAttrResult = $scriptUtils.evaluateReturn(drOptionAttr, this);
                              Array.from(Object.entries(drOptionAttrResult??{})).forEach(([k,v])=>{
                                if (v === null) {
                                  n.removeAttribute(k);
                                } else {
                                  n.setAttribute(k,v);
                                }
                              })
                            
                            }
                            const hasDrOptionIf = n.hasAttribute('${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_IF_OPTIONNAME}');
                            if (hasDrOptionIf) {
                              const drOptionIf = n.getAttribute('${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_IF_OPTIONNAME}');
                              const e = $scriptUtils.evaluateReturn(drOptionIf, this);
                              if(!e) {
                                continue;
                              }
                            
                            }
                            
                            const drOptionAttr = n.getAttribute('${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_DETECT_ATTR_OPTIONNAME}');
                            if (drOptionAttr) {
                              const drOptionAttrResult = $scriptUtils.evaluateReturn(drOptionAttr, this);
                              Array.from(Object.entries(drOptionAttrResult??{})).forEach(([k,v])=>{
                                if (v === null) {
                                  n.removeAttribute(k);
                                } else {
                                  n.setAttribute(k,v);
                                }
                              })
                            }
                            
                            const drOptionFilter = n.getAttribute('${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_DETECT_FILTER_OPTIONNAME}');
                            if (drOptionFilter) {
                              const drOptionFilterResult = $scriptUtils.evaluateReturn(drOptionFilter, this);
                              // console.log('---drforof----', drOptionFilter, drOptionFilterResult)
                              if (!drOptionFilterResult) {
                                continue;
                              }
                            }

                            n.innerHTML = n.innerHTML.replace(/\\#it\\#/g, destIt).replace(/\\#index\\#/g, i);
                            if (${hasVariableName} && '${variableName}') {
                              n.innerHTML = n.innerHTML.replaceAll('#${variableName}#', forOfStr);
                            }
                            if (${hasItemVariableName} && '${itemVariableName}') {
                              n.innerHTML = n.innerHTML.replaceAll('#${itemVariableName}#', destIt);
                            }
                            if (${hasItemIndexVariableName} && '${itemIndexVariableName}') {
                              n.innerHTML = n.innerHTML.replaceAll('#${itemIndexVariableName}#', i);
                            }
                   
                            if (this.__render.drStripOption === 'true') {
                                Array.from(n.childNodes).forEach(it => this.__render.fag.append(it));
                            } else {
                                this.__render.fag.append(n);
                            }
                           
                        }
                        
                        if('${this.elementSource.attrs.drNextOption}' !== 'null') {
                            const n = this.__render.element.cloneNode(true);
                            Object.entries(this.__render.drAttr).filter(([k,v]) => k !== 'drForOf' && k !== 'drNextOption' && v).forEach(([k, v]) => n.setAttribute(this.__render.drAttrsOriginName[k], v));
                            const [name, idx] = '${this.elementSource.attrs.drNextOption}'.split(',');
                            n.setAttribute('${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_FOR_OF_NAME}', name + '[' + idx + ']');
                            n.setAttribute('${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_NEXT_OPTIONNAME}', name + ',' +  (Number(idx) + 1));
                            this.__render.fag.append(n);
                        }
                    }
                    ${this.elementSource.attrs.drAfterOption ?? ''}
                    `, Object.assign(this.source.obj, {
            __render: Object.freeze({
                drStripOption: this.elementSource.attrs.drStripOption,
                drAttr: this.elementSource.attrs,
                drAttrsOriginName: _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drAttrsOriginName,
                fag: newTemp,
                ...this.render
                // eslint-disable-next-line no-use-before-define
            })
        }));
        _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drVarDecoding(newTemp, vars);
        _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drItOtherDecoding(newTemp, itRandom);
        const tempalte = this.source.config.window.document.createElement('template');
        tempalte.innerHTML = newTemp.innerHTML;
        this.returnContainer.fag.append(tempalte.content);
        const rr = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.checkPointCreates(this.returnContainer.fag, this.source.obj, this.source.config);
        this.elementSource.element.parentNode?.replaceChild(this.returnContainer.fag, this.elementSource.element);
        // const rrr = rr.flatMap(it => it.render(obj, config));// .flat();
        this.returnContainer.raws.push(...rr);
        // console.log(`drForOf    ${performance.now() - t0} .`);
        return _OperatorExecuter__WEBPACK_IMPORTED_MODULE_2__.ExecuteState.EXECUTE;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/operators/DrForm.ts":
/*!**********************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/operators/DrForm.ts ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DrForm: () => (/* binding */ DrForm)
/* harmony export */ });
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _validators_Validator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../validators/Validator */ "../../packages/@dooboostore/dom-render/src/validators/Validator.ts");
/* harmony import */ var _events_EventManager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../events/EventManager */ "../../packages/@dooboostore/dom-render/src/events/EventManager.ts");
/* harmony import */ var _validators_ValidatorArray__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../validators/ValidatorArray */ "../../packages/@dooboostore/dom-render/src/validators/ValidatorArray.ts");
/* harmony import */ var _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./OperatorExecuterAttrRequire */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuterAttrRequire.ts");
/* harmony import */ var _OperatorExecuter__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./OperatorExecuter */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuter.ts");
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");







class DrForm extends _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_4__.OperatorExecuterAttrRequire {
    constructor(rawSet, render, returnContainer, elementSource, source, afterCallBack) {
        super(rawSet, render, returnContainer, elementSource, source, afterCallBack, false);
    }
    async executeAttrRequire(attr) {
        _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_0__.RawSet.drFormOtherMoveAttr(this.elementSource.element, 'name', 'temp-name', this.source.config);
        const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_6__.ObjectUtils.Script.evaluateReturn(`${attr}`, this.source.obj);
        const childs = Array.from(this.elementSource.element.querySelectorAll('[name]'));
        const fromName = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_6__.ObjectUtils.Script.evaluateReturn(this.elementSource.element.getAttribute(`${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_0__.RawSet.DR_FORM_NAME}:name`) ?? '', this.source.obj);
        const thisName = fromName ?? this.elementSource.element.getAttribute('name');
        // //  Input 
        if (childs.length <= 0 && thisName) {
            childs.push(this.elementSource.element);
        }
        else {
            if (data instanceof _validators_Validator__WEBPACK_IMPORTED_MODULE_1__.Validator) {
                data.setTarget(this.elementSource.element);
            }
        }
        childs.forEach(it => {
            const eventName = it.getAttribute(`${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_0__.RawSet.DR_FORM_NAME}:event`) ?? 'change';
            const validatorName = it.getAttribute(`${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_0__.RawSet.DR_FORM_NAME}:validator`);
            const attrEventName = _events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.attrPrefix + 'event-' + eventName;
            let varpath = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_6__.ObjectUtils.Script.evaluateReturn(this.elementSource.element.getAttribute(`${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_0__.RawSet.DR_FORM_NAME}:name`) ?? '', this.source.obj) ?? it.getAttribute('name');
            if (varpath != null) {
                if (validatorName) {
                    _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_6__.ObjectUtils.Script.evaluate(`
                                ${this.render.bindScript}
                                const validator = typeof ${validatorName} ==='function' ?  new  ${validatorName}() : ${validatorName};
                                ${attr}['${varpath}'] = validator;
                            `, Object.assign(this.source.obj, {
                        __render: Object.freeze({
                            drStripOption: this.elementSource.attrs.drStripOption,
                            ...this.render
                        })
                    }));
                }
                varpath = `${attr}['${varpath}']`;
                const data = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_6__.ObjectUtils.Script.evaluateReturn(`${varpath}`, this.source.obj);
                if (data instanceof _validators_ValidatorArray__WEBPACK_IMPORTED_MODULE_3__.ValidatorArray) {
                    it.setAttribute(attrEventName, `${varpath}.setArrayValue($target, $target.value, $event); ${it.getAttribute(attrEventName) ?? ''};`);
                    data.addValidator(it.value, it);
                }
                else if (data instanceof _validators_Validator__WEBPACK_IMPORTED_MODULE_1__.Validator) {
                    // varpath += (varpath ? '.value' : 'value');
                    // varpath = drAttr.drForm + '.' + varpath;
                    // it.setAttribute(attrEventName, `${varpath} = $target.value; ${target}=$target; ${event}=$event;`);
                    it.setAttribute(attrEventName, `${varpath}.set($target.value, $target, $event); ${it.getAttribute(attrEventName) ?? ''};`);
                    data.setTarget(it);
                    data.value = it.value;
                }
                else {
                    it.setAttribute(attrEventName, `${varpath} = $target.value;`);
                }
            }
        });
        _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_0__.RawSet.drFormOtherMoveAttr(this.elementSource.element, 'temp-name', 'name', this.source.config);
        this.returnContainer.raws.push(..._rawsets_RawSet__WEBPACK_IMPORTED_MODULE_0__.RawSet.checkPointCreates(this.elementSource.element, this.source.obj, this.source.config));
        return _OperatorExecuter__WEBPACK_IMPORTED_MODULE_5__.ExecuteState.EXECUTE;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/operators/DrIf.ts":
/*!********************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/operators/DrIf.ts ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DrIf: () => (/* binding */ DrIf)
/* harmony export */ });
/* harmony import */ var _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./OperatorExecuterAttrRequire */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuterAttrRequire.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _OperatorExecuter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OperatorExecuter */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuter.ts");
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");




class DrIf extends _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__.OperatorExecuterAttrRequire {
    constructor(rawSet, render, returnContainer, elementSource, source, afterCallBack) {
        source.operatorAround = undefined;
        super(rawSet, render, returnContainer, elementSource, source, afterCallBack, false);
    }
    async executeAttrRequire(attr) {
        const itRandom = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drItOtherEncoding(this.elementSource.element, 'DrIf');
        const vars = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drVarEncoding(this.elementSource.element, this.elementSource.attrs.drVarOption ?? '');
        const newTemp = this.source.config.window.document.createElement('temp');
        // Object.entries(this.__render.drAttr).filter(([k,v]) => k !== 'drIf' && v).forEach(([k, v]) => n.setAttribute(this.__render.drAttrsOriginName[k], v)); <--   attr          
        const keepgoing = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_3__.ObjectUtils.Script.evaluate(`
                ${this.render.bindScript}
                ${this.elementSource.attrs.drBeforeOption ?? ''}
                if ($rawSet.data === (${_dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_3__.ObjectUtils.Path.toOptionalChainPath(attr)})) {
                    return false;
                }
                $rawSet.data = ${_dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_3__.ObjectUtils.Path.toOptionalChainPath(attr)};
                if($rawSet.data) {
                    const n = $element.cloneNode(true);
                    Object.entries(this.__render.drAttr).filter(([k,v]) => k !== 'drIf' && v).forEach(([k, v]) => n.setAttribute(this.__render.drAttrsOriginName[k], v));
                    var destIt = ${this.elementSource.attrs.drItOption};
                    if (destIt !== undefined) {
                     //  .. ...
                        Array.from(n.getAttributeNames()).forEach(it => n.setAttribute(it, n.getAttribute(it).replace(/\\#DrIFIt\\#/g, destIt)))
                        n.innerHTML = n.innerHTML.replace(/\\#DrIFIt\\#/g, destIt);
                    }
                    if (this.__render.drStripOption === 'true') {
                        Array.from(n.childNodes).forEach(it => this.__render.fag.append(it));
                    } else {
                        this.__render.fag.append(n);
                    }
                }
                ${this.elementSource.attrs.drAfterOption ?? ''};
                return true;
                `, Object.assign(this.source.obj, {
            __render: Object.freeze({
                fag: newTemp,
                drAttr: this.elementSource.attrs,
                drAttrsOriginName: _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drAttrsOriginName,
                drStripOption: this.elementSource.attrs.drStripOption,
                ...this.render
            })
        }));
        // TODO: ??  ?
        if (keepgoing === false) {
            return _OperatorExecuter__WEBPACK_IMPORTED_MODULE_2__.ExecuteState.STOP;
        }
        _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drVarDecoding(newTemp, vars);
        _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drItOtherDecoding(newTemp, itRandom);
        // const bypass = (newTemp.innerHTML ?? '').trim().length <= 0;
        const tempalte = this.source.config.window.document.createElement('template');
        tempalte.innerHTML = newTemp.innerHTML;
        this.returnContainer.fag.append(tempalte.content);
        const rr = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.checkPointCreates(this.returnContainer.fag, this.source.obj, this.source.config);
        this.elementSource.element.parentNode?.replaceChild(this.returnContainer.fag, this.elementSource.element);
        this.returnContainer.raws.push(...rr);
        return _OperatorExecuter__WEBPACK_IMPORTED_MODULE_2__.ExecuteState.EXECUTE;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/operators/DrInnerHTML.ts":
/*!***************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/operators/DrInnerHTML.ts ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DrInnerHTML: () => (/* binding */ DrInnerHTML)
/* harmony export */ });
/* harmony import */ var _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./OperatorExecuterAttrRequire */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuterAttrRequire.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _OperatorExecuter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OperatorExecuter */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuter.ts");
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");




class DrInnerHTML extends _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__.OperatorExecuterAttrRequire {
    constructor(rawSet, render, returnContainer, elementSource, source, afterCallBack) {
        super(rawSet, render, returnContainer, elementSource, source, afterCallBack, false);
    }
    async executeAttrRequire(attr) {
        const newTemp = this.source.config.window.document.createElement('temp');
        _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_3__.ObjectUtils.Script.evaluate(`
                        ${this.render.bindScript}
                        const n = $element.cloneNode(true);
                        ${this.elementSource.attrs.drBeforeOption ?? ''}
                        n.innerHTML = ${attr};
                        if (this.__render.drStripOption === 'true') {
                            Array.from(n.childNodes).forEach(it => this.__render.fag.append(it));
                        } else {
                            this.__render.fag.append(n);
                        }
                        ${this.elementSource.attrs.drAfterOption ?? ''}
                    `, Object.assign(this.source.obj, {
            __render: Object.freeze({
                drStripOption: this.elementSource.attrs.drStripOption,
                fag: newTemp,
                ...this.render
                // eslint-disable-next-line no-use-before-define
            })
        }));
        const tempalte = this.source.config.window.document.createElement('template');
        tempalte.innerHTML = newTemp.innerHTML;
        this.returnContainer.fag.append(tempalte.content);
        const rr = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.checkPointCreates(this.returnContainer.fag, this.source.obj, this.source.config);
        this.elementSource.element.parentNode?.replaceChild(this.returnContainer.fag, this.elementSource.element);
        this.returnContainer.raws.push(...rr);
        return _OperatorExecuter__WEBPACK_IMPORTED_MODULE_2__.ExecuteState.EXECUTE;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/operators/DrInnerText.ts":
/*!***************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/operators/DrInnerText.ts ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DrInnerText: () => (/* binding */ DrInnerText)
/* harmony export */ });
/* harmony import */ var _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./OperatorExecuterAttrRequire */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuterAttrRequire.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _OperatorExecuter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OperatorExecuter */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuter.ts");
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");




class DrInnerText extends _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__.OperatorExecuterAttrRequire {
    constructor(rawSet, render, returnContainer, elementSource, source, afterCallBack) {
        super(rawSet, render, returnContainer, elementSource, source, afterCallBack, false);
    }
    async executeAttrRequire(attr) {
        const newTemp = this.source.config.window.document.createElement('temp');
        _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_3__.ObjectUtils.Script.evaluate(` 
                        ${this.render.bindScript}
                        const n = $element.cloneNode(true);  
                        ${this.elementSource.attrs.drBeforeOption ?? ''}
                        n.innerText = ${attr};
                        if (this.__render.drStripOption === 'true') {
                            Array.from(n.childNodes).forEach(it => this.__render.fag.append(it));
                        } else {
                            this.__render.fag.append(n);
                        }
                        ${this.elementSource.attrs.drAfterOption ?? ''}
                    `, Object.assign(this.source.obj, {
            __render: Object.freeze({
                drStripOption: this.elementSource.attrs.drStripOption,
                fag: newTemp,
                ...this.render
            })
        }));
        const tempalte = this.source.config.window.document.createElement('template');
        tempalte.innerHTML = newTemp.innerHTML;
        this.returnContainer.fag.append(tempalte.content);
        const rr = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.checkPointCreates(this.returnContainer.fag, this.source.obj, this.source.config);
        this.elementSource.element.parentNode?.replaceChild(this.returnContainer.fag, this.elementSource.element);
        this.returnContainer.raws.push(...rr);
        return _OperatorExecuter__WEBPACK_IMPORTED_MODULE_2__.ExecuteState.EXECUTE;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/operators/DrPre.ts":
/*!*********************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/operators/DrPre.ts ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DrPre: () => (/* binding */ DrPre)
/* harmony export */ });
/* harmony import */ var _OperatorExecuter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./OperatorExecuter */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuter.ts");

class DrPre extends _OperatorExecuter__WEBPACK_IMPORTED_MODULE_0__.OperatorExecuter {
    constructor(rawSet, render, returnContainer, elementSource, source, afterCallBack) {
        source.operatorAround = undefined;
        super(rawSet, render, returnContainer, elementSource, source, afterCallBack);
    }
    async execute(value) {
        return (value != null) ? _OperatorExecuter__WEBPACK_IMPORTED_MODULE_0__.ExecuteState.EXECUTE : _OperatorExecuter__WEBPACK_IMPORTED_MODULE_0__.ExecuteState.NO_EXECUTE;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/operators/DrRepeat.ts":
/*!************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/operators/DrRepeat.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DrRepeat: () => (/* binding */ DrRepeat)
/* harmony export */ });
/* harmony import */ var _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./OperatorExecuterAttrRequire */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuterAttrRequire.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _events_EventManager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../events/EventManager */ "../../packages/@dooboostore/dom-render/src/events/EventManager.ts");
/* harmony import */ var _OperatorExecuter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./OperatorExecuter */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuter.ts");
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");





class DrRepeat extends _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__.OperatorExecuterAttrRequire {
    constructor(rawSet, render, returnContainer, elementSource, source, afterCallBack) {
        source.operatorAround = undefined;
        super(rawSet, render, returnContainer, elementSource, source, afterCallBack, false);
    }
    async executeAttrRequire(attr) {
        const itRandom = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drItOtherEncoding(this.elementSource.element);
        const vars = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drVarEncoding(this.elementSource.element, this.elementSource.attrs.drVarOption ?? '');
        const newTemp = this.source.config.window.document.createElement('temp');
        _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluate(`
                    ${this.render.bindScript}
                    ${this.elementSource.attrs.drBeforeOption ?? ''}
                    var i = 0; 
                    const repeat = ${attr};
                    const repeatStr = \`${attr}\`;
                    let range = repeat;
                    if (typeof repeat === 'number') {
                        range = ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.RANGE_VARNAME}(repeat);
                    } 
                    for(const it of range) {
                        var destIt = it;
                        if (range.isRange) {
                            destIt = it;
                        }  else {
                            destIt = repeatStr + '[' + i +']'
                        }
                        const n = this.__render.element.cloneNode(true);
                        n.getAttributeNames().forEach(it => n.setAttribute(it, n.getAttribute(it).replace(/\\#it\\#/g, destIt).replace(/\\#nearRangeIt\\#/g, destIt).replace(/\\#nearRangeIndex\\#/g, destIt)))
                        n.innerHTML = n.innerHTML.replace(/\\#it\\#/g, destIt).replace(/\\#index\\#/g, destIt);
                        
                        if (this.__render.drStripOption === 'true') {
                            Array.from(n.childNodes).forEach(it => this.__render.fag.append(it));
                        } else {
                            this.__render.fag.append(n);
                        }
                        i++;
                    }
                    ${this.elementSource.attrs.drAfterOption ?? ''}
                    `, Object.assign(this.source.obj, {
            __render: Object.freeze({
                fag: newTemp,
                drStripOption: this.elementSource.attrs.drStripOption,
                ...this.render
            })
        }));
        _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drVarDecoding(newTemp, vars);
        _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drItOtherDecoding(newTemp, itRandom);
        const tempalte = this.source.config.window.document.createElement('template');
        tempalte.innerHTML = newTemp.innerHTML;
        this.returnContainer.fag.append(tempalte.content);
        const rr = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.checkPointCreates(this.returnContainer.fag, this.source.obj, this.source.config);
        this.elementSource.element.parentNode?.replaceChild(this.returnContainer.fag, this.elementSource.element);
        this.returnContainer.raws.push(...rr);
        return _OperatorExecuter__WEBPACK_IMPORTED_MODULE_3__.ExecuteState.EXECUTE;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/operators/DrStripElement.ts":
/*!******************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/operators/DrStripElement.ts ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DrStripElement: () => (/* binding */ DrStripElement)
/* harmony export */ });
/* harmony import */ var _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./OperatorExecuterAttrRequire */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuterAttrRequire.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _OperatorExecuter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OperatorExecuter */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuter.ts");
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");




class DrStripElement extends _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__.OperatorExecuterAttrRequire {
    constructor(rawSet, render, returnContainer, elementSource, source, afterCallBack) {
        source.operatorAround = undefined;
        super(rawSet, render, returnContainer, elementSource, source, afterCallBack, false);
    }
    async executeAttrRequire(attr) {
        // const itRandom = RawSet.drItOtherEncoding(this.elementSource.element, 'DrStripElement');
        // const vars = RawSet.drVarEncoding(this.elementSource.element, this.elementSource.attrs.drVarOption ?? '');
        const newTemp = this.source.config.window.document.createElement('temp');
        // Object.entries(this.__render.drAttr).filter(([k,v]) => k !== 'drIf' && v).forEach(([k, v]) => n.setAttribute(this.__render.drAttrsOriginName[k], v)); <--   attr          
        _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_3__.ObjectUtils.Script.evaluate(`
                ${this.render.bindScript}
                ${this.elementSource.attrs.drBeforeOption ?? ''}
                const n = $element.cloneNode(true);
                if(${attr}) {
                  Array.from(n.childNodes).forEach(it => this.__render.fag.append(it));
                } else {
                  this.__render.fag.append(n);
                }
                ${this.elementSource.attrs.drAfterOption ?? ''};
                return true;
                `, Object.assign(this.source.obj, {
            __render: Object.freeze({
                fag: newTemp,
                drAttr: this.elementSource.attrs,
                drAttrsOriginName: _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drAttrsOriginName,
                drStripOption: this.elementSource.attrs.drStripOption,
                ...this.render
            })
        }));
        const tempalte = this.source.config.window.document.createElement('template');
        tempalte.innerHTML = newTemp.innerHTML;
        this.returnContainer.fag.append(tempalte.content);
        const rr = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.checkPointCreates(this.returnContainer.fag, this.source.obj, this.source.config);
        this.elementSource.element.parentNode?.replaceChild(this.returnContainer.fag, this.elementSource.element);
        this.returnContainer.raws.push(...rr);
        return _OperatorExecuter__WEBPACK_IMPORTED_MODULE_2__.ExecuteState.EXECUTE;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/operators/DrTargetAttr.ts":
/*!****************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/operators/DrTargetAttr.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DrTargetAttr: () => (/* binding */ DrTargetAttr)
/* harmony export */ });
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _OperatorExecuter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OperatorExecuter */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuter.ts");


class DrTargetAttr extends _OperatorExecuter__WEBPACK_IMPORTED_MODULE_1__.OperatorExecuter {
    constructor(rawSet, render, returnContainer, elementSource, source, afterCallBack) {
        source.operatorAround = undefined;
        super(rawSet, render, returnContainer, elementSource, source, afterCallBack, false);
    }
    async execute() {
        const attributeNames = this.elementSource.element.getAttributeNames();
        const targetAttr = this.source.config?.targetAttrs?.find(it => attributeNames.includes(it.name));
        if (targetAttr) {
            const attrName = targetAttr.name;
            const attrValue = this.rawSet.getAttributeAndDelete(this.elementSource.element, attrName);
            if (attrValue && attrName && (!this.elementSource.attrs.drForOf && !this.elementSource.attrs.drFor && !this.elementSource.attrs.drRepeat)) {
                const documentFragment = targetAttr.callBack(this.elementSource.element, attrValue, this.source.obj, this.rawSet);
                if (documentFragment) {
                    const rr = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_0__.RawSet.checkPointCreates(documentFragment, this.source.obj, this.source.config);
                    this.elementSource.element.parentNode?.replaceChild(documentFragment, this.elementSource.element);
                    this.returnContainer.raws.push(...rr);
                    this.afterCallBack.onAttrInitCallBacks.push({
                        attrName,
                        attrValue,
                        obj: this.source.obj
                    });
                    targetAttr?.complete?.(this.elementSource.element, attrValue, this.source.obj, this.rawSet);
                }
            }
            return _OperatorExecuter__WEBPACK_IMPORTED_MODULE_1__.ExecuteState.EXECUTE;
        }
        return _OperatorExecuter__WEBPACK_IMPORTED_MODULE_1__.ExecuteState.NO_EXECUTE;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/operators/DrTargetElement.ts":
/*!*******************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/operators/DrTargetElement.ts ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DrTargetElement: () => (/* binding */ DrTargetElement)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _OperatorExecuter__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./OperatorExecuter */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuter.ts");
/* harmony import */ var _rawsets__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../rawsets */ "../../packages/@dooboostore/dom-render/src/rawsets/index.ts");




//    TargetElement .
class DrTargetElement extends _OperatorExecuter__WEBPACK_IMPORTED_MODULE_2__.OperatorExecuter {
    constructor(rawSet, render, returnContainer, elementSource, source, afterCallBack) {
        source.operatorAround = undefined;
        super(rawSet, render, returnContainer, elementSource, source, afterCallBack, false);
    }
    async execute() {
        let targetElement = undefined;
        let isTargetElementElement = this.elementSource.element.tagName.toLowerCase() === _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_TARGET_ELEMENT_ELEMENTNAME.toLowerCase();
        if (isTargetElementElement) {
            const targetElementTagName = this.elementSource.element.getAttribute(`${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_TARGET_ELEMENT_ELEMENTNAME}:is`)?.toLowerCase();
            targetElement = this.source.config?.targetElements?.find(it => it.name.toLowerCase() === targetElementTagName);
        }
        else {
            targetElement = this.source.config?.targetElements?.find(it => it.name.toLowerCase() === this.elementSource.element.tagName.toLowerCase());
        }
        // console.log('--------------tar', isTargetElementElement, targetElement, this.elementSource.element.tagName);
        if (targetElement) {
            if (this.rawSet.point.start instanceof this.source.config.window.HTMLMetaElement &&
                this.rawSet.point.end instanceof this.source.config.window.HTMLMetaElement) {
                this.rawSet.point.start.setAttribute('this-path', `this.${_rawsets__WEBPACK_IMPORTED_MODULE_3__.DomRenderComponentMetaKey.DOMRENDER_COMPONENTS_KEY}.${this.rawSet.uuid}`);
                this.rawSet.point.end.setAttribute('this-path', `this.${_rawsets__WEBPACK_IMPORTED_MODULE_3__.DomRenderComponentMetaKey.DOMRENDER_COMPONENTS_KEY}.${this.rawSet.uuid}`);
            }
            const documentFragment = await targetElement.callBack(this.elementSource.element, this.source.obj, this.rawSet, this.elementSource.attrs, this.source.config);
            if (documentFragment) {
                const detectAction = this.elementSource.element.getAttribute(_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.DR_DETECT_NAME);
                // const dictionaryKey = this.elementSource.element.getAttribute(RawSet.DR_DICTIONARY_OPTIONKEYNAME);
                // console.log('dictionaryKey', dictionaryKey);
                // const render = (documentFragment as any).render;
                this.rawSet.dataSet.fragment = documentFragment;
                // if (documentFragment) {
                //     const tempDiv = this.source.config.window.document.createElement('div');
                //     tempDiv.appendChild(documentFragment.cloneNode(true));
                //     console.log('DocumentFragment innerHTML:', tempDiv.innerHTML);
                // }
                // this.rawSet.dataSet??={};
                // this.rawSet.dataSet.data = render.component;
                if (detectAction && this.rawSet.dataSet.render) {
                    // TODO: ?
                    this.rawSet.detect = {
                        action: () => {
                            const script = `var $component = this.__render.component; var $element = this.__render.element; var $innerHTML = this.__render.innerHTML; var $attribute = this.__render.attribute;  ${detectAction} `;
                            _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_0__.ObjectUtils.Script.evaluate(script, Object.assign(this.source.obj, {
                                __render: this.rawSet.dataSet.render
                            }));
                        }
                    };
                }
                // fag.append(documentFragment)
                // console.log('----------1', ElementUtils.toInnerHTML(documentFragment, {document: this.source.config.window.document}));
                // await Promises.sleep(1000)
                let targetFragment = documentFragment;
                if (targetElement.noStrip) {
                    // documentFragment.firstElementChild.classList.add(`${this.rawSet.uuid}___DrTargetElement`)
                    const fragment = this.source.config.window.document.createDocumentFragment();
                    Array.from(documentFragment.firstElementChild?.childNodes || []).forEach(child => {
                        // fragment.appendChild(child.cloneNode(true));
                        fragment.appendChild(child);
                    });
                    // fragment.append(documentFragment.firstElementChild);
                    targetFragment = fragment;
                }
                // console.log('----------2', ElementUtils.toInnerHTML(targetFragment, {document: this.source.config.window.document}));
                const rr = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.checkPointCreates(targetFragment, this.source.obj, this.source.config);
                rr.forEach((it, index) => {
                    // const z = ElementUtils.toInnerHTML(it.dataSet.fragment, {document: this.source.config.window.document});
                    // console.log('-z--z('+index+')', z, it);
                    // it.point.start;
                    // //  comment element 
                    // const comment = this.source.config.window.document.createComment('  comment element');
                    // it.point.start.parentNode?.insertBefore(comment, it.point.start.nextSibling);
                });
                // for (let rawSet of rr) {
                //   await rawSet.render(this.source.obj, this.source.config)
                // }
                // console.log('cccccccccccccccccccccc', rr, typeof Window);
                if (targetElement.noStrip) {
                    Array.from(targetFragment.childNodes || []).forEach(child => {
                        documentFragment.firstElementChild?.appendChild(child);
                    });
                }
                this.elementSource.element.parentNode?.replaceChild(documentFragment, this.elementSource.element);
                this.returnContainer.raws.push(...rr);
                this.afterCallBack.onElementInitCallBacks.push({
                    name: targetElement.name.toLowerCase(),
                    obj: this.source.obj,
                    targetElement,
                    creatorMetaData: targetElement.__creatorMetaData
                });
                // console.log('sssssssssssssss', this.source.obj);
                targetElement?.complete?.(this.elementSource.element, this.source.obj, this.rawSet);
            }
            return _OperatorExecuter__WEBPACK_IMPORTED_MODULE_2__.ExecuteState.EXECUTE;
        }
        return _OperatorExecuter__WEBPACK_IMPORTED_MODULE_2__.ExecuteState.NO_EXECUTE;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/operators/DrTargetElementIsElement.ts":
/*!****************************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/operators/DrTargetElementIsElement.ts ***!
  \****************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DrTargetElementIsElement: () => (/* binding */ DrTargetElementIsElement)
/* harmony export */ });
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _OperatorExecuter__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./OperatorExecuter */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuter.ts");
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");
/* harmony import */ var _rawsets__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../rawsets */ "../../packages/@dooboostore/dom-render/src/rawsets/index.ts");




//    TargetElement .
class DrTargetElementIsElement extends _OperatorExecuter__WEBPACK_IMPORTED_MODULE_1__.OperatorExecuter {
    constructor(rawSet, render, returnContainer, elementSource, source, afterCallBack) {
        source.operatorAround = undefined;
        super(rawSet, render, returnContainer, elementSource, source, afterCallBack, false);
    }
    async execute(attr) {
        if (!attr) {
            return _OperatorExecuter__WEBPACK_IMPORTED_MODULE_1__.ExecuteState.NO_EXECUTE;
        }
        const targetElement = this.source.config?.targetElements?.find(it => it.name.toLowerCase() === attr.toLowerCase());
        // console.log('--------------tar', targetElement)
        if (targetElement) {
            if (this.rawSet.point.start instanceof this.source.config.window.HTMLMetaElement && this.rawSet.point.end instanceof this.source.config.window.HTMLMetaElement) {
                this.rawSet.point.start.setAttribute('this-path', `this.${_rawsets__WEBPACK_IMPORTED_MODULE_3__.DomRenderComponentMetaKey.DOMRENDER_COMPONENTS_KEY}.${this.rawSet.uuid}`);
                this.rawSet.point.end.setAttribute('this-path', `this.${_rawsets__WEBPACK_IMPORTED_MODULE_3__.DomRenderComponentMetaKey.DOMRENDER_COMPONENTS_KEY}.${this.rawSet.uuid}`);
            }
            const documentFragment = await targetElement.callBack(this.elementSource.element, this.source.obj, this.rawSet, this.elementSource.attrs, this.source.config);
            if (documentFragment) {
                const detectAction = this.elementSource.element.getAttribute(_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_0__.RawSet.DR_DETECT_NAME);
                this.rawSet.dataSet.fragment = documentFragment;
                if (detectAction && this.rawSet.dataSet.render) {
                    // TODO: ?
                    this.rawSet.detect = {
                        action: () => {
                            const script = `var $component = this.__render.component; var $element = this.__render.element; var $innerHTML = this.__render.innerHTML; var $attribute = this.__render.attribute;  ${detectAction} `;
                            _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_2__.ObjectUtils.Script.evaluate(script, Object.assign(this.source.obj, {
                                __render: this.rawSet.dataSet.render
                            }));
                        }
                    };
                }
                // dr-replace-target-element-is   NoStrip 
                const noStrip = targetElement.noStrip;
                let targetFragment = documentFragment;
                if (noStrip) {
                    const fragment = this.source.config.window.document.createDocumentFragment();
                    Array.from(documentFragment.firstElementChild?.childNodes || []).forEach(child => {
                        fragment.appendChild(child);
                    });
                    targetFragment = fragment;
                }
                const rr = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_0__.RawSet.checkPointCreates(targetFragment, this.source.obj, this.source.config);
                if (noStrip) {
                    Array.from(targetFragment.childNodes || []).forEach(child => {
                        documentFragment.firstElementChild?.appendChild(child);
                    });
                }
                this.elementSource.element.parentNode?.replaceChild(documentFragment, this.elementSource.element);
                this.returnContainer.raws.push(...rr);
                this.afterCallBack.onElementInitCallBacks.push({
                    name: targetElement.name.toLowerCase(),
                    obj: this.source.obj,
                    targetElement,
                    creatorMetaData: targetElement.__creatorMetaData
                });
                targetElement?.complete?.(this.elementSource.element, this.source.obj, this.rawSet);
            }
            return _OperatorExecuter__WEBPACK_IMPORTED_MODULE_1__.ExecuteState.EXECUTE;
        }
        return _OperatorExecuter__WEBPACK_IMPORTED_MODULE_1__.ExecuteState.NO_EXECUTE;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/operators/DrThis.ts":
/*!**********************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/operators/DrThis.ts ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DrThis: () => (/* binding */ DrThis)
/* harmony export */ });
/* harmony import */ var _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./OperatorExecuterAttrRequire */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuterAttrRequire.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _components_ComponentSet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../components/ComponentSet */ "../../packages/@dooboostore/dom-render/src/components/ComponentSet.ts");
/* harmony import */ var _OperatorExecuter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./OperatorExecuter */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuter.ts");
/* harmony import */ var _lifecycle_dr_this_OnDrThisUnBind__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../lifecycle/dr-this/OnDrThisUnBind */ "../../packages/@dooboostore/dom-render/src/lifecycle/dr-this/OnDrThisUnBind.ts");
/* harmony import */ var _lifecycle_dr_this_OnDrThisBind__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../lifecycle/dr-this/OnDrThisBind */ "../../packages/@dooboostore/dom-render/src/lifecycle/dr-this/OnDrThisBind.ts");
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");







class DrThis extends _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__.OperatorExecuterAttrRequire {
    async executeAttrRequire(attr) {
        // const e = this.elementSource;
        // console.log('drThis!!!!!!!!!!!!!', this.elementSource.attrs.drDetectIfOption, this.elementSource.attrs.drIfOption);
        const optionIf = this.elementSource.attrs.drDetectIfOption ?? this.elementSource.attrs.drIfOption;
        const ok = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_6__.ObjectUtils.Script.evaluate(`
                ${this.render.bindScript}
                try {
                  const ok  = ${this.elementSource.attrs.drThis};
                  const option = ${optionIf};
                  if (option!==null) {
                     return !!(ok && option); 
                  }
                  // console.log('vv', ${this.elementSource.attrs.drThis}, ${this.elementSource.attrs.drIfOption}, '${this.elementSource.attrs.drIfOption}');
                  return !!ok;
                } catch(e) {
                  return false;
                }
                `, Object.assign(this.source.obj, {
            __render: Object.freeze({
                drAttr: this.elementSource.attrs,
                drAttrsOriginName: _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drAttrsOriginName,
                ...this.render
            })
        }));
        // console.log('----zxvxcv-----!!!aa!', ok);
        // if (!ok) {
        //   this.elementSource.element.remove();
        //   return ExecuteState.STOP;
        // }
        // console.log('----zxvxcv-----!!!!', attr);
        if (attr && this.elementSource.attrs.drThis && ok) {
            let thisPath = this.elementSource.attrs.drThis;
            // let optionIf = this.elementSource.attrs.drIfOption;
            // console.log('drThis!!!!!!!!!!!!!, ', optionIf)
            if (attr instanceof _components_ComponentSet__WEBPACK_IMPORTED_MODULE_2__.ComponentSet) {
                // console.log('drThis!!!!!!!!!!->', attr)
                // if (this.rawSet.data) {
                //   const destroyOptions = this.elementSource.attrs.drDestroyOption?.split(',') ?? [];
                //   debugger;
                //   RawSet.destroy((this.rawSet.data as ComponentSet).obj, [], this.source.config, destroyOptions);
                // }
                if (attr.config?.beforeComponentSet?.obj !== attr.obj) {
                    if ((0,_lifecycle_dr_this_OnDrThisUnBind__WEBPACK_IMPORTED_MODULE_4__.isOnDrThisUnBind)(attr.config.beforeComponentSet?.obj)) {
                        attr.config.beforeComponentSet?.obj?.onDrThisUnBind?.();
                    }
                }
                // this.rawSet.dataSet ??= {};
                // this.rawSet.dataSet.data = attr;
                if (attr.config?.beforeComponentSet?.obj !== attr.obj) {
                    if ((0,_lifecycle_dr_this_OnDrThisBind__WEBPACK_IMPORTED_MODULE_5__.isOnDrThisBind)(attr.obj)) {
                        attr.obj?.onDrThisBind?.();
                    }
                }
                // : componentSet  objPath   
                thisPath = `${this.elementSource.attrs.drThis}${attr.config.objPath ? ('.' + attr.config.objPath) : ''}`;
                // const zthisPath = `${this.elementSource.attrs.drThis}${attr.config.objPath ? ('?.' + attr.config.objPath) : ''}`;
                // console.log('thisPaththisPaththisPath',thisPath)
                this.setThisPath(thisPath);
                const componentBody = await _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drThisCreate(this.rawSet, this.elementSource.element, thisPath, this.elementSource.attrs.drVarOption ?? '', this.elementSource.attrs.drStripOption, this.source.obj, this.source.config, attr);
                if (componentBody) {
                    this.returnContainer.fag.append(componentBody);
                    this.afterCallBack.onThisComponentSetCallBacks.push(attr);
                }
            }
            else {
                this.setThisPath(thisPath);
                const fragment = await _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.drThisCreate(this.rawSet, this.elementSource.element, this.elementSource.attrs.drThis, this.elementSource.attrs.drVarOption ?? '', this.elementSource.attrs.drStripOption, this.source.obj, this.source.config);
                if (fragment) {
                    this.returnContainer.fag.append(fragment);
                }
            }
            // console.log('!!!!!!!!!zzz', Array.from(this.returnContainer.fag.childNodes), this.elementSource.element);
            const rr = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_1__.RawSet.checkPointCreates(this.returnContainer.fag, this.source.obj, this.source.config);
            this.elementSource.element.parentNode?.replaceChild(this.returnContainer.fag, this.elementSource.element);
            this.returnContainer.raws.push(...rr);
        }
        else {
            this.elementSource.element.remove();
        }
        return _OperatorExecuter__WEBPACK_IMPORTED_MODULE_3__.ExecuteState.EXECUTE;
    }
    setThisPath(thisPath) {
        // if (this.rawSet.point.start instanceof HTMLMetaElement && this.rawSet.point.end instanceof HTMLMetaElement) {
        if (this.rawSet.point.start instanceof this.source.config.window.HTMLMetaElement && this.rawSet.point.end instanceof this.source.config.window.HTMLMetaElement) {
            this.rawSet.point.start.setAttribute('this-path', thisPath);
            this.rawSet.point.end.setAttribute('this-path', thisPath);
        }
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/operators/DrThisProperty.ts":
/*!******************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/operators/DrThisProperty.ts ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DrThisProperty: () => (/* binding */ DrThisProperty)
/* harmony export */ });
/* harmony import */ var _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./OperatorExecuterAttrRequire */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuterAttrRequire.ts");
/* harmony import */ var _dooboostore_core_web_script_ScriptUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/core-web/script/ScriptUtils */ "../../packages/@dooboostore/core-web/src/script/ScriptUtils.ts");
/* harmony import */ var _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _OperatorExecuter__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./OperatorExecuter */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuter.ts");
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");





class DrThisProperty extends _OperatorExecuterAttrRequire__WEBPACK_IMPORTED_MODULE_0__.OperatorExecuterAttrRequire {
    constructor(rawSet, render, returnContainer, elementSource, source, afterCallBack) {
        source.operatorAround = undefined;
        super(rawSet, render, returnContainer, elementSource, source, afterCallBack, false);
    }
    async executeAttrRequire(attr) {
        const itRandom = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.drItOtherEncoding(this.elementSource.element, 'DrThisProperty');
        const vars = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.drVarEncoding(this.elementSource.element, this.elementSource.attrs.drVarOption ?? '');
        const newTemp = this.source.config.window.document.createElement('temp');
        const dictioanry = _dooboostore_core_web_script_ScriptUtils__WEBPACK_IMPORTED_MODULE_1__.ScriptUtils.evaluateReturn(attr, this.source.obj);
        const dictionaryKey = this.elementSource.attrs.drKeyOption ?? '';
        // console.log('--->', attr, dictionaryKey)
        // if (!(dictioanry instanceof Dictionary)) {
        //     return ExecuteState.STOP;
        // }
        // await new Promise(resolve => setTimeout(resolve, 1000));
        // console.log('!!!!!!!!!!!!!!', this.rawSet);
        _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_4__.ObjectUtils.Script.evaluate(`
                    ${this.render.bindScript}
                    ${this.elementSource.attrs.drBeforeOption ?? ''}
                    var i = 0; 
                    const dictionary = ${attr};
                    const dictionaryKey = '${dictionaryKey}';
                    const dictionaryStr = \`${attr}\`.trim();
                    // console.log('----@#!@#@!#', this.__render.oldChild);
                    if (dictionary) {
                        for(const it in dictionary) {
                            var destIt = dictionaryStr + '["' + it + '"]';
                            const n = this.__render.element.cloneNode(true);
                            n.setAttribute('dr-this', destIt);
                            n.setAttribute('${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.DR_KEY_OPTIONNAME}', it);
                            // n.setAttribute('dr-dictionary-key', it);
                            this.__render.fag.append(n);
                            i++;
                        }
                         this.__render.rawset.point.start.setAttribute('${_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.DR_HAS_KEYS_OPTIONNAME}',Object.keys(dictionary).join(','));
                    }
                    ${this.elementSource.attrs.drAfterOption ?? ''}
                    `, Object.assign(this.source.obj, {
            __render: Object.freeze({
                drStripOption: this.elementSource.attrs.drStripOption,
                drAttr: this.elementSource.attrs,
                drAttrsOriginName: _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.drAttrsOriginName,
                fag: newTemp,
                ...this.render
            })
        }));
        _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.drVarDecoding(newTemp, vars);
        _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.drItOtherDecoding(newTemp, itRandom);
        const tempalte = this.source.config.window.document.createElement('template');
        tempalte.innerHTML = newTemp.innerHTML;
        this.returnContainer.fag.append(tempalte.content);
        const rr = _rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.checkPointCreates(this.returnContainer.fag, this.source.obj, this.source.config);
        this.elementSource.element.parentNode?.replaceChild(this.returnContainer.fag, this.elementSource.element);
        // const rrr = rr.flatMap(it => it.render(obj, config));// .flat();
        this.returnContainer.raws.push(...rr);
        return _OperatorExecuter__WEBPACK_IMPORTED_MODULE_3__.ExecuteState.EXECUTE;
    }
    static append(obj, fullPath, key, rawSet, config) {
        const genNode = config.window.document.importNode(rawSet.dataSet.fragment, true);
        // console.log('---> append', rawSet, genNode);
        const rawSets = [];
        for (const cNode of Array.from(genNode.childNodes.values())) {
            const element = cNode.cloneNode(true);
            element.removeAttribute(_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.DR_THIS_PROPERTY_NAME);
            element.setAttribute(_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.DR_THIS_NAME, `this.${fullPath}`);
            element.setAttribute(_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.DR_KEY_OPTIONNAME, key);
            // rawSet.point.end.after(element);
            const fg = config.window.document.createDocumentFragment();
            fg.append(element);
            rawSets.push(..._rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.checkPointCreates(fg, obj, config));
            rawSet.point.end.before(fg);
            const start = rawSet.point.start;
            const keys = start.getAttribute(_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.DR_HAS_KEYS_OPTIONNAME)?.split(',') ?? [];
            keys.push(key);
            start.setAttribute(_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_2__.RawSet.DR_HAS_KEYS_OPTIONNAME, keys.join(','));
            rawSets.forEach(async (it) => await it.render(obj, config));
        }
        return rawSets;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuter.ts":
/*!********************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/operators/OperatorExecuter.ts ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ExecuteState: () => (/* binding */ ExecuteState),
/* harmony export */   OperatorExecuter: () => (/* binding */ OperatorExecuter)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");

var ExecuteState;
(function (ExecuteState) {
    ExecuteState[ExecuteState["EXECUTE"] = 0] = "EXECUTE";
    ExecuteState[ExecuteState["NO_EXECUTE"] = 1] = "NO_EXECUTE";
    ExecuteState[ExecuteState["STOP"] = 2] = "STOP";
})(ExecuteState || (ExecuteState = {}));
class OperatorExecuter {
    rawSet;
    render;
    returnContainer;
    elementSource;
    source;
    afterCallBack;
    startingExecute;
    constructor(rawSet, render, returnContainer, elementSource, source, afterCallBack, startingExecute = true) {
        this.rawSet = rawSet;
        this.render = render;
        this.returnContainer = returnContainer;
        this.elementSource = elementSource;
        this.source = source;
        this.afterCallBack = afterCallBack;
        this.startingExecute = startingExecute;
    }
    ;
    async start() {
        let attrValue = this.elementSource.attr;
        // console.log('OperatorExecuter ', attrValue, this);
        if (this.source.operatorAround?.beforeAttr) {
            attrValue = this.source.operatorAround.beforeAttr(attrValue, this) ?? '';
        }
        let r = attrValue;
        if (r && this.startingExecute) {
            const optionalPath = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_0__.ObjectUtils.Path.toOptionalChainPath(attrValue);
            r = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_0__.ObjectUtils.Script.evaluate(` ${this.render.bindScript}; return ${optionalPath}`, Object.assign(this.source.obj, { __render: this.render }));
        }
        if (this.source.operatorAround?.before) {
            r = this.source.operatorAround?.before(r, this);
        }
        const state = await this.execute(r);
        this.source.operatorAround?.after?.(r, this);
        return state;
    }
    ;
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuterAttrRequire.ts":
/*!*******************************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/operators/OperatorExecuterAttrRequire.ts ***!
  \*******************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   OperatorExecuterAttrRequire: () => (/* binding */ OperatorExecuterAttrRequire)
/* harmony export */ });
/* harmony import */ var _OperatorExecuter__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./OperatorExecuter */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuter.ts");

class OperatorExecuterAttrRequire extends _OperatorExecuter__WEBPACK_IMPORTED_MODULE_0__.OperatorExecuter {
    constructor(rawSet, render, returnContainer, elementSource, source, afterCallBack, startingExecute = true) {
        super(rawSet, render, returnContainer, elementSource, source, afterCallBack, startingExecute);
    }
    ;
    async execute(data) {
        if (!this.elementSource.attr) {
            return _OperatorExecuter__WEBPACK_IMPORTED_MODULE_0__.ExecuteState.NO_EXECUTE;
        }
        return await this.executeAttrRequire(data);
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/rawsets/AttrInitCallBack.ts":
/*!******************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/rawsets/AttrInitCallBack.ts ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/rawsets/Attrs.ts":
/*!*******************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/rawsets/Attrs.ts ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/rawsets/CreatorMetaData.ts":
/*!*****************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/rawsets/CreatorMetaData.ts ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/rawsets/DestroyOptionType.ts":
/*!*******************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/rawsets/DestroyOptionType.ts ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DestroyOptionType: () => (/* binding */ DestroyOptionType)
/* harmony export */ });
var DestroyOptionType;
(function (DestroyOptionType) {
    DestroyOptionType["NO_DESTROY"] = "NO_DESTROY";
    DestroyOptionType["NO_MESSENGER_DESTROY"] = "NO_MESSENGER_DESTROY";
})(DestroyOptionType || (DestroyOptionType = {}));


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/rawsets/ElementInitCallBack.ts":
/*!*********************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/rawsets/ElementInitCallBack.ts ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts":
/*!********************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   RawSet: () => (/* binding */ RawSet)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_random_RandomUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/random/RandomUtils */ "../../packages/@dooboostore/core/src/random/RandomUtils.ts");
/* harmony import */ var _dooboostore_core_string_StringUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/core/string/StringUtils */ "../../packages/@dooboostore/core/src/string/StringUtils.ts");
/* harmony import */ var _events_EventManager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../events/EventManager */ "../../packages/@dooboostore/dom-render/src/events/EventManager.ts");
/* harmony import */ var _iterators_Range__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../iterators/Range */ "../../packages/@dooboostore/dom-render/src/iterators/Range.ts");
/* harmony import */ var _dooboostore_core_web_element_ElementUtils__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dooboostore/core-web/element/ElementUtils */ "../../packages/@dooboostore/core-web/src/element/ElementUtils.ts");
/* harmony import */ var _operators_DrPre__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../operators/DrPre */ "../../packages/@dooboostore/dom-render/src/operators/DrPre.ts");
/* harmony import */ var _operators_Dr__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../operators/Dr */ "../../packages/@dooboostore/dom-render/src/operators/Dr.ts");
/* harmony import */ var _operators_DrIf__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../operators/DrIf */ "../../packages/@dooboostore/dom-render/src/operators/DrIf.ts");
/* harmony import */ var _operators_OperatorExecuter__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../operators/OperatorExecuter */ "../../packages/@dooboostore/dom-render/src/operators/OperatorExecuter.ts");
/* harmony import */ var _operators_DrThis__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../operators/DrThis */ "../../packages/@dooboostore/dom-render/src/operators/DrThis.ts");
/* harmony import */ var _operators_DrForm__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../operators/DrForm */ "../../packages/@dooboostore/dom-render/src/operators/DrForm.ts");
/* harmony import */ var _operators_DrInnerText__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../operators/DrInnerText */ "../../packages/@dooboostore/dom-render/src/operators/DrInnerText.ts");
/* harmony import */ var _operators_DrInnerHTML__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../operators/DrInnerHTML */ "../../packages/@dooboostore/dom-render/src/operators/DrInnerHTML.ts");
/* harmony import */ var _operators_DrFor__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../operators/DrFor */ "../../packages/@dooboostore/dom-render/src/operators/DrFor.ts");
/* harmony import */ var _operators_DrForOf__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../operators/DrForOf */ "../../packages/@dooboostore/dom-render/src/operators/DrForOf.ts");
/* harmony import */ var _operators_DrAppender__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../operators/DrAppender */ "../../packages/@dooboostore/dom-render/src/operators/DrAppender.ts");
/* harmony import */ var _operators_DrRepeat__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../operators/DrRepeat */ "../../packages/@dooboostore/dom-render/src/operators/DrRepeat.ts");
/* harmony import */ var _operators_DrTargetElement__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../operators/DrTargetElement */ "../../packages/@dooboostore/dom-render/src/operators/DrTargetElement.ts");
/* harmony import */ var _operators_DrTargetAttr__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../operators/DrTargetAttr */ "../../packages/@dooboostore/dom-render/src/operators/DrTargetAttr.ts");
/* harmony import */ var _operators_DrStripElement__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ../operators/DrStripElement */ "../../packages/@dooboostore/dom-render/src/operators/DrStripElement.ts");
/* harmony import */ var _DestroyOptionType__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ./DestroyOptionType */ "../../packages/@dooboostore/dom-render/src/rawsets/DestroyOptionType.ts");
/* harmony import */ var _RawSetType__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./RawSetType */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSetType.ts");
/* harmony import */ var _operators_DrThisProperty__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ../operators/DrThisProperty */ "../../packages/@dooboostore/dom-render/src/operators/DrThisProperty.ts");
/* harmony import */ var _RawSetOperatorType__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./RawSetOperatorType */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSetOperatorType.ts");
/* harmony import */ var _dooboostore_core_parser_css_CssParser__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! @dooboostore/core/parser/css/CssParser */ "../../packages/@dooboostore/core/src/parser/css/CssParser.ts");
/* harmony import */ var _lifecycle_OnCreateRenderData__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ../lifecycle/OnCreateRenderData */ "../../packages/@dooboostore/dom-render/src/lifecycle/OnCreateRenderData.ts");
/* harmony import */ var _lifecycle_OnCreateRender__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! ../lifecycle/OnCreateRender */ "../../packages/@dooboostore/dom-render/src/lifecycle/OnCreateRender.ts");
/* harmony import */ var _lifecycle_OnChangeAttrRender__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ../lifecycle/OnChangeAttrRender */ "../../packages/@dooboostore/dom-render/src/lifecycle/OnChangeAttrRender.ts");
/* harmony import */ var _lifecycle_OnInitRender__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ../lifecycle/OnInitRender */ "../../packages/@dooboostore/dom-render/src/lifecycle/OnInitRender.ts");
/* harmony import */ var _lifecycle_OnCreatedThisChild__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ../lifecycle/OnCreatedThisChild */ "../../packages/@dooboostore/dom-render/src/lifecycle/OnCreatedThisChild.ts");
/* harmony import */ var _lifecycle_OnDestroyRender__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ../lifecycle/OnDestroyRender */ "../../packages/@dooboostore/dom-render/src/lifecycle/OnDestroyRender.ts");
/* harmony import */ var _operators_DrTargetElementIsElement__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ../operators/DrTargetElementIsElement */ "../../packages/@dooboostore/dom-render/src/operators/DrTargetElementIsElement.ts");
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");
/* harmony import */ var _dooboostore_core_web_node_NodeUtils__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! @dooboostore/core-web/node/NodeUtils */ "../../packages/@dooboostore/core-web/src/node/NodeUtils.ts");
/* harmony import */ var _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_34__ = __webpack_require__(/*! @dooboostore/core/convert/ConvertUtils */ "../../packages/@dooboostore/core/src/convert/ConvertUtils.ts");
/* harmony import */ var _index__WEBPACK_IMPORTED_MODULE_35__ = __webpack_require__(/*! ./index */ "../../packages/@dooboostore/dom-render/src/rawsets/index.ts");




































// let renderCnt = 0;
class RawSet {
    uuid;
    type;
    point;
    dataSet;
    detect;
    static DR_NAME = 'dr';
    static DR_IF_NAME = 'dr-if';
    static DR_FOR_NAME = 'dr-for';
    static DR_FOR_OF_NAME = 'dr-for-of';
    static DR_THIS_PROPERTY_NAME = 'dr-this-property';
    static DR_REPEAT_NAME = 'dr-repeat';
    static DR_THIS_NAME = 'dr-this';
    static DR_FORM_NAME = 'dr-form';
    static DR_PRE_NAME = 'dr-pre';
    static DR_APPENDER_NAME = 'dr-appender';
    static DR_INNERHTML_NAME = 'dr-inner-html';
    static DR_INNERTEXT_NAME = 'dr-inner-text';
    static DR_DETECT_NAME = 'dr-detect';
    static DR_STRIP_NAME = 'dr-strip';
    static DR_REPLACE_TARGET_ELEMENT_IS_NAME = 'dr-replace-target-element-is';
    // elementName
    static DR_TARGET_ELEMENT_ELEMENTNAME = 'dr-target-element';
    //  
    static DR_DETECT_IF_OPTIONNAME = 'dr-detect-option-if';
    static DR_DETECT_FILTER_OPTIONNAME = 'dr-detect-option-filter';
    static DR_DETECT_ATTR_OPTIONNAME = 'dr-detect-option-attr';
    /**
     * @deprecated
     */
    static DR_THIS_OPTIONNAME = 'dr-option-this';
    static DR_ATTR_OPTIONNAME = 'dr-option-attr';
    static DR_IF_OPTIONNAME = 'dr-option-if';
    static DR_IT_OPTIONNAME = 'dr-option-it';
    static DR_VAR_OPTIONNAME = 'dr-option-var';
    static DR_AFTER_OPTIONNAME = 'dr-option-after';
    static DR_NEXT_OPTIONNAME = 'dr-option-next';
    static DR_BEFORE_OPTIONNAME = 'dr-option-before';
    static DR_COMPLETE_OPTIONNAME = 'dr-option-complete';
    static DR_STRIP_OPTIONNAME = 'dr-option-strip';
    static DR_DESTROY_OPTIONNAME = 'dr-option-destroy';
    static DR_THIS_NAME_OPTIONNAME = 'dr-option-this-name';
    static DR_VARIABLE_NAME_OPTIONNAME = 'dr-option-variable-name';
    static DR_ITEM_VARIABLE_NAME_OPTIONNAME = 'dr-option-item-variable-name';
    static DR_ITEM_INDEX_VARIABLE_NAME_OPTIONNAME = 'dr-option-item-index-variable-name';
    static DR_INNER_HTML_NAME_OPTIONNAME = 'dr-option-inner-html-name';
    static DR_INNER_TEXT_NAME_OPTIONNAME = 'dr-option-inner-text-name';
    static DR_INNER_HTML_ESCAPED_NAME_OPTIONNAME = 'dr-option-inner-html-escaped-name';
    static DR_KEY_OPTIONNAME = 'dr-option-key';
    static DR_HAS_KEYS_OPTIONNAME = 'dr-option-has-keys';
    static DR_ON_CREATE_ARGUMENTS_OPTIONNAME = 'dr-on-create:arguments';
    static DR_ON_CREATED_CALLBACK_OPTIONNAME = 'dr-on-create:callback';
    static DR_ON_CONSTRUCTOR_ARGUMENTS_OPTIONNAME = 'dr-on-constructor:arguments';
    static drAttrsOriginName = {
        dr: RawSet.DR_NAME,
        drIf: RawSet.DR_IF_NAME,
        drFor: RawSet.DR_FOR_NAME,
        drForOf: RawSet.DR_FOR_OF_NAME,
        drThisProperty: RawSet.DR_THIS_PROPERTY_NAME,
        drAppender: RawSet.DR_APPENDER_NAME,
        drRepeat: RawSet.DR_REPEAT_NAME,
        drThis: RawSet.DR_THIS_NAME,
        drForm: RawSet.DR_FORM_NAME,
        drPre: RawSet.DR_PRE_NAME,
        drInnerHTML: RawSet.DR_INNERHTML_NAME,
        drInnerText: RawSet.DR_INNERTEXT_NAME,
        drItOption: RawSet.DR_IT_OPTIONNAME,
        drVarOption: RawSet.DR_VAR_OPTIONNAME,
        drAfterOption: RawSet.DR_AFTER_OPTIONNAME,
        drNextOption: RawSet.DR_NEXT_OPTIONNAME,
        drBeforeOption: RawSet.DR_BEFORE_OPTIONNAME,
        drCompleteOption: RawSet.DR_COMPLETE_OPTIONNAME,
        drStripElement: RawSet.DR_STRIP_NAME,
        drReplaceTargetElementIs: RawSet.DR_REPLACE_TARGET_ELEMENT_IS_NAME,
        drStripOption: RawSet.DR_STRIP_OPTIONNAME,
        drIfOption: RawSet.DR_IF_OPTIONNAME,
        drDetectIfOption: RawSet.DR_DETECT_IF_OPTIONNAME,
        drDestroyOption: RawSet.DR_DESTROY_OPTIONNAME,
        drHasKeysOption: RawSet.DR_HAS_KEYS_OPTIONNAME,
        drKeyOption: RawSet.DR_KEY_OPTIONNAME
    };
    static DR_TAGS = [];
    // public static readonly DR_REPLACE_ACTION_ATTRIBUTES = [
    //   RawSet.DR_REPLACE_TARGET_ELEMENT_IS_NAME
    // ]
    static DR_ELEMENTS = [
        RawSet.DR_TARGET_ELEMENT_ELEMENTNAME
    ];
    static DR_ATTRIBUTES = [
        RawSet.DR_NAME,
        RawSet.DR_APPENDER_NAME,
        RawSet.DR_IF_NAME,
        RawSet.DR_FOR_OF_NAME,
        RawSet.DR_THIS_PROPERTY_NAME,
        RawSet.DR_FOR_NAME,
        RawSet.DR_THIS_NAME,
        RawSet.DR_FORM_NAME,
        RawSet.DR_PRE_NAME,
        RawSet.DR_INNERHTML_NAME,
        RawSet.DR_INNERTEXT_NAME,
        RawSet.DR_REPEAT_NAME,
        // RawSet.DR_DETECT_NAME, // TODO: DrDetect   
        RawSet.DR_STRIP_NAME
    ];
    constructor(uuid, type, point, dataSet, detect) {
        this.uuid = uuid;
        this.type = type;
        this.point = point;
        this.dataSet = dataSet;
        this.detect = detect;
        // point.start.rawSet = this;
        // console.log('rawset constructor->', (this.point.node as Element).getAttributeNames());
    }
    get isConnected() {
        // console.log('isConnect???', this, this.point.start.isConnected, this.point.end.isConnected);
        return (this.point && this.point.start && this.point.end && this.point.start.isConnected && this.point.end.isConnected);
    }
    // 
    getUsingTriggerVariables(config) {
        const usingTriggerVariables = new Set();
        // console.log('------data', this.dataSet)
        this.dataSet.fragment.childNodes.forEach((cNode, key) => {
            // console.log('-----aaaa-data', cNode, key)
            let script = '';
            if (cNode.nodeType === Node.TEXT_NODE) {
                script = `\`${cNode.textContent ?? ''}\``;
                const expressionGroups = RawSet.expressionGroups(script);
                // console.log('???????', script, expressionGroups)
                if (expressionGroups[0].length > 1) {
                    script = expressionGroups[0][1];
                }
                // console.log('--', expressionGroups, script)
            }
            else if (cNode.nodeType === Node.ELEMENT_NODE) {
                const element = cNode;
                const targetAttrNames = (config?.targetAttrs?.map(it => it.name) ?? []).concat(RawSet.DR_ATTRIBUTES, RawSet.DR_DETECT_FILTER_OPTIONNAME, RawSet.DR_DETECT_IF_OPTIONNAME, RawSet.DR_DETECT_ATTR_OPTIONNAME); // .concat(EventManager.normalAttrMapAttrName);
                const targetScripts = targetAttrNames
                    .map(it => element.getAttribute(it))
                    .filter(it => it)
                    .map(it => `(${it})`);
                const targetAttrMap = element.getAttribute(_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.normalAttrMapAttrName);
                // console.log('targetAttrMap-->', targetAttrMap)
                if (targetAttrMap) {
                    new Map(JSON.parse(targetAttrMap)).forEach((v, k) => {
                        const variablePaths = v.variablePaths;
                        // let targetScript = v.originalAttrValue;
                        // variablePaths.forEach(it => {
                        //   let r = ObjectUtils.Path.toOptionalChainPath(it.inner);
                        //   targetScript = targetScript.replaceAll(it.origin,`\${${r}}`);
                        // })
                        // targetScripts.push(`(${targetScript})`);
                        //    
                        variablePaths.forEach(it => targetScripts.push(`(${it.inner})`));
                        // console.log('targetScripts', targetScripts);
                    });
                }
                // console.log('targetScriptstargetScripts', targetScripts)
                script = targetScripts.join(';');
                // script = targetScripts.map(it=>`try{${it}}catch(e){}`).join(';');
                // attribute  
                // console.log('----!!!!!-->', targetAttrNames)
                // const otherAttrs = element.getAttributeNames()
                //     .filter(it => !targetAttrNames.includes(it.toLowerCase()) && RawSet.isExporesion(element.getAttribute(it)))
                //     .map(it => {
                //         return `\`${element.getAttribute(it) ?? ''}\``;
                //     }).join(';');
                // script += ';' + otherAttrs
            }
            if (script) {
                // console.log('------1-',script)
                script = script.replace(/#[^#]*#/g, '({})');
                // console.log('------2-',script)
                // script = script.replace('}$','}');
                // script = script.replace('@this@','this');
                // console.log('----------->', script)
                // TODO: .. ..?     ?
                _events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.VARNAMES.forEach(it => {
                    // script = script.replace(RegExp(it.replace('$', '\\$'), 'g'), `this?.___${it}`);
                    // script = script.replace(RegExp(it.replace('$', '\\$'), 'g'), `this.___${it}`);
                    script = script.replace(RegExp(it.replace('$', '\\$'), 'g'), `this.___${it}`);
                    // console.log('scripts-->', script)
                });
                // console.log('--------1--', script);
                // script = script.replaceAll('#{','${').replaceAll('}#', '}')
                // console.log('--------2--', script);
                // TODO: .. ..?     ?
                Array.from(_dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Path.detectPathFromScript(script, { excludeThis: true }))
                    .filter(it => !it.startsWith(`___${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.SCRIPTS_VARNAME}`))
                    .forEach(it => usingTriggerVariables.add(it));
            }
        });
        // console.log('usingTriggerVariable----------->', usingTriggerVariables)
        return usingTriggerVariables;
    }
    //  render  
    // public async render(obj: any, config: DomRenderConfig): Promise<RawSet[]> {
    // }
    lastRenderedValue;
    async render(obj, config) {
        // console.log('render!!!!!!!!!!!!!!')
        // renderCnt++;
        // const t0 = performance.now();
        // console.group('RawSet render', this);
        // Dirty Checking Optimization for Text Nodes
        if (this.dataSet.fragment.childNodes.length === 1 && this.dataSet.fragment.childNodes[0].nodeType === Node.TEXT_NODE) {
            const textContent = this.dataSet.fragment.childNodes[0].textContent;
            if (textContent) {
                const runText = RawSet.expressionGroups(textContent)[0][1];
                const __render = {
                    rawSet: this,
                    scripts: _events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.setBindProperty(config?.scripts, obj),
                    router: config?.router,
                    range: _iterators_Range__WEBPACK_IMPORTED_MODULE_3__.Range.range,
                    element: this.dataSet.fragment.childNodes[0],
                    attribute: {},
                    rootObject: obj,
                    scriptUtils: _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Script,
                    nearThis: this.findNearThis(obj),
                    parentThis: this.findParentThis(obj),
                    bindScript: ` /** render **/
                      const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.SCRIPTS_VARNAME} = this.__render.scripts;
                      const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.RAWSET_VARNAME} = this.__render.rawSet;
                      const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.ELEMENT_VARNAME} = this.__render.element;
                      const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.ATTRIBUTE_VARNAME} = this.__render.attribute;
                      const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.RANGE_VARNAME} = this.__render.range;
                      const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.ROUTER_VARNAME} = this.__render.router;
                      const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.NEAR_THIS_VARNAME} = this.__render.nearThis;
                      const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.PARENT_THIS_VARNAME} = this.__render.parentThis;
                      const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.SCRIPT_UTILS_VARNAME} = this.__render.scriptUtils;
                      const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.ROOT_OBJECT_VARNAME} = this.__render.rootObject;
              `
                };
                try {
                    const newValue = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Script.evaluateReturn({
                        bodyScript: __render.bindScript,
                        returnScript: runText
                    }, Object.assign(obj, { __render }));
                    const newValueStr = String(newValue);
                    if (this.lastRenderedValue === newValueStr) {
                        // console.log(' Skipping render: Value unchanged', newValue);
                        return { raws: [], executedOperators: [] };
                    }
                    // console.log(' Rendering: Value changed', this.lastRenderedValue, '->', newValue);
                    // Update lastRenderedValue BEFORE proceeding with render
                    // This ensures the value is cached even if render fails partway through
                    this.lastRenderedValue = newValueStr;
                }
                catch (e) {
                    // Evaluation failed, proceed with normal render
                    // console.log(' Dirty check failed, proceeding with render', e);
                }
            }
        }
        const genNode = config.window.document.importNode(this.dataSet.fragment, true);
        const raws = [];
        const onAttrInitCallBacks = [];
        const onElementInitCallBacks = [];
        const onThisComponentSetCallBacks = [];
        const drAttrs = [];
        // console.log('rawSet render!!', obj, config, this, Array.from(genNode.childNodes.values()));
        const executedOperators = [];
        for (const cNode of Array.from(genNode.childNodes.values())) {
            // console.log('cNodecNodecNode', cNode);
            let attribute = {};
            if (cNode.nodeType === Node.ELEMENT_NODE) {
                attribute = _dooboostore_core_web_element_ElementUtils__WEBPACK_IMPORTED_MODULE_4__.ElementUtils.getAttributeToObject(cNode);
            }
            const __render = Object.freeze({
                rawSet: this,
                scripts: _events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.setBindProperty(config?.scripts, obj),
                router: config?.router,
                range: _iterators_Range__WEBPACK_IMPORTED_MODULE_3__.Range.range,
                element: cNode,
                attribute: attribute,
                rootObject: obj,
                scriptUtils: _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Script,
                nearThis: this.findNearThis(obj),
                parentThis: this.findParentThis(obj),
                bindScript: ` /** render **/
                    const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.SCRIPTS_VARNAME} = this.__render.scripts;
                    const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.RAWSET_VARNAME} = this.__render.rawSet;
                    const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.ELEMENT_VARNAME} = this.__render.element;
                    const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.ATTRIBUTE_VARNAME} = this.__render.attribute;
                    const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.RANGE_VARNAME} = this.__render.range;
                    const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.ROUTER_VARNAME} = this.__render.router;
                    const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.NEAR_THIS_VARNAME} = this.__render.nearThis;
                    const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.PARENT_THIS_VARNAME} = this.__render.parentThis;
                    const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.SCRIPT_UTILS_VARNAME} = this.__render.scriptUtils;
                    const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.ROOT_OBJECT_VARNAME} = this.__render.rootObject;
            `
            });
            // const normalAttribute = attribute[EventManager.normalAttrMapAttrName];
            // if (normalAttribute) {
            //   new Map<string, string>(JSON.parse(normalAttribute)).forEach((v, k) => {
            //     const cval = ScriptUtils.evalReturn({ bodyScript: __render.bindScript, returnScript: v }, Object.assign(obj, { __render: __render }));
            //     console.log('-----------',v,k, cval);
            //     attribute[v] = cval;
            //   });
            // }
            const fag = config.window.document.createDocumentFragment();
            if (cNode.nodeType === Node.TEXT_NODE && cNode.textContent) {
                // console.log('text-->', this, obj, config, cNode.textContent);
                // console.log('text-->', Array.from(this.fragment.childNodes))
                const textContent = cNode.textContent;
                const runText = RawSet.expressionGroups(textContent)[0][1];
                // console.log('--->', RawSet.exporesionGrouops(textContent), textContent,runText, runText[0][1])
                let newNode;
                if (textContent?.startsWith('#')) {
                    const r = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Script.evaluateReturn({ bodyScript: __render.bindScript, returnScript: runText }, Object.assign(obj, { __render }));
                    const template = config.window.document.createElement('template');
                    template.innerHTML = r;
                    newNode = template.content;
                }
                else {
                    const r = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Script.evaluateReturn({ bodyScript: __render.bindScript, returnScript: runText }, Object.assign(obj, { __render }));
                    newNode = config.window.document.createTextNode(r);
                }
                cNode.parentNode?.replaceChild(newNode, cNode);
                // console.log('-------', this.point.start.parentNode.nodeName)
                //  style value change   :  completed  attr   
                if (this.type === _RawSetType__WEBPACK_IMPORTED_MODULE_21__.RawSetType.STYLE_TEXT && this.point.parent) {
                    this.point.parent.removeAttribute('completed');
                }
            }
            else if (cNode.nodeType === Node.ELEMENT_NODE) {
                const element = cNode;
                // console.log('target-->', element)
                const drAttr = {
                    dr: this.getAttributeAndDelete(element, RawSet.DR_NAME),
                    drIf: this.getAttributeAndDelete(element, RawSet.DR_IF_NAME),
                    drFor: this.getAttributeAndDelete(element, RawSet.DR_FOR_NAME),
                    drForOf: this.getAttributeAndDelete(element, RawSet.DR_FOR_OF_NAME),
                    drThisProperty: this.getAttributeAndDelete(element, RawSet.DR_THIS_PROPERTY_NAME),
                    drAppender: this.getAttributeAndDelete(element, RawSet.DR_APPENDER_NAME),
                    drRepeat: this.getAttributeAndDelete(element, RawSet.DR_REPEAT_NAME),
                    drThis: this.getAttributeAndDelete(element, RawSet.DR_THIS_NAME),
                    drForm: this.getAttributeAndDelete(element, RawSet.DR_FORM_NAME),
                    drPre: this.getAttributeAndDelete(element, RawSet.DR_PRE_NAME),
                    drInnerHTML: this.getAttributeAndDelete(element, RawSet.DR_INNERHTML_NAME),
                    drInnerText: this.getAttributeAndDelete(element, RawSet.DR_INNERTEXT_NAME),
                    drStripElement: this.getAttributeAndDelete(element, RawSet.DR_STRIP_NAME),
                    drReplaceTargetElementIs: this.getAttributeAndDelete(element, RawSet.DR_REPLACE_TARGET_ELEMENT_IS_NAME),
                    drItOption: this.getAttributeAndDelete(element, RawSet.DR_IT_OPTIONNAME),
                    drIfOption: this.getAttributeAndDelete(element, RawSet.DR_IF_OPTIONNAME),
                    drVarOption: this.getAttributeAndDelete(element, RawSet.DR_VAR_OPTIONNAME),
                    drNextOption: this.getAttributeAndDelete(element, RawSet.DR_NEXT_OPTIONNAME),
                    drAfterOption: this.getAttributeAndDelete(element, RawSet.DR_AFTER_OPTIONNAME),
                    drBeforeOption: this.getAttributeAndDelete(element, RawSet.DR_BEFORE_OPTIONNAME),
                    drCompleteOption: this.getAttributeAndDelete(element, RawSet.DR_COMPLETE_OPTIONNAME),
                    drStripOption: this.getAttributeAndDelete(element, RawSet.DR_STRIP_OPTIONNAME),
                    drDestroyOption: this.getAttributeAndDelete(element, RawSet.DR_DESTROY_OPTIONNAME),
                    drKeyOption: this.getAttributeAndDelete(element, RawSet.DR_KEY_OPTIONNAME),
                    drDetectIfOption: this.getAttribute(element, RawSet.DR_DETECT_IF_OPTIONNAME),
                    drHasKeysOption: this.getAttribute(element, RawSet.DR_HAS_KEYS_OPTIONNAME)
                };
                drAttrs.push(drAttr);
                //   
                const operators = [
                    new _operators_DrPre__WEBPACK_IMPORTED_MODULE_5__.DrPre(this, __render, { raws, fag }, { element, attrName: RawSet.DR_PRE_NAME, attr: drAttr.drPre, attrs: drAttr }, { config, obj, operatorAround: config.operatorAround?.drPre }, { onAttrInitCallBacks, onElementInitCallBacks, onThisComponentSetCallBacks }),
                    new _operators_Dr__WEBPACK_IMPORTED_MODULE_6__.Dr(this, __render, { raws, fag }, { element, attrName: RawSet.DR_NAME, attr: drAttr.dr, attrs: drAttr }, { config, obj, operatorAround: config.operatorAround?.dr }, { onAttrInitCallBacks, onElementInitCallBacks, onThisComponentSetCallBacks }),
                    // new Dr(this, __render, {raws, fag}, {element, attrName: EventManager.onRenderedInitAttrName, attr: drAttr.dr, attrs: drAttr}, {config, obj, operatorAround: config.operatorAround?.dr}, {onAttrInitCallBacks, onElementInitCallBacks, onThisComponentSetCallBacks}),
                    new _operators_DrIf__WEBPACK_IMPORTED_MODULE_7__.DrIf(this, __render, { raws, fag }, { element, attrName: RawSet.DR_IF_NAME, attr: drAttr.drIf, attrs: drAttr }, { config, obj, operatorAround: config.operatorAround?.drIf }, { onAttrInitCallBacks, onElementInitCallBacks, onThisComponentSetCallBacks }),
                    new _operators_DrStripElement__WEBPACK_IMPORTED_MODULE_19__.DrStripElement(this, __render, { raws, fag }, { element, attrName: RawSet.DR_STRIP_NAME, attr: drAttr.drStripElement, attrs: drAttr }, { config, obj, operatorAround: config.operatorAround?.drThis }, { onAttrInitCallBacks, onElementInitCallBacks, onThisComponentSetCallBacks }),
                    new _operators_DrThis__WEBPACK_IMPORTED_MODULE_9__.DrThis(this, __render, { raws, fag }, { element, attrName: RawSet.DR_THIS_NAME, attr: drAttr.drThis, attrs: drAttr }, { config, obj, operatorAround: config.operatorAround?.drThis }, { onAttrInitCallBacks, onElementInitCallBacks, onThisComponentSetCallBacks }),
                    new _operators_DrForm__WEBPACK_IMPORTED_MODULE_10__.DrForm(this, __render, { raws, fag }, { element, attrName: RawSet.DR_FOR_NAME, attr: drAttr.drForm, attrs: drAttr }, { config, obj, operatorAround: config.operatorAround?.drForm }, { onAttrInitCallBacks, onElementInitCallBacks, onThisComponentSetCallBacks }),
                    new _operators_DrInnerText__WEBPACK_IMPORTED_MODULE_11__.DrInnerText(this, __render, { raws, fag }, { element, attrName: RawSet.DR_INNERTEXT_NAME, attr: drAttr.drInnerText, attrs: drAttr }, { config, obj, operatorAround: config.operatorAround?.drInnerText }, { onAttrInitCallBacks, onElementInitCallBacks, onThisComponentSetCallBacks }),
                    new _operators_DrInnerHTML__WEBPACK_IMPORTED_MODULE_12__.DrInnerHTML(this, __render, { raws, fag }, { element, attrName: RawSet.DR_INNERHTML_NAME, attr: drAttr.drInnerHTML, attrs: drAttr }, { config, obj, operatorAround: config.operatorAround?.drInnerHTML }, { onAttrInitCallBacks, onElementInitCallBacks, onThisComponentSetCallBacks }),
                    new _operators_DrFor__WEBPACK_IMPORTED_MODULE_13__.DrFor(this, __render, { raws, fag }, { element, attrName: RawSet.DR_FOR_NAME, attr: drAttr.drFor, attrs: drAttr }, { config, obj, operatorAround: config.operatorAround?.drFor }, { onAttrInitCallBacks, onElementInitCallBacks, onThisComponentSetCallBacks }),
                    new _operators_DrForOf__WEBPACK_IMPORTED_MODULE_14__.DrForOf(this, __render, { raws, fag }, { element, attrName: RawSet.DR_FOR_OF_NAME, attr: drAttr.drForOf, attrs: drAttr }, { config, obj, operatorAround: config.operatorAround?.drForOf }, { onAttrInitCallBacks, onElementInitCallBacks, onThisComponentSetCallBacks }),
                    new _operators_DrThisProperty__WEBPACK_IMPORTED_MODULE_22__.DrThisProperty(this, __render, { raws, fag }, { element, attrName: RawSet.DR_THIS_PROPERTY_NAME, attr: drAttr.drThisProperty, attrs: drAttr }, { config, obj, operatorAround: config.operatorAround?.drThisProperty }, { onAttrInitCallBacks, onElementInitCallBacks, onThisComponentSetCallBacks }),
                    new _operators_DrAppender__WEBPACK_IMPORTED_MODULE_15__.DrAppender(this, __render, { raws, fag }, { element, attrName: RawSet.DR_APPENDER_NAME, attr: drAttr.drAppender, attrs: drAttr }, { config, obj, operatorAround: config.operatorAround?.drAppender }, { onAttrInitCallBacks, onElementInitCallBacks, onThisComponentSetCallBacks }),
                    new _operators_DrRepeat__WEBPACK_IMPORTED_MODULE_16__.DrRepeat(this, __render, { raws, fag }, { element, attrName: RawSet.DR_REPEAT_NAME, attr: drAttr.drRepeat, attrs: drAttr }, { config, obj, operatorAround: config.operatorAround?.drRepeat }, { onAttrInitCallBacks, onElementInitCallBacks, onThisComponentSetCallBacks }),
                    new _operators_DrTargetElementIsElement__WEBPACK_IMPORTED_MODULE_31__.DrTargetElementIsElement(this, __render, { raws, fag }, { element, attrName: RawSet.DR_REPLACE_TARGET_ELEMENT_IS_NAME, attr: drAttr.drReplaceTargetElementIs, attrs: drAttr }, { config, obj }, { onAttrInitCallBacks, onElementInitCallBacks, onThisComponentSetCallBacks }),
                    new _operators_DrTargetElement__WEBPACK_IMPORTED_MODULE_17__.DrTargetElement(this, __render, { raws, fag }, { element, attrs: drAttr }, { config, obj }, { onAttrInitCallBacks, onElementInitCallBacks, onThisComponentSetCallBacks }),
                    new _operators_DrTargetAttr__WEBPACK_IMPORTED_MODULE_18__.DrTargetAttr(this, __render, { raws, fag }, { element, attrs: drAttr }, { config, obj }, { onAttrInitCallBacks, onElementInitCallBacks, onThisComponentSetCallBacks })
                ];
                for (const operator of operators) {
                    const state = await operator.start();
                    if (state === _operators_OperatorExecuter__WEBPACK_IMPORTED_MODULE_8__.ExecuteState.EXECUTE) {
                        executedOperators.push(operator);
                        break;
                    }
                    else if (state === _operators_OperatorExecuter__WEBPACK_IMPORTED_MODULE_8__.ExecuteState.STOP) {
                        return { raws, executedOperators };
                    }
                }
            }
        }
        this.point.childrenRawSets = raws;
        raws.forEach(it => {
            it.point.parentRawSet = this;
        });
        // console.log('pppppppppppppp', this);
        // replaceBody applyEvent   20250511
        const childrenNodes = Array.from(genNode.childNodes);
        // console.log(`RawSet aa took ${performance.now() - t0} milliseconds. children`, childrenNodes);
        this.applyEvent(obj, genNode, config);
        // console.log(`RawSet xxxxxxxxxx took ${performance.now() - t0} milliseconds.`);
        this.replaceBody(genNode); //      .
        // console.log(`RawSet replaceBody took ${performance.now() - t0} milliseconds.`);
        // console.log('rawSEt!!!!!!!', obj, this.near)
        // console.log('rawSEt!!!!!!!', obj, this.findNearThis(obj),childrenNodes,config)
        // console.log('rawSEt!!!!!!!', obj, drAttrs)
        this.onRenderedEvent(obj, childrenNodes, config);
        // console.log(`RawSet onRenderedEvent took ${performance.now() - t0} milliseconds.`);
        drAttrs.forEach(it => {
            if (it.drCompleteOption) {
                // genNode.childNodes
                const render = Object.freeze({
                    rawSet: this,
                    fag: genNode,
                    scripts: _events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.setBindProperty(config?.scripts, obj)
                });
                _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Script.evaluate(`
                const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.FAG_VARNAME} = this.__render.fag;
                const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.SCRIPTS_VARNAME} = this.__render.scripts;
                const ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.RAWSET_VARNAME} = this.__render.rawSet;
                ${it.drCompleteOption}`, Object.assign(obj, { __render: render }));
            }
        });
        // console.log(`RawSet drAttrs.forEach took ${performance.now() - t0} milliseconds.`);
        //  style isolation  :scope  .
        // 2023.9.4   style   
        // RawSet.generateStyleSheetsLocal(config);
        for (const it of onThisComponentSetCallBacks) {
            if ((0,_lifecycle_OnInitRender__WEBPACK_IMPORTED_MODULE_28__.isOnInitRender)(it.obj)) {
                await it.obj?.onInitRender?.({}, this);
            }
        }
        // console.log(`RawSet const it of onThisComponentSetCallBacks took ${performance.now() - t0} milliseconds.`);
        for (const it of onElementInitCallBacks) {
            if ((0,_lifecycle_OnInitRender__WEBPACK_IMPORTED_MODULE_28__.isOnInitRender)(this.dataSet.render?.currentThis)) {
                // TODO:   .   
                // console.log('!!!!!!!!!!!!!!!!!!!!!!!!!!!!!', it, this.dataSet);
                // dr-on-init:arguments
                // if (isOnInitRender()) {
                //   it.targetElement.__render.component.onInitRender?.(...param);
                // }
                // if (it.targetElement?.__render?.element && it.targetElement?.__render?.component) {
                //   const oninit = it.targetElement.__render.element.getAttribute(RawSet.DR_ON_INIT_ARGUMENTS_OPTIONNAME); // dr-on-component-init
                //   let param = [];
                //   if (oninit) {
                //     const script = `${it.targetElement.__render.renderScript} return ${oninit} `;
                //     param = ScriptUtils.eval(script, Object.assign(obj, {
                //       __render: it.targetElement.__render
                //     }));
                //     if (!Array.isArray(param)) {
                //       param = [param];
                //     }
                //   }
                //
                //   if (isOnInitRender(it.targetElement.__render.component)) {
                //     it.targetElement.__render.component.onInitRender?.(...param);
                //   }
                // }
                await this.dataSet.render.currentThis.onInitRender({}, this);
            }
            config?.onElementInit?.(it.name, obj, this, it.targetElement);
        }
        // console.log(`RawSet for (const it of onElementInitCallBacks) { took ${performance.now() - t0} milliseconds.`);
        // TODO:   targetElement  ?
        for (const it of onAttrInitCallBacks) {
            config?.onAttrInit?.(it.attrName, it.attrValue, obj, this);
        }
        // console.log(`RawSet  for (const it of onAttrInitCallBacks) { took ${performance.now() - t0} milliseconds.`);
        // component destroy
        if (obj[_index__WEBPACK_IMPORTED_MODULE_35__.DomRenderComponentMetaKey.DOMRENDER_COMPONENTS_KEY]) {
            Object.entries(obj[_index__WEBPACK_IMPORTED_MODULE_35__.DomRenderComponentMetaKey.DOMRENDER_COMPONENTS_KEY]).forEach(([key, value]) => {
                const rawSet = value.__rawSet;
                const drAttrs = rawSet?.dataSet.render?.attribute;
                if (rawSet && !rawSet.isConnected) {
                    const destroyOptions = drAttrs?.drDestroyOption?.split(',') ?? [];
                    RawSet.destroy(obj[_index__WEBPACK_IMPORTED_MODULE_35__.DomRenderComponentMetaKey.DOMRENDER_COMPONENTS_KEY][key], { rawSet: rawSet }, config, destroyOptions);
                    delete obj[_index__WEBPACK_IMPORTED_MODULE_35__.DomRenderComponentMetaKey.DOMRENDER_COMPONENTS_KEY][key];
                }
            });
        }
        // console.log(`RawSet  if (obj.__domrender_components) { took ${performance.now() - t0} milliseconds.`);
        // console.log('-------raws',raws)
        // console.log(`RawSet render took ${performance.now() - t0} milliseconds. END!!`, renderCnt);
        console.groupEnd();
        return { raws: raws, executedOperators: executedOperators };
    }
    //    
    static generateRuleSelector(start, end, sit) {
        const selectorText = `:is(${start} ~ *:not(${start} ~ ${end} ~ *))`;
        if (sit.startsWith('## ')) {
            return sit.replace(/^## /, '');
        }
        else if (sit.startsWith('.')) {
            return `${selectorText}${sit}, ${selectorText} ${sit}`;
        }
        else if (sit.includes('::')) {
            const reg = sit.match(/(.*)::(.*)$/);
            const first = reg?.[1];
            const extracted = reg?.[2];
            const divText = `${start} ~ ${first}:not(${start} ~ ${end} ~ *)`;
            return `${selectorText} ${first}, ${divText}::${extracted}`;
        }
        else {
            const divText = `${start} ~ ${sit}:not(${start} ~ ${end} ~ *)`;
            return `${selectorText} ${sit}, ${divText}`;
        }
    }
    static generateStyleTransform(styleBody, componentKey, styleTagWrap = true) {
        // console.log('style!!!!!!!!!!!!!!!!1', styleBody, componentKey, styleTagWrap);
        if (Array.isArray(styleBody)) {
            styleBody = styleBody.join('\n');
        }
        styleBody = styleBody.replaceAll('#uuid#', componentKey);
        const start = `#${componentKey}-start`;
        const end = `#${componentKey}-end`;
        //   ??..
        //  .. css       deprecated  
        // const before = StringUtils.regexExecArrayReplace(styleBody, /(\$\{.*?\}\$)/g, (data) => {
        //   // console.log('?', `var(--domrender-${data[0]})`)
        //   return `var(--domrender-${data[0]})`;
        // });
        // const before = styleBody;
        // console.log('before@@@@@@@@@@@', before)
        const cssParser = new _dooboostore_core_parser_css_CssParser__WEBPACK_IMPORTED_MODULE_24__.CssParser(styleBody);
        const processRule = (rule) => {
            if ((0,_dooboostore_core_parser_css_CssParser__WEBPACK_IMPORTED_MODULE_24__.isStyleRule)(rule)) {
                const isRoot = rule.selector.includes(':root');
                if (!isRoot) {
                    // Handle comma-separated selectors
                    const selectors = rule.selector.split(',').map(s => s.trim());
                    const transformedSelectors = selectors.map(selector => this.generateRuleSelector(start, end, selector));
                    rule.selector = transformedSelectors.join(', ');
                }
            }
            else if ((0,_dooboostore_core_parser_css_CssParser__WEBPACK_IMPORTED_MODULE_24__.isAtRule)(rule)) {
                if (rule.name === 'media') {
                    const hasRoot = rule.children.some(childRule => (0,_dooboostore_core_parser_css_CssParser__WEBPACK_IMPORTED_MODULE_24__.isStyleRule)(childRule) && childRule.selector.includes(':root'));
                    if (!hasRoot) {
                        rule.children.forEach(childRule => {
                            if ((0,_dooboostore_core_parser_css_CssParser__WEBPACK_IMPORTED_MODULE_24__.isStyleRule)(childRule)) {
                                const selectors = childRule.selector.split(',').map(s => s.trim());
                                const transformedSelectors = selectors.map(selector => this.generateRuleSelector(start, end, selector));
                                childRule.selector = transformedSelectors.join(', ');
                            }
                        });
                    }
                }
            }
        };
        cssParser.rules.forEach(processRule);
        let after = cssParser.stringify();
        // let after = StringUtils.regexExecArrayReplace(stringify as string, /(var\(--domrender-(\$\{.*?\}\$)?\))/g, (data) => {
        //   return data[2];
        // });
        // console.log('after@@@@@@@@@@@', after)
        //   selector    20250518
        after = after.replaceAll('/*$', '${');
        after = after.replaceAll('$*/', '}$');
        if (styleTagWrap) {
            styleBody = `<style id='${componentKey}-style' domstyle>${after}</style>`;
        }
        // console.log('style!!!!!!!!!!!!!!2', styleBody);
        return styleBody;
    }
    applyEvent(obj, fragment = this.dataSet.fragment, config) {
        // const t0 = performance.now();
        this.dataSet.config.eventManager.applyEvent(obj, this.dataSet.config.eventManager.findAttrElements(fragment, config), config);
        // console.log(`RawSet applyEvent took ${performance.now() - t0} milliseconds.`);
    }
    onRenderedEvent(obj, nodes, config) {
        this.dataSet.config.eventManager.onRenderedEvent(obj, nodes, config);
    }
    getAttribute(element, attr) {
        const data = element.getAttribute(attr);
        return data;
    }
    getAttributeAndDelete(element, attr) {
        const data = element.getAttribute(attr);
        // if (data)
        //  element.setAttribute(`origin-${attr}`, data);
        element.removeAttribute(attr);
        return data;
    }
    getDrAppendAttributeAndDelete(element, obj) {
        let data = element.getAttribute(RawSet.DR_APPENDER_NAME);
        // if (data && !/\[[0-9]+\]/g.test(data)) {
        if (data && !/\[.+\]/g.test(data)) {
            const currentIndex = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Script.evaluateReturn(`${_dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Path.toOptionalChainPath(data)}?.length -1`, obj);
            // console.log('------?', currentIndex)
            // if (currentIndex === undefined || isNaN(currentIndex)) {
            //     return undefined;
            // }
            // const currentIndex = ScriptUtils.evalReturn(`${data}.length`, obj);
            data = `${data}[${currentIndex}]`;
            element.setAttribute(RawSet.DR_APPENDER_NAME, data);
            // element.setAttribute(RawSet.DR_IF_NAME, data);
            // element.setAttribute('dr-id', data);
            // console.log('-->', element)
        }
        // if (data && !/\.childs\[[0-9]+\]/g.test(data)) {
        //     const currentIndex = ScriptUtils.evalReturn(`${data}.currentIndex`, obj);
        //     data = `${data}.childs[${currentIndex}]`;
        //     element.setAttribute(RawSet.DR_APPENDER_NAME, data)
        // }
        element.removeAttribute(RawSet.DR_APPENDER_NAME);
        return data;
    }
    replaceBody(genNode) {
        this.childAllRemove();
        this.point.start.parentNode?.insertBefore(genNode, this.point.start.nextSibling); //  start checkpoint  end checkpoint  .    ( meta tag  ..)
    }
    //  important
    static checkPointCreates(element, obj, config) {
        // console.log('!@@@@@@@@@@@@@@@@', obj);
        // const NodeFilter = (config.window as any).NodeFilter;
        // const thisVariableName = (element as any).__domrender_this_variable_name;
        // let html = element instanceof DocumentFragment ? ElementUtils.toInnerHTML(element, {document: config.window.document}) : (element as HTMLElement).outerHTML;
        // console.log('==============html-->', element, html);
        const NodeFilter = config.window.NodeFilter;
        const Node = config.window.Node;
        const processedNodes = new Set();
        const findNodes = _dooboostore_core_web_node_NodeUtils__WEBPACK_IMPORTED_MODULE_33__.NodeUtils.findNodes(element, node => {
            // console.log('nodeType', node.nodeType, node, (node as any).tagName, (node as any).data);
            // for (const processedNode of processedNodes) {
            //   console.log('pre check!!', Array.from(processedNodes),processedNode !== node , processedNode.contains(node));
            //   // if(processedNode.contains(node)){
            //   console.log('---prechecker--html', (processedNode as HTMLElement).outerHTML,'------', (node as HTMLElement).outerHTML);
            //   // }
            //   if (processedNode !== node && processedNode.contains(node)) {
            //     console.log('acceptNodeReturn contain', NodeFilter.FILTER_REJECT);
            //     return NodeFilter.FILTER_REJECT;
            //   }
            // }
            if (node.nodeType === Node.TEXT_NODE) {
                // console.log('nodeText--->', node.textContent)
                // console.log('????????', node.parentElement, node.parentElement?.getAttribute('dr-pre'));
                // console.log('???????/',node.textContent, node.parentElement?.getAttribute('dr-pre'))
                // TODO: 
                // const between = StringUtils.betweenRegexpStr('[$#]\\{', '\\}', StringUtils.deleteEnter((node as Text).data ?? ''))
                const between = RawSet.expressionGroups(_dooboostore_core_string_StringUtils__WEBPACK_IMPORTED_MODULE_1__.StringUtils.deleteEnter(node.data ?? ''));
                // console.log('bbbb', between)
                const r = between?.length > 0
                    ? _dooboostore_core_web_node_NodeUtils__WEBPACK_IMPORTED_MODULE_33__.NodeUtils.FindNodesFilterResult.MATCH_AND_SKIP_CHILDREN
                    : _dooboostore_core_web_node_NodeUtils__WEBPACK_IMPORTED_MODULE_33__.NodeUtils.FindNodesFilterResult.NO_MATCH_AND_SKIP_CHILDREN;
                // console.log('acceptNodeReturn node', r);
                return r;
                // return /\$\{.*?\}/g.test(StringUtils.deleteEnter((node as Text).data ?? '')) ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_REJECT;
                // return /[$#]\{.*?\}/g.test(StringUtils.deleteEnter((node as Text).data ?? '')) ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_REJECT;
            }
            else if (node.nodeType === Node.ELEMENT_NODE) {
                const element = node;
                // if (typeof Window === 'undefined' && element.getAttribute('ttt') === 'visual') {
                //   return NodeFilter.FILTER_REJECT;
                // }
                // console.log('nodeHTML-->', element.outerHTML);
                if (element.hasAttribute(RawSet.DR_PRE_NAME)) {
                    let r = _dooboostore_core_web_node_NodeUtils__WEBPACK_IMPORTED_MODULE_33__.NodeUtils.FindNodesFilterResult.NO_MATCH_AND_SKIP_CHILDREN;
                    // console.log('acceptNodeReturn', r);
                    return r;
                }
                if (element.hasAttribute(_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.attrAttrName)) {
                    // console.log('elementAttrAttrName-->', element.outerHTML);
                    const script = element.getAttribute(_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.attrAttrName) ?? '';
                    // console.log('scriptscriptscriptscriptscriptscript,', script)
                    // const keyValuePairs = Array.from(script.matchAll(/['"]?(\w+)['"]?:\s*([^,}]+)/g))
                    const keyValuePairs = Array.from(script.matchAll(/['"]?([\w-_]+)['"]?:\s*([^,}]+)/g))
                        .map(match => ({
                        key: match[1],
                        value: match[2]
                    }));
                    (keyValuePairs ?? []).forEach(it => {
                        element.setAttribute(it.key, '${' + it.value + '}$');
                    });
                }
                // element.setAttribute('dr-event-click', 'console.log(11)');
                const targetElementIs = element.getAttribute(RawSet.DR_REPLACE_TARGET_ELEMENT_IS_NAME);
                const targetElementNames = config.targetElements?.map(it => it.name.toLowerCase()) ?? [];
                targetElementNames.push(...RawSet.DR_ELEMENTS);
                const isElement = targetElementNames.includes(element.tagName.toLowerCase()) ||
                    targetElementNames.includes(targetElementIs?.toLowerCase());
                // if (isElement) {
                //   (element as HTMLElement).style.display = 'none';
                //   (element as HTMLElement).style.width = '100px';
                //   (element as HTMLElement).style.height = '100px';
                //   console.log((element as HTMLElement).outerHTML)
                // }
                // console.log('------targetElementIstargetElementIs>', targetElementNames, '---', isElement, targetElementIs);
                // const targetAttrNames = (config.targetAttrs?.map(it => it.name) ?? []).concat([...RawSet.DR_ATTRIBUTES,...EventManager.RAWSET_CHECK_ATTRIBUTE]);
                const targetAttrNames = (config.targetAttrs?.map(it => it.name) ?? []).concat([...RawSet.DR_ATTRIBUTES]);
                const normalAttrs = new Map();
                const linkVariables = new Map();
                const linkNames = _events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.linkAttrs.map(it => it.name);
                const isAttr = element.getAttributeNames().filter(it => !_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.noDetectAttr.includes(it)).filter(it => {
                    const value = element.getAttribute(it)?.trim();
                    // link
                    if (value && linkNames.includes(it)) {
                        linkVariables.set(it, value);
                    }
                    else if (value && RawSet.isExpression(value)) {
                        // 
                        const variablePaths = RawSet.expressionGroups(value).map(it => ({
                            origin: it[0].trim(),
                            inner: it[1].trim()
                        }));
                        const isStringTemplate = variablePaths.length > 1 || (variablePaths[0] && variablePaths[0].origin !== value);
                        // normal Attribute  .
                        // TODO:    ?
                        // let variablePath: string = RawSet.expressionGroups(value)[0][1];
                        // const originVariable = variablePath;
                        // variablePath = variablePath.replace(/#[^#]*#/g, '({})');
                        // const optionalChainPath = ObjectUtils.Path.toOptionalChainPath(variablePath);
                        // const cval = ObjectUtils.Script.evaluateReturn(optionalChainPath, Object.assign(obj));
                        let targetScript = value;
                        variablePaths.forEach(it => {
                            let r = it.inner.replace(/#[^#]*#/g, '({})');
                            r = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Path.toOptionalChainPath(r);
                            targetScript = targetScript.replaceAll(it.origin, `\${${r}}`);
                        });
                        const cval = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Script.evaluateReturn('`' + targetScript + '`', Object.assign(obj));
                        if (cval === null) {
                            element.removeAttribute(it);
                            /* TODO:   
                             TODO: ..... ?
                            *
                <select dr-event-change="@this@.onMarketChange($event)" class="market-select">
                    <option>  (${@this@.markets?.length??0}$)</option>
                    <option dr-for-of="@this@.markets" dr-option-item-variable-name="market" value="${#market#.uuid}$" dr-attr="{selected: #market#.uuid === @this@.marketUUID ? 'selected' : null}">
                      ${#market#.name}$
                    </option>
                  </select>
                             */
                            // } else if (
                            //   !(element.hasAttribute(RawSet.DR_VARIABLE_NAME_OPTIONNAME) || element.hasAttribute(RawSet.DR_ITEM_VARIABLE_NAME_OPTIONNAME) || element.hasAttribute(RawSet.DR_ITEM_INDEX_VARIABLE_NAME_OPTIONNAME))
                            // ) {
                            //     element.setAttribute(it, cval);
                        }
                        else {
                            element.setAttribute(it, cval);
                        }
                        normalAttrs.set(it, { originalAttrValue: value, variablePaths: variablePaths, isStringTemplate });
                        // normalAttrs.set(it, originVariable);
                        // console.log('normalAttribute', it, variablePath);
                    }
                    // console.log(element.getAttribute(it), attrExpresion);
                    const isTargetAttr = targetAttrNames.includes(it.toLowerCase());
                    return isTargetAttr;
                }).length > 0;
                if (linkVariables.size) {
                    element.setAttribute(_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.linkTargetMapAttrName, JSON.stringify(Array.from(linkVariables.entries())));
                }
                //  attribute 
                if (normalAttrs.size) {
                    element.setAttribute(_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.normalAttrMapAttrName, JSON.stringify(Array.from(normalAttrs.entries())));
                }
                // if (isElement)  {
                //   element.setAttribute('www', '@this@');
                // }
                const r = isAttr || isElement ? _dooboostore_core_web_node_NodeUtils__WEBPACK_IMPORTED_MODULE_33__.NodeUtils.FindNodesFilterResult.MATCH_AND_SKIP_CHILDREN : _dooboostore_core_web_node_NodeUtils__WEBPACK_IMPORTED_MODULE_33__.NodeUtils.FindNodesFilterResult.NO_MATCH_AND_CONTINUE;
                // console.log('acceptNodeReturn element', r);
                return r;
            }
            const r = _dooboostore_core_web_node_NodeUtils__WEBPACK_IMPORTED_MODULE_33__.NodeUtils.FindNodesFilterResult.NO_MATCH_AND_CONTINUE;
            // console.log('acceptNodeReturn  nothing', r);
            return r;
        });
        const pars = [];
        let currentNode;
        const name = _dooboostore_core_random_RandomUtils__WEBPACK_IMPORTED_MODULE_0__.RandomUtils.uuid();
        // console.log('name==', name);
        // eslint-disable-next-line no-cond-assign
        // while ((currentNode = nodeIterator?.nextNode())) {
        // console.log('findNodes~~', findNodes);
        for (const currentNode of findNodes) {
            //        .. JSDOM ..       .
            processedNodes.add(currentNode);
            // console.log('currentNode!!!!', currentNode);
            if (currentNode.nodeType === Node.TEXT_NODE) {
                const text = currentNode.textContent ?? '';
                const template = config.window.document?.createElement('template');
                if (!template)
                    break;
                // const a = StringUtils.regexExec(/\$\{.*?\}/g, text);
                // const a = StringUtils.regexExec(/[$#]\{.*?\}/g, text);
                // const a = StringUtils.betweenRegexpStr('[$#]\\{', '\\}', text); // <--TODO: ..
                const groups = RawSet.expressionGroups(text);
                const map = groups.map(it => ({
                    uuid: `${_dooboostore_core_random_RandomUtils__WEBPACK_IMPORTED_MODULE_0__.RandomUtils.alphabet(40)}_${obj?.constructor?.name}`,
                    content: it[0],
                    regexArr: it
                }));
                // console.log('create!!',map);
                let lasterIndex = 0;
                for (let i = 0; i < map.length; i++) {
                    const it = map[i];
                    // console.log('itttttttttttt', it);
                    const regexArr = it.regexArr;
                    // : text asdasd ${this.name}$    asdasd <--    
                    const preparedText = regexArr.input.substring(lasterIndex, regexArr.index);
                    // const preparedText = regexArr[1];
                    // const start = config.window.document.createElement('meta');
                    // start.setAttribute('id', `${it.uuid}-start`);
                    // const end = config.window.document.createElement('meta');
                    // end.setAttribute('id', `${it.uuid}-end`);
                    let type;
                    if (currentNode.parentNode && currentNode.parentNode.nodeName.toUpperCase() === 'STYLE') {
                        type = _RawSetType__WEBPACK_IMPORTED_MODULE_21__.RawSetType.STYLE_TEXT;
                    }
                    else {
                        type = _RawSetType__WEBPACK_IMPORTED_MODULE_21__.RawSetType.TEXT;
                    }
                    const node = config.window.document.createTextNode(preparedText);
                    const startEndPoint = RawSet.createStartEndPoint({ id: it.uuid, type }, config);
                    // layout setting
                    // console.log('createTextNode', node);
                    template.content.append(node); // expression      text .
                    template.content.append(startEndPoint.start); // add start checkpoint
                    template.content.append(startEndPoint.end); // add end checkpoint
                    // content  RawSet render  start  end  fragment  .
                    const fragment = config.window.document.createDocumentFragment();
                    fragment.append(config.window.document.createTextNode(it.content));
                    // (startEndPoint.start as any).khh = RandomUtils.decimal(0,10)
                    pars.push(new RawSet(it.uuid, type, {
                        start: startEndPoint.start,
                        node: currentNode,
                        end: startEndPoint.end,
                        parent: currentNode.parentNode
                        // thisVariableName: thisVariableName
                    }, { fragment: fragment, config: config }));
                    lasterIndex = regexArr.index + it.content.length;
                }
                template.content.append(config.window.document.createTextNode(text.substring(lasterIndex, text.length)));
                const p = currentNode?.parentNode;
                p?.replaceChild(template.content, currentNode); // <--  text fragment replace   .
            }
            else if (currentNode.nodeType === Node.ELEMENT_NODE) {
                // const uuid = `${RandomUtils.alphabet(40)}___${obj?.constructor?.name}`;
                const uuid = `${_dooboostore_core_random_RandomUtils__WEBPACK_IMPORTED_MODULE_0__.RandomUtils.alphabet(40)}`;
                const element = currentNode;
                // console.log('create ElementTarget', uuid, element.outerHTML);
                const fragment = config.window.document.createDocumentFragment();
                const elementType = _RawSetType__WEBPACK_IMPORTED_MODULE_21__.RawSetType.TARGET_ELEMENT;
                const startEndPoint = RawSet.createStartEndPoint({ node: element, id: uuid, type: elementType }, config);
                //   component .
                const targetElementIs = element.getAttribute(RawSet.DR_REPLACE_TARGET_ELEMENT_IS_NAME);
                const targetElementNames = config.targetElements?.map(it => it.name.toLowerCase()) ?? [];
                targetElementNames.push(...RawSet.DR_ELEMENTS);
                const isElement = targetElementNames.includes(element.tagName.toLowerCase()) ||
                    targetElementNames.includes(targetElementIs?.toLowerCase());
                // if (isElement) {
                //   (element as HTMLElement).style.display = 'none'
                // }
                // const isElement = targetElementNames.includes(element.tagName.toLowerCase());
                const targetAttrNames = (config.targetAttrs?.map(it => it.name) ?? []).concat(RawSet.DR_ATTRIBUTES);
                const isAttr = element.getAttributeNames().filter(it => targetAttrNames.includes(it.toLowerCase())).length > 0;
                currentNode?.parentNode?.insertBefore(startEndPoint.start, currentNode);
                currentNode?.parentNode?.insertBefore(startEndPoint.end, currentNode.nextSibling);
                fragment.append(currentNode);
                // const tempDiv = document.createElement('div');
                // tempDiv.appendChild(fragment.cloneNode(true)); // fragment  
                // console.log('------',tempDiv.innerHTML);
                // console.log();
                const rawSet = new RawSet(uuid, isElement ? elementType : isAttr ? _RawSetType__WEBPACK_IMPORTED_MODULE_21__.RawSetType.TARGET_ATTR : _RawSetType__WEBPACK_IMPORTED_MODULE_21__.RawSetType.UNKOWN, {
                    start: startEndPoint.start,
                    node: currentNode,
                    end: startEndPoint.end,
                    parent: currentNode.parentNode
                    // thisVariableName: thisVariableName
                }, { config: config, fragment: fragment });
                pars.push(rawSet);
            }
        }
        // config
        const util = _dooboostore_core_web_element_ElementUtils__WEBPACK_IMPORTED_MODULE_4__.ElementUtils;
        // console.log('parsparsparsparsparsparsparsparsparspars', pars, name);
        return pars;
        // const lastpars: RawSet[] = []
        //
        // pars.forEach(it => {
        //   // it.uuid
        //   const parents = pars.filter(it => it.dataSet.fragment.getElementById(it.uuid+'-start'))
        //
        //   console.log('vvvvvvvvv', parents);
        //   if (parents.length>0) {
        //     parents.forEach(sit => {
        //       sit.dataSet.fragment.getElementById(sit.uuid + '-start')?.replaceWith(it.dataSet.fragment);
        //       it.dataSet.fragment.getElementById(sit.uuid + '-end').remove();
        //       console.log('rrr');
        //       // ElementUtils.toInnerHTML(it.dataSet.fragment, {document: config.window.document});
        //       // ElementUtils.toInnerHTML(it.dataSet.fragment
        //     });
        //   } else {
        //     lastpars.push(it)
        //   }
        // })
        // console.log('zzzzzz', lastpars);
        // return lastpars;
    }
    static createStartEndPoint(data, config) {
        if (data.type === _RawSetType__WEBPACK_IMPORTED_MODULE_21__.RawSetType.TARGET_ELEMENT && data.node) {
            const element = data.node;
            const start = config.window.document.createElement('meta');
            const end = config.window.document.createElement('meta');
            start.setAttribute('id', `${data.id}-start`);
            start.setAttribute('dr-start-point', '');
            const keys = element.getAttribute(RawSet.DR_KEY_OPTIONNAME);
            const thisPropertyType = element.getAttribute(RawSet.DR_THIS_PROPERTY_NAME);
            if (thisPropertyType) {
                start.setAttribute('type', _RawSetOperatorType__WEBPACK_IMPORTED_MODULE_23__.RawSetOperatorType.DR_THIS_PROPERTY);
            }
            if (keys) {
                element.removeAttribute(RawSet.DR_KEY_OPTIONNAME);
                start.setAttribute(RawSet.DR_KEY_OPTIONNAME, keys);
            }
            end.setAttribute('id', `${data.id}-end`);
            end.setAttribute('dr-end-point', '');
            return { start, end };
        }
        else if (data.type === _RawSetType__WEBPACK_IMPORTED_MODULE_21__.RawSetType.STYLE_TEXT) {
            return {
                start: config.window.document.createTextNode(`/*start text ${data.id}*/`),
                end: config.window.document.createTextNode(`/*end text ${data.id}*/`)
            };
        }
        else {
            // text
            return {
                start: config.window.document.createComment(`start text ${data.id}`),
                end: config.window.document.createComment(`end text ${data.id}`)
            };
        }
    }
    remove() {
        this.childAllRemove();
        this.point.end.remove();
        this.point.start.remove();
    }
    childAllRemove() {
        let next = this.point.start.nextSibling;
        while (next) {
            if (next === this.point.end) {
                break;
            }
            next.remove();
            next = this.point.start.nextSibling;
        }
    }
    childs(stopNext) {
        const childs = [];
        let next = this.point.start.nextSibling;
        while (next && next !== this.point.end) {
            if (stopNext?.(next)) {
                return;
            }
            childs.push(next);
            next = next.nextSibling;
        }
        return childs;
    }
    getHasRawSet(key) {
        let rawSet;
        this.childs(node => {
            const drKey = node.getAttribute?.(RawSet.DR_KEY_OPTIONNAME);
            if (drKey && drKey === key) {
                rawSet = node.rawSet;
                return true;
            }
            return false;
        });
        return rawSet;
    }
    static drItOtherEncoding(element, postFix) {
        const random = _dooboostore_core_random_RandomUtils__WEBPACK_IMPORTED_MODULE_0__.RandomUtils.uuid() + postFix;
        const regex = /#it#/g;
        element
            .querySelectorAll(`[${RawSet.DR_IT_OPTIONNAME}], [${RawSet.DR_FOR_OF_NAME}], [${RawSet.DR_REPEAT_NAME}], [${RawSet.DR_APPENDER_NAME}]`)
            .forEach(it => {
            it.innerHTML = it.innerHTML.replace(regex, random);
        });
        return random;
    }
    static drItOtherDecoding(element, random) {
        element
            .querySelectorAll(`[${RawSet.DR_IT_OPTIONNAME}], [${RawSet.DR_FOR_OF_NAME}], [${RawSet.DR_REPEAT_NAME}], [${RawSet.DR_APPENDER_NAME}]`)
            .forEach(it => {
            it.innerHTML = it.innerHTML.replace(RegExp(random, 'g'), '#it#');
        });
    }
    static drVarDecoding(element, vars) {
        element.querySelectorAll(`[${RawSet.DR_THIS_NAME}]`).forEach(it => {
            vars
                .filter(vit => vit.value && vit.name)
                .forEach(vit => {
                it.innerHTML = it.innerHTML.replace(RegExp(vit.random, 'g'), vit.value);
            });
        });
    }
    static replaceInnerHTML(element, config) {
        const innerHTML = element.innerHTML;
        const tobe = (config.toBe = config.toBe ?? _dooboostore_core_random_RandomUtils__WEBPACK_IMPORTED_MODULE_0__.RandomUtils.uuid());
        if (config.asIs instanceof RegExp) {
            element.innerHTML = innerHTML.replace(config.asIs, config.toBe);
        }
        else {
            element.innerHTML = innerHTML.replaceAll(config.asIs, config.toBe);
        }
        return tobe;
    }
    static drThisEncoding(element, drThis, config) {
        const thisRandom = (config.toBe = config?.toBe ?? _dooboostore_core_random_RandomUtils__WEBPACK_IMPORTED_MODULE_0__.RandomUtils.uuid());
        // console.log('rrrrrrrrrrrrr', thisRandom);
        // const thisRegex = /(?<!(dr-|\.))this(?=.?)/g;
        // const thisRegex = /[^(dr\-)]this(?=.?)/g;
        // const thisRegex = /[^(dr\-)]this\./g;
        // safari    regex    .
        // element.querySelectorAll(`[${RawSet.DR_PRE_NAME}]`).forEach(it => {
        //     let message = it.innerHTML;
        // })
        element.querySelectorAll(`[${RawSet.DR_PRE_NAME}]`).forEach(it => {
            it.innerHTML = it.innerHTML.replace(config.asIs, thisRandom);
        });
        element.querySelectorAll(`[${RawSet.DR_THIS_NAME}]`).forEach(it => {
            // console.log('rrrrrrrrand?', drThis,config);
            let message = it.innerHTML;
            // StringUtils.regexExec(/([^(dr\-)])?this(?=.?)/g, message).reverse().forEach(it => {
            _dooboostore_core_string_StringUtils__WEBPACK_IMPORTED_MODULE_1__.StringUtils.regexExec(config.asIs, message)
                .reverse()
                .forEach(it => {
                message = message.substr(0, it.index) + message.substr(it.index).replace(it[0], `${it[1] ?? ''}${drThis}`);
            });
            it.innerHTML = message;
        });
        // console.log('changggg', element.innerHTML);
        let message = element.innerHTML;
        _dooboostore_core_string_StringUtils__WEBPACK_IMPORTED_MODULE_1__.StringUtils.regexExec(config.asIs, message)
            .reverse()
            .forEach(it => {
            message = message.substr(0, it.index) + message.substr(it.index).replace(it[0], `${it[1] ?? ''}${drThis}`);
        });
        element.innerHTML = message;
        return thisRandom;
    }
    static drThisBindEncoding(element, variable, config) {
        element.querySelectorAll(`[${RawSet.DR_THIS_NAME}]`).forEach(eIt => {
            let message = eIt.innerHTML;
            // StringUtils.regexExec(/([^(dr\-)])?this(?=.?)/g, message).reverse().forEach(it => {
            _dooboostore_core_string_StringUtils__WEBPACK_IMPORTED_MODULE_1__.StringUtils.regexExec(variable, message)
                .reverse()
                .forEach(it => {
                message =
                    message.substr(0, it.index) +
                        message.substr(it.index).replace(it[0], `${it[1] ?? ''}${eIt.getAttribute(RawSet.DR_THIS_NAME)}`);
            });
            eIt.innerHTML = message;
        });
        const targetElements = config.config.targetElements ?? [];
        const targetElementNames = targetElements
            .map(it => it.name.replaceAll('.', '\\.').replaceAll(':', '\\:'))
            .join(',');
        const thisRandom = _dooboostore_core_random_RandomUtils__WEBPACK_IMPORTED_MODULE_0__.RandomUtils.uuid();
        // console.log('thisRandom', thisRandom, variable);
        element.querySelectorAll(targetElementNames).forEach(it => {
            it.innerHTML = it.innerHTML.replace(variable, thisRandom);
        });
        element.querySelectorAll(`[${RawSet.DR_REPLACE_TARGET_ELEMENT_IS_NAME}]`).forEach(it => {
            it.innerHTML = it.innerHTML.replace(variable, thisRandom);
        });
        if (config.otherReplaceVariablePath) {
            let message = element.innerHTML;
            _dooboostore_core_string_StringUtils__WEBPACK_IMPORTED_MODULE_1__.StringUtils.regexExec(variable, message)
                .reverse()
                .forEach(it => {
                message =
                    message.substr(0, it.index) +
                        message.substr(it.index).replace(it[0], `${it[1] ?? ''}${config.otherReplaceVariablePath}`);
            });
            element.innerHTML = message;
        }
        return thisRandom;
    }
    static drThisBindDecoding(element, config) {
        const targetElements = config.config.targetElements ?? [];
        const targetElementNames = targetElements
            .map(it => it.name.replaceAll('.', '\\.').replaceAll(':', '\\:'))
            .join(',');
        element.querySelectorAll(targetElementNames).forEach(it => {
            it.innerHTML = it.innerHTML.replace(RegExp(config.asIs, 'g'), config.toBe);
        });
        element.querySelectorAll(`[${RawSet.DR_REPLACE_TARGET_ELEMENT_IS_NAME}]`).forEach(it => {
            it.innerHTML = it.innerHTML.replace(RegExp(config.asIs, 'g'), config.toBe);
        });
    }
    static drThisDecoding(element, config) {
        element.querySelectorAll(`[${RawSet.DR_PRE_NAME}]`).forEach(it => {
            it.innerHTML = it.innerHTML.replace(RegExp(config.asIs, 'g'), config.toBe);
        });
        element.querySelectorAll(`[${RawSet.DR_THIS_NAME}]`).forEach(it => {
            it.innerHTML = it.innerHTML.replace(RegExp(config.asIs, 'g'), config.toBe);
        });
    }
    static drFormOtherMoveAttr(element, as, to, config) {
        element.querySelectorAll(`[${RawSet.DR_FORM_NAME}]`).forEach(subElement => {
            const nodeIterator = config.window.document?.createNodeIterator(subElement, NodeFilter.SHOW_ELEMENT, {
                acceptNode(node) {
                    if (node.nodeType === Node.ELEMENT_NODE) {
                        const element = node;
                        return element.hasAttribute(as) ? NodeFilter.FILTER_ACCEPT : NodeFilter.FILTER_REJECT;
                    }
                    else {
                        return NodeFilter.FILTER_REJECT;
                    }
                }
            });
            let node;
            // eslint-disable-next-line no-cond-assign
            while ((node = nodeIterator?.nextNode())) {
                const element = node;
                element.setAttribute(to, element.getAttribute(as) ?? '');
                element.removeAttribute(as);
            }
        });
    }
    static drVarEncoding(element, drVarOption) {
        const vars = (drVarOption?.split(',') ?? []).map(it => {
            const s = it.trim().split('=');
            const name = s[0]?.trim();
            const value = s[1]?.trim();
            return {
                name,
                value,
                // regex: RegExp('(?<!(dr-|\\.))var\\.' + s[0] + '(?=.?)', 'g'),
                regex: RegExp('\\$var\\.' + name + '(?=.?)', 'g'),
                random: _dooboostore_core_random_RandomUtils__WEBPACK_IMPORTED_MODULE_0__.RandomUtils.uuid()
            };
        });
        // console.log('asd', element.innerHTML);
        // element.querySelectorAll(`[${RawSet.DR_THIS_NAME}]`).forEach(it => {
        element.querySelectorAll(`[${RawSet.DR_VAR_OPTIONNAME}]`).forEach(it => {
            vars
                .filter(vit => vit.value && vit.name)
                .forEach(vit => {
                it.innerHTML = it.innerHTML.replace(vit.regex, vit.random);
            });
        });
        vars
            .filter(vit => vit.value && vit.name)
            .forEach(vit => {
            element.innerHTML = element.innerHTML.replace(vit.regex, vit.value);
        });
        return vars;
    }
    static async drThisCreate(rawSet, element, drThis, drVarOption, drStripOption, obj, config, set) {
        // console.log('ttttttttttttttttttttt',element.innerHTML, drThis, set, obj);
        const fag = config.window.document?.createDocumentFragment();
        if (!fag) {
            return;
        }
        const targetElement = element.cloneNode(true);
        let targetObj = obj;
        if (set) {
            targetObj = set.obj;
            set.setTemplateStyle(await RawSet.fetchTemplateStyle(set));
            const style = RawSet.generateStyleTransform(set.styles ?? [], rawSet.uuid, true);
            targetElement.innerHTML = style + (set.template ?? '');
        }
        else {
            targetObj = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Script.evaluateReturn(_dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Path.toOptionalChainPath(drThis), obj);
        }
        const componentKey = rawSet.uuid;
        const renderScript = ` /*drThisCreate*/
        // console.log('-----', this.__render);
        var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.RENDER_VARNAME} = this.__render; 
        var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.RAWSET_VARNAME} = this.__render.rawSet; 
        var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.COMPONENT_VARNAME} = this.__render.component; 
        var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.ELEMENT_VARNAME} = this.__render.element; 
        var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.ROUTER_VARNAME} = this.__render.router; 
        var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.INNER_HTML_VARNAME} = this.__render.innerHTML; 
        var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.ATTRIBUTE_VARNAME} = this.__render.attribute; 
        var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.PARENT_THIS_PATH_VARNAME} = this.__render.parentThisPath; 
        var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.CURRENT_THIS_VARNAME} = this.__render.currentThis; 
        var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.CURRENT_THIS_PATH_VARNAME} = this.__render.currentThisPath; 
        var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.PARENT_THIS_VARNAME} = this.__render.parentThis; 
        var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.NEAR_THIS_PATH_VARNAME} = this.__render.nearThisPath; 
        var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.NEAR_THIS_VARNAME} = this.__render.nearThis; 
        var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.CREATOR_META_DATA_VARNAME} = this.__render.creatorMetaData;
      `;
        const parentThisPath = rawSet.findParentThisPath();
        const parentThis = rawSet.findParentThis(obj);
        const nearThisPath = rawSet.findNearThisPath();
        const nearThis = rawSet.findNearThis(obj);
        // console.log('ttttttttttttttttt',parentThisPath, parentThis, nearThisPath, nearThis);
        // console.log('-element.innerHTMLelement.innerHTMLelement.innerHTML',element.innerHTML);
        let render = {
            renderScript: renderScript,
            element: element,
            getElement: () => config.window.document.querySelector(`[class*="${rawSet.uuid}"]`),
            innerHTML: element.innerHTML,
            // attribute: ObjectUtils.toDeleteKey(attribute, [...Object.values(RawSet.drAttrsOriginName), ...Object.values(EventManager.VARNAMES)]),
            rawSet: rawSet,
            router: config.router,
            componentKey: componentKey,
            currentThis: targetObj,
            currentThisPath: drThis,
            parentThisPath: parentThisPath,
            parentThis: parentThis,
            nearThisPath: nearThisPath,
            nearThis: nearThis,
            scripts: _events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.setBindProperty(config.scripts ?? {}, obj)
        };
        // const attribute = DomUtils.getAttributeToObject(element);
        render.attribute = RawSet.getAttributeObject(element, { script: renderScript, obj: obj, renderData: render });
        render = Object.freeze(render);
        // dr-on-create data onCreateRender
        const onCreateDataScript = `return {rootParent: this, render: this.__render}`;
        const onCreateDataParam = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Script.evaluate(onCreateDataScript, Object.assign(obj, { __render: render }));
        if ((0,_lifecycle_OnCreateRenderData__WEBPACK_IMPORTED_MODULE_25__.isOnCreateRenderData)(targetObj)) {
            targetObj?.onCreateRenderData(onCreateDataParam);
        }
        //   this   callback
        if (onCreateDataParam?.render?.parentThis && (0,_lifecycle_OnCreatedThisChild__WEBPACK_IMPORTED_MODULE_29__.isOnCreatedThisChild)(onCreateDataParam?.render?.parentThis)) {
            onCreateDataParam.render.parentThis.onCreatedThisChild(targetObj, onCreateDataParam);
        }
        // dr-on-create onCreateRender
        const onCreate = element.getAttribute(RawSet.DR_ON_CREATE_ARGUMENTS_OPTIONNAME);
        let createParam = [];
        if (onCreate) {
            createParam = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Script.evaluateReturn({ bodyScript: renderScript, returnScript: _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Path.toOptionalChainPath(onCreate) }, obj);
            if (!Array.isArray(createParam)) {
                createParam = [createParam];
            }
        }
        if ((0,_lifecycle_OnCreateRender__WEBPACK_IMPORTED_MODULE_26__.isOnCreateRender)(targetObj)) {
            targetObj.onCreateRender(...createParam);
        }
        // console.log('?');
        //  dr-normal-attr-map
        // const normalAttrMap = element.getAttribute(EventManager.normalAttrMapAttrName);
        const targetAttrObject = RawSet.getAttributeObject(element, { script: renderScript, obj: obj, renderData: render });
        if (targetAttrObject) {
            rawSet.dataSet.render ??= {};
            rawSet.dataSet.render.attribute = targetAttrObject;
            Object.entries(targetAttrObject).forEach(([key, cval], index) => {
                // console.log('ooooooooooooooooo', key, cval);
                // const script = `${renderScript} return ${value} `;
                // const cval = ScriptUtils.eval(script, Object.assign(obj, { __render: render }));
                // // element.setAttribute(key, cval);
                if ((0,_lifecycle_OnChangeAttrRender__WEBPACK_IMPORTED_MODULE_27__.isOnChangeAttrRender)(targetObj)) {
                    targetObj.onChangeAttrRender(key, cval, { rawSet: rawSet });
                }
            });
        }
        // dr-on-component-init
        // const oninit = element.getAttribute(`${EventManager.attrPrefix}on-component-init`); // dr-on-component-init
        const oninit = element.getAttribute(RawSet.DR_ON_CREATED_CALLBACK_OPTIONNAME); // dr-on-component-init
        // console.log('--------drThisCreate!!!', oninit)
        if (oninit) {
            const script = `${renderScript}  ${oninit} `;
            _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Script.evaluate(script, Object.assign(obj, { __render: render }));
        }
        targetElement.querySelectorAll(_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.attrNames.map(it => `[${it}]`).join(',')).forEach(it => {
            it.setAttribute(_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.ownerVariablePathAttrName, 'this');
        });
        // console.log('targetElement',targetElement);
        // attribute
        // const componentName = element.getAttribute(RawSet.DR_COMPONENT_NAME_OPTIONNAME) ?? 'component';
        // const componentNameReplaceKey = RandomUtils.uuid();
        // if (componentName) {
        //   RawSet.replaceInnerHTML(element, {asIs: `#${componentName}#`, toBe: 'this'})
        // }
        // const innerHTMLName = element.getAttribute(RawSet.DR_COMPONENT_INNER_HTML_NAME_OPTIONNAME) ?? 'innerHTML';
        // const innerHTMLNameReplaceKey = RandomUtils.uuid();
        // if (innerHTMLName) {
        //   RawSet.replaceInnerHTML(element, {asIs: `#${innerHTMLName}#`, toBe: innerHTMLNameReplaceKey})
        // }
        rawSet.point.innerHTML = element.innerHTML;
        const innerText = element.textContent?.trim() ?? '';
        const escapedInnerHTML = _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_34__.ConvertUtils.escapeHTML(element.innerHTML);
        //   ...     .. ..
        const innerHTMLName = targetElement.getAttribute(RawSet.DR_INNER_HTML_NAME_OPTIONNAME) ?? 'innerHTML';
        const innerTEXTName = targetElement.getAttribute(RawSet.DR_INNER_TEXT_NAME_OPTIONNAME) ?? 'innerTEXT';
        const innerHTMLEscapedName = targetElement.getAttribute(RawSet.DR_INNER_HTML_ESCAPED_NAME_OPTIONNAME) ?? 'innerHTMLEscaped';
        const templateReplacements = [];
        if (innerHTMLName) {
            templateReplacements.push({
                regex: new RegExp(`#${innerHTMLName}#`, 'g'),
                callback: () => element.innerHTML
            });
        }
        if (innerTEXTName) {
            templateReplacements.push({
                regex: new RegExp(`#${innerTEXTName}#`, 'g'),
                callback: () => innerText
            });
        }
        if (innerHTMLEscapedName) {
            templateReplacements.push({
                regex: new RegExp(`#${innerHTMLEscapedName}#`, 'g'),
                callback: () => escapedInnerHTML
            });
        }
        if (templateReplacements.length > 0) {
            targetElement.innerHTML = _dooboostore_core_string_StringUtils__WEBPACK_IMPORTED_MODULE_1__.StringUtils.replaceSequentially(targetElement.innerHTML, templateReplacements);
        }
        // console.log('aa-asIs', targetElement.innerHTML);
        const componentName = targetElement.getAttribute(RawSet.DR_VARIABLE_NAME_OPTIONNAME) ?? 'component';
        const optionThisName = targetElement.getAttribute(RawSet.DR_THIS_NAME_OPTIONNAME);
        // console.log('11111111111111', optionThisName)
        targetElement
            .getAttributeNames()
            .forEach(it => targetElement.setAttribute(it, targetElement.getAttribute(it).replace(/#this#/g, drThis)));
        const thisRandom = this.drThisEncoding(targetElement, drThis, { asIs: /@this@/g });
        // console.log('@@@@@@@@@@@@@0', thisRandom);
        // let thisNameRandom: string | undefined = undefined;
        targetElement.innerHTML = targetElement.innerHTML.replaceAll(`#${componentName}#`, drThis);
        if (optionThisName) {
            // console.log('-----0', element.innerHTML, '\n', targetElement.innerHTML)
            targetElement.innerHTML = targetElement.innerHTML.replaceAll(`@${optionThisName}@`, drThis);
            // console.log('-----1', element.innerHTML, '\n', targetElement.innerHTML)
            // thisNameRandom = this.drThisBindEncoding(targetElement, new RegExp(`@${optionThisName}@`, 'g'), {config: config, otherReplaceVariablePath: drThis});
        }
        const nearThisRandom = this.drThisBindEncoding(targetElement, /@nearThis@/g, {
            config: config,
            otherReplaceVariablePath: rawSet.findNearThisPath()
        });
        const parentThisRandom = this.drThisBindEncoding(targetElement, /@parentThis@/g, {
            config: config,
            otherReplaceVariablePath: rawSet.findParentThisPath()
        });
        // console.log('@@@@@@@@@@@@@1', targetElement.innerHTML, rawSet.findParentThisPath());
        // console.log('@@@@@@@@@@@@@-----------', rawSet.point?.parentRawSet?.point?.start, rawSet.point?.parentRawSet?.point?.start instanceof HTMLMetaElement);
        // if (rawSet.point?.parentRawSet?.point?.start instanceof HTMLMetaElement) {
        // console.log('@@@@@@@@@@@@@-----------', rawSet.point?.parentRawSet?.point?.start.getAttribute('this-path'));
        // }
        // console.log('@@@@@@@@@@@@@2', targetElement.innerHTML);
        // const nearThisRandom = this.drThisEncoding(targetElement, rawSet.findNearThisPath(), {asIs: /@nearThis@/g});
        // const parentThisRandom = this.drThisEncoding(targetElement, rawSet.findParentThisPath(), {asIs: /@parentThis@/g});
        // console.log('aa-toBe', targetElement.innerHTML);
        // console.log('------', rawSet.findNearThisPath());
        // console.log('------', rawSet.findParentThisPath());
        const vars = this.drVarEncoding(targetElement, drVarOption);
        this.drVarDecoding(targetElement, vars);
        this.drThisDecoding(targetElement, { asIs: thisRandom, toBe: '@this@' });
        // if (optionThisName && thisNameRandom)
        //   this.drThisBindDecoding(targetElement, {config: config, asIs: thisNameRandom, toBe: `@${optionThisName}@`});
        this.drThisBindDecoding(targetElement, { config: config, asIs: nearThisRandom, toBe: '@nearThis@' });
        this.drThisBindDecoding(targetElement, { config: config, asIs: parentThisRandom, toBe: '@parentThis@' });
        // if (componentName) {
        //   RawSet.replaceInnerHTML(element, {asIs: componentNameReplaceKey, toBe: `#${componentName}#`})
        // }
        // if (innerHTMLName) {
        //   RawSet.replaceInnerHTML(targetElement, {asIs: innerHTMLNameReplaceKey, toBe: `#${innerHTMLName}#`})
        // }
        // console.log('ddddddddddddd', targetElement.innerHTML);
        if (drStripOption && (drStripOption === true || drStripOption === 'true')) {
            // console.log('------childNodes', Array.from(n.childNodes))
            Array.from(targetElement.childNodes).forEach(it => fag.append(it));
        }
        else {
            targetElement.classList.add(`${rawSet.uuid}`);
            fag.append(targetElement);
        }
        // (fag as any).__domrender_this_variable_name = drThis;
        // console.log('set __domrender_this_variable_name', (fag as any).__domrender_this_variable_name)
        return fag;
    }
    static async fetchTemplateStyle(set) {
        // const id = RandomUtils.getRandomString(20);
        const stylePromises = [];
        const templatePromise = set.template && set.template.startsWith('lazy://')
            ? (await fetch(set.template.substring(6))).text()
            : Promise.resolve(set.template);
        if (Array.isArray(set.styles)) {
            for (let i = 0; set.styles && i < (set.styles.length ?? 0); i++) {
                const it = set.styles[i];
                stylePromises.push(it.startsWith('lazy://') ? (await fetch(it.substring(6))).text() : Promise.resolve(it));
            }
        }
        else if (set.styles) {
            stylePromises.push(Promise.resolve(set.styles));
        }
        // const tempTemplate = config.window.document.createElement('template');
        // tempTemplate.innerHTML = await templatePromise;
        // const tempContainer = config.window.document.createElement('div');
        return {
            template: await templatePromise,
            styles: await Promise.all(stylePromises)
        };
    }
    static createComponentTargetAttribute(name, getThisObj, factory) {
        const targetAttribute = {
            name,
            callBack(element, attrValue, obj, rawSet) {
                const thisObj = getThisObj(element, attrValue, obj, rawSet);
                const data = factory(element, attrValue, obj, rawSet);
                // rawSet.point.thisVariableName = (data as any).__domrender_this_variable_name;
                if (thisObj) {
                    // const i = thisObj.__domrender_component_new = (thisObj.__domrender_component_new ?? new Proxy({}, new DomRenderFinalProxy())) as CreatorMetaData;
                    // i.thisVariableName = rawSet.point.thisVariableName;
                    // i.rawSet = rawSet;
                    // i.innerHTML = element.innerHTML;
                    // i.rootCreator = new Proxy(obj, new DomRenderFinalProxy());
                    // i.creator = new Proxy(rawSet.point.thisVariableName ? ScriptUtils.evalReturn(rawSet.point.thisVariableName, obj) : obj, new DomRenderFinalProxy());
                }
                return data;
            }
        };
        return targetAttribute;
    }
    static createComponentTargetElement({ name, objFactory, template = '', styles = [], noStrip }) {
        const targetElement = {
            name,
            styles,
            template,
            noStrip,
            async callBack(element, obj, rawSet, attrs, config) {
                const templateStyle = await RawSet.fetchTemplateStyle({ template: this.template, styles: this.styles });
                this.template = templateStyle.template;
                this.styles = templateStyle.styles;
                obj[_index__WEBPACK_IMPORTED_MODULE_35__.DomRenderComponentMetaKey.DOMRENDER_COMPONENTS_KEY] ??= {};
                const domrenderComponents = obj[_index__WEBPACK_IMPORTED_MODULE_35__.DomRenderComponentMetaKey.DOMRENDER_COMPONENTS_KEY];
                // debugger;
                const renderScript = ` /*createComponentTargetElement*/
            var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.RAWSET_VARNAME} = this.__render.rawSet; 
            var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.COMPONENT_VARNAME} = this.__render.component; 
            var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.ELEMENT_VARNAME} = this.__render.element; 
            var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.ROUTER_VARNAME} = this.__render.router; 
            var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.INNER_HTML_VARNAME} = this.__render.innerHTML; 
            var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.ATTRIBUTE_VARNAME} = this.__render.attribute; 
            var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.PARENT_THIS_PATH_VARNAME} = this.__render.parentThisPath; 
            var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.PARENT_THIS_VARNAME} = this.__render.parentThis; 
            var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.NEAR_THIS_PATH_VARNAME} = this.__render.nearThisPath; 
            var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.NEAR_THIS_VARNAME} = this.__render.nearThis; 
            var ${_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.CREATOR_META_DATA_VARNAME} = this.__render.creatorMetaData;
        `;
                const parentThisPath = rawSet.findParentThisPath();
                const parentThis = rawSet.findParentThis(obj);
                const nearThisPath = rawSet.findNearThisPath();
                const nearThis = rawSet.findNearThis(obj);
                let render = {
                    renderScript,
                    element: element,
                    innerHTML: element.innerHTML,
                    // attribute: attribute,
                    getElement: () => config.window.document.querySelector(`[class*="${rawSet.uuid}"]`),
                    rawSet: rawSet,
                    router: config.router,
                    componentKey: rawSet.uuid,
                    nearThisPath: nearThisPath,
                    nearThis: nearThis,
                    parentThisPath: parentThisPath,
                    parentThis: parentThis,
                    scripts: _events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.setBindProperty(config.scripts ?? {}, obj)
                };
                const constructor = element.getAttribute(RawSet.DR_ON_CONSTRUCTOR_ARGUMENTS_OPTIONNAME);
                let constructorParam = [];
                // script    
                render.attribute = RawSet.getAttributeObject(element, { script: renderScript, obj: obj, renderData: render });
                render = Object.freeze(render);
                //
                // // dr-constructor
                if (constructor) {
                    let param = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Script.evaluateReturn({ bodyScript: renderScript, returnScript: _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Path.toOptionalChainPath(constructor) }, Object.assign(obj, { __render: render })) ?? [];
                    if (!Array.isArray(param)) {
                        param = [param];
                    }
                    constructorParam = param;
                }
                // // console.log('------22', attrs);
                const instance = (domrenderComponents[rawSet.uuid] = objFactory(element, obj, rawSet, constructorParam));
                render = {
                    currentThis: instance,
                    // creatorMetaData: i,
                    ...render
                };
                rawSet.dataSet.render = render;
                //   destroy .
                instance.__rawSet = rawSet;
                let applayTemplate = element.innerHTML;
                let applayTemplateText = element.textContent?.trim() ?? '';
                let applayTemplateEscape = _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_34__.ConvertUtils.escapeHTML(element.innerHTML);
                let innerHTMLThisRandom;
                const componentName = element.getAttribute(RawSet.DR_VARIABLE_NAME_OPTIONNAME) ?? 'component';
                const innerHTMLName = element.getAttribute(RawSet.DR_INNER_HTML_NAME_OPTIONNAME) ?? 'innerHTML';
                const innerTEXTName = element.getAttribute(RawSet.DR_INNER_TEXT_NAME_OPTIONNAME) ?? 'innerTEXT';
                const innerHTMLEscapedName = element.getAttribute(RawSet.DR_INNER_HTML_ESCAPED_NAME_OPTIONNAME) ?? 'innerHTMLEscaped';
                // if (element.getAttribute(RawSet.DR_COMPONENT_VARIABLE_NAME_OPTIONNAME)) {
                //   console.log('vvvvvvv', element.getAttribute(RawSet.DR_COMPONENT_VARIABLE_NAME_OPTIONNAME));
                // }
                if (applayTemplate) {
                    // if (rawSet.point.thisVariableName) {
                    //  innerHTML this    .
                    innerHTMLThisRandom = _dooboostore_core_random_RandomUtils__WEBPACK_IMPORTED_MODULE_0__.RandomUtils.uuid();
                    applayTemplate = _dooboostore_core_string_StringUtils__WEBPACK_IMPORTED_MODULE_1__.StringUtils.replaceSequentially(applayTemplate, [
                        {
                            regex: /this\./g,
                            callback: () => innerHTMLThisRandom
                        },
                        {
                            regex: new RegExp(`#${componentName}#`, 'g'),
                            callback: () => nearThisPath
                        }
                    ]);
                    // }
                    // applayTemplate = applayTemplate.replace(RegExp(`#${componentName}#`, 'g'), 'this');
                }
                // applayTemplate = template.replace(RegExp(`#${innerHTMLName}#`, 'g'), applayTemplate);
                // RawSet.replaceInnerHTML(
                // applayTemplate = StringUtils.regexExecArrayReplace(this.template, RegExp(`#${innerHTMLName}#`, 'g'), applayTemplate)
                // applayTemplate = StringUtils.regexExecArrayReplace(this.template, [RegExp(`#${innerHTMLName}#`, 'g')], applayTemplate)
                applayTemplate = _dooboostore_core_string_StringUtils__WEBPACK_IMPORTED_MODULE_1__.StringUtils.replaceSequentially((this.template ?? ''), [
                    {
                        regex: new RegExp(`#${innerHTMLName}#`, 'g'),
                        callback: () => applayTemplate
                    },
                    {
                        regex: new RegExp(`#${innerTEXTName}#`, 'g'),
                        callback: () => applayTemplateText
                    },
                    {
                        regex: new RegExp(`#${innerHTMLEscapedName}#`, 'g'),
                        callback: () => applayTemplateEscape
                    }
                ]);
                // dr-on-component-init
                // const oninit = element.getAttribute(`${EventManager.attrPrefix}on-component-init`); // dr-on-component-init
                // const oninit = element.getAttribute(RawSet.DR_ON_CREATED_CALLBACK_OPTIONNAME); // dr-on-component-init
                // if (oninit) {
                //   const script = `${renderScript}  ${oninit} `;
                //   ObjectUtils.Script.eval(script, Object.assign(obj, {
                //     __render: render
                //   }));
                // }
                const style = RawSet.generateStyleTransform(this.styles, rawSet.uuid, true);
                element.innerHTML = style + (applayTemplate ?? '');
                //  targetElement  .
                // console.log('---createComponentTargetElement', element);
                let data = await RawSet.drThisCreate(rawSet, element, `this.${_index__WEBPACK_IMPORTED_MODULE_35__.DomRenderComponentMetaKey.DOMRENDER_COMPONENTS_KEY}.${rawSet.uuid}`, '', !noStrip, obj, config);
                // const tempDiv = document.createElement("div");
                // tempDiv.appendChild(data.cloneNode(true)); //  
                // console.log('-------------ddddddddddddd', element.innerHTML, tempDiv.innerHTML);
                // let data = await RawSet.drThisCreate(rawSet, element, `this.__domrender_components.${componentKey}`, '', false, obj, config);
                //  innerHTML this     .  this  
                // console.log('!!!!!@', (data && innerHTMLThisRandom) ,innerHTMLThisRandom);
                if (data && innerHTMLThisRandom) {
                    const template = config.window.document.createElement('template');
                    // console.log('------->', template.content);
                    //   linkedom  .  innerhtml 
                    // template.content.append(data);
                    // console.log('-------', template.innerHTML);
                    // const d = config.window.document.createElement('div')
                    // d.innerHTML='<a></a>'
                    // console.log('-----XX', ElementUtils.toInnerHTML(data, {document: config.window.document}));
                    // template.innerHTML = template.innerHTML.replace(RegExp(innerHTMLThisRandom, 'g'), 'this.');
                    let s = _dooboostore_core_web_element_ElementUtils__WEBPACK_IMPORTED_MODULE_4__.ElementUtils.toInnerHTML(data, { document: config.window.document });
                    template.innerHTML = s.replace(RegExp(innerHTMLThisRandom, 'g'), 'this.');
                    ;
                    // console.log('ccc?', template.innerHTML);
                    // template.innerHTML = '<div>zzzzzzz</div>'
                    data = template.content;
                }
                // (data as any).render = render;
                return data;
            }
            // complete
        };
        return targetElement;
    }
    static isExpression(data) {
        // const reg = /(?:[$#]\{(?:(([$#]\{)??[^$#]?[^{]*?)\}[$#]))/g;
        const reg = /[$#]\{([\s\S.]*?)\}[$#]/g;
        return reg.test(data ?? '');
    }
    static expressionGroups(data) {
        // const reg = /(?:[$#]\{(?:(([$#]\{)??[^$#]*?)\}[$#]))/g;
        // const reg = /(?:[$#]\{(?:(([$#]\{)??[^$#]?[^{]*?)\}[$#]))/g;
        const reg = /[$#]\{([\s\S.]*?)\}[$#]/g;
        return _dooboostore_core_string_StringUtils__WEBPACK_IMPORTED_MODULE_1__.StringUtils.regexExec(reg, data ?? '');
    }
    static destroy(obj, parameter, config, destroyOptions = []) {
        // console.log('destroy destroydestroydestroydestroy', obj, parameter, config, destroyOptions);
        if (!destroyOptions.some(it => it === _DestroyOptionType__WEBPACK_IMPORTED_MODULE_20__.DestroyOptionType.NO_DESTROY)) {
            if (!destroyOptions.some(it => it === _DestroyOptionType__WEBPACK_IMPORTED_MODULE_20__.DestroyOptionType.NO_MESSENGER_DESTROY)) {
                if (config.messenger && obj) {
                    config.messenger.deleteChannelFromObj(obj);
                }
            }
            if (obj && obj.onDestroy === 'function') {
                obj.onDestroy();
            }
            // console.log('------------destroy', obj);
            if ((0,_lifecycle_OnDestroyRender__WEBPACK_IMPORTED_MODULE_30__.isOnDestroyRender)(obj)) {
                obj.onDestroyRender?.(parameter);
            }
        }
    }
    findNearThis = (obj, rawSet = this) => {
        const path = this.findNearThisPath(rawSet);
        if (path) {
            const optionalPath = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Path.toOptionalChainPath(path);
            // console.log('ppppp-', path, optionalPath)
            return _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Script.evaluateReturn(optionalPath, obj);
        }
    };
    findParentThis = (obj, rawSet = this) => {
        const path = this.findParentThisPath(rawSet);
        if (path) {
            const optionalPath = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Path.toOptionalChainPath(path);
            return _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Script.evaluateReturn(optionalPath, obj);
        }
    };
    findNearThisPath = (rawSet = this) => {
        const paths = this.findThisPaths(rawSet);
        return paths[paths.length - 1];
    };
    findParentThisPath = (rawSet = this) => {
        const paths = this.findThisPaths(rawSet);
        return paths[paths.length - 2];
    };
    findThisPaths = (rawSet = this) => {
        const paths = [];
        const findPath = (rawSet) => {
            if (rawSet && rawSet.point) {
                // jsDom instranceof HTMLMetaElement ? ?
                if (rawSet.point?.start &&
                    'getAttribute' in rawSet.point.start &&
                    rawSet.point.start.getAttribute('this-path')) {
                    paths.push(rawSet.point.start.getAttribute('this-path'));
                }
                if (rawSet.point.parentRawSet)
                    findPath(rawSet.point.parentRawSet);
            }
        };
        findPath(rawSet);
        paths.push('this');
        return paths.reverse();
    };
    static getAttributeObject(element, config) {
        if (!element) {
            return undefined;
        }
        const attribute = _dooboostore_core_web_element_ElementUtils__WEBPACK_IMPORTED_MODULE_4__.ElementUtils.getAttributeToObject(element);
        const normalAttribute = attribute[_events_EventManager__WEBPACK_IMPORTED_MODULE_2__.EventManager.normalAttrMapAttrName];
        if (normalAttribute) {
            new Map(JSON.parse(normalAttribute)).forEach((v, k) => {
                const variablePaths = v.variablePaths;
                let targetScript = v.originalAttrValue.trim();
                //!! expression              .
                if (v.isStringTemplate) {
                    variablePaths.forEach(it => {
                        let r = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Path.toOptionalChainPath(it.inner);
                        targetScript = targetScript.replaceAll(it.origin, `\${${r}}`);
                    });
                }
                else {
                    let r = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Path.toOptionalChainPath(variablePaths[0].inner);
                    targetScript = targetScript.replaceAll(variablePaths[0].origin, r);
                }
                const cval = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_32__.ObjectUtils.Script.evaluateReturn({ bodyScript: config.script, returnScript: v.isStringTemplate ? '`' + targetScript + '`' : targetScript }, Object.assign(config.obj, config.renderData ? { __render: config.renderData } : undefined));
                attribute[k] = cval;
            });
        }
        // console.log('attribute', attribute);
        return attribute;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/rawsets/RawSetOperatorType.ts":
/*!********************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/rawsets/RawSetOperatorType.ts ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   RawSetOperatorType: () => (/* binding */ RawSetOperatorType)
/* harmony export */ });
var RawSetOperatorType;
(function (RawSetOperatorType) {
    RawSetOperatorType["DR_THIS_PROPERTY"] = "this-property";
})(RawSetOperatorType || (RawSetOperatorType = {}));


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/rawsets/RawSetType.ts":
/*!************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/rawsets/RawSetType.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   RawSetType: () => (/* binding */ RawSetType)
/* harmony export */ });
var RawSetType;
(function (RawSetType) {
    RawSetType["TEXT"] = "TEXT";
    RawSetType["STYLE_TEXT"] = "STYLE_TEXT";
    RawSetType["TARGET_ELEMENT"] = "TARGET_ELEMENT";
    RawSetType["TARGET_ATTR"] = "TARGET_ATTR";
    RawSetType["UNKOWN"] = "UNKOWN";
})(RawSetType || (RawSetType = {}));


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/rawsets/Render.ts":
/*!********************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/rawsets/Render.ts ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);



/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/rawsets/index.ts":
/*!*******************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/rawsets/index.ts ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DestroyOptionType: () => (/* reexport safe */ _DestroyOptionType__WEBPACK_IMPORTED_MODULE_3__.DestroyOptionType),
/* harmony export */   DomRenderComponentMetaKey: () => (/* binding */ DomRenderComponentMetaKey),
/* harmony export */   DomRenderProxyMetaKey: () => (/* binding */ DomRenderProxyMetaKey),
/* harmony export */   RawSet: () => (/* reexport safe */ _RawSet__WEBPACK_IMPORTED_MODULE_5__.RawSet),
/* harmony export */   RawSetOperatorType: () => (/* reexport safe */ _RawSetOperatorType__WEBPACK_IMPORTED_MODULE_6__.RawSetOperatorType),
/* harmony export */   RawSetType: () => (/* reexport safe */ _RawSetType__WEBPACK_IMPORTED_MODULE_7__.RawSetType)
/* harmony export */ });
/* harmony import */ var _AttrInitCallBack__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AttrInitCallBack */ "../../packages/@dooboostore/dom-render/src/rawsets/AttrInitCallBack.ts");
/* harmony import */ var _Attrs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Attrs */ "../../packages/@dooboostore/dom-render/src/rawsets/Attrs.ts");
/* harmony import */ var _CreatorMetaData__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./CreatorMetaData */ "../../packages/@dooboostore/dom-render/src/rawsets/CreatorMetaData.ts");
/* harmony import */ var _DestroyOptionType__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./DestroyOptionType */ "../../packages/@dooboostore/dom-render/src/rawsets/DestroyOptionType.ts");
/* harmony import */ var _ElementInitCallBack__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./ElementInitCallBack */ "../../packages/@dooboostore/dom-render/src/rawsets/ElementInitCallBack.ts");
/* harmony import */ var _RawSet__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _RawSetOperatorType__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./RawSetOperatorType */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSetOperatorType.ts");
/* harmony import */ var _RawSetType__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./RawSetType */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSetType.ts");
/* harmony import */ var _Render__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./Render */ "../../packages/@dooboostore/dom-render/src/rawsets/Render.ts");









var DomRenderComponentMetaKey;
(function (DomRenderComponentMetaKey) {
    DomRenderComponentMetaKey["DOMRENDER_COMPONENTS_KEY"] = "__domrender_components";
})(DomRenderComponentMetaKey || (DomRenderComponentMetaKey = {}));
var DomRenderProxyMetaKey;
(function (DomRenderProxyMetaKey) {
    DomRenderProxyMetaKey["onBeforeReturnGet"] = "onBeforeReturnGet";
    DomRenderProxyMetaKey["onBeforeReturnSet"] = "onBeforeReturnSet";
    DomRenderProxyMetaKey["__render"] = "__render";
    DomRenderProxyMetaKey["_rawSets"] = "_rawSets";
    DomRenderProxyMetaKey["_targets"] = "_targets";
    DomRenderProxyMetaKey["_domRender_proxy"] = "_domRender_proxy";
    DomRenderProxyMetaKey["_DomRender_isProxy"] = "_DomRender_isProxy";
    DomRenderProxyMetaKey["_DomRender_isFinal"] = "_DomRender_isFinal";
    DomRenderProxyMetaKey["_DomRender_ref"] = "_DomRender_ref";
    DomRenderProxyMetaKey["_domRender_ref"] = "_domRender_ref";
    DomRenderProxyMetaKey["_DomRender_origin"] = "_DomRender_origin";
    DomRenderProxyMetaKey["_domRender_origin"] = "_domRender_origin";
    DomRenderProxyMetaKey["_DomRender_config"] = "_DomRender_config";
    DomRenderProxyMetaKey["_domRender_config"] = "_domRender_config";
    DomRenderProxyMetaKey["_DomRender_proxy"] = "_DomRender_proxy";
})(DomRenderProxyMetaKey || (DomRenderProxyMetaKey = {}));


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/routers/HashRouter.ts":
/*!************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/routers/HashRouter.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   HashRouter: () => (/* binding */ HashRouter)
/* harmony export */ });
/* harmony import */ var _Router__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Router */ "../../packages/@dooboostore/dom-render/src/routers/Router.ts");
/* harmony import */ var _dooboostore_core_web_location_LocationUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/core-web/location/LocationUtils */ "../../packages/@dooboostore/core-web/src/location/LocationUtils.ts");


class HashRouter extends _Router__WEBPACK_IMPORTED_MODULE_0__.Router {
    constructor(config) {
        super(config);
    }
    getSearchParams(data) {
        const hashSearch = _dooboostore_core_web_location_LocationUtils__WEBPACK_IMPORTED_MODULE_1__.LocationUtils.hashSearch(this.config.window);
        const searchParams = hashSearch ? new URLSearchParams(hashSearch) : (new URL(this.config.window.document.location.href)).searchParams;
        data?.delete?.forEach(it => {
            searchParams.delete(it);
        });
        data?.append?.forEach(it => {
            searchParams.append(it[0], it[1]);
        });
        return searchParams;
    }
    push(path, data, title = '') {
        if (path === '/') {
            return super.pushState(data, title, '/');
        }
        else {
            return super.pushState(data, title, `#${this.toUrl(path)}`);
        }
    }
    replace(path, data, title) {
        if (path === '/') {
            return super.replaceState(data, title, '/');
        }
        else {
            return super.replaceState(data, title, `#${this.toUrl(path)}`);
        }
    }
    setDeleteHashSearchParam(name, data, title) {
    }
    pushDeleteHashSearchParam(name, data, title) {
        const s = this.getHashSearchParams({ delete: Array.isArray(name) ? name : [name] });
        const size = Array.from(s.entries()).length;
        const href = `${this.config.window.location.pathname}${this.config.window.location.search}${size > 0 ? '#' + s.toString() : ''}`;
        super.pushState(data, title, href);
    }
    pushDeleteSearchParam(name, data, title) {
        const s = this.getSearchParams({ delete: Array.isArray(name) ? name : [name] });
        this.push({ searchParams: s }, data, title);
    }
    pushAddSearchParam(params, data, title) {
        const s = this.getSearchParams({ append: params });
        this.push({ searchParams: s }, data, title);
    }
    replaceDeleteHashSearchParam(name, data, title) {
        const s = this.getHashSearchParams({ delete: Array.isArray(name) ? name : [name] });
        const size = Array.from(s.entries()).length;
        const href = `${this.config.window.location.pathname}${this.config.window.location.search}${size > 0 ? '#' + s.toString() : ''}`;
        super.pushState(data, title, href);
    }
    replaceDeleteSearchParam(name, data, title) {
        const s = this.getSearchParams({ delete: Array.isArray(name) ? name : [name] });
        this.push({ searchParams: s }, data, title);
    }
    replaceAddSearchParam(params, data, title) {
        const s = this.getSearchParams({ append: params });
        this.push({ searchParams: s }, data, title);
    }
    getUrl() {
        return _dooboostore_core_web_location_LocationUtils__WEBPACK_IMPORTED_MODULE_1__.LocationUtils.hash(this.config.window) || '/';
    }
    getHref() {
        return this.config.window.location.href;
    }
    getPathName() {
        return _dooboostore_core_web_location_LocationUtils__WEBPACK_IMPORTED_MODULE_1__.LocationUtils.hashPath(this.config.window) || '/';
    }
    getSearch() {
        return _dooboostore_core_web_location_LocationUtils__WEBPACK_IMPORTED_MODULE_1__.LocationUtils.hashSearch(this.config.window);
    }
    getHashSearchParams(data) {
        const hash = this.config.window.location.hash;
        const queryIndex = hash.indexOf('?');
        const searchParams = (queryIndex !== -1) ? new URLSearchParams(hash.slice(queryIndex + 1)) : new URLSearchParams();
        ;
        data?.delete?.forEach(it => {
            searchParams.delete(it);
        });
        data?.append?.forEach(it => {
            searchParams.append(it[0], it[1]);
        });
        return searchParams;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/routers/PathRouter.ts":
/*!************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/routers/PathRouter.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   PathRouter: () => (/* binding */ PathRouter)
/* harmony export */ });
/* harmony import */ var _Router__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Router */ "../../packages/@dooboostore/dom-render/src/routers/Router.ts");

class PathRouter extends _Router__WEBPACK_IMPORTED_MODULE_0__.Router {
    constructor(config) {
        super(config);
    }
    getSearchParams(data) {
        if (!this.config.window.document?.location?.href) {
            return new URLSearchParams();
        }
        const searchParams = (new URL(this.config.window.document.location?.href)).searchParams;
        data?.delete?.forEach(it => {
            searchParams.delete(it);
        });
        data?.append?.forEach(it => {
            searchParams.append(it[0], it[1]);
        });
        return searchParams;
    }
    push(path, data, title = '') {
        return super.pushState(data, title, this.toUrl(path));
    }
    replace(path, data, title = '') {
        return super.replaceState(data, title, this.toUrl(path));
    }
    pushDeleteSearchParam(name, data, title) {
        const s = this.getSearchParams({ delete: [name] });
        this.push({ searchParams: s }, data, title);
    }
    pushDeleteHashSearchParam(name, data, title) {
        const s = this.getHashSearchParams({ delete: [name] });
        const size = Array.from(s.entries()).length;
        const href = `${this.config.window.location?.pathname ?? '/'}${this.config.window.location?.search}${size > 0 ? '#' + s.toString() : ''}`;
        super.pushState(data, title, href);
    }
    pushAddSearchParam(params, data, title) {
        const s = this.getSearchParams({ append: params });
        this.push({ searchParams: s }, data, title);
    }
    replaceDeleteSearchParam(name, data, title) {
        const s = this.getSearchParams({ delete: Array.isArray(name) ? name : [name] });
        this.replace({ searchParams: s }, data, title);
    }
    replaceDeleteHashSearchParam(name, data, title) {
        const s = this.getHashSearchParams({ delete: Array.isArray(name) ? name : [name] });
        const size = Array.from(s.entries()).length;
        const href = `${this.config.window.location?.pathname ?? '/'}${this.config.window.location?.search}${size > 0 ? '#' + s.toString() : ''}`;
        super.replaceState(data, title, href);
    }
    replaceAddSearchParam(params, data, title) {
        const s = this.getSearchParams({ append: params });
        this.replace({ searchParams: s }, data, title);
    }
    getUrl() {
        if (!this.config.window.document?.location?.href) {
            //if ((!this.config.window.document?.location?.href) || (this.config.window.document?.location?.href === 'about:blank')) {
            return '/';
        }
        const url = new URL(this.config.window.document.location?.href);
        return url.pathname + url.search;
    }
    getHref() {
        return this.config.window.location?.href ?? '/';
    }
    getPathName() {
        return this.config.window.location?.pathname ?? '/';
    }
    getSearch() {
        return this.config.window.location?.search ?? '';
    }
    getHashSearchParams(data) {
        // http://local.com/#wow=222&wow=bb&z=2
        const searchParams = new URLSearchParams(this.config.window.location?.hash.slice(1) ?? '');
        data?.delete?.forEach(it => {
            searchParams.delete(it);
        });
        data?.append?.forEach(it => {
            searchParams.append(it[0], it[1]);
        });
        return searchParams;
        // return undefined;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/routers/Router.ts":
/*!********************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/routers/Router.ts ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Router: () => (/* binding */ Router)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/convert/ConvertUtils */ "../../packages/@dooboostore/core/src/convert/ConvertUtils.ts");
/* harmony import */ var _dooboostore_core_message_BehaviorSubject__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/core/message/BehaviorSubject */ "../../packages/@dooboostore/core/src/message/BehaviorSubject.ts");
/* harmony import */ var _dooboostore_core_expression_Expression__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/core/expression/Expression */ "../../packages/@dooboostore/core/src/expression/Expression.ts");
/* harmony import */ var _dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/core/valid/ValidUtils */ "../../packages/@dooboostore/core/src/valid/ValidUtils.ts");




class Router {
    behaviorSubject;
    _config;
    constructor(config) {
        this._config = config;
        let routeData;
        if (config?.firstUrl) {
            const path = config.firstUrl.split('?');
            const urlSearchParams = new URLSearchParams(path[1] ?? '');
            routeData = {
                url: config.firstUrl,
                path: path[0],
                searchParams: urlSearchParams,
                router: this,
                search: urlSearchParams.size > 0 ? `?${urlSearchParams.toString()}` : '',
                triggerPoint: 'end'
            };
            this.behaviorSubject = new _dooboostore_core_message_BehaviorSubject__WEBPACK_IMPORTED_MODULE_1__.BehaviorSubject(routeData);
            this.go(config.firstUrl);
        }
        else {
            routeData = { ...this.getRouteData(), triggerPoint: 'end' };
            this.behaviorSubject = new _dooboostore_core_message_BehaviorSubject__WEBPACK_IMPORTED_MODULE_1__.BehaviorSubject(routeData);
        }
        this.config.window.addEventListener('popstate', (event) => {
            // domrender    back, previous   
            // if(!isPopStateCurrentTargetDomrenderRouter(event.state)) {
            // console.log('-------');
            const routeData = { ...this.getRouteData(), triggerPoint: 'end' };
            this.behaviorSubject.next(routeData);
            // }
        });
    }
    get observable() {
        return this.behaviorSubject.asObservable();
    }
    get searchParamObject() {
        return _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_0__.ConvertUtils.toObject(this.getSearchParams());
    }
    get config() {
        return this._config;
    }
    getSearchFirstParamsObject(defaultValue) {
        const a = _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_0__.ConvertUtils.toObject(this.getSearchParams(), { firstValue: true });
        return Object.assign({}, defaultValue, a);
    }
    getHashSearchFirstParamsObject() {
        return _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_0__.ConvertUtils.toObject(this.getHashSearchParams(), { firstValue: true });
    }
    // async attach(): Promise<void> {
    //   // const proxy = getDomRenderProxy(this.config.rootObject)
    //   // if (proxy) {
    //   //   const key = `___${EventManager.ROUTER_VARNAME}`;
    //   //   await proxy.render(key);
    //   // }
    // }
    testRegexp(regexp) {
        if (regexp) {
            const b = RegExp(regexp).test(this.getPathName());
            return b;
        }
        else {
            return false;
        }
    }
    test(urlExpression) {
        if (urlExpression && this.getPathData(urlExpression)) {
            return true;
        }
        else {
            return false;
        }
    }
    getRouteData(config) {
        let path = this.getPathName();
        let url = this.getUrl();
        let searchParams = this.getSearchParams();
        let search = this.getSearch();
        // console.log('pppppppppppppp', path,url,searchParams,search);
        //  URL   URL 
        if (config?.pathOrUrl) {
            const paths = config.pathOrUrl.split('?');
            search = paths[1] ? `?${paths[1]}` : '';
            searchParams = new URLSearchParams(search);
            const firstUrl = paths[0];
            if (_dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_3__.ValidUtils.isUrl(firstUrl)) {
                path = new URL(firstUrl).pathname;
            }
            else {
                path = firstUrl;
            }
            url = config.pathOrUrl;
            // }
        }
        // console.log('url', url);
        const newVar = {
            path: path,
            url: url,
            searchParams: searchParams,
            //            
            // search: searchParams.size > 0 ? `?${searchParams.toString()}` : '',
            search: search,
            router: this
        };
        const data = this.getData();
        if (data) {
            newVar.data = data;
        }
        if (config?.urlExpression) {
            const data = this.getPathData(config.urlExpression);
            if (data) {
                newVar.pathData = data;
            }
        }
        // newVar.router = this;
        // newVar.currentTarget = config?.currentTarget;
        return Object.freeze(newVar);
    }
    pushState(data, title, path) {
        // data = this.config.changeStateConvertDate?this.config.changeStateConvertDate(data): data;
        // console.log('--->pushState', data);
        this.behaviorSubject.next({ ...this.getRouteData({ pathOrUrl: path }), triggerPoint: 'start' });
        this.config.window.history?.pushState(data, title ?? '', path);
        this.behaviorSubject.next({ ...this.getRouteData({ pathOrUrl: path }), triggerPoint: 'end' });
        return { data };
    }
    replaceState(data, title, path) {
        // data = this.config.changeStateConvertDate?this.config.changeStateConvertDate(data): data;
        // console.log('--->replaceState', data);
        this.behaviorSubject.next({ ...this.getRouteData({ pathOrUrl: path }), triggerPoint: 'start' });
        this.config.window.history?.replaceState(data, title ?? '', path);
        this.behaviorSubject.next({ ...this.getRouteData({ pathOrUrl: path }), triggerPoint: 'end' });
        return { data };
    }
    getData() {
        return this.config.window.history?.state;
    }
    getPathData(urlExpression, currentUrl = this.getPathName()) {
        return _dooboostore_core_expression_Expression__WEBPACK_IMPORTED_MODULE_2__.Expression.Path.pathNameData(currentUrl, urlExpression);
    }
    back() {
        this.behaviorSubject.next({ ...this.getRouteData(), triggerPoint: 'start' });
        this.config.window.history.back();
        //en constructo  this.config.window.addEventListener('popstate'      .
    }
    forward() {
        this.behaviorSubject.next({ ...this.getRouteData(), triggerPoint: 'start' });
        this.config.window.history?.forward();
        //end constructor  this.config.window.addEventListener('popstate'      .
    }
    go(config) {
        // console.log('Router go', config);
        if (typeof config === 'number') {
            this.behaviorSubject.next({ ...this.getRouteData(), triggerPoint: 'start' });
            this.config.window.history?.go(config);
            //end constructor  this.config.window.addEventListener('popstate'      .
            return;
        }
        if (typeof config === 'string') {
            config = { path: config };
        }
        // let data: ChangeStateResult | undefined = undefined;
        if (config?.replace) {
            this.replace(config.path, config.data, config.title);
        }
        else {
            this.push(config.path, config.data, config.title);
        }
        // if (!this.config.disableAttach) {
        //   await this.attach();
        // }
        //   (: true -   )
        if (config.scrollToTop !== false) {
            try {
                this._config.window?.scrollTo?.(0, 0);
            }
            catch (e) {
            }
        }
        // console.log('----------', data, config)
        // if (!config.disabledPopEvent) {
        //   this.dispatchPopStateEvent(config?.data);
        // }
    }
    toUrl(data) {
        // console.log('toUrl', data);
        let targetPath;
        if (typeof data === 'string') {
            targetPath = data;
        }
        else {
            const tpath = data.path ?? this.getPathName();
            const s = data.searchParams ? _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_0__.ConvertUtils.toRawQueryString(data.searchParams, { valueEncodeURIComponent: true }) : '';
            // data.searchParams
            targetPath = `${tpath}${s.length > 0 ? '?' : ''}${s}`;
        }
        return targetPath;
    }
    reload() {
        const currentUrl = this.getUrl();
        this.replace(currentUrl);
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/types/Types.ts":
/*!*****************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/types/Types.ts ***!
  \*****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DomRenderFinalProxy: () => (/* binding */ DomRenderFinalProxy),
/* harmony export */   Shield: () => (/* binding */ Shield)
/* harmony export */ });
class Shield {
}
class DomRenderFinalProxy {
    set(target, p, value, receiver) {
        target[p] = value;
        return true;
    }
    get(target, p, receiver) {
        return target[p];
    }
    static final(obj) {
        obj._DomRender_isFinal = true;
        return obj;
    }
    static isFinal(obj) {
        return '_DomRender_isFinal' in obj;
    }
    static unFinal(obj) {
        delete obj._DomRender_isFinal;
        return obj;
    }
    has(target, p) {
        return p === '_DomRender_isFinal' || p in target;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/validators/NonPassValidator.ts":
/*!*********************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/validators/NonPassValidator.ts ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   NonPassValidator: () => (/* binding */ NonPassValidator)
/* harmony export */ });
/* harmony import */ var _Validator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Validator */ "../../packages/@dooboostore/dom-render/src/validators/Validator.ts");

class NonPassValidator extends _Validator__WEBPACK_IMPORTED_MODULE_0__.Validator {
    constructor(value, target, event, autoValid = true) {
        super(value, target, event, autoValid);
    }
    valid() {
        return false;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/validators/Validator.ts":
/*!**************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/validators/Validator.ts ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Validator: () => (/* binding */ Validator)
/* harmony export */ });
// export interface Valid<T = any, E = Element> {
//     valid(value?: T, target?: E, event?: Event): boolean;
// }
class Validator {
    _value;
    _target;
    _event;
    _autoValid;
    _autoValidAction;
    _validAction;
    constructor(_value, target, event, autoValid = true, autoValidAction = true) {
        this._value = _value;
        this.setTarget(target);
        this.setEvent(event);
        this.setAutoValid(autoValid);
        this.setAutoValidAction(autoValidAction);
    }
    getValidAction() {
        return this._validAction;
    }
    setValidAction(value) {
        this._validAction = value;
        return this;
    }
    getAutoValid() {
        return this._autoValid;
    }
    setAutoValid(autoValid) {
        this._autoValid = autoValid;
        return this;
    }
    getAutoValidAction() {
        return this._autoValidAction;
    }
    setAutoValidAction(autoValid) {
        this._autoValidAction = autoValid;
        return this;
    }
    getEvent() {
        return this._event;
    }
    setEvent(event) {
        if (event) {
            this._event = this.domRenderFinal(event);
        }
        return this;
    }
    getTarget() {
        return this._target;
    }
    targetFocus() {
        this._target?.focus?.();
    }
    targetReset() {
        this._target?.reset?.();
    }
    targetDispatchEvent(event) {
        return this._target?.dispatchEvent(event);
    }
    setTarget(target) {
        if (target) {
            this._target = this.domRenderFinal(target);
        }
        return this;
    }
    domRenderFinal(obj) {
        obj._DomRender_isFinal = true;
        return obj;
    }
    get value() {
        if (this._value === undefined || this._value === null) {
            this._value = this.getTarget()?.value;
        }
        return this._value;
    }
    set value(value) {
        // console.log('---?set?', value, this)
        this._value = value;
        this.tickValue(value);
    }
    tickValue(value) {
        this.changeValue(value);
        const target = this.getTarget();
        if (target && target?.value !== undefined && target?.value !== null) {
            try {
                target.value = this._value;
            }
            catch (e) {
                console.error('set value function is blocked ');
            }
        }
        if (this.getAutoValidAction()) {
            this.validAction();
        }
        else if (this.getAutoValid()) {
            this.valid();
        }
    }
    set(value, target, event) {
        this.setTarget(target);
        this.setEvent(event);
        this.value = value;
    }
    changeValue(value) {
    }
    get checked() {
        return this.getTarget()?.checked ?? false;
    }
    set checked(checked) {
        const target = this.getTarget();
        if (target) {
            target.checked = checked;
        }
    }
    get selectedIndex() {
        return this.getTarget()?.selectedIndex ?? -1;
    }
    set selectedIndex(selectedIndex) {
        const target = this.getTarget();
        if (target) {
            target.selectedIndex = selectedIndex;
        }
    }
    querySelector(selector) {
        return this.getTarget()?.querySelector(selector);
    }
    querySelectorALL(selector) {
        return this.getTarget()?.querySelectorAll(selector);
    }
    validAction() {
        const valid = this.valid();
        this.getValidAction()?.(valid, this.value, this.getTarget(), this.getEvent());
        return valid;
    }
    inValid() {
        return !this.valid();
    }
    ;
    allValid() {
        return this.valid() && this.childInValid();
    }
    allValidAction() {
        return this.validAction() && this.childInValidAction();
    }
    allInValid() {
        return !this.allValid();
    }
    allInValidAction() {
        return !this.allValidAction();
    }
    childValid() {
        return !this.childInValid();
    }
    childValue() {
        const data = {};
        this.childValidators().filter(([k, v]) => {
            data[k] = v.value;
        });
        return data;
    }
    childValidAction() {
        return !this.childInValidAction();
    }
    childInValid() {
        const inValid = this.childValidators().filter(([k, v]) => !v.valid());
        return inValid.length > 0;
    }
    childInValidValidator() {
        const inValid = this.childValidators().filter(([k, v]) => !v.valid());
        return inValid;
    }
    childInValidAction() {
        const inValid = this.childValidators().filter(([k, v]) => !v.validAction());
        return inValid.length > 0;
    }
    childValidator(name) {
        return Object.entries(this).find(([k, v]) => (k === name && (v instanceof Validator)))?.[1];
    }
    childValidators() {
        return Object.entries(this).filter(([k, v]) => (v instanceof Validator));
    }
    childValidValidator() {
        return this.childValidators().filter(it => it[1].valid());
    }
    syncValue() {
        this.value = this.getTarget()?.value;
    }
    allSyncValue() {
        this.childValidators().forEach(([k, e]) => {
            e.syncValue();
        });
    }
    get length() {
        return this.value?.length ?? 0;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/dom-render/src/validators/ValidatorArray.ts":
/*!*******************************************************************************!*\
  !*** ../../packages/@dooboostore/dom-render/src/validators/ValidatorArray.ts ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ValidatorArray: () => (/* binding */ ValidatorArray)
/* harmony export */ });
/* harmony import */ var _Validator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Validator */ "../../packages/@dooboostore/dom-render/src/validators/Validator.ts");
/* harmony import */ var _NonPassValidator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./NonPassValidator */ "../../packages/@dooboostore/dom-render/src/validators/NonPassValidator.ts");


class ValidatorArray extends _Validator__WEBPACK_IMPORTED_MODULE_0__.Validator {
    _makeValidatorFactory = (value, target, event) => {
        return new _NonPassValidator__WEBPACK_IMPORTED_MODULE_1__.NonPassValidator(value, target, event);
    };
    constructor(value, target, event, autoValid = true) {
        super(value, target, event, autoValid);
    }
    getMakeValidatorFactory() {
        return this._makeValidatorFactory;
    }
    setMakeValidatorFactory(value) {
        this._makeValidatorFactory = value;
        return this;
    }
    setArrayValue(target, value, event) {
        this.value?.filter(it => {
            if (it.getTarget()) {
                return it.getTarget() === target;
            }
            else {
                return false;
            }
        }).forEach(it => {
            it.set(value, target, event);
        });
        this.tickValue(this.value);
    }
    addValidator(value, target, event) {
        if (!this.value) {
            this.value = [];
        }
        if (value instanceof _Validator__WEBPACK_IMPORTED_MODULE_0__.Validator) {
            this.value?.push(value);
        }
        else {
            this.value?.push(this.makeValidator(value, target, event));
        }
        this.tickValue(this.value);
    }
    allChecked(checked) {
        this.checked = checked;
        this.value?.forEach(it => {
            it.checked = checked;
        });
    }
    getValidators() {
        return this._value;
    }
    getValidator(e) {
        return this.value?.filter(it => it.getTarget() === e)[0];
    }
    getValidatorByValue(value) {
        const validatorByValue = this.getValidatorByValues(value)[0];
        return validatorByValue;
    }
    getValidatorByValues(value) {
        return this.value?.filter(it => it.value === value) ?? [];
    }
    removeElement(e) {
        const value = this.value;
        if (value) {
            this.value = value.filter(it => it.getTarget() !== e);
        }
    }
    makeValidator(value, target, event) {
        return this._makeValidatorFactory(value, target, event);
    }
    ;
}


/***/ }),

/***/ "../../packages/@dooboostore/lib-web/src/canvas/chart/OverlayStockChart.ts":
/*!*********************************************************************************!*\
  !*** ../../packages/@dooboostore/lib-web/src/canvas/chart/OverlayStockChart.ts ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   OverlayStockChart: () => (/* binding */ OverlayStockChart),
/* harmony export */   isChartKeyData: () => (/* binding */ isChartKeyData),
/* harmony export */   isMultiPointEvent: () => (/* binding */ isMultiPointEvent),
/* harmony export */   isPointEvent: () => (/* binding */ isPointEvent),
/* harmony export */   isRangeEvent: () => (/* binding */ isRangeEvent),
/* harmony export */   isXPointEvent: () => (/* binding */ isXPointEvent),
/* harmony export */   isXRangeEvent: () => (/* binding */ isXRangeEvent),
/* harmony export */   isXYPointEvent: () => (/* binding */ isXYPointEvent),
/* harmony export */   isXYRangeEvent: () => (/* binding */ isXYRangeEvent),
/* harmony export */   isYPointEvent: () => (/* binding */ isYPointEvent),
/* harmony export */   isYRangeEvent: () => (/* binding */ isYRangeEvent)
/* harmony export */ });
//   
const isChartKeyData = (data) => 'datas' in data && Array.isArray(data.datas);
const isXPointEvent = (event) => 'x' in event && !('y' in event) && !('startX' in event) && !('startY' in event);
const isYPointEvent = (event) => 'y' in event && !('x' in event) && !('startX' in event) && !('startY' in event);
const isXYPointEvent = (event) => 'x' in event && 'y' in event && !('startX' in event) && !('startY' in event) && !('points' in event);
const isXRangeEvent = (event) => 'startX' in event && 'endX' in event && !('startY' in event) && !('endY' in event) && !('points' in event);
const isYRangeEvent = (event) => 'startY' in event && 'endY' in event && !('startX' in event) && !('endX' in event) && !('points' in event);
const isXYRangeEvent = (event) => 'startX' in event && 'endX' in event && 'startY' in event && 'endY' in event && !('points' in event);
const isRangeEvent = (event) => isXRangeEvent(event) || isYRangeEvent(event) || isXYRangeEvent(event);
const isMultiPointEvent = (event) => 'points' in event && Array.isArray(event.points);
const isPointEvent = (event) => !isRangeEvent(event) && !isMultiPointEvent(event);
class OverlayStockChart {
    ctx;
    canvas;
    width;
    height;
    padding = 50; // , config  
    paddingLeft = 50;
    paddingRight = 50;
    paddingTop = 50;
    paddingBottom = 50;
    chartAreaWidth = 0; //      
    chartAreaLeft = 50; //    X 
    //    
    lightColors = [
        '#0000FF', // Blue
        '#FF0000', // Red
        '#00AA00', // Green
        '#FF00FF', // Magenta
        '#FF8C00', // Dark Orange
        '#8B00FF', // Violet
        '#00CED1', // Dark Turquoise
        '#FF1493', // Deep Pink
        '#32CD32', // Lime Green
        '#FFD700', // Gold
        '#4169E1', // Royal Blue
        '#DC143C', // Crimson
        '#00FA9A', // Medium Spring Green
        '#FF69B4', // Hot Pink
        '#1E90FF', // Dodger Blue
        '#FF4500', // Orange Red
        '#9370DB', // Medium Purple
        '#00BFFF', // Deep Sky Blue
        '#FF6347', // Tomato
        '#48D1CC' // Medium Turquoise
    ];
    //     (   )
    darkColors = [
        '#5C9EFF', // Bright Blue
        '#FF5C5C', // Bright Red
        '#5CFF5C', // Bright Green
        '#FF5CFF', // Bright Magenta
        '#FFB85C', // Bright Orange
        '#B85CFF', // Bright Violet
        '#5CFFFF', // Bright Cyan
        '#FF5CB8', // Bright Pink
        '#B8FF5C', // Bright Lime
        '#FFE55C', // Bright Yellow
        '#5CB8FF', // Sky Blue
        '#FF5C85', // Bright Crimson
        '#5CFFB8', // Bright Spring Green
        '#FFB8FF', // Light Pink
        '#5CE5FF', // Light Blue
        '#FF855C', // Bright Coral
        '#B8B8FF', // Light Purple
        '#5CDBFF', // Bright Sky Blue
        '#FF9C5C', // Light Tomato
        '#85FFFF' // Bright Turquoise
    ];
    colors = this.lightColors; // 
    chartMarginTop = 0.05;
    chartMarginBottom = 0.05;
    dataMap;
    originalDataMap; // /   
    //   min/max  (chartKey, symbol)
    globalMinMaxCache = new Map();
    commonEvents;
    tickerColors = new Map();
    config;
    //  
    state;
    mouseX = null;
    mouseY = null;
    canvasWidth = 0;
    canvasHeight = 0;
    legendItems = [];
    dataPoints = [];
    hoveredPoint = null;
    zoomStart = 0;
    zoomEnd = 100;
    isDragging = false;
    dragStartX = null;
    dragCurrentX = null;
    isPanning = false;
    panStartX = null;
    zoomButtons = [];
    sortedTimes = [];
    eventMarkers = [];
    hoveredEventMarker = null;
    eventTooltipsToRender = [];
    //  
    touchStartX = null;
    touchStartY = null;
    lastPinchDistance = null;
    isTouchDragging = false;
    isTouchPanning = false;
    resizeObserver = null;
    //  
    lastTapTime = 0;
    lastTapX = 0;
    lastTapY = 0;
    //   ( )
    averageLineCache = new Map();
    averageLineCacheKey = '';
    //   (PC)
    clickTimer = null;
    clickDelay = 250; // 250ms   
    constructor(canvas, dataMap, options = {}) {
        const { commonEvents = {}, initialState = {}, config = {} } = options;
        this.canvas = canvas;
        this.ctx = canvas.getContext('2d');
        this.width = 0;
        this.height = 0;
        this.dataMap = this.normalizeDataMap(dataMap);
        this.originalDataMap = this.dataMap; //   
        this.commonEvents = this.normalizeCommonEvents(commonEvents);
        // initialState  
        const defaultState = {
            enabledTickers: new Set(),
            visibleTickers: new Set(),
            showEvents: false,
            showCandles: false,
            showGaps: true,
            visibleChartKeys: [],
            lineMode: 'line',
            showAverage: [],
            hideValues: false,
            hideLines: false,
            showGrid: false,
            showPoints: false,
            normalize: 'none',
            rangeMin: undefined, // undefined   
            rangeMax: undefined // undefined   
        };
        this.state = { ...defaultState, ...initialState };
        //      
        const isDarkMode = this.detectDarkMode(config.theme);
        //     
        this.colors = isDarkMode ? this.darkColors : this.lightColors;
        // config   ( )
        //  config  ,    
        this.config = {
            ...config,
            theme: config.theme ?? 'auto',
            backgroundColor: config.backgroundColor ?? (isDarkMode ? '#1E1E1E' : '#FFFFFF'),
            gridStrokeStyle: config.gridStrokeStyle ?? (isDarkMode ? '#444444' : '#CCCCCC'),
            crosshairStrokeStyle: config.crosshairStrokeStyle ?? (isDarkMode ? '#888888' : '#666666')
        };
        // config    min/max  (config.xMin/xMax )
        this.calculateGlobalMinMax();
        // padding  - hide  true  padding   10 
        this.paddingLeft = this.config.hideYAxisLabels ? 10 : (this.config.paddingLeft ?? 50);
        this.paddingRight = this.config.hideYAxisLabels ? 10 : (this.config.paddingRight ?? 50);
        this.paddingTop = this.config.hideLegend ? 10 : (this.config.paddingTop ?? 50);
        this.paddingBottom = this.config.hideXAxisLabels ? 10 : (this.config.paddingBottom ?? 50);
        this.padding = 50; //  padding (  )
        //   paddingLeft  
        this.chartAreaLeft = this.paddingLeft;
        this.chartAreaWidth = 0; // render 
        // visibleChartKeys        
        if (!this.state.visibleChartKeys || this.state.visibleChartKeys.length === 0) {
            const firstTicker = Array.from(dataMap.values())[0];
            if (firstTicker && firstTicker.data) {
                const firstKey = Object.keys(firstTicker.data)[0];
                if (firstKey) {
                    this.state.visibleChartKeys = [firstKey];
                }
            }
        }
        //   
        let colorIndex = 0;
        dataMap.forEach((value, symbol) => {
            const color = value.color || this.colors[colorIndex % this.colors.length];
            this.tickerColors.set(symbol, color);
            colorIndex++;
        });
        this.setupEventListeners();
        this.setupResizeObserver();
    }
    // main.ts     
    normalizeDataMap(inputMap) {
        const normalizedMap = new Map();
        inputMap.forEach((value, symbol) => {
            //      chartKey  
            const data = value.data;
            if (isChartKeyData(data)) {
                //   : ChartKeyData -> { 'default': {...} } 
                normalizedMap.set(symbol, {
                    color: value.color,
                    lineMode: value.lineMode,
                    data: {
                        'default': {
                            datas: data.datas,
                            events: data.events,
                            lineMode: data.lineMode,
                            movingAverageXwidth: data.movingAverageXwidth
                        }
                    }
                });
            }
            else {
                //  chartKey  
                normalizedMap.set(symbol, {
                    color: value.color,
                    lineMode: value.lineMode,
                    data: data
                });
            }
        });
        return normalizedMap;
    }
    //   min/max   
    calculateGlobalMinMax() {
        this.globalMinMaxCache.clear();
        // config.xMin/xMax      
        let filterMinTime = undefined;
        let filterMaxTime = undefined;
        if (this.config.xMin !== undefined) {
            filterMinTime = typeof this.config.xMin === 'function' ? this.config.xMin('default') : this.config.xMin;
        }
        if (this.config.xMax !== undefined) {
            filterMaxTime = typeof this.config.xMax === 'function' ? this.config.xMax('default') : this.config.xMax;
        }
        this.originalDataMap.forEach((value, symbol) => {
            Object.keys(value.data).forEach(chartKey => {
                const chartDataObj = value.data[chartKey];
                if (!chartDataObj)
                    return;
                // config.yMin/yMax  (chartKey   )
                let filterMinY = undefined;
                let filterMaxY = undefined;
                if (this.config.yMin !== undefined) {
                    filterMinY = typeof this.config.yMin === 'function' ? this.config.yMin(chartKey) : this.config.yMin;
                }
                if (this.config.yMax !== undefined) {
                    filterMaxY = typeof this.config.yMax === 'function' ? this.config.yMax(chartKey) : this.config.yMax;
                }
                // xMin/xMax  
                let filteredDatas = chartDataObj.datas;
                if (filterMinTime !== undefined || filterMaxTime !== undefined) {
                    filteredDatas = chartDataObj.datas.filter(d => {
                        if (filterMinTime !== undefined && d.x < filterMinTime)
                            return false;
                        if (filterMaxTime !== undefined && d.x > filterMaxTime)
                            return false;
                        return true;
                    });
                }
                // yMin/yMax   (  )
                if (filterMinY !== undefined || filterMaxY !== undefined) {
                    filteredDatas = filteredDatas.filter(d => {
                        if (d.y === null || d.y === undefined)
                            return false;
                        if (filterMinY !== undefined && d.y < filterMinY)
                            return false;
                        if (filterMaxY !== undefined && d.y > filterMaxY)
                            return false;
                        return true;
                    });
                }
                const allValues = filteredDatas
                    .filter(d => d.y !== null && d.y !== undefined)
                    .map(d => d.y);
                if (allValues.length > 0) {
                    // yMin/yMax     min/max 
                    let min = Math.min(...allValues);
                    let max = Math.max(...allValues);
                    if (filterMinY !== undefined) {
                        min = Math.max(min, filterMinY); //   min  yMin   
                    }
                    if (filterMaxY !== undefined) {
                        max = Math.min(max, filterMaxY); //   max  yMax   
                    }
                    if (!this.globalMinMaxCache.has(chartKey)) {
                        this.globalMinMaxCache.set(chartKey, new Map());
                    }
                    this.globalMinMaxCache.get(chartKey).set(symbol, { min, max });
                }
            });
        });
    }
    // commonEvents   
    normalizeCommonEvents(input) {
        //     
        return input;
    }
    //  
    detectDarkMode(theme) {
        if (theme === 'dark')
            return true;
        if (theme === 'light')
            return false;
        // 'auto'  undefined:   
        if (typeof window !== 'undefined' && window.matchMedia) {
            return window.matchMedia('(prefers-color-scheme: dark)').matches;
        }
        return false; // :  
    }
    //   /  
    getTextColor() {
        const isDarkMode = this.detectDarkMode(this.config.theme);
        return isDarkMode ? '#E0E0E0' : '#000000';
    }
    //     
    getAxisColor() {
        const isDarkMode = this.detectDarkMode(this.config.theme);
        return isDarkMode ? '#666666' : '#000000';
    }
    //      
    getDefaultEventColor(transparent = false) {
        const isDarkMode = this.detectDarkMode(this.config.theme);
        if (transparent) {
            return isDarkMode ? 'rgba(255, 180, 92, 0.3)' : 'rgba(255, 102, 0, 0.2)';
        }
        return isDarkMode ? '#FFB85C' : '#FF6600';
    }
    destroy() {
        //  
        if (this.resizeObserver) {
            this.resizeObserver.disconnect();
            this.resizeObserver = null;
        }
        //    
        //      
        if (typeof window !== 'undefined' && this.canvas.removeEventListener) {
            //      canvas  
            // (        )
            const newCanvas = this.canvas.cloneNode(true);
            this.canvas.parentNode?.replaceChild(newCanvas, this.canvas);
        }
    }
    setupResizeObserver() {
        //   ResizeObserver  
        if (typeof ResizeObserver === 'undefined') {
            return;
        }
        this.resizeObserver = new ResizeObserver(() => {
            this.render();
        });
        this.resizeObserver.observe(this.canvas);
    }
    setData(dataMap, commonEvents = {}) {
        this.dataMap = this.normalizeDataMap(dataMap);
        this.originalDataMap = this.dataMap; //   
        this.calculateGlobalMinMax(); //  min/max 
        this.commonEvents = this.normalizeCommonEvents(commonEvents);
        //   
        this.averageLineCache.clear();
        //   
        this.tickerColors.clear();
        let colorIndex = 0;
        dataMap.forEach((value, symbol) => {
            const color = value.color || this.colors[colorIndex % this.colors.length];
            this.tickerColors.set(symbol, color);
            colorIndex++;
        });
    }
    updateState(partialState) {
        this.state = { ...this.state, ...partialState };
        // visibleTickers showAverage   
        if (partialState.visibleTickers || partialState.showAverage) {
            this.averageLineCache.clear();
        }
        this.render();
    }
    updateTickerMovingAverages(widths) {
        console.log('[updateTickerMovingAverages] called with widths:', widths);
        console.log('[updateTickerMovingAverages] dataMap size:', this.dataMap.size);
        //    chartKey movingAverageXwidth 
        this.dataMap.forEach((tickerData, symbol) => {
            console.log(`[updateTickerMovingAverages] Processing symbol: ${symbol}`);
            if (isChartKeyData(tickerData.data)) {
                //   
                tickerData.data.movingAverageXwidth = widths.length > 0 ? widths : undefined;
                console.log(`  Single chart key, set movingAverageXwidth:`, tickerData.data.movingAverageXwidth);
            }
            else {
                //   
                Object.keys(tickerData.data).forEach((chartKey) => {
                    const chartKeyData = tickerData.data[chartKey];
                    chartKeyData.movingAverageXwidth = widths.length > 0 ? widths : undefined;
                    console.log(`  Chart key: ${chartKey}, set movingAverageXwidth:`, chartKeyData.movingAverageXwidth);
                });
            }
        });
        //    
        this.averageLineCache.clear();
        this.render();
    }
    getState() {
        return { ...this.state };
    }
    getSortedTimes() {
        return this.sortedTimes;
    }
    getTickerColor(symbol) {
        return this.tickerColors.get(symbol) || this.colors[0];
    }
    applyFormatResult(result) {
        if (typeof result === 'string') {
            return result;
        }
        //  
        if (result.font)
            this.ctx.font = result.font;
        if (result.fillStyle)
            this.ctx.fillStyle = result.fillStyle;
        if (result.textAlign)
            this.ctx.textAlign = result.textAlign;
        if (result.textBaseline)
            this.ctx.textBaseline = result.textBaseline;
        return result.value;
    }
    getChartRight() {
        return this.chartAreaLeft + this.chartAreaWidth;
    }
    getX(time, minTime, maxTime) {
        const timeRange = maxTime - minTime || 1;
        //     ( padding )
        const chartWidth = this.chartAreaWidth;
        const normalizedTime = (time - minTime) / timeRange;
        //    paddingLeft 
        return this.paddingLeft + normalizedTime * chartWidth;
    }
    getY(value, minVal, maxVal, topY, height) {
        const range = maxVal - minVal || 1;
        const normalizedValue = (value - minVal) / range;
        //  11%,  5% 
        const totalMargin = this.chartMarginTop + this.chartMarginBottom;
        const scaledValue = this.chartMarginBottom + normalizedValue * (1 - totalMargin);
        return topY + (1 - scaledValue) * height;
    }
    drawChartKey(chartKey, area, visibleTickers, sortedTimes, options = {}) {
        const { showCandles = false, fillGaps = false, lineMode = 'line', showAverage = false, hideValues = false, hideLines = false, showGrid = false, displayMinTime, displayMaxTime } = options;
        if (sortedTimes.length === 0)
            return;
        // area   
        const chartTopY = area.y;
        const chartHeight = area.height;
        //   -  originalDataMap  (  displayMinTime/displayMaxTime )
        const dataBySymbol = new Map();
        //   movingAverageXwidth  (      )
        const tickerMovingAverages = new Map();
        this.originalDataMap.forEach((value, symbol) => {
            const points = [];
            const chartDataObj = value.data[chartKey];
            if (!chartDataObj)
                return;
            //   movingAverageXwidth  (ChartKeyData )
            if (chartDataObj.movingAverageXwidth && chartDataObj.movingAverageXwidth.length > 0) {
                tickerMovingAverages.set(symbol, chartDataObj.movingAverageXwidth);
                console.log(`[drawChartKey] ${symbol} - ${chartKey}: movingAverageXwidth =`, chartDataObj.movingAverageXwidth);
            }
            const chartData = chartDataObj.datas || [];
            chartData.forEach(d => {
                const time = d.x;
                if (d.y !== null && d.y !== undefined) {
                    // yOpen, yHigh, yLow    OHLC  
                    const hasOHLC = d.yOpen !== null && d.yOpen !== undefined &&
                        d.yHigh !== null && d.yHigh !== undefined &&
                        d.yLow !== null && d.yLow !== undefined;
                    points.push({
                        time,
                        open: hasOHLC ? d.yOpen : d.y,
                        high: hasOHLC ? d.yHigh : d.y,
                        low: hasOHLC ? d.yLow : d.y,
                        close: d.y
                    });
                }
            });
            dataBySymbol.set(symbol, points);
        });
        // X  
        // displayMinTime/displayMaxTime    (zoom  )
        //  config.xMin/xMax  ( )
        //       
        let minTime;
        let maxTime;
        if (displayMinTime !== undefined && displayMaxTime !== undefined) {
            // zoom   displayMinTime/displayMaxTime 
            minTime = displayMinTime;
            maxTime = displayMaxTime;
        }
        else if (this.config.xMin !== undefined && this.config.xMax !== undefined) {
            // zoom  config   config 
            minTime = typeof this.config.xMin === 'function' ? this.config.xMin(chartKey) : this.config.xMin;
            maxTime = typeof this.config.xMax === 'function' ? this.config.xMax(chartKey) : this.config.xMax;
        }
        else {
            //       
            minTime = sortedTimes[0];
            maxTime = sortedTimes[sortedTimes.length - 1];
        }
        const timeRange = maxTime - minTime || 1;
        const minMaxBySymbol = new Map();
        if (this.state.normalize === 'rangeNormalize') {
            //  :    (displayMinTime~displayMaxTime)  
            //  Y 
            dataBySymbol.forEach((points, symbol) => {
                //      
                const visiblePoints = points.filter(p => p.time >= (displayMinTime ?? minTime) &&
                    p.time <= (displayMaxTime ?? maxTime));
                const closes = visiblePoints.map(p => p.close);
                if (closes.length > 0) {
                    let min = Math.min(...closes);
                    let max = Math.max(...closes);
                    // config yMin/yMax   
                    if (this.config.yMin !== undefined) {
                        const configMin = typeof this.config.yMin === 'function' ? this.config.yMin(chartKey) : this.config.yMin;
                        if (configMin !== undefined) {
                            min = configMin;
                        }
                    }
                    if (this.config.yMax !== undefined) {
                        const configMax = typeof this.config.yMax === 'function' ? this.config.yMax(chartKey) : this.config.yMax;
                        if (configMax !== undefined) {
                            max = configMax;
                        }
                    }
                    minMaxBySymbol.set(symbol, { min, max });
                }
            });
        }
        else if (this.state.normalize === 'normalize') {
            //   :    min/max 
            //  Y 
            const chartMinMaxCache = this.globalMinMaxCache.get(chartKey);
            if (chartMinMaxCache) {
                dataBySymbol.forEach((points, symbol) => {
                    const cachedMinMax = chartMinMaxCache.get(symbol);
                    if (cachedMinMax) {
                        let min = cachedMinMax.min;
                        let max = cachedMinMax.max;
                        // config yMin/yMax   
                        if (this.config.yMin !== undefined) {
                            const configMin = typeof this.config.yMin === 'function' ? this.config.yMin(chartKey) : this.config.yMin;
                            if (configMin !== undefined) {
                                min = configMin;
                            }
                        }
                        if (this.config.yMax !== undefined) {
                            const configMax = typeof this.config.yMax === 'function' ? this.config.yMax(chartKey) : this.config.yMax;
                            if (configMax !== undefined) {
                                max = configMax;
                            }
                        }
                        minMaxBySymbol.set(symbol, { min, max });
                    }
                });
            }
        }
        else {
            //   ('none'):        
            let globalMin = Infinity;
            let globalMax = -Infinity;
            dataBySymbol.forEach((points) => {
                //      
                const visiblePoints = points.filter(p => p.time >= (displayMinTime ?? minTime) &&
                    p.time <= (displayMaxTime ?? maxTime));
                const closes = visiblePoints.map(p => p.close);
                if (closes.length > 0) {
                    globalMin = Math.min(globalMin, ...closes);
                    globalMax = Math.max(globalMax, ...closes);
                }
            });
            // config yMin/yMax   
            if (this.config.yMin !== undefined) {
                const configMin = typeof this.config.yMin === 'function' ? this.config.yMin(chartKey) : this.config.yMin;
                if (configMin !== undefined) {
                    globalMin = configMin;
                }
            }
            if (this.config.yMax !== undefined) {
                const configMax = typeof this.config.yMax === 'function' ? this.config.yMax(chartKey) : this.config.yMax;
                if (configMax !== undefined) {
                    globalMax = configMax;
                }
            }
            //    min/max 
            dataBySymbol.forEach((_, symbol) => {
                minMaxBySymbol.set(symbol, {
                    min: globalMin,
                    max: globalMax
                });
            });
        }
        const graphTop = chartTopY;
        const graphBottom = chartTopY + chartHeight;
        const graphHeight = chartHeight;
        // 
        this.ctx.fillStyle = this.config.backgroundColor || '#FFFFFF';
        this.ctx.fillRect(0, chartTopY, this.width, chartHeight);
        // 
        if (showGrid) {
            this.drawGrid(graphTop, graphHeight);
        }
        // Y
        this.drawYAxis(graphTop, graphBottom);
        // Y 
        if (!hideValues && !this.config.hideYAxisLabels) {
            //  min/max  ( )
            let globalMin = Infinity;
            let globalMax = -Infinity;
            minMaxBySymbol.forEach((minMax) => {
                globalMin = Math.min(globalMin, minMax.min);
                globalMax = Math.max(globalMax, minMax.max);
            });
            this.drawYAxisLabels(graphTop, graphHeight, graphBottom, globalMin, globalMax, chartKey);
        }
        // Y 
        if (!this.config.hideYAxisLabels) {
            const labelFormatted = this.config.labelFormat ? this.config.labelFormat(chartKey) : chartKey;
            const yAxisLabel = this.applyFormatResult(labelFormatted);
            this.drawYAxisTitle(yAxisLabel, graphTop, graphBottom);
        }
        //  
        dataBySymbol.forEach((points, symbol) => {
            if (!visibleTickers.has(symbol)) {
                return;
            }
            const color = this.getTickerColor(symbol);
            const minMax = minMaxBySymbol.get(symbol);
            const sortedPoints = points.sort((a, b) => a.time - b.time);
            // lineMode : chartKey > ticker > RenderState
            const tickerData = this.dataMap.get(symbol);
            const chartKeyData = tickerData?.data[chartKey];
            const effectiveLineMode = chartKeyData?.lineMode || tickerData?.lineMode || lineMode;
            //  (OHLC    )
            if (showCandles) {
                const candlePoints = sortedPoints.filter(p => {
                    // open, high, low, close     (OHLC   )
                    //    OHLC  close  
                    return !(p.open === p.close && p.high === p.close && p.low === p.close);
                });
                if (candlePoints.length > 0) {
                    this.drawCandles(candlePoints, minMax, color, minTime, maxTime, graphTop, graphHeight, symbol, chartKey);
                }
            }
            // 
            if (!hideLines) {
                this.drawLine(sortedPoints, minMax, color, minTime, maxTime, timeRange, sortedTimes.length, graphTop, graphHeight, fillGaps, effectiveLineMode, symbol, chartKey);
            }
        });
        //  -  showAverage  movingAverageXwidth  
        // 1.  /  (   )
        if (showAverage && showAverage.length > 0 && dataBySymbol.size > 0) {
            //    
            const hasAverageEnabled = showAverage.some(cfg => cfg.type === 'average' && cfg.visible !== false);
            if (hasAverageEnabled) {
                //       
                showAverage.forEach(avgConfig => {
                    // visible false  
                    if (avgConfig.visible === false) {
                        return;
                    }
                    this.drawAverageLine(dataBySymbol, minMaxBySymbol, sortedTimes, minTime, maxTime, graphTop, graphHeight, lineMode, avgConfig, chartKey);
                });
            }
        }
        // 2.  movingAverageXwidth  (  )
        // tickerMovingAverages  xWidth 
        console.log(`[drawChartKey] tickerMovingAverages size: ${tickerMovingAverages.size}`);
        if (tickerMovingAverages.size > 0) {
            // showAverage  xWidth   (   )
            const activeXWidths = new Set();
            if (showAverage && showAverage.length > 0) {
                showAverage.forEach(avgConfig => {
                    if (avgConfig.type === 'moving' && avgConfig.visible !== false) {
                        activeXWidths.add(avgConfig.xWidth);
                    }
                });
            }
            // tickerMovingAverages  xWidth activeXWidths 
            tickerMovingAverages.forEach((xWidths) => {
                xWidths.forEach(xWidth => {
                    activeXWidths.add(xWidth);
                });
            });
            console.log(`[drawChartKey] activeXWidths:`, Array.from(activeXWidths));
            //  xWidth   
            if (activeXWidths.size > 0) {
                console.log(`[drawChartKey] Drawing ticker moving averages...`);
                tickerMovingAverages.forEach((xWidths, symbol) => {
                    console.log(`[drawChartKey] Processing ticker: ${symbol}, xWidths:`, xWidths);
                    //    
                    const tickerDataBySymbol = new Map();
                    const tickerData = dataBySymbol.get(symbol);
                    if (!tickerData) {
                        console.log(`[drawChartKey] No data for ${symbol}`);
                        return;
                    }
                    tickerDataBySymbol.set(symbol, tickerData.map(p => ({ time: p.time, close: p.close })));
                    const tickerMinMax = minMaxBySymbol.get(symbol);
                    if (!tickerMinMax) {
                        console.log(`[drawChartKey] No minMax for ${symbol}`);
                        return;
                    }
                    const tickerMinMaxBySymbol = new Map();
                    tickerMinMaxBySymbol.set(symbol, tickerMinMax);
                    //   
                    const tickerColor = this.getTickerColor(symbol);
                    // activeXWidths  xWidth 
                    const filteredXWidths = xWidths.filter(xWidth => activeXWidths.has(xWidth));
                    const totalLines = filteredXWidths.length;
                    console.log(`[drawChartKey] ${symbol} filteredXWidths:`, filteredXWidths);
                    filteredXWidths.forEach((xWidth, index) => {
                        //    (1.0),   (0.3)
                        const opacity = totalLines === 1 ? 1.0 : 1.0 - (index / (totalLines - 1)) * 0.7;
                        console.log(`[drawChartKey] Drawing MA for ${symbol}, xWidth: ${xWidth}, opacity: ${opacity}`);
                        const avgConfig = {
                            type: 'moving',
                            xWidth,
                            label: `${symbol}-MA${Math.round(xWidth / (60 * 1000 * 60 * 24))}`,
                            color: tickerColor, //   
                            visible: true,
                            opacity // opacity 
                        };
                        this.drawAverageLine(tickerDataBySymbol, tickerMinMaxBySymbol, sortedTimes, minTime, maxTime, graphTop, graphHeight, lineMode, avgConfig, chartKey, symbol);
                    });
                });
            }
        }
        return { dataBySymbol, minMaxBySymbol, sortedTimes };
    }
    drawGrid(topY, height) {
        const gridDivisions = 10;
        const gridWidth = this.chartAreaWidth;
        const gridStepX = gridWidth / gridDivisions;
        const gridStepY = height / gridDivisions;
        this.ctx.strokeStyle = this.config.gridStrokeStyle || '#CCCCCC';
        this.ctx.lineWidth = this.config.gridLineWidth || 1;
        for (let i = 0; i <= gridDivisions; i++) {
            const x = this.chartAreaLeft + gridStepX * i;
            this.ctx.beginPath();
            this.ctx.moveTo(x, topY);
            this.ctx.lineTo(x, topY + height);
            this.ctx.stroke();
        }
        for (let i = 0; i <= gridDivisions; i++) {
            const y = topY + gridStepY * i;
            this.ctx.beginPath();
            this.ctx.moveTo(this.chartAreaLeft, y);
            this.ctx.lineTo(this.getChartRight(), y);
            this.ctx.stroke();
        }
    }
    drawYAxis(topY, bottomY) {
        this.ctx.strokeStyle = this.getAxisColor();
        this.ctx.lineWidth = 2;
        this.ctx.beginPath();
        this.ctx.moveTo(this.paddingLeft, topY);
        this.ctx.lineTo(this.paddingLeft, bottomY);
        this.ctx.stroke();
    }
    drawYAxisLabels(topY, height, bottomY, minValue, maxValue, chartKey) {
        const yLabelCount = this.config.yLabelCount ?? 6;
        // yLabelCount 0   
        if (yLabelCount === 0) {
            return;
        }
        this.ctx.fillStyle = this.getTextColor();
        this.ctx.font = '12px Arial';
        this.ctx.textAlign = 'right';
        this.ctx.textBaseline = 'middle';
        this.ctx.strokeStyle = this.getAxisColor();
        this.ctx.lineWidth = 1;
        const labelCount = Math.max(2, yLabelCount); //  2 ( )
        const totalLabels = labelCount;
        const step = 100 / (labelCount - 1); // 0 100 labelCount-1  
        for (let i = 0; i < labelCount; i++) {
            const normalizedValue = (100 - i * step) / 100;
            const totalMargin = this.chartMarginTop + this.chartMarginBottom;
            const scaledValue = this.chartMarginBottom + normalizedValue * (1 - totalMargin);
            const y = bottomY - scaledValue * height;
            let labelText;
            if (this.state.normalize !== 'none' || minValue === undefined || maxValue === undefined) {
                //   (rangeNormalize  normalize): % 
                const value = 100 - i * step;
                labelText = `${Math.round(value)}%`;
            }
            else {
                //   (none):   
                const actualValue = minValue + normalizedValue * (maxValue - minValue);
                const formatted = this.config.yFormat ? this.config.yFormat(actualValue, i, totalLabels, chartKey) : actualValue.toLocaleString(undefined, { maximumFractionDigits: 2 });
                labelText = this.applyFormatResult(formatted);
            }
            this.ctx.fillText(labelText, this.paddingLeft - 5, y);
            this.ctx.beginPath();
            this.ctx.moveTo(this.paddingLeft - 5, y);
            this.ctx.lineTo(this.paddingLeft, y);
            this.ctx.stroke();
        }
    }
    drawYAxisTitle(title, topY, bottomY) {
        this.ctx.save();
        const labelY = (topY + bottomY) / 2;
        // paddingLeft     ,    
        const titleX = Math.min(this.paddingLeft / 2, 8);
        this.ctx.translate(titleX, labelY);
        this.ctx.rotate(-Math.PI / 2);
        this.ctx.fillStyle = this.getTextColor();
        this.ctx.font = 'bold 14px Arial';
        this.ctx.textAlign = 'center';
        this.ctx.textBaseline = 'middle';
        this.ctx.fillText(title, 0, 0);
        this.ctx.restore();
    }
    drawCandles(points, minMax, color, minTime, maxTime, topY, height, symbol, chartKey) {
        if (points.length === 0)
            return;
        this.ctx.save();
        this.ctx.beginPath();
        this.ctx.rect(this.chartAreaLeft, topY, this.chartAreaWidth, height);
        this.ctx.clip();
        points.forEach(point => {
            const x = this.getX(point.time, minTime, maxTime);
            const yHigh = this.getY(point.high, minMax.min, minMax.max, topY, height);
            const yLow = this.getY(point.low, minMax.min, minMax.max, topY, height);
            const yOpen = this.getY(point.open, minMax.min, minMax.max, topY, height);
            const yClose = this.getY(point.close, minMax.min, minMax.max, topY, height);
            const isUp = point.close >= point.open;
            //   
            let upColor = color;
            let downColor = color;
            let borderColor = color;
            if (symbol && chartKey) {
                if (this.config.candleUpColor) {
                    upColor = typeof this.config.candleUpColor === 'function'
                        ? this.config.candleUpColor(symbol, chartKey)
                        : this.config.candleUpColor;
                }
                if (this.config.candleDownColor) {
                    downColor = typeof this.config.candleDownColor === 'function'
                        ? this.config.candleDownColor(symbol, chartKey)
                        : this.config.candleDownColor;
                }
                if (this.config.candleBorderColor) {
                    borderColor = typeof this.config.candleBorderColor === 'function'
                        ? this.config.candleBorderColor(symbol, chartKey)
                        : this.config.candleBorderColor;
                }
            }
            // High-Low 
            // this.ctx.globalAlpha = 0.6; // 0.3
            this.ctx.globalAlpha = 0.3; // 0.3
            this.ctx.strokeStyle = borderColor;
            this.ctx.lineWidth = 1;
            this.ctx.beginPath();
            this.ctx.moveTo(x, yHigh);
            this.ctx.lineTo(x, yLow);
            this.ctx.stroke();
            // Open-Close  
            const candleWidth = 2;
            this.ctx.strokeStyle = borderColor;
            this.ctx.fillStyle = isUp ? upColor : downColor;
            const rectY = Math.min(yOpen, yClose);
            const rectHeight = Math.max(Math.abs(yOpen - yClose), 1);
            this.ctx.fillRect(x - candleWidth / 2, rectY, candleWidth, rectHeight);
            this.ctx.strokeRect(x - candleWidth / 2, rectY, candleWidth, rectHeight);
            this.ctx.globalAlpha = 1;
        });
        this.ctx.restore();
    }
    drawLine(points, minMax, color, minTime, maxTime, timeRange, totalPoints, topY, height, fillGaps, lineMode, symbol, chartKey) {
        if (points.length === 0)
            return;
        this.ctx.save();
        this.ctx.beginPath();
        this.ctx.rect(this.chartAreaLeft, topY, this.chartAreaWidth, height);
        this.ctx.clip();
        //   
        let lineColor = color;
        let lineWidth = 1;
        if (symbol && chartKey) {
            if (this.config.lineStrokeStyle) {
                lineColor = typeof this.config.lineStrokeStyle === 'function'
                    ? this.config.lineStrokeStyle(symbol, chartKey)
                    : this.config.lineStrokeStyle;
            }
            if (this.config.lineWidth) {
                lineWidth = typeof this.config.lineWidth === 'function'
                    ? this.config.lineWidth(symbol, chartKey)
                    : this.config.lineWidth;
            }
        }
        this.ctx.strokeStyle = lineColor;
        this.ctx.lineWidth = lineWidth;
        this.ctx.lineJoin = 'round';
        this.ctx.lineCap = 'round';
        this.ctx.beginPath();
        const firstX = this.getX(points[0].time, minTime, maxTime);
        const firstY = this.getY(points[0].close, minMax.min, minMax.max, topY, height);
        this.ctx.moveTo(firstX, firstY);
        const avgTimeDiff = timeRange / totalPoints;
        for (let i = 1; i < points.length; i++) {
            const point = points[i];
            const prevPoint = points[i - 1];
            const x = this.getX(point.time, minTime, maxTime);
            const y = this.getY(point.close, minMax.min, minMax.max, topY, height);
            const timeDiff = point.time - prevPoint.time;
            if (timeDiff > avgTimeDiff * 2) {
                this.ctx.stroke();
                if (!fillGaps) {
                    this.ctx.setLineDash([5, 5]);
                }
                this.ctx.beginPath();
                const prevX = this.getX(prevPoint.time, minTime, maxTime);
                const prevY = this.getY(prevPoint.close, minMax.min, minMax.max, topY, height);
                this.ctx.moveTo(prevX, prevY);
                if (lineMode.startsWith('line-smooth')) {
                    this.drawBezierCurve(prevX, prevY, x, y, point, minMax, topY, height, lineMode);
                }
                else if (lineMode === 'step-to') {
                    // step-to:  -> 
                    this.ctx.lineTo(x, prevY); // 
                    this.ctx.lineTo(x, y); // 
                }
                else if (lineMode === 'step-from') {
                    // step-from:  -> 
                    this.ctx.lineTo(prevX, y); // 
                    this.ctx.lineTo(x, y); // 
                }
                else if (lineMode === 'step-center') {
                    // step-center:  ->   -> 
                    const midX = (prevX + x) / 2;
                    this.ctx.lineTo(midX, prevY); //  ()
                    this.ctx.lineTo(midX, y); //  ()
                    this.ctx.lineTo(x, y); //  ()
                }
                else {
                    // line: 
                    this.ctx.lineTo(x, y);
                }
                this.ctx.stroke();
                if (!fillGaps) {
                    this.ctx.setLineDash([]);
                }
                this.ctx.beginPath();
                this.ctx.moveTo(x, y);
            }
            else {
                if (lineMode.startsWith('line-smooth')) {
                    const prevX = this.getX(prevPoint.time, minTime, maxTime);
                    const prevY = this.getY(prevPoint.close, minMax.min, minMax.max, topY, height);
                    this.drawBezierCurve(prevX, prevY, x, y, point, minMax, topY, height, lineMode);
                }
                else if (lineMode === 'step-to') {
                    // step-to:  -> 
                    this.ctx.lineTo(x, this.getY(prevPoint.close, minMax.min, minMax.max, topY, height)); // 
                    this.ctx.lineTo(x, y); // 
                }
                else if (lineMode === 'step-from') {
                    // step-from:  -> 
                    const prevX = this.getX(prevPoint.time, minTime, maxTime);
                    this.ctx.lineTo(prevX, y); // 
                    this.ctx.lineTo(x, y); // 
                }
                else if (lineMode === 'step-center') {
                    // step-center:  ->   -> 
                    const prevX = this.getX(prevPoint.time, minTime, maxTime);
                    const prevY = this.getY(prevPoint.close, minMax.min, minMax.max, topY, height);
                    const midX = (prevX + x) / 2;
                    this.ctx.lineTo(midX, prevY); //  ()
                    this.ctx.lineTo(midX, y); //  ()
                    this.ctx.lineTo(x, y); //  ()
                    this.ctx.lineTo(x, y); // 
                }
                else {
                    // line: 
                    this.ctx.lineTo(x, y);
                }
            }
        }
        this.ctx.stroke();
        this.ctx.restore();
    }
    drawBezierCurve(prevX, prevY, x, y, point, minMax, topY, height, lineMode) {
        const cp1x = prevX + (x - prevX) / 3;
        const cp1y = prevY;
        const cp2x = prevX + (x - prevX) * 2 / 3;
        let cp2y;
        if (lineMode === 'line-smooth-open' && point.open && point.open > 0) {
            cp2y = this.getY(point.open, minMax.min, minMax.max, topY, height);
        }
        else if (lineMode === 'line-smooth-high' && point.high && point.high > 0) {
            cp2y = this.getY(point.high, minMax.min, minMax.max, topY, height);
        }
        else if (lineMode === 'line-smooth-low' && point.low && point.low > 0) {
            cp2y = this.getY(point.low, minMax.min, minMax.max, topY, height);
        }
        else if (lineMode === 'line-smooth-middle' && point.high && point.low) {
            cp2y = this.getY((point.high + point.low) / 2, minMax.min, minMax.max, topY, height);
        }
        else {
            cp2y = y;
        }
        this.ctx.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);
    }
    drawAverageLine(dataBySymbol, minMaxBySymbol, sortedTimes, minTime, maxTime, topY, height, lineMode, averageConfig, chartKey, filterSymbol //    ( )
    ) {
        console.log(`[drawAverageLine] chartKey: ${chartKey}, filterSymbol: ${filterSymbol}, type: ${averageConfig.type}`);
        //    (visibleTickers, chartKey, averageConfig, normalize  )
        const visibleTickersKey = Array.from(this.state.visibleTickers).sort().join(',');
        //         
        // filterSymbol     ( )
        let cacheKey = `${chartKey}-${averageConfig.type}-${averageConfig.type === 'moving' ? averageConfig.xWidth : 'full'}-${averageConfig.label}-${visibleTickersKey}-${this.state.normalize}`;
        if (filterSymbol) {
            cacheKey += `-ticker-${filterSymbol}`;
        }
        if (this.state.normalize === 'rangeNormalize') {
            //   :      
            cacheKey += `-${minTime}-${maxTime}`;
        }
        //     (this.originalDataMap)  -     
        const fullDataBySymbol = new Map();
        //   min/max 
        // rangeNormalize:    min/max 
        // normalize:   min/max  (globalMinMaxCache)
        const normalizationMinMaxBySymbol = new Map();
        this.originalDataMap.forEach((value, symbol) => {
            // filterSymbol    
            if (filterSymbol && symbol !== filterSymbol) {
                return;
            }
            // visibleTickers   
            if (!this.state.visibleTickers.has(symbol))
                return;
            const points = [];
            //  chartKey   (price, volume, obv )
            const chartDataObj = value.data[chartKey];
            if (!chartDataObj)
                return;
            const chartData = chartDataObj.datas || [];
            chartData.forEach(d => {
                if (d.y !== null && d.y !== undefined) {
                    points.push({
                        time: d.x,
                        close: d.y
                    });
                }
            });
            if (points.length > 0) {
                fullDataBySymbol.set(symbol, points);
                //  min/max 
                if (this.state.normalize === 'normalize') {
                    //  : globalMinMaxCache 
                    const globalMinMax = this.globalMinMaxCache.get(chartKey)?.get(symbol);
                    if (globalMinMax) {
                        normalizationMinMaxBySymbol.set(symbol, globalMinMax);
                    }
                }
                else if (this.state.normalize === 'rangeNormalize') {
                    //  :    min/max 
                    const rangeMinMax = minMaxBySymbol.get(symbol);
                    if (rangeMinMax) {
                        normalizationMinMaxBySymbol.set(symbol, rangeMinMax);
                    }
                }
                else {
                    //  :   min/max 
                    const globalMinMax = this.globalMinMaxCache.get(chartKey)?.get(symbol);
                    if (globalMinMax) {
                        normalizationMinMaxBySymbol.set(symbol, globalMinMax);
                    }
                }
            }
        });
        // : normalizationMinMaxBySymbol 
        console.log(`[drawAverageLine] chartKey: ${chartKey}, normalize: ${this.state.normalize}`);
        console.log(`[drawAverageLine] fullDataBySymbol size: ${fullDataBySymbol.size}`);
        console.log(`[drawAverageLine] fullDataBySymbol symbols:`, Array.from(fullDataBySymbol.keys()));
        console.log(`[drawAverageLine] normalizationMinMaxBySymbol size: ${normalizationMinMaxBySymbol.size}`);
        if (normalizationMinMaxBySymbol.size === 0) {
            console.warn(`[drawAverageLine] normalizationMinMaxBySymbol is empty for chartKey: ${chartKey}, normalize: ${this.state.normalize}`);
            console.warn(`globalMinMaxCache has chartKey:`, this.globalMinMaxCache.has(chartKey));
            console.warn(`minMaxBySymbol size:`, minMaxBySymbol.size);
            return; //    
        }
        //      
        const allTimesSet = new Set();
        fullDataBySymbol.forEach((sortedPoints) => {
            sortedPoints.forEach(point => {
                allTimesSet.add(point.time);
            });
        });
        const allTimes = Array.from(allTimesSet).sort((a, b) => a - b);
        if (averageConfig.type === 'average') {
            //  
            let avgPoints = [];
            if (this.averageLineCache.has(cacheKey)) {
                avgPoints = this.averageLineCache.get(cacheKey);
            }
            else {
                //  :     
                //     
                allTimes.forEach(time => {
                    const normalizedValues = [];
                    fullDataBySymbol.forEach((sortedPoints, symbol) => {
                        const minMax = normalizationMinMaxBySymbol.get(symbol);
                        if (!minMax)
                            return;
                        let closeValue = null;
                        const exactPoint = sortedPoints.find(p => p.time === time);
                        if (exactPoint) {
                            closeValue = exactPoint.close;
                        }
                        else {
                            let prevPoint = null;
                            let nextPoint = null;
                            for (let i = 0; i < sortedPoints.length; i++) {
                                if (sortedPoints[i].time < time) {
                                    prevPoint = sortedPoints[i];
                                }
                                else if (sortedPoints[i].time > time) {
                                    nextPoint = sortedPoints[i];
                                    break;
                                }
                            }
                            if (prevPoint && nextPoint) {
                                const ratio = (time - prevPoint.time) / (nextPoint.time - prevPoint.time);
                                closeValue = prevPoint.close + (nextPoint.close - prevPoint.close) * ratio;
                            }
                            else if (prevPoint) {
                                closeValue = prevPoint.close;
                            }
                            else if (nextPoint) {
                                closeValue = nextPoint.close;
                            }
                        }
                        if (closeValue !== null) {
                            //        
                            if (this.state.normalize === 'rangeNormalize' || this.state.normalize === 'normalize') {
                                const normalizedValue = ((closeValue - minMax.min) / (minMax.max - minMax.min || 1)) * 100;
                                normalizedValues.push(normalizedValue);
                            }
                            else {
                                //     
                                normalizedValues.push(closeValue);
                            }
                        }
                    });
                    if (normalizedValues.length > 0) {
                        const avgValue = normalizedValues.reduce((sum, v) => sum + v, 0) / normalizedValues.length;
                        avgPoints.push({ time, avgValue });
                    }
                });
                //  
                this.averageLineCache.set(cacheKey, avgPoints);
            }
            // Y  
            const avgPointsWithY = avgPoints.map(p => ({
                time: p.time,
                avgY: (this.state.normalize === 'rangeNormalize' || this.state.normalize === 'normalize')
                    ? this.getY(p.avgValue, 0, 100, topY, height) //  : 0-100% 
                    : (() => {
                        //  :   min/max 
                        let globalMin = Infinity;
                        let globalMax = -Infinity;
                        minMaxBySymbol.forEach((minMax) => {
                            globalMin = Math.min(globalMin, minMax.min);
                            globalMax = Math.max(globalMax, minMax.max);
                        });
                        return this.getY(p.avgValue, globalMin, globalMax, topY, height);
                    })()
            }));
            //    +  /   (   )
            const visibleAvgPoints = [];
            let foundFirstVisible = false;
            for (let i = 0; i < avgPointsWithY.length; i++) {
                const point = avgPointsWithY[i];
                //    
                if (point.time >= minTime && point.time <= maxTime) {
                    //      ,    
                    if (!foundFirstVisible && i > 0) {
                        visibleAvgPoints.push(avgPointsWithY[i - 1]);
                    }
                    foundFirstVisible = true;
                    visibleAvgPoints.push(point);
                }
                //     ( )
                else if (point.time > maxTime && foundFirstVisible) {
                    visibleAvgPoints.push(point);
                    break;
                }
            }
            this.drawSingleAverageLine(visibleAvgPoints, minTime, maxTime, topY, height, lineMode, averageConfig);
        }
        else if (averageConfig.type === 'moving') {
            //  
            let movingAvgPoints = [];
            if (this.averageLineCache.has(cacheKey)) {
                //   avgValue   Y  
                const cachedAvgValues = this.averageLineCache.get(cacheKey);
                // Y   ( )
                cachedAvgValues.forEach(item => {
                    let yCoord;
                    if (this.state.normalize === 'rangeNormalize' || this.state.normalize === 'normalize') {
                        //  : 0-100% 
                        yCoord = this.getY(item.avgValue, 0, 100, topY, height);
                    }
                    else {
                        //  :   min/max 
                        let globalMin = Infinity;
                        let globalMax = -Infinity;
                        minMaxBySymbol.forEach((minMax) => {
                            globalMin = Math.min(globalMin, minMax.min);
                            globalMax = Math.max(globalMax, minMax.max);
                        });
                        yCoord = this.getY(item.avgValue, globalMin, globalMax, topY, height);
                    }
                    movingAvgPoints.push({ time: item.time, avgY: yCoord });
                });
            }
            else {
                // :     ( )
                const xWidth = averageConfig.xWidth; //   ()
                //     (  )
                const avgValues = [];
                allTimes.forEach(time => {
                    const normalizedValues = [];
                    fullDataBySymbol.forEach((sortedPoints, symbol) => {
                        const minMax = normalizationMinMaxBySymbol.get(symbol);
                        if (!minMax)
                            return;
                        let closeValue = null;
                        const exactPoint = sortedPoints.find(p => p.time === time);
                        if (exactPoint) {
                            closeValue = exactPoint.close;
                        }
                        else {
                            let prevPoint = null;
                            let nextPoint = null;
                            for (let i = 0; i < sortedPoints.length; i++) {
                                if (sortedPoints[i].time < time) {
                                    prevPoint = sortedPoints[i];
                                }
                                else if (sortedPoints[i].time > time) {
                                    nextPoint = sortedPoints[i];
                                    break;
                                }
                            }
                            if (prevPoint && nextPoint) {
                                const ratio = (time - prevPoint.time) / (nextPoint.time - prevPoint.time);
                                closeValue = prevPoint.close + (nextPoint.close - prevPoint.close) * ratio;
                            }
                            else if (prevPoint) {
                                closeValue = prevPoint.close;
                            }
                            else if (nextPoint) {
                                closeValue = nextPoint.close;
                            }
                        }
                        if (closeValue !== null) {
                            //        
                            if (this.state.normalize === 'rangeNormalize' || this.state.normalize === 'normalize') {
                                const normalizedValue = ((closeValue - minMax.min) / (minMax.max - minMax.min || 1)) * 100;
                                normalizedValues.push(normalizedValue);
                            }
                            else {
                                //     
                                normalizedValues.push(closeValue);
                            }
                        }
                    });
                    if (normalizedValues.length > 0) {
                        const avgValue = normalizedValues.reduce((sum, y) => sum + y, 0) / normalizedValues.length;
                        avgValues.push({ time, avgValue });
                    }
                });
                //     
                let movingAvgPointsTemp = [];
                const firstDataTime = avgValues.length > 0 ? avgValues[0].time : 0;
                avgValues.forEach((item, index) => {
                    const time = item.time;
                    // xWidth     
                    if (time < firstDataTime + xWidth) {
                        return;
                    }
                    //   xWidth   
                    const startTime = time - xWidth;
                    //      
                    const rangeValues = [];
                    avgValues.forEach(v => {
                        if (v.time > startTime && v.time <= time) {
                            rangeValues.push(v.avgValue);
                        }
                    });
                    //    
                    if (rangeValues.length > 0) {
                        const movingAvg = rangeValues.reduce((sum, v) => sum + v, 0) / rangeValues.length;
                        movingAvgPointsTemp.push({ time, avgY: movingAvg }); // avgY  avgValue 
                    }
                });
                //   (avgY avgValue )
                const cacheData = movingAvgPointsTemp.map(p => ({ time: p.time, avgValue: p.avgY }));
                this.averageLineCache.set(cacheKey, cacheData);
                // Y  
                movingAvgPoints = movingAvgPointsTemp.map(item => {
                    let yCoord;
                    if (this.state.normalize === 'rangeNormalize' || this.state.normalize === 'normalize') {
                        //  : 0-100% 
                        yCoord = this.getY(item.avgY, 0, 100, topY, height);
                    }
                    else {
                        //  :   min/max 
                        let globalMin = Infinity;
                        let globalMax = -Infinity;
                        minMaxBySymbol.forEach((minMax) => {
                            globalMin = Math.min(globalMin, minMax.min);
                            globalMax = Math.max(globalMax, minMax.max);
                        });
                        yCoord = this.getY(item.avgY, globalMin, globalMax, topY, height);
                    }
                    return { time: item.time, avgY: yCoord };
                });
            }
            //    +  /   (   )
            const visibleMovingAvgPoints = [];
            let foundFirstVisible = false;
            for (let i = 0; i < movingAvgPoints.length; i++) {
                const point = movingAvgPoints[i];
                //    
                if (point.time >= minTime && point.time <= maxTime) {
                    //      ,    
                    if (!foundFirstVisible && i > 0) {
                        visibleMovingAvgPoints.push(movingAvgPoints[i - 1]);
                    }
                    foundFirstVisible = true;
                    visibleMovingAvgPoints.push(point);
                }
                //     ( )
                else if (point.time > maxTime && foundFirstVisible) {
                    visibleMovingAvgPoints.push(point);
                    break;
                }
            }
            this.drawSingleAverageLine(visibleMovingAvgPoints, minTime, maxTime, topY, height, lineMode, averageConfig);
        }
    }
    drawSingleAverageLine(avgPoints, minTime, maxTime, topY, height, lineMode, averageConfig) {
        if (avgPoints.length === 0)
            return;
        this.ctx.save();
        this.ctx.beginPath();
        this.ctx.rect(this.chartAreaLeft, topY, this.chartAreaWidth, height);
        this.ctx.clip();
        //   (config ,  averageConfig.color,  )
        const strokeStyle = averageConfig.color || this.config.averageStrokeStyle || '#000000';
        this.ctx.strokeStyle = strokeStyle;
        //    (label '-MA'   )
        const isTickerMA = averageConfig.label.includes('-MA');
        if (isTickerMA) {
            //  : lineWidth 1, 
            this.ctx.lineWidth = 1;
            this.ctx.setLineDash([5, 3]);
        }
        else {
            //  : config  
            this.ctx.lineWidth = this.config.averageLineWidth || 2;
            this.ctx.setLineDash(this.config.averageLineDash || [3, 2]);
        }
        // opacity  (averageConfig  ,  1.0)
        this.ctx.globalAlpha = averageConfig.opacity !== undefined ? averageConfig.opacity : 1.0;
        this.ctx.beginPath();
        avgPoints.forEach((point, i) => {
            const x = this.getX(point.time, minTime, maxTime);
            const y = point.avgY;
            if (i === 0) {
                this.ctx.moveTo(x, y);
            }
            else if (lineMode.startsWith('line-smooth') && i > 0) {
                const prevPoint = avgPoints[i - 1];
                const prevX = this.getX(prevPoint.time, minTime, maxTime);
                const prevY = prevPoint.avgY;
                const cp1x = prevX + (x - prevX) / 3;
                const cp1y = prevY;
                const cp2x = prevX + (x - prevX) * 2 / 3;
                const cp2y = y;
                this.ctx.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);
            }
            else {
                this.ctx.lineTo(x, y);
            }
        });
        this.ctx.stroke();
        this.ctx.setLineDash([]);
        this.ctx.globalAlpha = 1.0;
        this.ctx.restore();
    }
    drawLegend(area, dataBySymbol, visibleTickers) {
        const legendBoxSize = 10; //  
        const legendHeight = 16;
        const lineSpacing = -5; //  
        const itemSpacing = 10; //   
        const textMargin = 5; //    
        const newLegendItems = [];
        this.ctx.textAlign = 'left';
        this.ctx.textBaseline = 'middle';
        this.ctx.font = '11px Arial';
        let currentX = area.x;
        let currentY = area.y;
        let currentLineMaxHeight = legendHeight;
        const maxWidth = area.x + area.width;
        //  
        dataBySymbol.forEach((_, symbol) => {
            const color = this.getTickerColor(symbol);
            const isVisible = visibleTickers.has(symbol);
            //   
            const textWidth = this.ctx.measureText(symbol).width;
            const itemWidth = legendBoxSize + textMargin + textWidth + itemSpacing; //  +  +  +  
            //      
            if (currentX + itemWidth > maxWidth && currentX > area.x) {
                currentX = area.x;
                currentY += currentLineMaxHeight + lineSpacing;
                currentLineMaxHeight = legendHeight;
            }
            const itemX = currentX;
            newLegendItems.push({
                symbol,
                x: itemX - 5,
                y: currentY - legendHeight / 2,
                width: itemWidth,
                height: legendHeight
            });
            this.ctx.globalAlpha = isVisible ? 1.0 : 0.3;
            //   ()
            this.ctx.fillStyle = color;
            this.ctx.fillRect(itemX, currentY - legendBoxSize / 2, legendBoxSize, legendBoxSize);
            //  
            this.ctx.fillStyle = isVisible ? this.getTextColor() : (this.detectDarkMode(this.config.theme) ? '#666666' : '#999999');
            this.ctx.fillText(symbol, itemX + legendBoxSize + textMargin, currentY);
            this.ctx.globalAlpha = 1.0;
            currentX += itemWidth;
        });
        //    (  legendItems )
        if (this.state.showAverage && this.state.showAverage.length > 0) {
            this.state.showAverage.forEach(avgConfig => {
                const label = avgConfig.label;
                const color = avgConfig.color || this.config.averageStrokeStyle || '#000000';
                const isVisible = avgConfig.visible !== false; //  true
                //    (average:  moving:xWidth )
                const avgSymbol = avgConfig.type === 'average'
                    ? 'average:'
                    : `moving:${avgConfig.xWidth}`;
                //   
                const textWidth = this.ctx.measureText(label).width;
                const itemWidth = legendBoxSize + textMargin + textWidth + itemSpacing;
                //      
                if (currentX + itemWidth > maxWidth && currentX > area.x) {
                    currentX = area.x;
                    currentY += currentLineMaxHeight + lineSpacing;
                    currentLineMaxHeight = legendHeight;
                }
                const itemX = currentX;
                //  legendItems  ( )
                newLegendItems.push({
                    symbol: avgSymbol,
                    x: itemX - 5,
                    y: currentY - legendHeight / 2,
                    width: itemWidth,
                    height: legendHeight
                });
                // /    
                this.ctx.globalAlpha = isVisible ? 1.0 : 0.3;
                //  
                this.ctx.fillStyle = color;
                this.ctx.fillRect(itemX, currentY - legendBoxSize / 2, legendBoxSize, legendBoxSize);
                //  
                this.ctx.fillStyle = isVisible ? this.getTextColor() : (this.detectDarkMode(this.config.theme) ? '#666666' : '#999999');
                this.ctx.fillText(label, itemX + legendBoxSize + textMargin, currentY);
                this.ctx.globalAlpha = 1.0;
                currentX += itemWidth;
            });
        }
        return newLegendItems;
    }
    drawRangeEventLabel(event, x, y, color, align = 'center', baseline = 'top') {
        this.ctx.save();
        //   
        const font = this.config.eventRangeLabelFont
            ? (typeof this.config.eventRangeLabelFont === 'function'
                ? this.config.eventRangeLabelFont(event)
                : this.config.eventRangeLabelFont)
            : 'bold 11px Arial';
        this.ctx.font = font;
        this.ctx.textAlign = align;
        this.ctx.textBaseline = baseline;
        const textMetrics = this.ctx.measureText(event.label);
        const textWidth = textMetrics.width;
        const textHeight = 12; //   
        //    ( )
        const bgStyle = this.config.eventRangeLabelBackgroundStyle
            ? (typeof this.config.eventRangeLabelBackgroundStyle === 'function'
                ? this.config.eventRangeLabelBackgroundStyle(event)
                : this.config.eventRangeLabelBackgroundStyle)
            : undefined;
        if (bgStyle) {
            const bgX = align === 'center' ? x - textWidth / 2 - 4 : x - 4;
            this.ctx.fillStyle = bgStyle;
            this.ctx.fillRect(bgX, y - 2, textWidth + 8, 16);
        }
        //   
        const textColor = this.config.eventRangeLabelFillStyle
            ? (typeof this.config.eventRangeLabelFillStyle === 'function'
                ? this.config.eventRangeLabelFillStyle(event)
                : this.config.eventRangeLabelFillStyle)
            : (color.includes('rgba') ? color.replace(/[\d.]+\)$/g, '1)') : color);
        this.ctx.fillStyle = textColor;
        this.ctx.fillText(event.label, align === 'center' ? x : x, y);
        this.ctx.restore();
        //     (Range  )
        const labelX = align === 'center' ? x : x + textWidth / 2;
        const labelY = y + textHeight / 2;
        // Range     
        const rangeEvent = {
            ...event,
            isRangeLabel: true,
            labelRect: {
                x: align === 'center' ? x - textWidth / 2 : x,
                y: y,
                width: textWidth,
                height: textHeight
            }
        };
        this.eventMarkers.push({
            event: rangeEvent,
            x: labelX,
            y: labelY,
            radius: Math.max(textWidth / 2, 10)
        });
    }
    checkRangeEventHover(event, x, y) {
        const isHovered = this.hoveredEventMarker !== null &&
            this.hoveredEventMarker.label === event.label &&
            isRangeEvent(this.hoveredEventMarker);
        if (isHovered) {
            this.eventTooltipsToRender.push({ event, x, y: y + 20, pointsDown: true });
        }
    }
    drawEventMarkers(sortedTimes, chartBottom, showEvents, chartAreas, displayMinTime, displayMaxTime, minMaxByChartKey) {
        if (!showEvents || sortedTimes.length === 0)
            return;
        const minTime = displayMinTime ?? sortedTimes[0];
        const maxTime = displayMaxTime ?? sortedTimes[sortedTimes.length - 1];
        //    ( + ) -      
        const allEvents = [];
        // 1. X    (   )
        if (this.commonEvents.x && this.commonEvents.x.length > 0) {
            //  visible   X   
            for (const chartKey of this.state.visibleChartKeys) {
                allEvents.push(...this.commonEvents.x.map(e => ({
                    ...e,
                    symbol: undefined,
                    chartKey,
                    isCommonX: true // X   
                })));
            }
        }
        // 2.    
        if (this.commonEvents.chart) {
            if (Array.isArray(this.commonEvents.chart)) {
                //  : EventMarker[] ->   visibleChartKey  
                const defaultChartKey = this.state.visibleChartKeys[0];
                if (defaultChartKey) {
                    allEvents.push(...this.commonEvents.chart.map(e => ({
                        ...e,
                        chartKey: defaultChartKey,
                        symbol: undefined
                    })));
                }
            }
            else {
                //  : { [key: string]: EventMarker[] }
                //        
                for (const chartKey of this.state.visibleChartKeys) {
                    const events = this.commonEvents.chart[chartKey];
                    if (events && events.length > 0) {
                        allEvents.push(...events.map(e => ({ ...e, chartKey, symbol: undefined })));
                    }
                }
            }
        }
        // 3.     (  )
        //    chartKey 
        this.dataMap.forEach((value, symbol) => {
            if (!this.state.enabledTickers.has(symbol))
                return;
            //  chartKey  
            for (const chartKey of this.state.visibleChartKeys) {
                const chartDataObj = value.data[chartKey];
                if (chartDataObj && chartDataObj.events && chartDataObj.events.length > 0) {
                    // symbol   (  symbol   symbol )
                    allEvents.push(...chartDataObj.events.map(e => {
                        const eventWithSymbol = { ...e, chartKey };
                        eventWithSymbol.symbol = symbol; //  symbol 
                        return eventWithSymbol;
                    }));
                }
            }
        });
        if (allEvents.length === 0)
            return;
        //     
        this.eventMarkers = [];
        //     (render   )
        this.eventTooltipsToRender = [];
        //   
        const rangeEvents = [];
        const xOnlyEvents = [];
        const yOnlyEvents = [];
        const xyEvents = [];
        const multiPointEvents = [];
        allEvents.forEach(event => {
            if (isRangeEvent(event)) {
                rangeEvents.push(event);
            }
            else if (isMultiPointEvent(event)) {
                multiPointEvents.push(event);
            }
            else if (isXPointEvent(event)) {
                xOnlyEvents.push(event);
            }
            else if (isYPointEvent(event)) {
                yOnlyEvents.push(event);
            }
            else if (isXYPointEvent(event)) {
                xyEvents.push(event);
            }
        });
        // 0:    ( ,       )
        rangeEvents.forEach(event => {
            if (!isRangeEvent(event))
                return;
            //  
            let eventColor = event.color;
            if (!eventColor && event.symbol) {
                const symbolData = this.dataMap.get(event.symbol);
                if (symbolData?.color) {
                    eventColor = symbolData.color;
                }
                else {
                    eventColor = this.getTickerColor(event.symbol);
                }
            }
            if (!eventColor) {
                eventColor = this.getDefaultEventColor(true); //   ()
            }
            // XY   ( +  )
            if (isXYRangeEvent(event)) {
                const startX = event.startX;
                const endX = event.endX;
                const startY = event.startY;
                const endY = event.endY;
                if (startX >= minTime && startX <= maxTime || endX >= minTime && endX <= maxTime || (startX <= minTime && endX >= maxTime)) {
                    const x1 = this.getX(Math.max(startX, minTime), minTime, maxTime);
                    const x2 = this.getX(Math.min(endX, maxTime), minTime, maxTime);
                    const chartKey = event.chartKey || this.state.visibleChartKeys[0];
                    //      
                    if (!this.state.visibleChartKeys.includes(chartKey)) {
                        return;
                    }
                    const area = chartAreas.find(a => a.key === chartKey);
                    if (area) {
                        // minMaxByChartKey drawChartKey  , normalize      
                        let globalMin = Infinity, globalMax = -Infinity;
                        let usedChartKeyRange = false;
                        //  minMaxByChartKey  (normalize  )
                        if (minMaxByChartKey && event.symbol) {
                            const chartMinMax = minMaxByChartKey.get(chartKey);
                            if (chartMinMax) {
                                const symbolMinMax = chartMinMax.get(event.symbol);
                                if (symbolMinMax) {
                                    globalMin = symbolMinMax.min;
                                    globalMax = symbolMinMax.max;
                                    usedChartKeyRange = true;
                                }
                            }
                        }
                        // minMaxByChartKey    fallback
                        if (!usedChartKeyRange && event.symbol) {
                            const symbolData = this.dataMap.get(event.symbol);
                            if (symbolData) {
                                const chartDataObj = symbolData.data[chartKey];
                                if (chartDataObj) {
                                    const values = chartDataObj.datas.map(d => d.y).filter(v => v !== null && v !== undefined);
                                    if (values.length > 0) {
                                        globalMin = Math.min(...values);
                                        globalMax = Math.max(...values);
                                        usedChartKeyRange = true;
                                    }
                                }
                            }
                        }
                        // symbol     :   
                        if (!usedChartKeyRange) {
                            this.dataMap.forEach((value) => {
                                const chartDataObj = value.data[chartKey];
                                if (chartDataObj) {
                                    const values = chartDataObj.datas.map(d => d.y).filter(v => v !== null && v !== undefined);
                                    if (values.length > 0) {
                                        globalMin = Math.min(globalMin, ...values);
                                        globalMax = Math.max(globalMax, ...values);
                                    }
                                }
                            });
                        }
                        if (globalMin !== Infinity && globalMax !== -Infinity) {
                            //   Y  0-100%  
                            let normalizedStartY = startY;
                            let normalizedEndY = endY;
                            if (this.state.normalize === 'rangeNormalize' || this.state.normalize === 'normalize') {
                                // startY, endY globalMin~globalMax  0~100  
                                normalizedStartY = ((startY - globalMin) / (globalMax - globalMin)) * 100;
                                normalizedEndY = ((endY - globalMin) / (globalMax - globalMin)) * 100;
                                //    0~100  min/max 
                                globalMin = 0;
                                globalMax = 100;
                            }
                            // Y      
                            const rangeMin = Math.min(normalizedStartY, normalizedEndY);
                            const rangeMax = Math.max(normalizedStartY, normalizedEndY);
                            //        
                            if (rangeMax < globalMin || rangeMin > globalMax) {
                                return;
                            }
                            const y1Raw = this.getY(normalizedStartY, globalMin, globalMax, area.y, area.height);
                            const y2Raw = this.getY(normalizedEndY, globalMin, globalMax, area.y, area.height);
                            // Y     
                            const y1 = Math.max(area.y, Math.min(area.y + area.height, y1Raw));
                            const y2 = Math.max(area.y, Math.min(area.y + area.height, y2Raw));
                            const rectY = Math.min(y1, y2);
                            const rectHeight = Math.abs(y2 - y1);
                            //  
                            const isHovered = this.hoveredEventMarker !== null &&
                                this.hoveredEventMarker.label === event.label &&
                                isRangeEvent(this.hoveredEventMarker);
                            //  
                            const fillStyle = this.config.eventRangeFillStyle
                                ? (typeof this.config.eventRangeFillStyle === 'function'
                                    ? this.config.eventRangeFillStyle(event, isHovered)
                                    : this.config.eventRangeFillStyle)
                                : (eventColor.includes('rgba') ? eventColor : eventColor + '33');
                            const strokeStyle = this.config.eventRangeStrokeStyle
                                ? (typeof this.config.eventRangeStrokeStyle === 'function'
                                    ? this.config.eventRangeStrokeStyle(event)
                                    : this.config.eventRangeStrokeStyle)
                                : (eventColor.includes('rgba') ? eventColor.replace(/[\d.]+\)$/g, '0.5)') : eventColor);
                            const lineWidth = this.config.eventRangeLineWidth
                                ? (typeof this.config.eventRangeLineWidth === 'function'
                                    ? this.config.eventRangeLineWidth(event)
                                    : this.config.eventRangeLineWidth)
                                : 1;
                            //   (   )
                            this.ctx.save();
                            this.ctx.beginPath();
                            this.ctx.rect(this.chartAreaLeft, area.y, this.chartAreaWidth, area.height);
                            this.ctx.clip();
                            this.ctx.fillStyle = fillStyle;
                            this.ctx.fillRect(x1, rectY, x2 - x1, rectHeight);
                            this.ctx.strokeStyle = strokeStyle;
                            this.ctx.lineWidth = lineWidth;
                            this.ctx.strokeRect(x1, rectY, x2 - x1, rectHeight);
                            this.ctx.restore();
                            //  (startX, startY   )
                            const labelX = x1;
                            const labelY = y1; // startY   
                            const baseline = startY < endY ? 'top' : 'bottom'; // startY   top   
                            this.drawRangeEventLabel(event, labelX, labelY, eventColor, 'left', baseline);
                            //  
                            this.checkRangeEventHover(event, labelX, labelY);
                        }
                    }
                }
            }
            // X   ( )
            else if (isXRangeEvent(event)) {
                const startX = event.startX;
                const endX = event.endX;
                if (startX >= minTime && startX <= maxTime || endX >= minTime && endX <= maxTime || (startX <= minTime && endX >= maxTime)) {
                    const x1 = this.getX(Math.max(startX, minTime), minTime, maxTime);
                    const x2 = this.getX(Math.min(endX, maxTime), minTime, maxTime);
                    //  
                    const isHovered = this.hoveredEventMarker !== null &&
                        this.hoveredEventMarker.label === event.label &&
                        isRangeEvent(this.hoveredEventMarker);
                    //  
                    const fillStyle = this.config.eventRangeFillStyle
                        ? (typeof this.config.eventRangeFillStyle === 'function'
                            ? this.config.eventRangeFillStyle(event, isHovered)
                            : this.config.eventRangeFillStyle)
                        : (eventColor.includes('rgba') ? eventColor : eventColor + '33');
                    const strokeStyle = this.config.eventRangeStrokeStyle
                        ? (typeof this.config.eventRangeStrokeStyle === 'function'
                            ? this.config.eventRangeStrokeStyle(event)
                            : this.config.eventRangeStrokeStyle)
                        : (eventColor.includes('rgba') ? eventColor.replace(/[\d.]+\)$/g, '0.5)') : eventColor);
                    const lineWidth = this.config.eventRangeLineWidth
                        ? (typeof this.config.eventRangeLineWidth === 'function'
                            ? this.config.eventRangeLineWidth(event)
                            : this.config.eventRangeLineWidth)
                        : 1;
                    //     
                    chartAreas.forEach(area => {
                        //   (   )
                        this.ctx.save();
                        this.ctx.beginPath();
                        this.ctx.rect(this.chartAreaLeft, area.y, this.chartAreaWidth, area.height);
                        this.ctx.clip();
                        this.ctx.fillStyle = fillStyle;
                        this.ctx.fillRect(x1, area.y, x2 - x1, area.height);
                        this.ctx.strokeStyle = strokeStyle;
                        this.ctx.lineWidth = lineWidth;
                        this.ctx.strokeRect(x1, area.y, x2 - x1, area.height);
                        this.ctx.restore();
                    });
                    //  (startX ,   )
                    const labelX = x1;
                    const labelY = chartAreas[0].y;
                    this.drawRangeEventLabel(event, labelX, labelY, eventColor, 'left');
                    //  
                    this.checkRangeEventHover(event, labelX, labelY);
                }
            }
            // Y   ( )
            else if (isYRangeEvent(event)) {
                const startY = event.startY;
                const endY = event.endY;
                const chartKey = event.chartKey || this.state.visibleChartKeys[0];
                //      
                if (!this.state.visibleChartKeys.includes(chartKey)) {
                    return;
                }
                const area = chartAreas.find(a => a.key === chartKey);
                if (area) {
                    // minMaxByChartKey drawChartKey  , normalize      
                    let globalMin = Infinity, globalMax = -Infinity;
                    let usedChartKeyRange = false;
                    //  minMaxByChartKey  (normalize  )
                    if (minMaxByChartKey && event.symbol) {
                        const chartMinMax = minMaxByChartKey.get(chartKey);
                        if (chartMinMax) {
                            const symbolMinMax = chartMinMax.get(event.symbol);
                            if (symbolMinMax) {
                                globalMin = symbolMinMax.min;
                                globalMax = symbolMinMax.max;
                                usedChartKeyRange = true;
                            }
                        }
                    }
                    // minMaxByChartKey    fallback
                    if (!usedChartKeyRange && event.symbol) {
                        const symbolData = this.dataMap.get(event.symbol);
                        if (symbolData) {
                            const chartDataObj = symbolData.data[chartKey];
                            if (chartDataObj) {
                                const values = chartDataObj.datas.map(d => d.y).filter(v => v !== null && v !== undefined);
                                if (values.length > 0) {
                                    globalMin = Math.min(...values);
                                    globalMax = Math.max(...values);
                                    usedChartKeyRange = true;
                                }
                            }
                        }
                    }
                    // symbol     :   
                    if (!usedChartKeyRange) {
                        this.dataMap.forEach((value) => {
                            const chartDataObj = value.data[chartKey];
                            if (chartDataObj) {
                                const values = chartDataObj.datas.map(d => d.y).filter(v => v !== null && v !== undefined);
                                if (values.length > 0) {
                                    globalMin = Math.min(globalMin, ...values);
                                    globalMax = Math.max(globalMax, ...values);
                                }
                            }
                        });
                    }
                    if (globalMin !== Infinity && globalMax !== -Infinity) {
                        //   Y  0-100%  
                        let normalizedStartY = startY;
                        let normalizedEndY = endY;
                        if (this.state.normalize === 'rangeNormalize' || this.state.normalize === 'normalize') {
                            // startY, endY globalMin~globalMax  0~100  
                            normalizedStartY = ((startY - globalMin) / (globalMax - globalMin)) * 100;
                            normalizedEndY = ((endY - globalMin) / (globalMax - globalMin)) * 100;
                            //    0~100  min/max 
                            globalMin = 0;
                            globalMax = 100;
                        }
                        // Y      
                        const rangeMin = Math.min(normalizedStartY, normalizedEndY);
                        const rangeMax = Math.max(normalizedStartY, normalizedEndY);
                        //        
                        if (rangeMax < globalMin || rangeMin > globalMax) {
                            return;
                        }
                        const y1Raw = this.getY(normalizedStartY, globalMin, globalMax, area.y, area.height);
                        const y2Raw = this.getY(normalizedEndY, globalMin, globalMax, area.y, area.height);
                        // Y     
                        const y1 = Math.max(area.y, Math.min(area.y + area.height, y1Raw));
                        const y2 = Math.max(area.y, Math.min(area.y + area.height, y2Raw));
                        const rectY = Math.min(y1, y2);
                        const rectHeight = Math.abs(y2 - y1);
                        //  
                        const isHovered = this.hoveredEventMarker !== null &&
                            this.hoveredEventMarker.label === event.label &&
                            isRangeEvent(this.hoveredEventMarker);
                        //  
                        const fillStyle = this.config.eventRangeFillStyle
                            ? (typeof this.config.eventRangeFillStyle === 'function'
                                ? this.config.eventRangeFillStyle(event, isHovered)
                                : this.config.eventRangeFillStyle)
                            : (eventColor.includes('rgba') ? eventColor : eventColor + '33');
                        const strokeStyle = this.config.eventRangeStrokeStyle
                            ? (typeof this.config.eventRangeStrokeStyle === 'function'
                                ? this.config.eventRangeStrokeStyle(event)
                                : this.config.eventRangeStrokeStyle)
                            : (eventColor.includes('rgba') ? eventColor.replace(/[\d.]+\)$/g, '0.5)') : eventColor);
                        const lineWidth = this.config.eventRangeLineWidth
                            ? (typeof this.config.eventRangeLineWidth === 'function'
                                ? this.config.eventRangeLineWidth(event)
                                : this.config.eventRangeLineWidth)
                            : 1;
                        //   (   )
                        this.ctx.save();
                        this.ctx.beginPath();
                        this.ctx.rect(this.chartAreaLeft, area.y, this.chartAreaWidth, area.height);
                        this.ctx.clip();
                        //  X   
                        this.ctx.fillStyle = fillStyle;
                        this.ctx.fillRect(this.chartAreaLeft, rectY, this.chartAreaWidth, rectHeight);
                        this.ctx.strokeStyle = strokeStyle;
                        this.ctx.lineWidth = lineWidth;
                        this.ctx.strokeRect(this.chartAreaLeft, rectY, this.chartAreaWidth, rectHeight);
                        this.ctx.restore();
                        //  (startY   )
                        const labelX = this.chartAreaLeft;
                        const labelY = y1; // startY    ()
                        // baseline :   startY/endY  
                        let baseline;
                        if (y1Raw < area.y) {
                            // startY      
                            baseline = 'top';
                        }
                        else if (y1Raw > area.y + area.height) {
                            // startY      
                            baseline = 'bottom';
                        }
                        else {
                            // startY     
                            baseline = startY < endY ? 'top' : 'bottom';
                        }
                        this.drawRangeEventLabel(event, labelX, labelY, eventColor, 'left', baseline);
                        //  
                        this.checkRangeEventHover(event, labelX, labelY);
                    }
                }
            }
        });
        // 0.5:     (PointEvent -    /)
        multiPointEvents.forEach(event => {
            if (!isMultiPointEvent(event))
                return;
            //  
            let eventColor = event.color;
            if (!eventColor && event.symbol) {
                const symbolData = this.dataMap.get(event.symbol);
                if (symbolData?.color) {
                    eventColor = symbolData.color;
                }
                else {
                    eventColor = this.getTickerColor(event.symbol);
                }
            }
            if (!eventColor) {
                eventColor = this.getDefaultEventColor();
            }
            const chartKey = event.chartKey || this.state.visibleChartKeys[0];
            //      
            if (!this.state.visibleChartKeys.includes(chartKey)) {
                return;
            }
            const area = chartAreas.find(a => a.key === chartKey);
            if (!area)
                return;
            //    
            // minMaxByChartKey drawChartKey  , normalize      
            let globalMin = Infinity, globalMax = -Infinity;
            let usedChartKeyRange = false;
            //  minMaxByChartKey  (normalize  )
            if (minMaxByChartKey && event.symbol) {
                const chartMinMax = minMaxByChartKey.get(chartKey);
                if (chartMinMax) {
                    const symbolMinMax = chartMinMax.get(event.symbol);
                    if (symbolMinMax) {
                        globalMin = symbolMinMax.min;
                        globalMax = symbolMinMax.max;
                        usedChartKeyRange = true;
                    }
                }
            }
            // minMaxByChartKey    fallback
            if (!usedChartKeyRange && event.symbol) {
                const symbolData = this.dataMap.get(event.symbol);
                if (symbolData) {
                    const chartDataObj = symbolData.data[chartKey];
                    if (chartDataObj) {
                        const values = chartDataObj.datas.map(d => d.y).filter(v => v !== null && v !== undefined);
                        if (values.length > 0) {
                            globalMin = Math.min(...values);
                            globalMax = Math.max(...values);
                            usedChartKeyRange = true;
                        }
                    }
                }
            }
            // symbol     :   
            if (!usedChartKeyRange) {
                this.dataMap.forEach((value) => {
                    const chartDataObj = value.data[chartKey];
                    if (chartDataObj) {
                        const values = chartDataObj.datas.map(d => d.y).filter(v => v !== null && v !== undefined);
                        if (values.length > 0) {
                            globalMin = Math.min(globalMin, ...values);
                            globalMax = Math.max(globalMax, ...values);
                        }
                    }
                });
            }
            if (globalMin === Infinity || globalMax === -Infinity)
                return;
            //   Y  0-100%  
            const originalMin = globalMin;
            const originalMax = globalMax;
            if (this.state.normalize === 'rangeNormalize' || this.state.normalize === 'normalize') {
                globalMin = 0;
                globalMax = 100;
            }
            //  
            this.ctx.save();
            this.ctx.beginPath();
            this.ctx.rect(this.chartAreaLeft, area.y, this.chartAreaWidth, area.height);
            this.ctx.clip();
            //  
            const strokeStyle = event.strokeStyle || eventColor;
            const fillStyle = event.fillStyle;
            this.ctx.strokeStyle = strokeStyle;
            this.ctx.lineWidth = 2;
            this.ctx.lineJoin = 'round';
            this.ctx.lineCap = 'round';
            //  
            this.ctx.beginPath();
            event.points.forEach((point, index) => {
                const x = this.getX(point.x, minTime, maxTime);
                //   Y  
                let normalizedY = point.y;
                if (this.state.normalize === 'rangeNormalize' || this.state.normalize === 'normalize') {
                    normalizedY = ((point.y - originalMin) / (originalMax - originalMin)) * 100;
                }
                const y = this.getY(normalizedY, globalMin, globalMax, area.y, area.height);
                if (index === 0) {
                    this.ctx.moveTo(x, y);
                }
                else {
                    if (event.smooth) {
                        //   
                        const prevPoint = event.points[index - 1];
                        const prevX = this.getX(prevPoint.x, minTime, maxTime);
                        //   Y  
                        let prevNormalizedY = prevPoint.y;
                        if (this.state.normalize === 'rangeNormalize' || this.state.normalize === 'normalize') {
                            prevNormalizedY = ((prevPoint.y - originalMin) / (originalMax - originalMin)) * 100;
                        }
                        const prevY = this.getY(prevNormalizedY, globalMin, globalMax, area.y, area.height);
                        //   (   )
                        const cp1x = prevX + (x - prevX) / 3;
                        const cp1y = prevY;
                        const cp2x = prevX + (x - prevX) * 2 / 3;
                        const cp2y = y;
                        this.ctx.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, x, y);
                    }
                    else {
                        this.ctx.lineTo(x, y);
                    }
                }
            });
            //  (fillStyle )
            if (fillStyle) {
                this.ctx.closePath();
                this.ctx.fillStyle = fillStyle;
                this.ctx.fill();
            }
            //  
            if (strokeStyle) {
                this.ctx.stroke();
            }
            //       
            // fillStyle       
            if (!fillStyle) {
                event.points.forEach((point, index) => {
                    const x = this.getX(point.x, minTime, maxTime);
                    //   Y  
                    let normalizedY = point.y;
                    if (this.state.normalize === 'rangeNormalize' || this.state.normalize === 'normalize') {
                        normalizedY = ((point.y - originalMin) / (originalMax - originalMin)) * 100;
                    }
                    const y = this.getY(normalizedY, globalMin, globalMax, area.y, area.height);
                    const pointEvent = {
                        ...event,
                        x: point.x,
                        y: point.y,
                        pointIndex: index
                    };
                    this.eventMarkers.push({
                        event: pointEvent,
                        x,
                        y,
                        radius: 8
                    });
                    //     
                    const isHovered = this.hoveredEventMarker !== null &&
                        this.hoveredEventMarker.label === event.label &&
                        this.hoveredEventMarker.x === point.x &&
                        this.hoveredEventMarker.y === point.y;
                    if (isHovered) {
                        this.eventTooltipsToRender.push({
                            event: pointEvent,
                            x,
                            y: y - 10,
                            pointsDown: false
                        });
                    }
                });
            }
            //    
            event.points.forEach((point, index) => {
                const x = this.getX(point.x, minTime, maxTime);
                //   Y  
                let normalizedY = point.y;
                if (this.state.normalize === 'rangeNormalize' || this.state.normalize === 'normalize') {
                    normalizedY = ((point.y - originalMin) / (originalMax - originalMin)) * 100;
                }
                const y = this.getY(normalizedY, globalMin, globalMax, area.y, area.height);
                if (point.xPointType || point.yPointType) {
                    const pointType = point.xPointType || point.yPointType || 'dot';
                    if (pointType === 'dot') {
                        this.ctx.fillStyle = strokeStyle;
                        this.ctx.beginPath();
                        this.ctx.arc(x, y, 3, 0, Math.PI * 2);
                        this.ctx.fill();
                    }
                    else if (pointType === 'rightArrow') {
                        //  :  x, y 
                        this.ctx.fillStyle = strokeStyle;
                        this.ctx.beginPath();
                        this.ctx.moveTo(x - 8, y - 4);
                        this.ctx.lineTo(x, y);
                        this.ctx.lineTo(x - 8, y + 4);
                        this.ctx.closePath();
                        this.ctx.fill();
                    }
                    else if (pointType === 'leftArrow') {
                        //  :  x, y 
                        this.ctx.fillStyle = strokeStyle;
                        this.ctx.beginPath();
                        this.ctx.moveTo(x + 8, y - 4);
                        this.ctx.lineTo(x, y);
                        this.ctx.lineTo(x + 8, y + 4);
                        this.ctx.closePath();
                        this.ctx.fill();
                    }
                    else if (pointType === 'rightArrowDot') {
                        //   +  ():   x, y 
                        this.ctx.fillStyle = strokeStyle;
                        this.ctx.beginPath();
                        this.ctx.moveTo(x - 6, y - 4);
                        this.ctx.lineTo(x, y);
                        this.ctx.lineTo(x - 6, y + 4);
                        this.ctx.closePath();
                        this.ctx.fill();
                        //  ( )
                        this.ctx.beginPath();
                        this.ctx.arc(x, y, 1.5, 0, Math.PI * 2);
                        this.ctx.fill();
                    }
                    else if (pointType === 'leftArrowDot') {
                        //   +  ():   x, y 
                        this.ctx.fillStyle = strokeStyle;
                        this.ctx.beginPath();
                        this.ctx.moveTo(x + 6, y - 4);
                        this.ctx.lineTo(x, y);
                        this.ctx.lineTo(x + 6, y + 4);
                        this.ctx.closePath();
                        this.ctx.fill();
                        //  ( )
                        this.ctx.beginPath();
                        this.ctx.arc(x, y, 1.5, 0, Math.PI * 2);
                        this.ctx.fill();
                    }
                    else if (pointType === 'rightArrowLine') {
                        //   +  (|):   x, y 
                        this.ctx.fillStyle = strokeStyle;
                        this.ctx.beginPath();
                        this.ctx.moveTo(x - 6, y - 4);
                        this.ctx.lineTo(x, y);
                        this.ctx.lineTo(x - 6, y + 4);
                        this.ctx.closePath();
                        this.ctx.fill();
                        //  ( )
                        this.ctx.strokeStyle = strokeStyle;
                        this.ctx.lineWidth = 2;
                        this.ctx.beginPath();
                        this.ctx.moveTo(x, y - 5);
                        this.ctx.lineTo(x, y + 5);
                        this.ctx.stroke();
                    }
                    else if (pointType === 'leftArrowLine') {
                        //   +  (|):   x, y 
                        this.ctx.fillStyle = strokeStyle;
                        this.ctx.beginPath();
                        this.ctx.moveTo(x + 6, y - 4);
                        this.ctx.lineTo(x, y);
                        this.ctx.lineTo(x + 6, y + 4);
                        this.ctx.closePath();
                        this.ctx.fill();
                        //  ( )
                        this.ctx.strokeStyle = strokeStyle;
                        this.ctx.lineWidth = 2;
                        this.ctx.beginPath();
                        this.ctx.moveTo(x, y - 5);
                        this.ctx.lineTo(x, y + 5);
                        this.ctx.stroke();
                    }
                }
            });
            this.ctx.restore();
            // fillStyle  :   / 
            // fillStyle  :   /  (  )
            if (fillStyle && event.points.length > 0) {
                const firstPoint = event.points[0];
                const labelX = this.getX(firstPoint.x, minTime, maxTime);
                //   Y  
                let normalizedY = firstPoint.y;
                if (this.state.normalize === 'rangeNormalize' || this.state.normalize === 'normalize') {
                    normalizedY = ((firstPoint.y - originalMin) / (originalMax - originalMin)) * 100;
                }
                const labelY = this.getY(normalizedY, globalMin, globalMax, area.y, area.height);
                //   
                const labelFormatted = this.config.eventLabelFormat
                    ? this.config.eventLabelFormat(event)
                    : event.label;
                const labelText = this.applyFormatResult(labelFormatted);
                this.ctx.fillStyle = strokeStyle;
                this.ctx.font = 'bold 11px Arial';
                this.ctx.textAlign = 'left';
                this.ctx.textBaseline = 'bottom';
                const textMetrics = this.ctx.measureText(labelText);
                this.ctx.fillText(labelText, labelX + 5, labelY - 5);
                //     
                this.eventMarkers.push({
                    event,
                    x: labelX + 5 + textMetrics.width / 2,
                    y: labelY - 5 - 6, //   
                    radius: Math.max(textMetrics.width / 2, 10)
                });
                //     
                const isHovered = this.hoveredEventMarker !== null &&
                    this.hoveredEventMarker.label === event.label;
                if (isHovered) {
                    this.eventTooltipsToRender.push({
                        event,
                        x: labelX + 5 + textMetrics.width / 2,
                        y: labelY - 20,
                        pointsDown: false
                    });
                }
            }
            else if (event.points.length > 0) {
                // fillStyle    
                const firstPoint = event.points[0];
                const labelX = this.getX(firstPoint.x, minTime, maxTime);
                //   Y  
                let normalizedY = firstPoint.y;
                if (this.state.normalize === 'rangeNormalize' || this.state.normalize === 'normalize') {
                    normalizedY = ((firstPoint.y - originalMin) / (originalMax - originalMin)) * 100;
                }
                const labelY = this.getY(normalizedY, globalMin, globalMax, area.y, area.height);
                //   
                const labelFormatted = this.config.eventLabelFormat
                    ? this.config.eventLabelFormat(event)
                    : event.label;
                const labelText = this.applyFormatResult(labelFormatted);
                this.ctx.fillStyle = strokeStyle;
                this.ctx.font = 'bold 11px Arial';
                this.ctx.textAlign = 'left';
                this.ctx.textBaseline = 'bottom';
                this.ctx.fillText(labelText, labelX + 5, labelY - 5);
            }
        });
        // 1: X-only   ( )
        xOnlyEvents.forEach(event => {
            //  : 1.   color, 2.  color, 3.   , 4.  
            let eventColor = event.color;
            if (!eventColor && event.symbol) {
                const symbolData = this.dataMap.get(event.symbol);
                if (symbolData?.color) {
                    eventColor = symbolData.color;
                }
                else {
                    eventColor = this.getTickerColor(event.symbol);
                }
            }
            if (!eventColor) {
                eventColor = this.getDefaultEventColor(); //   
            }
            // X  
            const xTime = event.x;
            const eventChartKey = event.chartKey;
            const isCommonX = event.isCommonX; //  X  
            // X  ( )
            if (xTime >= minTime && xTime <= maxTime) {
                //  X  :   ,    
                //  X  :    
                if (isCommonX) {
                    //  X :  visible   
                    const x = this.getX(xTime, minTime, maxTime);
                    //  
                    const strokeStyle = this.config.eventXStrokeStyle
                        ? (typeof this.config.eventXStrokeStyle === 'function'
                            ? this.config.eventXStrokeStyle(event)
                            : this.config.eventXStrokeStyle)
                        : eventColor;
                    const lineWidth = this.config.eventXLineWidth
                        ? (typeof this.config.eventXLineWidth === 'function'
                            ? this.config.eventXLineWidth(event)
                            : this.config.eventXLineWidth)
                        : 2;
                    const lineDash = this.config.eventXLineDash
                        ? (typeof this.config.eventXLineDash === 'function'
                            ? this.config.eventXLineDash(event)
                            : this.config.eventXLineDash)
                        : [];
                    this.ctx.strokeStyle = strokeStyle;
                    this.ctx.lineWidth = lineWidth;
                    this.ctx.setLineDash(lineDash);
                    //     
                    chartAreas.forEach(area => {
                        this.ctx.beginPath();
                        this.ctx.moveTo(x, area.y);
                        this.ctx.lineTo(x, area.y + area.height);
                        this.ctx.stroke();
                    });
                    this.ctx.setLineDash([]);
                    //     
                    const firstArea = chartAreas[0];
                    if (firstArea && eventChartKey === firstArea.key) {
                        //    (X-only  )
                        const labelFormatted = this.config.eventLabelFormat
                            ? this.config.eventLabelFormat(event)
                            : event.label;
                        const labelText = this.applyFormatResult(labelFormatted);
                        //    (90   ,   )
                        const labelY = firstArea.y; //     
                        this.ctx.save();
                        this.ctx.translate(x, labelY);
                        this.ctx.rotate(Math.PI / 2); // 90   ( )
                        this.ctx.fillStyle = strokeStyle;
                        this.ctx.font = 'bold 11px Arial';
                        this.ctx.textAlign = 'left'; //      
                        this.ctx.textBaseline = 'top'; //  
                        const textMetrics = this.ctx.measureText(labelText);
                        this.ctx.fillText(labelText, 5, 0); //    
                        this.ctx.restore();
                        //     (  )
                        const lineHitWidth = 10;
                        this.eventMarkers.push({
                            event,
                            x: x,
                            y: (chartAreas[0].y + chartAreas[chartAreas.length - 1].y + chartAreas[chartAreas.length - 1].height) / 2, //   
                            radius: lineHitWidth / 2
                        });
                        //     
                        const isHovered = this.hoveredEventMarker !== null &&
                            this.hoveredEventMarker.label === event.label &&
                            isXPointEvent(this.hoveredEventMarker) &&
                            this.hoveredEventMarker.x === event.x;
                        if (isHovered) {
                            this.eventTooltipsToRender.push({ event, x, y: labelY + 20, pointsDown: true });
                        }
                    }
                }
                else {
                    //  X :    
                    const chartKey = eventChartKey || this.state.visibleChartKeys[0];
                    //      
                    if (!this.state.visibleChartKeys.includes(chartKey)) {
                        return;
                    }
                    const area = chartAreas.find(a => a.key === chartKey);
                    if (!area) {
                        return;
                    }
                    const x = this.getX(xTime, minTime, maxTime);
                    //  
                    const strokeStyle = this.config.eventXStrokeStyle
                        ? (typeof this.config.eventXStrokeStyle === 'function'
                            ? this.config.eventXStrokeStyle(event)
                            : this.config.eventXStrokeStyle)
                        : eventColor;
                    const lineWidth = this.config.eventXLineWidth
                        ? (typeof this.config.eventXLineWidth === 'function'
                            ? this.config.eventXLineWidth(event)
                            : this.config.eventXLineWidth)
                        : 2;
                    const lineDash = this.config.eventXLineDash
                        ? (typeof this.config.eventXLineDash === 'function'
                            ? this.config.eventXLineDash(event)
                            : this.config.eventXLineDash)
                        : [];
                    //     
                    this.ctx.strokeStyle = strokeStyle;
                    this.ctx.lineWidth = lineWidth;
                    this.ctx.setLineDash(lineDash);
                    this.ctx.beginPath();
                    this.ctx.moveTo(x, area.y);
                    this.ctx.lineTo(x, area.y + area.height);
                    this.ctx.stroke();
                    this.ctx.setLineDash([]);
                    //    (X-only  )
                    const labelFormatted = this.config.eventLabelFormat
                        ? this.config.eventLabelFormat(event)
                        : event.label;
                    const labelText = this.applyFormatResult(labelFormatted);
                    //    (90   ,   )
                    const labelY = area.y; //    
                    this.ctx.save();
                    this.ctx.translate(x, labelY);
                    this.ctx.rotate(Math.PI / 2); // 90   ( )
                    this.ctx.fillStyle = strokeStyle;
                    this.ctx.font = 'bold 11px Arial';
                    this.ctx.textAlign = 'left'; //      
                    this.ctx.textBaseline = 'top'; //  
                    const textMetrics = this.ctx.measureText(labelText);
                    this.ctx.fillText(labelText, 5, 0); //    
                    this.ctx.restore();
                    //     (   -  )
                    const lineHitWidth = 10;
                    this.eventMarkers.push({
                        event,
                        x: x,
                        y: area.y + area.height / 2, //   
                        radius: lineHitWidth / 2
                    });
                    //     
                    const isHovered = this.hoveredEventMarker !== null &&
                        this.hoveredEventMarker.label === event.label &&
                        isXPointEvent(this.hoveredEventMarker) &&
                        this.hoveredEventMarker.x === event.x;
                    if (isHovered) {
                        this.eventTooltipsToRender.push({ event, x, y: labelY + 20, pointsDown: true });
                    }
                }
            }
        });
        // 2: Y-only   ( )
        yOnlyEvents.forEach(event => {
            //  
            let eventColor = event.color;
            if (!eventColor && event.symbol) {
                const symbolData = this.dataMap.get(event.symbol);
                if (symbolData?.color) {
                    eventColor = symbolData.color;
                }
                else {
                    eventColor = this.getTickerColor(event.symbol);
                }
            }
            if (!eventColor) {
                eventColor = this.getDefaultEventColor();
            }
            const yValue = event.y;
            const eventChartKey = event.chartKey;
            // Y  ( )
            if (yValue !== undefined) {
                const chartKey = event.chartKey || this.state.visibleChartKeys[0];
                const area = chartAreas.find(a => a.key === chartKey);
                if (area) {
                    // Y    
                    // minMaxByChartKey drawChartKey  , normalize      
                    let globalMin = Infinity, globalMax = -Infinity;
                    let usedChartKeyRange = false;
                    //  minMaxByChartKey  (normalize  )
                    if (minMaxByChartKey && event.symbol) {
                        const chartMinMax = minMaxByChartKey.get(chartKey);
                        if (chartMinMax) {
                            const symbolMinMax = chartMinMax.get(event.symbol);
                            if (symbolMinMax) {
                                globalMin = symbolMinMax.min;
                                globalMax = symbolMinMax.max;
                                usedChartKeyRange = true;
                            }
                        }
                    }
                    // minMaxByChartKey    fallback
                    if (!usedChartKeyRange && event.symbol) {
                        const symbolData = this.dataMap.get(event.symbol);
                        if (symbolData) {
                            const chartDataObj = symbolData.data[chartKey];
                            if (chartDataObj) {
                                const values = chartDataObj.datas.map(d => d.y).filter(v => v !== null && v !== undefined);
                                if (values.length > 0) {
                                    globalMin = Math.min(...values);
                                    globalMax = Math.max(...values);
                                    usedChartKeyRange = true;
                                }
                            }
                        }
                    }
                    // symbol     :   
                    if (!usedChartKeyRange) {
                        this.dataMap.forEach((value) => {
                            const chartDataObj = value.data[chartKey];
                            if (chartDataObj) {
                                const values = chartDataObj.datas.map(d => d.y).filter(v => v !== null && v !== undefined);
                                if (values.length > 0) {
                                    globalMin = Math.min(globalMin, ...values);
                                    globalMax = Math.max(globalMax, ...values);
                                }
                            }
                        });
                    }
                    if (globalMin !== Infinity && globalMax !== -Infinity) {
                        //   Y  0-100%  
                        let normalizedYValue = yValue;
                        if (this.state.normalize === 'rangeNormalize' || this.state.normalize === 'normalize') {
                            // yValue globalMin~globalMax  0~100  
                            normalizedYValue = ((yValue - globalMin) / (globalMax - globalMin)) * 100;
                            //    0~100  min/max 
                            globalMin = 0;
                            globalMax = 100;
                        }
                        // Y     (    )
                        const y = this.getY(normalizedYValue, globalMin, globalMax, area.y, area.height);
                        //  
                        const strokeStyle = this.config.eventYStrokeStyle
                            ? (typeof this.config.eventYStrokeStyle === 'function'
                                ? this.config.eventYStrokeStyle(event)
                                : this.config.eventYStrokeStyle)
                            : eventColor;
                        const lineWidth = this.config.eventYLineWidth
                            ? (typeof this.config.eventYLineWidth === 'function'
                                ? this.config.eventYLineWidth(event)
                                : this.config.eventYLineWidth)
                            : 2;
                        const lineDash = this.config.eventYLineDash
                            ? (typeof this.config.eventYLineDash === 'function'
                                ? this.config.eventYLineDash(event)
                                : this.config.eventYLineDash)
                            : [5, 5];
                        this.ctx.strokeStyle = strokeStyle;
                        this.ctx.lineWidth = lineWidth;
                        this.ctx.setLineDash(lineDash);
                        this.ctx.beginPath();
                        this.ctx.moveTo(this.chartAreaLeft, y);
                        this.ctx.lineTo(this.getChartRight(), y);
                        this.ctx.stroke();
                        this.ctx.setLineDash([]);
                        //    (Y-only  )
                        const labelFormatted = this.config.eventLabelFormat
                            ? this.config.eventLabelFormat(event)
                            : event.label;
                        const labelText = this.applyFormatResult(labelFormatted);
                        this.ctx.fillStyle = strokeStyle;
                        this.ctx.font = 'bold 11px Arial';
                        this.ctx.textAlign = 'left';
                        this.ctx.textBaseline = 'middle';
                        const labelX = this.chartAreaLeft;
                        const textMetrics = this.ctx.measureText(labelText);
                        this.ctx.fillText(labelText, labelX, y);
                        //     (   -  )
                        //   Y  , X     
                        const lineHitHeight = 10; //       ( 5px)
                        this.eventMarkers.push({
                            event,
                            x: (this.chartAreaLeft + this.getChartRight()) / 2, //  
                            y: y,
                            radius: lineHitHeight / 2 //   
                        });
                        //    
                        const isHovered = this.hoveredEventMarker !== null &&
                            this.hoveredEventMarker.label === event.label &&
                            isYPointEvent(this.hoveredEventMarker) &&
                            this.hoveredEventMarker.y === event.y;
                        if (isHovered) {
                            this.eventTooltipsToRender.push({ event, x: labelX + textMetrics.width / 2, y, pointsDown: true });
                        }
                    }
                }
            }
        });
        // 3: XY    (     )
        xyEvents.forEach(event => {
            //  
            let eventColor = event.color;
            if (!eventColor && event.symbol) {
                const symbolData = this.dataMap.get(event.symbol);
                if (symbolData?.color) {
                    eventColor = symbolData.color;
                }
                else {
                    eventColor = this.getTickerColor(event.symbol);
                }
            }
            if (!eventColor) {
                eventColor = this.getDefaultEventColor();
            }
            const xTime = event.x;
            const yValue = event.y;
            const eventChartKey = event.chartKey;
            // X Y   ( )
            if (xTime !== undefined && yValue !== undefined) {
                if (xTime >= minTime && xTime <= maxTime) {
                    const chartKey = event.chartKey || this.state.visibleChartKeys[0];
                    const area = chartAreas.find(a => a.key === chartKey);
                    if (area) {
                        // Y    
                        // minMaxByChartKey drawChartKey  , normalize      
                        // - normalize OFF:   global min/max
                        // - normalize ON:    min/max
                        let globalMin = Infinity, globalMax = -Infinity;
                        let usedChartKeyRange = false;
                        //  minMaxByChartKey  (normalize  )
                        if (minMaxByChartKey && event.symbol) {
                            const chartMinMax = minMaxByChartKey.get(chartKey);
                            if (chartMinMax) {
                                const symbolMinMax = chartMinMax.get(event.symbol);
                                if (symbolMinMax) {
                                    globalMin = symbolMinMax.min;
                                    globalMax = symbolMinMax.max;
                                    usedChartKeyRange = true;
                                }
                            }
                        }
                        // minMaxByChartKey    fallback
                        if (!usedChartKeyRange && event.symbol) {
                            const symbolData = this.dataMap.get(event.symbol);
                            if (symbolData) {
                                const chartDataObj = symbolData.data[chartKey];
                                if (chartDataObj) {
                                    const values = chartDataObj.datas.map(d => d.y).filter(v => v !== null && v !== undefined);
                                    if (values.length > 0) {
                                        globalMin = Math.min(...values);
                                        globalMax = Math.max(...values);
                                        usedChartKeyRange = true;
                                    }
                                }
                            }
                        }
                        // symbol     :   
                        if (!usedChartKeyRange) {
                            globalMin = Infinity;
                            globalMax = -Infinity;
                            this.dataMap.forEach((value) => {
                                const chartDataObj = value.data[chartKey];
                                if (chartDataObj) {
                                    const values = chartDataObj.datas.map(d => d.y).filter(v => v !== null && v !== undefined);
                                    if (values.length > 0) {
                                        globalMin = Math.min(globalMin, ...values);
                                        globalMax = Math.max(globalMax, ...values);
                                    }
                                }
                            });
                        }
                        if (globalMin !== Infinity && globalMax !== -Infinity) {
                            // Y        
                            const x = this.getX(xTime, minTime, maxTime);
                            // Y     
                            const clampedYValue = Math.max(globalMin, Math.min(globalMax, yValue));
                            const y = this.getY(clampedYValue, globalMin, globalMax, area.y, area.height);
                            // Y     (   )
                            const isOutOfRange = yValue < globalMin || yValue > globalMax;
                            //  : label x, y   (    )
                            const isHovered = this.hoveredEventMarker !== null &&
                                this.hoveredEventMarker.label === event.label &&
                                isXYPointEvent(this.hoveredEventMarker) &&
                                this.hoveredEventMarker.x === event.x &&
                                this.hoveredEventMarker.y === event.y;
                            //  
                            const arrowSize = this.config.eventArrowSize
                                ? (typeof this.config.eventArrowSize === 'function'
                                    ? this.config.eventArrowSize(event)
                                    : this.config.eventArrowSize)
                                : 16;
                            const arrowFillStyle = this.config.eventArrowFillStyle
                                ? (typeof this.config.eventArrowFillStyle === 'function'
                                    ? this.config.eventArrowFillStyle(event, isHovered)
                                    : this.config.eventArrowFillStyle)
                                : (isHovered ? eventColor : '#FFFFFF');
                            const arrowStrokeStyle = this.config.eventArrowStrokeStyle
                                ? (typeof this.config.eventArrowStrokeStyle === 'function'
                                    ? this.config.eventArrowStrokeStyle(event)
                                    : this.config.eventArrowStrokeStyle)
                                : eventColor;
                            const arrowLineWidth = this.config.eventArrowLineWidth
                                ? (typeof this.config.eventArrowLineWidth === 'function'
                                    ? this.config.eventArrowLineWidth(event)
                                    : this.config.eventArrowLineWidth)
                                : 2;
                            //    (: 'tag')
                            const markerType = event.type || 'tag';
                            // Y    50%     ( )
                            // Y    50%     ( )
                            const chartMidY = area.y + area.height / 2;
                            const pointsDown = y < chartMidY; // y    ( 50%)
                            //   
                            const labelFormatted = this.config.eventLabelFormat
                                ? this.config.eventLabelFormat(event)
                                : event.label;
                            const labelText = this.applyFormatResult(labelFormatted);
                            if (markerType === 'dot') {
                                // === DOT :   ===
                                this.ctx.beginPath();
                                this.ctx.arc(x, y, 5, 0, Math.PI * 2);
                                this.ctx.fillStyle = arrowFillStyle;
                                this.ctx.fill();
                                this.ctx.strokeStyle = arrowStrokeStyle;
                                this.ctx.lineWidth = arrowLineWidth;
                                this.ctx.stroke();
                                //   ( )
                                this.ctx.fillStyle = arrowStrokeStyle;
                                this.ctx.font = 'bold 11px Arial';
                                this.ctx.textAlign = 'left';
                                this.ctx.textBaseline = 'middle';
                                this.ctx.fillText(labelText, x + 8, y);
                                //    
                                this.eventMarkers.push({ event, x, y, radius: 8 });
                                //   
                                if (isHovered) {
                                    const tooltipY = pointsDown ? y + 15 : y - 15;
                                    this.eventTooltipsToRender.push({ event, x, y: tooltipY, pointsDown });
                                }
                            }
                            else if (markerType === 'arrow') {
                                // === ARROW : PointEvent   () ===
                                const arrowDirection = pointsDown ? 'down' : 'up';
                                this.ctx.fillStyle = arrowStrokeStyle;
                                this.ctx.beginPath();
                                if (arrowDirection === 'down') {
                                    //    
                                    this.ctx.moveTo(x - 6, y - 8);
                                    this.ctx.lineTo(x, y);
                                    this.ctx.lineTo(x + 6, y - 8);
                                }
                                else {
                                    //    
                                    this.ctx.moveTo(x - 6, y + 8);
                                    this.ctx.lineTo(x, y);
                                    this.ctx.lineTo(x + 6, y + 8);
                                }
                                this.ctx.closePath();
                                this.ctx.fill();
                                //   ( )
                                this.ctx.fillStyle = arrowStrokeStyle;
                                this.ctx.font = 'bold 11px Arial';
                                this.ctx.textAlign = 'left';
                                this.ctx.textBaseline = 'middle';
                                const labelX = x + 10;
                                const labelY = arrowDirection === 'down' ? y - 4 : y + 4;
                                this.ctx.fillText(labelText, labelX, labelY);
                                //    
                                this.eventMarkers.push({ event, x, y, radius: 10 });
                                //   
                                if (isHovered) {
                                    const tooltipY = pointsDown ? y + 15 : y - 15;
                                    this.eventTooltipsToRender.push({ event, x, y: tooltipY, pointsDown });
                                }
                            }
                            else {
                                // === TAG :  +  () ===
                                const arrowOffsetY = pointsDown ? -arrowSize * 0.8 : arrowSize * 0.8;
                                const arrowY = y + arrowOffsetY;
                                this.ctx.save();
                                this.ctx.translate(x, arrowY);
                                if (pointsDown) {
                                    //   
                                    this.ctx.beginPath();
                                    this.ctx.moveTo(-arrowSize / 2, -arrowSize * 0.6);
                                    this.ctx.lineTo(arrowSize / 2, -arrowSize * 0.6);
                                    this.ctx.lineTo(arrowSize / 2, 0);
                                    this.ctx.lineTo(0, arrowSize * 0.8);
                                    this.ctx.lineTo(-arrowSize / 2, 0);
                                    this.ctx.closePath();
                                }
                                else {
                                    //   
                                    this.ctx.beginPath();
                                    this.ctx.moveTo(0, -arrowSize * 0.8);
                                    this.ctx.lineTo(-arrowSize / 2, 0);
                                    this.ctx.lineTo(-arrowSize / 2, arrowSize * 0.6);
                                    this.ctx.lineTo(arrowSize / 2, arrowSize * 0.6);
                                    this.ctx.lineTo(arrowSize / 2, 0);
                                    this.ctx.closePath();
                                }
                                this.ctx.fillStyle = arrowFillStyle;
                                this.ctx.strokeStyle = arrowStrokeStyle;
                                this.ctx.lineWidth = arrowLineWidth;
                                this.ctx.fill();
                                this.ctx.stroke();
                                //     ( )
                                const markerTextFormatted = this.config.eventMarkerTextFormat
                                    ? this.config.eventMarkerTextFormat(event)
                                    : event.label.charAt(0).toUpperCase();
                                const markerText = this.applyFormatResult(markerTextFormatted);
                                const textFillStyle = isHovered ? '#FFFFFF' : arrowStrokeStyle;
                                this.ctx.fillStyle = textFillStyle;
                                this.ctx.font = 'bold 11px Arial';
                                this.ctx.textAlign = 'center';
                                this.ctx.textBaseline = 'middle';
                                const textY = pointsDown ? -arrowSize * 0.15 : arrowSize * 0.15;
                                this.ctx.fillText(markerText, 0, textY);
                                this.ctx.restore();
                                //    
                                const pointRadius = 3;
                                this.ctx.beginPath();
                                this.ctx.arc(x, y, pointRadius, 0, Math.PI * 2);
                                this.ctx.fillStyle = arrowStrokeStyle;
                                this.ctx.fill();
                                this.ctx.strokeStyle = '#FFFFFF';
                                this.ctx.lineWidth = 1;
                                this.ctx.stroke();
                                //   ( )
                                this.ctx.fillStyle = arrowStrokeStyle;
                                this.ctx.font = 'bold 11px Arial';
                                this.ctx.textAlign = 'left';
                                this.ctx.textBaseline = 'middle';
                                const labelX = x + arrowSize / 2 + 5;
                                const labelY = arrowY;
                                this.ctx.fillText(labelText, labelX, labelY);
                                //    
                                this.eventMarkers.push({ event, x, y: arrowY, radius: arrowSize * 1.2 });
                                //   
                                if (isHovered) {
                                    const tooltipY = pointsDown ? arrowY + arrowSize * 0.8 : arrowY - arrowSize * 0.8;
                                    this.eventTooltipsToRender.push({ event, x, y: tooltipY, pointsDown });
                                }
                            }
                        }
                    }
                }
            }
        });
        //  render     
    }
    drawEventTooltip(event, x, y, pointsDown = true) {
        //    (     )
        this.ctx.save();
        //   ()
        let mainText;
        if (this.config.eventTooltipLabelFormat) {
            const formatted = this.config.eventTooltipLabelFormat(event);
            mainText = this.applyFormatResult(formatted);
        }
        else {
            mainText = event.label;
        }
        //   ( ) - X, Y   
        const subTextParts = [];
        if (isXYRangeEvent(event)) {
            // XY  
            const startXFormatted = this.config.tooltipXFormat
                ? this.config.tooltipXFormat(event.startX, '', event.chartKey || '')
                : (this.config.xFormat
                    ? this.config.xFormat(event.startX, 0, 1, event.chartKey)
                    : new Date(event.startX).toLocaleString());
            const endXFormatted = this.config.tooltipXFormat
                ? this.config.tooltipXFormat(event.endX, '', event.chartKey || '')
                : (this.config.xFormat
                    ? this.config.xFormat(event.endX, 0, 1, event.chartKey)
                    : new Date(event.endX).toLocaleString());
            subTextParts.push(`Period: ${this.applyFormatResult(startXFormatted)} ~ ${this.applyFormatResult(endXFormatted)}`);
            const startYFormatted = this.config.tooltipYFormat
                ? this.config.tooltipYFormat(event.startY, event.chartKey || '', '')
                : (this.config.yFormat
                    ? this.config.yFormat(event.startY, 0, 1, event.chartKey)
                    : event.startY.toLocaleString());
            const endYFormatted = this.config.tooltipYFormat
                ? this.config.tooltipYFormat(event.endY, event.chartKey || '', '')
                : (this.config.yFormat
                    ? this.config.yFormat(event.endY, 0, 1, event.chartKey)
                    : event.endY.toLocaleString());
            subTextParts.push(`Range: ${this.applyFormatResult(startYFormatted)} ~ ${this.applyFormatResult(endYFormatted)}`);
        }
        else if (isXRangeEvent(event)) {
            // X  
            const startXFormatted = this.config.tooltipXFormat
                ? this.config.tooltipXFormat(event.startX, '', event.chartKey || '')
                : (this.config.xFormat
                    ? this.config.xFormat(event.startX, 0, 1, event.chartKey)
                    : new Date(event.startX).toLocaleString());
            const endXFormatted = this.config.tooltipXFormat
                ? this.config.tooltipXFormat(event.endX, '', event.chartKey || '')
                : (this.config.xFormat
                    ? this.config.xFormat(event.endX, 0, 1, event.chartKey)
                    : new Date(event.endX).toLocaleString());
            subTextParts.push(`Period: ${this.applyFormatResult(startXFormatted)} ~ ${this.applyFormatResult(endXFormatted)}`);
        }
        else if (isYRangeEvent(event)) {
            // Y  
            const startYFormatted = this.config.tooltipYFormat
                ? this.config.tooltipYFormat(event.startY, event.chartKey || '', '')
                : (this.config.yFormat
                    ? this.config.yFormat(event.startY, 0, 1, event.chartKey)
                    : event.startY.toLocaleString());
            const endYFormatted = this.config.tooltipYFormat
                ? this.config.tooltipYFormat(event.endY, event.chartKey || '', '')
                : (this.config.yFormat
                    ? this.config.yFormat(event.endY, 0, 1, event.chartKey)
                    : event.endY.toLocaleString());
            subTextParts.push(`Range: ${this.applyFormatResult(startYFormatted)} ~ ${this.applyFormatResult(endYFormatted)}`);
        }
        else {
            //  
            // chartKey   (  )
            const eventWithMeta = event;
            const chartKey = eventWithMeta.chartKey;
            const pointIndex = eventWithMeta.pointIndex;
            // PointEvent   
            if (pointIndex !== undefined) {
                subTextParts.push(`Point ${pointIndex + 1}`);
            }
            // X  () -  x  
            if ('x' in event && event.x !== undefined) {
                const xTime = event.x;
                const xFormatted = this.config.tooltipXFormat
                    ? this.config.tooltipXFormat(xTime, '', chartKey || '')
                    : (this.config.xFormat
                        ? this.config.xFormat(xTime, 0, 1, chartKey)
                        : new Date(xTime).toLocaleString());
                subTextParts.push(`Time: ${this.applyFormatResult(xFormatted)}`);
            }
            // Y  -  y  
            if ('y' in event && event.y !== undefined) {
                const yValue = event.y;
                const yFormatted = this.config.tooltipYFormat
                    ? this.config.tooltipYFormat(yValue, chartKey || '', '')
                    : (this.config.yFormat
                        ? this.config.yFormat(yValue, 0, 1, chartKey)
                        : yValue.toLocaleString());
                subTextParts.push(`Value: ${this.applyFormatResult(yFormatted)}`);
            }
            // Chart Key
            if (chartKey) {
                const chartLabel = this.config.labelFormat
                    ? this.applyFormatResult(this.config.labelFormat(chartKey))
                    : chartKey;
                subTextParts.push(`Chart: ${chartLabel}`);
            }
        }
        const subText = subTextParts.length > 0 ? subTextParts.join(' | ') : '';
        //   
        this.ctx.font = 'bold 11px Arial';
        const mainTextWidth = this.ctx.measureText(mainText).width;
        this.ctx.font = '10px Arial';
        const subTextWidth = this.ctx.measureText(subText).width;
        const textWidth = Math.max(mainTextWidth, subTextWidth);
        const tooltipWidth = textWidth + 16;
        const tooltipHeight = subText ? 36 : 28;
        //   
        let tooltipX = x - tooltipWidth / 2; //  
        let tooltipY = pointsDown ? y + 5 : y - tooltipHeight - 5;
        //   
        if (tooltipX < this.padding) {
            tooltipX = this.padding;
        }
        if (tooltipX + tooltipWidth > this.canvasWidth - this.padding) {
            tooltipX = this.canvasWidth - this.padding - tooltipWidth;
        }
        if (tooltipY < this.padding) {
            tooltipY = y + 5;
        }
        if (tooltipY + tooltipHeight > this.canvasHeight - this.padding) {
            tooltipY = y - tooltipHeight - 5;
        }
        //  
        const isDarkMode = this.detectDarkMode(this.config.theme);
        this.ctx.fillStyle = isDarkMode ? 'rgba(50, 50, 50, 0.95)' : 'rgba(0, 0, 0, 0.85)';
        this.ctx.beginPath();
        this.ctx.roundRect(tooltipX, tooltipY, tooltipWidth, tooltipHeight, 4);
        this.ctx.fill();
        //  
        this.ctx.fillStyle = isDarkMode ? '#FFFFFF' : '#FFFFFF';
        this.ctx.font = 'bold 11px Arial';
        this.ctx.textAlign = 'left';
        this.ctx.textBaseline = 'top';
        this.ctx.fillText(mainText, tooltipX + 8, tooltipY + 6);
        //  
        if (subText) {
            this.ctx.font = '10px Arial';
            this.ctx.fillStyle = isDarkMode ? '#CCCCCC' : '#AAAAAA';
            this.ctx.fillText(subText, tooltipX + 8, tooltipY + 20);
        }
        //   
        this.ctx.restore();
    }
    drawXAxisLabels(area, sortedTimes, displayMinTime, displayMaxTime) {
        if (sortedTimes.length === 0)
            return;
        // X    
        // X         (  )
        const minTime = displayMinTime ?? sortedTimes[0];
        const maxTime = displayMaxTime ?? sortedTimes[sortedTimes.length - 1];
        const baselineY = area.y;
        this.ctx.fillStyle = this.getTextColor();
        this.ctx.font = '12px Arial';
        const tickYStart = baselineY;
        const tickYEnd = baselineY + 6;
        const labelY = baselineY + 13;
        const visibleTimes = sortedTimes.filter(t => t >= minTime && t <= maxTime);
        if (visibleTimes.length === 0)
            return;
        const dayStartTimes = [];
        const seenDays = new Set();
        visibleTimes.forEach(time => {
            const date = new Date(time);
            const dayKey = `${date.getFullYear()}-${date.getMonth()}-${date.getDate()}`;
            if (!seenDays.has(dayKey)) {
                seenDays.add(dayKey);
                const dayStart = new Date(date.getFullYear(), date.getMonth(), date.getDate(), 0, 0, 0);
                const dayStartTime = dayStart.getTime();
                if (dayStartTime >= minTime && dayStartTime <= maxTime) {
                    dayStartTimes.push(dayStartTime);
                }
            }
        });
        if (dayStartTimes.length === 0)
            return;
        const maxLabels = this.config.xLabelCount ?? 12;
        // 0   
        if (maxLabels === 0)
            return;
        //     ( maxLabels )
        const labelsToRender = [];
        if (dayStartTimes.length <= maxLabels) {
            //    
            labelsToRender.push(...dayStartTimes);
        }
        else {
            //    
            //     ,   
            labelsToRender.push(dayStartTimes[0]); //  
            //   (maxLabels - 2)
            const middleCount = maxLabels - 2;
            if (middleCount > 0) {
                const step = (dayStartTimes.length - 1) / (maxLabels - 1);
                for (let i = 1; i < maxLabels - 1; i++) {
                    const index = Math.round(i * step);
                    labelsToRender.push(dayStartTimes[index]);
                }
            }
            labelsToRender.push(dayStartTimes[dayStartTimes.length - 1]); // 
        }
        const totalLabels = labelsToRender.length;
        this.ctx.textAlign = 'center';
        labelsToRender.forEach((time, index) => {
            const x = this.getX(time, minTime, maxTime);
            const formatted = this.config.xFormat ? this.config.xFormat(time, index, totalLabels) : time.toString();
            const labelText = this.applyFormatResult(formatted);
            this.ctx.fillText(labelText, x, labelY);
            this.ctx.beginPath();
            this.ctx.moveTo(x, tickYStart);
            this.ctx.lineTo(x, tickYEnd);
            this.ctx.stroke();
        });
    }
    drawZoomButtons(area, zoomStart, zoomEnd, displayMinTime, displayMaxTime) {
        const buttonSize = 25;
        const buttonGap = 10;
        const startX = area.x;
        const startY = area.y;
        const zoomButtons = [];
        const buttons = [
            { type: 'zoomIn', label: '+' },
            { type: 'zoomOut', label: '' },
            { type: 'reset', label: '' }
        ];
        buttons.forEach((btn, i) => {
            const x = startX + i * (buttonSize + buttonGap);
            const y = startY;
            this.ctx.fillStyle = 'rgba(255, 255, 255, 0.5)';
            this.ctx.strokeStyle = '#999';
            this.ctx.lineWidth = 1;
            this.ctx.beginPath();
            this.ctx.roundRect(x, y, buttonSize, buttonSize, 4);
            this.ctx.fill();
            this.ctx.stroke();
            this.ctx.fillStyle = '#333';
            this.ctx.font = 'bold 13px Arial';
            this.ctx.textAlign = 'center';
            this.ctx.textBaseline = 'middle';
            this.ctx.fillText(btn.label, x + buttonSize / 2, y + buttonSize / 2);
            zoomButtons.push({ type: btn.type, x, y, width: buttonSize, height: buttonSize });
        });
        //         
        if (displayMinTime !== undefined && displayMaxTime !== undefined) {
            let dateRangeText;
            if (this.config.zoomRangeFormat) {
                // zoomRangeFormat   
                const formatted = this.config.zoomRangeFormat(displayMinTime, displayMaxTime);
                dateRangeText = this.applyFormatResult(formatted);
            }
            else {
                //  : xFormat  timestamp 
                const formatDateTime = (timestamp, index) => {
                    if (this.config.xFormat) {
                        const formatted = this.config.xFormat(timestamp, index, 2);
                        return this.applyFormatResult(formatted);
                    }
                    else {
                        return timestamp.toString();
                    }
                };
                const fromDate = formatDateTime(displayMinTime, 0);
                const toDate = formatDateTime(displayMaxTime, 1);
                dateRangeText = `${fromDate} ~ ${toDate}`;
            }
            //       
            this.ctx.font = '10px Arial';
            this.ctx.fillStyle = '#333';
            this.ctx.textAlign = 'center';
            this.ctx.fillText(dateRangeText, this.width / 2, startY - 5);
        }
        //         
        if (zoomStart > 0 || zoomEnd < 100) {
            this.ctx.font = '10px Arial';
            this.ctx.fillStyle = '#666';
            this.ctx.textAlign = 'center';
            this.ctx.fillText(`${zoomStart.toFixed(0)}%-${zoomEnd.toFixed(0)}%`, this.width / 2, startY + buttonSize + 5);
        }
        return zoomButtons;
    }
    drawDragSelection(isDragging, dragStartX, dragCurrentX, chartBottom) {
        if (!isDragging || dragStartX === null || dragCurrentX === null)
            return;
        const selectionLeft = Math.min(dragStartX, dragCurrentX);
        const selectionWidth = Math.abs(dragCurrentX - dragStartX);
        this.ctx.fillStyle = 'rgba(74, 144, 217, 0.2)';
        this.ctx.fillRect(selectionLeft, this.padding, selectionWidth, chartBottom - this.padding);
        this.ctx.strokeStyle = '#4a90d9';
        this.ctx.lineWidth = 1;
        this.ctx.setLineDash([4, 4]);
        this.ctx.strokeRect(selectionLeft, this.padding, selectionWidth, chartBottom - this.padding);
        this.ctx.setLineDash([]);
    }
    drawCrosshair(mouseX, mouseY, chartAreas, sortedTimes, displayMinTime, displayMaxTime) {
        //       (X)
        if (mouseX < this.chartAreaLeft || mouseX > this.getChartRight())
            return;
        //      
        let isInChartArea = false;
        for (const area of chartAreas) {
            if (mouseY >= area.y && mouseY <= area.y + area.height) {
                isInChartArea = true;
                break;
            }
        }
        if (!isInChartArea)
            return;
        const chartTop = chartAreas.length > 0 ? chartAreas[0].y : this.paddingTop;
        const chartBottom = chartAreas.length > 0
            ? chartAreas[chartAreas.length - 1].y + chartAreas[chartAreas.length - 1].height
            : this.height - this.paddingBottom;
        this.ctx.strokeStyle = this.config.crosshairStrokeStyle || '#666666';
        this.ctx.lineWidth = this.config.crosshairLineWidth || 1;
        this.ctx.setLineDash(this.config.crosshairLineDash || [4, 4]);
        // :    
        this.ctx.beginPath();
        this.ctx.moveTo(mouseX, chartTop);
        this.ctx.lineTo(mouseX, chartBottom);
        this.ctx.stroke();
        // :    
        this.ctx.beginPath();
        this.ctx.moveTo(this.chartAreaLeft, mouseY);
        this.ctx.lineTo(this.getChartRight(), mouseY);
        this.ctx.stroke();
        this.ctx.setLineDash([]);
        const timePercent = (mouseX - this.chartAreaLeft) / this.chartAreaWidth;
        if (sortedTimes.length > 0) {
            const minTime = displayMinTime ?? sortedTimes[0];
            const maxTime = displayMaxTime ?? sortedTimes[sortedTimes.length - 1];
            const timeRange = maxTime - minTime || 1;
            const currentTime = minTime + timePercent * timeRange;
            const date = new Date(currentTime);
            this.ctx.fillStyle = '#333333';
            this.ctx.font = 'bold 12px Arial';
            this.ctx.textAlign = 'center';
            const formatted = this.config.crosshairXFormat
                ? this.config.crosshairXFormat(currentTime)
                : (this.config.xFormat
                    ? this.config.xFormat(currentTime, 0, 1)
                    : currentTime.toString());
            const dateStr = this.applyFormatResult(formatted);
            this.ctx.fillStyle = this.getTextColor();
            this.ctx.fillText(dateStr, mouseX, this.height - this.padding + 35);
        }
        let valueStr = '';
        //     
        for (const area of chartAreas) {
            if (mouseY >= area.y && mouseY <= area.y + area.height) {
                const scaledValue = 1 - (mouseY - area.y) / area.height;
                const totalMargin = this.chartMarginTop + this.chartMarginBottom;
                const normalizedValue = (scaledValue - this.chartMarginBottom) / (1 - totalMargin);
                if (this.state.normalize === 'rangeNormalize' || this.state.normalize === 'normalize') {
                    //  :  
                    const valuePercent = normalizedValue * 100;
                    const formatted = this.config.crosshairYFormat
                        ? this.config.crosshairYFormat(valuePercent, area.key, true)
                        : `${valuePercent.toFixed(1)}%`;
                    valueStr = this.applyFormatResult(formatted);
                }
                else {
                    //  :      
                    //    min/max  
                    let globalMin = Infinity;
                    let globalMax = -Infinity;
                    this.dataMap.forEach((value) => {
                        const chartDataObj = value.data[area.key];
                        if (chartDataObj) {
                            const values = chartDataObj.datas.map((d) => d.y).filter((v) => v !== null && v !== undefined);
                            if (values.length > 0) {
                                globalMin = Math.min(globalMin, ...values);
                                globalMax = Math.max(globalMax, ...values);
                            }
                        }
                    });
                    if (globalMin !== Infinity && globalMax !== -Infinity) {
                        const actualValue = globalMin + normalizedValue * (globalMax - globalMin);
                        const formatted = this.config.crosshairYFormat
                            ? this.config.crosshairYFormat(actualValue, area.key, false)
                            : (this.config.yFormat
                                ? this.config.yFormat(actualValue, 0, 1, area.key)
                                : actualValue.toLocaleString(undefined, { maximumFractionDigits: 2 }));
                        valueStr = this.applyFormatResult(formatted);
                    }
                }
                break;
            }
        }
        if (valueStr) {
            this.ctx.fillStyle = this.getTextColor();
            this.ctx.font = 'bold 12px Arial';
            this.ctx.textAlign = 'left';
            this.ctx.textBaseline = 'middle';
            this.ctx.fillText(valueStr, this.paddingLeft + this.chartAreaWidth + 5, mouseY);
        }
    }
    drawDataPoints(visibleTickers, chartAreas, sortedTimes, displayMinTime, displayMaxTime) {
        const dataPoints = [];
        if (sortedTimes.length === 0)
            return dataPoints;
        const minTime = displayMinTime ?? sortedTimes[0];
        const maxTime = displayMaxTime ?? sortedTimes[sortedTimes.length - 1];
        const pointRadius = 3;
        const clipLeft = this.chartAreaLeft;
        const clipRight = this.getChartRight();
        //      
        chartAreas.forEach(area => {
            const chartKey = area.key;
            const graphTop = area.y;
            const graphHeight = area.height;
            //   min/max 
            const minMaxBySymbol = new Map();
            if (this.state.normalize === 'rangeNormalize') {
                //  :     min/max 
                this.dataMap.forEach((value, symbol) => {
                    const chartDataObj = value.data[chartKey];
                    if (chartDataObj) {
                        const visibleValues = chartDataObj.datas
                            .filter(d => d.x >= minTime && d.x <= maxTime && d.y !== null && d.y !== undefined)
                            .map(d => d.y);
                        if (visibleValues.length > 0) {
                            minMaxBySymbol.set(symbol, { min: Math.min(...visibleValues), max: Math.max(...visibleValues) });
                        }
                    }
                });
            }
            else if (this.state.normalize === 'normalize') {
                //  :    min/max 
                const chartMinMaxCache = this.globalMinMaxCache.get(chartKey);
                if (chartMinMaxCache) {
                    this.dataMap.forEach((value, symbol) => {
                        const cachedMinMax = chartMinMaxCache.get(symbol);
                        if (cachedMinMax) {
                            minMaxBySymbol.set(symbol, cachedMinMax);
                        }
                    });
                }
            }
            else {
                //  :    min/max 
                let globalMin = Infinity, globalMax = -Infinity;
                this.dataMap.forEach((value) => {
                    const chartDataObj = value.data[chartKey];
                    if (chartDataObj) {
                        const values = chartDataObj.datas.map(d => d.y).filter(v => v !== null && v !== undefined);
                        if (values.length > 0) {
                            globalMin = Math.min(globalMin, ...values);
                            globalMax = Math.max(globalMax, ...values);
                        }
                    }
                });
                //    min/max 
                this.dataMap.forEach((value, symbol) => {
                    minMaxBySymbol.set(symbol, { min: globalMin, max: globalMax });
                });
            }
            //    
            this.dataMap.forEach((value, symbol) => {
                if (!visibleTickers.has(symbol))
                    return;
                const color = this.getTickerColor(symbol);
                const minMax = minMaxBySymbol.get(symbol);
                if (!minMax)
                    return;
                const chartDataObj = value.data[chartKey];
                if (!chartDataObj)
                    return;
                chartDataObj.datas.forEach(d => {
                    if (d.y === null || d.y === undefined)
                        return;
                    const time = d.x;
                    if (time < minTime || time > maxTime)
                        return;
                    const x = this.getX(time, minTime, maxTime);
                    if (x < clipLeft || x > clipRight)
                        return;
                    const normalizedValue = (d.y - minMax.min) / (minMax.max - minMax.min || 1);
                    const totalMargin = this.chartMarginTop + this.chartMarginBottom;
                    const scaledValue = this.chartMarginBottom + normalizedValue * (1 - totalMargin);
                    const y = graphTop + (1 - scaledValue) * graphHeight;
                    this.ctx.fillStyle = color;
                    this.ctx.beginPath();
                    this.ctx.arc(x, y, pointRadius, 0, Math.PI * 2);
                    this.ctx.fill();
                    dataPoints.push({ symbol, x, y, value: d.y, time, chartType: chartKey });
                });
            });
        });
        return dataPoints;
    }
    drawPointTooltip(point, canvasArea) {
        const xFormatted = this.config.tooltipXFormat
            ? this.config.tooltipXFormat(point.time, point.symbol, point.chartType)
            : (this.config.xFormat
                ? this.config.xFormat(point.time, 0, 1, point.chartType)
                : point.time.toString());
        const dateStr = this.applyFormatResult(xFormatted);
        let text;
        if (this.config.tooltipLabelFormat) {
            const formatted = this.config.tooltipLabelFormat(point.symbol, point.chartType, point.value, point.time);
            text = this.applyFormatResult(formatted);
        }
        else {
            let valueStr;
            if (this.config.tooltipYFormat) {
                const formatted = this.config.tooltipYFormat(point.value, point.chartType, point.symbol);
                valueStr = this.applyFormatResult(formatted);
            }
            else if (this.config.yFormat) {
                const formatted = this.config.yFormat(point.value, 0, 1, point.chartType);
                valueStr = this.applyFormatResult(formatted);
            }
            else {
                //  :  2   (   )
                valueStr = point.value.toLocaleString(undefined, { maximumFractionDigits: 2 });
            }
            const labelFormatted = this.config.labelFormat
                ? this.config.labelFormat(point.chartType)
                : point.chartType;
            const chartLabel = this.applyFormatResult(labelFormatted);
            text = `${point.symbol} (${chartLabel}): ${valueStr}`;
        }
        const subText = dateStr;
        this.ctx.font = 'bold 11px Arial';
        const textWidth = Math.max(this.ctx.measureText(text).width, this.ctx.measureText(subText).width);
        const tooltipWidth = textWidth + 16;
        const tooltipHeight = 36;
        let tooltipX = point.x + 10;
        let tooltipY = point.y - tooltipHeight - 5;
        if (tooltipX + tooltipWidth > canvasArea.width - this.padding) {
            tooltipX = point.x - tooltipWidth - 10;
        }
        if (tooltipY < this.padding) {
            tooltipY = point.y + 10;
        }
        const isDarkMode = this.detectDarkMode(this.config.theme);
        this.ctx.fillStyle = isDarkMode ? 'rgba(50, 50, 50, 0.95)' : 'rgba(0, 0, 0, 0.85)';
        this.ctx.beginPath();
        this.ctx.roundRect(tooltipX, tooltipY, tooltipWidth, tooltipHeight, 4);
        this.ctx.fill();
        this.ctx.fillStyle = '#FFFFFF';
        this.ctx.textAlign = 'left';
        this.ctx.textBaseline = 'top';
        this.ctx.fillText(text, tooltipX + 8, tooltipY + 6);
        this.ctx.font = '10px Arial';
        this.ctx.fillStyle = isDarkMode ? '#CCCCCC' : '#AAAAAA';
        this.ctx.fillText(subText, tooltipX + 8, tooltipY + 20);
    }
    isInChartArea(x, y) {
        return x >= this.padding && x <= this.canvasWidth - this.padding && y >= this.padding;
    }
    xToZoomPercent(x) {
        const chartWidth = this.canvasWidth - this.padding * 2;
        const xInChart = x - this.padding;
        const percentInView = xInChart / chartWidth;
        return this.zoomStart + percentInView * (this.zoomEnd - this.zoomStart);
    }
    zoomIn(focusX) {
        const range = this.zoomEnd - this.zoomStart;
        if (range <= 1)
            return; //  1%   ( 10% )
        let focusPercent;
        if (focusX !== undefined) {
            focusPercent = this.xToZoomPercent(focusX);
        }
        else {
            focusPercent = (this.zoomStart + this.zoomEnd) / 2;
        }
        const newRange = range * 0.7;
        const focusRatio = (focusPercent - this.zoomStart) / range;
        this.zoomStart = Math.max(0, focusPercent - newRange * focusRatio);
        this.zoomEnd = Math.min(100, focusPercent + newRange * (1 - focusRatio));
        if (this.zoomStart < 0) {
            this.zoomEnd -= this.zoomStart;
            this.zoomStart = 0;
        }
        if (this.zoomEnd > 100) {
            this.zoomStart -= (this.zoomEnd - 100);
            this.zoomEnd = 100;
        }
        this.zoomStart = Math.round(this.zoomStart * 100) / 100;
        this.zoomEnd = Math.round(this.zoomEnd * 100) / 100;
        if (Math.abs(this.zoomStart) < 0.5 && Math.abs(this.zoomEnd - 100) < 0.5) {
            this.zoomStart = 0;
            this.zoomEnd = 100;
            this.isPanning = false;
            this.panStartX = null;
            this.isTouchPanning = false;
        }
        this.render();
    }
    zoomOut(focusX) {
        const range = this.zoomEnd - this.zoomStart;
        if (range >= 100)
            return;
        let focusPercent;
        if (focusX !== undefined) {
            focusPercent = this.xToZoomPercent(focusX);
        }
        else {
            focusPercent = (this.zoomStart + this.zoomEnd) / 2;
        }
        const newRange = Math.min(100, range * 1.4);
        const focusRatio = (focusPercent - this.zoomStart) / range;
        this.zoomStart = Math.max(0, focusPercent - newRange * focusRatio);
        this.zoomEnd = Math.min(100, focusPercent + newRange * (1 - focusRatio));
        if (this.zoomStart < 0) {
            this.zoomEnd -= this.zoomStart;
            this.zoomStart = 0;
        }
        if (this.zoomEnd > 100) {
            this.zoomStart -= (this.zoomEnd - 100);
            this.zoomEnd = 100;
        }
        this.zoomStart = Math.round(this.zoomStart * 100) / 100;
        this.zoomEnd = Math.round(this.zoomEnd * 100) / 100;
        if (Math.abs(this.zoomStart) < 0.5 && Math.abs(this.zoomEnd - 100) < 0.5) {
            this.zoomStart = 0;
            this.zoomEnd = 100;
            this.isPanning = false;
            this.panStartX = null;
            this.isTouchPanning = false;
        }
        this.render();
    }
    zoomReset() {
        this.zoomStart = 0;
        this.zoomEnd = 100;
        this.isPanning = false;
        this.panStartX = null;
        this.isTouchPanning = false;
        this.isDragging = false;
        this.dragStartX = null;
        this.dragCurrentX = null;
        this.isTouchDragging = false;
        this.render();
    }
    getPinchDistance(touches) {
        if (touches.length < 2)
            return 0;
        const dx = touches[0].clientX - touches[1].clientX;
        const dy = touches[0].clientY - touches[1].clientY;
        return Math.sqrt(dx * dx + dy * dy);
    }
    setupEventListeners() {
        //      
        if (typeof window === 'undefined' || !this.canvas.addEventListener) {
            return;
        }
        //  
        this.canvas.addEventListener('mousemove', (e) => {
            const rect = this.canvas.getBoundingClientRect();
            this.mouseX = e.clientX - rect.left;
            this.mouseY = e.clientY - rect.top;
            if (this.isDragging && this.dragStartX !== null) {
                //       
                this.dragCurrentX = Math.max(this.chartAreaLeft, Math.min(this.getChartRight(), this.mouseX));
                this.render();
                return;
            }
            if (this.isPanning && this.panStartX !== null) {
                const dx = this.mouseX - this.panStartX;
                const pixelRange = this.canvasWidth - this.padding * 2;
                const percentDelta = (dx / pixelRange) * (this.zoomEnd - this.zoomStart);
                let newStart = this.zoomStart - percentDelta;
                let newEnd = this.zoomEnd - percentDelta;
                if (newStart < 0) {
                    newEnd -= newStart;
                    newStart = 0;
                }
                if (newEnd > 100) {
                    newStart -= (newEnd - 100);
                    newEnd = 100;
                }
                this.zoomStart = Math.max(0, newStart);
                this.zoomEnd = Math.min(100, newEnd);
                this.panStartX = this.mouseX;
                this.zoomStart = Math.round(this.zoomStart * 100) / 100;
                this.zoomEnd = Math.round(this.zoomEnd * 100) / 100;
                if (Math.abs(this.zoomStart) < 0.5 && Math.abs(this.zoomEnd - 100) < 0.5) {
                    this.zoomStart = 0;
                    this.zoomEnd = 100;
                    this.isPanning = false;
                    this.panStartX = null;
                }
                this.render();
                return;
            }
            //    
            let foundEventMarker = null;
            for (const marker of this.eventMarkers) {
                // Range   (  )
                if (marker.event.isRangeLabel && marker.event.labelRect) {
                    const rect = marker.event.labelRect;
                    if (this.mouseX >= rect.x && this.mouseX <= rect.x + rect.width &&
                        this.mouseY >= rect.y && this.mouseY <= rect.y + rect.height) {
                        foundEventMarker = marker.event;
                        break;
                    }
                }
                // X-only  ( ) X  
                else if (isXPointEvent(marker.event)) {
                    const dx = Math.abs(this.mouseX - marker.x);
                    if (dx <= marker.radius) {
                        foundEventMarker = marker.event;
                        break;
                    }
                }
                // Y-only  ( ) Y  
                else if (isYPointEvent(marker.event)) {
                    const dy = Math.abs(this.mouseY - marker.y);
                    if (dy <= marker.radius) {
                        foundEventMarker = marker.event;
                        break;
                    }
                }
                //     
                else {
                    const dx = this.mouseX - marker.x;
                    const dy = this.mouseY - marker.y;
                    if (Math.sqrt(dx * dx + dy * dy) <= marker.radius) {
                        foundEventMarker = marker.event;
                        break;
                    }
                }
            }
            this.hoveredEventMarker = foundEventMarker;
            if (this.state.showPoints && this.dataPoints.length > 0) {
                const hoverRadius = 6;
                let foundPoint = null;
                for (const point of this.dataPoints) {
                    const dx = this.mouseX - point.x;
                    const dy = this.mouseY - point.y;
                    if (Math.sqrt(dx * dx + dy * dy) <= hoverRadius) {
                        foundPoint = point;
                        break;
                    }
                }
                this.hoveredPoint = foundPoint;
            }
            let cursor = 'pointer'; // 'crosshair';
            for (const btn of this.zoomButtons) {
                if (this.mouseX >= btn.x && this.mouseX <= btn.x + btn.width &&
                    this.mouseY >= btn.y && this.mouseY <= btn.y + btn.height) {
                    cursor = 'pointer';
                    break;
                }
            }
            for (const item of this.legendItems) {
                if (this.mouseX >= item.x && this.mouseX <= item.x + item.width &&
                    this.mouseY >= item.y && this.mouseY <= item.y + item.height) {
                    cursor = 'pointer';
                    break;
                }
            }
            if ((this.zoomStart > 0 || this.zoomEnd < 100) && this.isInChartArea(this.mouseX, this.mouseY) && cursor === 'crosshair') {
                cursor = 'grab';
            }
            this.canvas.style.cursor = cursor;
            this.render();
        });
        //  
        this.canvas.addEventListener('mouseleave', () => {
            this.mouseX = null;
            this.mouseY = null;
            //     
            if (this.hoveredPoint !== null && this.config.onPointTooltip) {
                this.config.onPointTooltip(null);
            }
            this.hoveredPoint = null;
            this.hoveredEventMarker = null;
            this.isDragging = false;
            this.dragStartX = null;
            this.dragCurrentX = null;
            this.isPanning = false;
            this.panStartX = null;
            this.render();
        });
        //  
        this.canvas.addEventListener('mousedown', (e) => {
            const rect = this.canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            for (const btn of this.zoomButtons) {
                if (x >= btn.x && x <= btn.x + btn.width &&
                    y >= btn.y && y <= btn.y + btn.height) {
                    return;
                }
            }
            for (const item of this.legendItems) {
                if (x >= item.x && x <= item.x + item.width &&
                    y >= item.y && y <= item.y + item.height) {
                    return;
                }
            }
            if (this.isInChartArea(x, y)) {
                if (this.zoomStart === 0 && this.zoomEnd === 100) {
                    this.isDragging = true;
                    //       
                    this.dragStartX = Math.max(this.chartAreaLeft, Math.min(this.getChartRight(), x));
                    this.dragCurrentX = this.dragStartX;
                }
                else {
                    this.isPanning = true;
                    this.panStartX = x;
                }
            }
        });
        //  
        this.canvas.addEventListener('mouseup', (e) => {
            const rect = this.canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            //       (  )
            for (const btn of this.zoomButtons) {
                if (x >= btn.x && x <= btn.x + btn.width &&
                    y >= btn.y && y <= btn.y + btn.height) {
                    return;
                }
            }
            if (this.isDragging && this.dragStartX !== null && this.dragCurrentX !== null) {
                const startX = Math.min(this.dragStartX, this.dragCurrentX);
                const endX = Math.max(this.dragStartX, this.dragCurrentX);
                const selectionWidth = endX - startX;
                if (selectionWidth > 10) {
                    const chartWidth = this.canvasWidth - this.padding * 2;
                    const startPercent = ((startX - this.padding) / chartWidth) * 100;
                    const endPercent = ((endX - this.padding) / chartWidth) * 100;
                    if (this.zoomStart === 0 && this.zoomEnd === 100) {
                        this.zoomStart = startPercent;
                        this.zoomEnd = endPercent;
                    }
                    else {
                        const currentRange = this.zoomEnd - this.zoomStart;
                        this.zoomStart = this.zoomStart + (startPercent / 100) * currentRange;
                        this.zoomEnd = this.zoomStart + ((endPercent - startPercent) / 100) * currentRange;
                    }
                    this.zoomStart = Math.max(0, this.zoomStart);
                    this.zoomEnd = Math.min(100, this.zoomEnd);
                }
                this.isDragging = false;
                this.dragStartX = null;
                this.dragCurrentX = null;
                this.render();
                return;
            }
            if (this.isPanning) {
                this.isPanning = false;
                this.panStartX = null;
                this.canvas.style.cursor = 'grab';
                this.render();
            }
        });
        // 
        this.canvas.addEventListener('click', (e) => {
            const rect = this.canvas.getBoundingClientRect();
            const clickX = e.clientX - rect.left;
            const clickY = e.clientY - rect.top;
            //   (click  )
            const currentTime = Date.now();
            const timeDiff = currentTime - this.lastTapTime;
            const dx = clickX - this.lastTapX;
            const dy = clickY - this.lastTapY;
            const distance = Math.sqrt(dx * dx + dy * dy);
            const tapThreshold = 300; // 300ms 
            const distanceThreshold = 30; // 30px 
            if (timeDiff < tapThreshold && distance < distanceThreshold) {
                //  
                //    
                let isZoomButton = false;
                for (const btn of this.zoomButtons) {
                    if (clickX >= btn.x && clickX <= btn.x + btn.width &&
                        clickY >= btn.y && clickY <= btn.y + btn.height) {
                        isZoomButton = true;
                        break;
                    }
                }
                //   
                let isLegend = false;
                for (const item of this.legendItems) {
                    if (clickX >= item.x && clickX <= item.x + item.width &&
                        clickY >= item.y && clickY <= item.y + item.height) {
                        isLegend = true;
                        break;
                    }
                }
                if (!isZoomButton && !isLegend && this.isInChartArea(clickX, clickY) && (this.zoomStart > 0 || this.zoomEnd < 100)) {
                    this.lastTapTime = 0; // 
                    this.zoomReset();
                    return;
                }
            }
            //    
            this.lastTapTime = currentTime;
            this.lastTapX = clickX;
            this.lastTapY = clickY;
            //     (  )
            for (const btn of this.zoomButtons) {
                if (clickX >= btn.x && clickX <= btn.x + btn.width &&
                    clickY >= btn.y && clickY <= btn.y + btn.height) {
                    if (btn.type === 'zoomIn') {
                        this.zoomIn();
                        if (this.config.onZoomButtonClick) {
                            this.config.onZoomButtonClick('zoomIn', this.zoomStart, this.zoomEnd);
                        }
                    }
                    else if (btn.type === 'zoomOut') {
                        this.zoomOut();
                        if (this.config.onZoomButtonClick) {
                            this.config.onZoomButtonClick('zoomOut', this.zoomStart, this.zoomEnd);
                        }
                    }
                    else if (btn.type === 'reset') {
                        this.zoomReset();
                        if (this.config.onZoomButtonClick) {
                            this.config.onZoomButtonClick('reset', this.zoomStart, this.zoomEnd);
                        }
                    }
                    return;
                }
            }
            //        
            if (this.clickTimer !== null) {
                clearTimeout(this.clickTimer);
                this.clickTimer = null;
            }
            this.clickTimer = window.setTimeout(() => {
                this.clickTimer = null;
                //    
                for (const marker of this.eventMarkers) {
                    let isInside = false;
                    // Range   (  )
                    if (marker.event.isRangeLabel && marker.event.labelRect) {
                        const rect = marker.event.labelRect;
                        isInside = clickX >= rect.x && clickX <= rect.x + rect.width &&
                            clickY >= rect.y && clickY <= rect.y + rect.height;
                    }
                    // X-only  ( ) X  
                    else if (isXPointEvent(marker.event)) {
                        const dx = Math.abs(clickX - marker.x);
                        isInside = dx <= marker.radius;
                    }
                    // Y-only  ( ) Y  
                    else if (isYPointEvent(marker.event)) {
                        const dy = Math.abs(clickY - marker.y);
                        isInside = dy <= marker.radius;
                    }
                    //     
                    else {
                        const dx = clickX - marker.x;
                        const dy = clickY - marker.y;
                        isInside = Math.sqrt(dx * dx + dy * dy) <= marker.radius;
                    }
                    if (isInside) {
                        // :    ,    
                        this.hoveredEventMarker = this.hoveredEventMarker === marker.event ? null : marker.event;
                        this.render();
                        return;
                    }
                }
                if (this.state.showPoints && this.dataPoints.length > 0) {
                    const clickRadius = 12;
                    for (const point of this.dataPoints) {
                        const dx = clickX - point.x;
                        const dy = clickY - point.y;
                        if (Math.sqrt(dx * dx + dy * dy) <= clickRadius) {
                            const newHoveredPoint = this.hoveredPoint === point ? null : point;
                            this.hoveredPoint = newHoveredPoint;
                            //  
                            if (this.config.onPointTooltip) {
                                this.config.onPointTooltip(newHoveredPoint);
                            }
                            this.render();
                            return;
                        }
                    }
                }
                for (const item of this.legendItems) {
                    if (clickX >= item.x && clickX <= item.x + item.width &&
                        clickY >= item.y && clickY <= item.y + item.height) {
                        //    (average:  moving: )
                        if (item.symbol.startsWith('average:') || item.symbol.startsWith('moving:')) {
                            //   (visible  )
                            if (item.symbol === 'average:') {
                                //   
                                const avgItem = this.state.showAverage.find(avg => avg.type === 'average');
                                if (avgItem) {
                                    avgItem.visible = !avgItem.visible;
                                }
                            }
                            else if (item.symbol.startsWith('moving:')) {
                                //  
                                const xWidth = parseInt(item.symbol.split(':')[1]);
                                const avgItem = this.state.showAverage.find(avg => avg.type === 'moving' && avg.xWidth === xWidth);
                                if (avgItem) {
                                    avgItem.visible = !avgItem.visible;
                                }
                            }
                        }
                        else {
                            //  
                            const wasVisible = this.state.visibleTickers.has(item.symbol);
                            if (wasVisible) {
                                this.state.visibleTickers.delete(item.symbol);
                            }
                            else {
                                this.state.visibleTickers.add(item.symbol);
                            }
                            //  
                            if (this.config.onLegendClick) {
                                this.config.onLegendClick(item.symbol, !wasVisible);
                            }
                        }
                        this.render();
                        return;
                    }
                }
            }, this.clickDelay);
        });
        //  (PC   )
        this.canvas.addEventListener('dblclick', (e) => {
            e.preventDefault(); //   
            const rect = this.canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            //    (     )
            if (this.clickTimer !== null) {
                clearTimeout(this.clickTimer);
                this.clickTimer = null;
            }
            //    
            for (const btn of this.zoomButtons) {
                if (x >= btn.x && x <= btn.x + btn.width &&
                    y >= btn.y && y <= btn.y + btn.height) {
                    return;
                }
            }
            //   
            for (const item of this.legendItems) {
                if (x >= item.x && x <= item.x + item.width &&
                    y >= item.y && y <= item.y + item.height) {
                    return;
                }
            }
            //      
            if (this.isInChartArea(x, y) && (this.zoomStart > 0 || this.zoomEnd < 100)) {
                this.zoomReset();
            }
        });
        // 
        this.canvas.addEventListener('wheel', (e) => {
            const rect = this.canvas.getBoundingClientRect();
            const x = e.clientX - rect.left;
            const y = e.clientY - rect.top;
            if (this.isInChartArea(x, y)) {
                e.preventDefault();
                if (e.deltaY < 0) {
                    this.zoomIn(x);
                }
                else {
                    this.zoomOut(x);
                }
            }
        }, { passive: false });
        //  
        this.canvas.addEventListener('touchstart', (e) => {
            const rect = this.canvas.getBoundingClientRect();
            const touch = e.touches[0];
            const x = touch.clientX - rect.left;
            const y = touch.clientY - rect.top;
            if (e.touches.length === 2) {
                this.lastPinchDistance = this.getPinchDistance(e.touches);
                this.isTouchDragging = false;
                this.isTouchPanning = false;
                return;
            }
            for (const btn of this.zoomButtons) {
                if (x >= btn.x && x <= btn.x + btn.width &&
                    y >= btn.y && y <= btn.y + btn.height) {
                    return;
                }
            }
            if (this.isInChartArea(x, y)) {
                this.touchStartX = x;
                this.touchStartY = y;
                if (this.zoomStart === 0 && this.zoomEnd === 100) {
                    this.isTouchDragging = true;
                    //       
                    this.dragStartX = Math.max(this.chartAreaLeft, Math.min(this.getChartRight(), x));
                    this.dragCurrentX = this.dragStartX;
                }
                else {
                    this.isTouchPanning = true;
                    this.panStartX = x;
                }
            }
        }, { passive: true });
        //  
        this.canvas.addEventListener('touchmove', (e) => {
            const rect = this.canvas.getBoundingClientRect();
            if (e.touches.length === 2 && this.lastPinchDistance !== null) {
                e.preventDefault();
                const newDistance = this.getPinchDistance(e.touches);
                const delta = newDistance - this.lastPinchDistance;
                const pinchCenterX = (e.touches[0].clientX + e.touches[1].clientX) / 2 - rect.left;
                if (Math.abs(delta) > 10) {
                    if (delta > 0) {
                        this.zoomIn(pinchCenterX);
                    }
                    else {
                        this.zoomOut(pinchCenterX);
                    }
                    this.lastPinchDistance = newDistance;
                }
                return;
            }
            if (e.touches.length !== 1)
                return;
            const touch = e.touches[0];
            const x = touch.clientX - rect.left;
            const y = touch.clientY - rect.top;
            if (this.isTouchDragging && this.dragStartX !== null) {
                e.preventDefault();
                //       
                this.dragCurrentX = Math.max(this.chartAreaLeft, Math.min(this.getChartRight(), x));
                this.isDragging = true;
                this.render();
                return;
            }
            if (this.isTouchPanning && this.panStartX !== null) {
                e.preventDefault();
                const dx = x - this.panStartX;
                const pixelRange = this.canvasWidth - this.padding * 2;
                const percentDelta = (dx / pixelRange) * (this.zoomEnd - this.zoomStart);
                let newStart = this.zoomStart - percentDelta;
                let newEnd = this.zoomEnd - percentDelta;
                if (newStart < 0) {
                    newEnd -= newStart;
                    newStart = 0;
                }
                if (newEnd > 100) {
                    newStart -= (newEnd - 100);
                    newEnd = 100;
                }
                this.zoomStart = Math.max(0, newStart);
                this.zoomEnd = Math.min(100, newEnd);
                this.panStartX = x;
                this.zoomStart = Math.round(this.zoomStart * 100) / 100;
                this.zoomEnd = Math.round(this.zoomEnd * 100) / 100;
                if (Math.abs(this.zoomStart) < 0.5 && Math.abs(this.zoomEnd - 100) < 0.5) {
                    this.zoomStart = 0;
                    this.zoomEnd = 100;
                    this.isTouchPanning = false;
                    this.panStartX = null;
                }
                this.render();
                return;
            }
        }, { passive: false });
        //  
        this.canvas.addEventListener('touchend', (e) => {
            const rect = this.canvas.getBoundingClientRect();
            if (this.lastPinchDistance !== null) {
                this.lastPinchDistance = null;
                return;
            }
            if (this.isTouchDragging && this.dragStartX !== null && this.dragCurrentX !== null) {
                const startX = Math.min(this.dragStartX, this.dragCurrentX);
                const endX = Math.max(this.dragStartX, this.dragCurrentX);
                const selectionWidth = endX - startX;
                if (selectionWidth > 20) {
                    const chartWidth = this.canvasWidth - this.padding * 2;
                    const startPercent = ((startX - this.padding) / chartWidth) * 100;
                    const endPercent = ((endX - this.padding) / chartWidth) * 100;
                    if (this.zoomStart === 0 && this.zoomEnd === 100) {
                        this.zoomStart = startPercent;
                        this.zoomEnd = endPercent;
                    }
                    else {
                        const currentRange = this.zoomEnd - this.zoomStart;
                        this.zoomStart = this.zoomStart + (startPercent / 100) * currentRange;
                        this.zoomEnd = this.zoomStart + ((endPercent - startPercent) / 100) * currentRange;
                    }
                    this.zoomStart = Math.max(0, this.zoomStart);
                    this.zoomEnd = Math.min(100, this.zoomEnd);
                }
                else if (selectionWidth < 10 && this.touchStartX !== null && this.touchStartY !== null) {
                    const tapX = this.touchStartX;
                    const tapY = this.touchStartY;
                    const currentTime = Date.now();
                    const tapThreshold = 300; // 300ms 
                    const distanceThreshold = 30; // 30px 
                    //  
                    const timeDiff = currentTime - this.lastTapTime;
                    const dx = tapX - this.lastTapX;
                    const dy = tapY - this.lastTapY;
                    const distance = Math.sqrt(dx * dx + dy * dy);
                    if (timeDiff < tapThreshold && distance < distanceThreshold) {
                        //   -     
                        if (this.isInChartArea(tapX, tapY) && (this.zoomStart > 0 || this.zoomEnd < 100)) {
                            this.zoomReset();
                            this.lastTapTime = 0; // 
                            this.isTouchDragging = false;
                            this.isDragging = false;
                            this.dragStartX = null;
                            this.dragCurrentX = null;
                            this.touchStartX = null;
                            this.touchStartY = null;
                            return;
                        }
                    }
                    //    
                    this.lastTapTime = currentTime;
                    this.lastTapX = tapX;
                    this.lastTapY = tapY;
                    for (const btn of this.zoomButtons) {
                        if (tapX >= btn.x && tapX <= btn.x + btn.width &&
                            tapY >= btn.y && tapY <= btn.y + btn.height) {
                            if (btn.type === 'zoomIn') {
                                this.zoomIn();
                                if (this.config.onZoomButtonClick) {
                                    this.config.onZoomButtonClick('zoomIn', this.zoomStart, this.zoomEnd);
                                }
                            }
                            else if (btn.type === 'zoomOut') {
                                this.zoomOut();
                                if (this.config.onZoomButtonClick) {
                                    this.config.onZoomButtonClick('zoomOut', this.zoomStart, this.zoomEnd);
                                }
                            }
                            else if (btn.type === 'reset') {
                                this.zoomReset();
                                if (this.config.onZoomButtonClick) {
                                    this.config.onZoomButtonClick('reset', this.zoomStart, this.zoomEnd);
                                }
                            }
                            break;
                        }
                    }
                    //    
                    for (const marker of this.eventMarkers) {
                        let isInside = false;
                        // Range   (  )
                        if (marker.event.isRangeLabel && marker.event.labelRect) {
                            const rect = marker.event.labelRect;
                            isInside = tapX >= rect.x && tapX <= rect.x + rect.width &&
                                tapY >= rect.y && tapY <= rect.y + rect.height;
                        }
                        // X-only  ( ) X  
                        else if (isXPointEvent(marker.event)) {
                            const dx = Math.abs(tapX - marker.x);
                            isInside = dx <= marker.radius;
                        }
                        // Y-only  ( ) Y  
                        else if (isYPointEvent(marker.event)) {
                            const dy = Math.abs(tapY - marker.y);
                            isInside = dy <= marker.radius;
                        }
                        //     
                        else {
                            const dx = tapX - marker.x;
                            const dy = tapY - marker.y;
                            isInside = Math.sqrt(dx * dx + dy * dy) <= marker.radius;
                        }
                        if (isInside) {
                            // :    ,    
                            this.hoveredEventMarker = this.hoveredEventMarker === marker.event ? null : marker.event;
                            break;
                        }
                    }
                    if (this.state.showPoints && this.dataPoints.length > 0) {
                        const tapRadius = 20;
                        for (const point of this.dataPoints) {
                            const dx = tapX - point.x;
                            const dy = tapY - point.y;
                            if (Math.sqrt(dx * dx + dy * dy) <= tapRadius) {
                                const newHoveredPoint = this.hoveredPoint === point ? null : point;
                                this.hoveredPoint = newHoveredPoint;
                                //  
                                if (this.config.onPointTooltip) {
                                    this.config.onPointTooltip(newHoveredPoint);
                                }
                                break;
                            }
                        }
                    }
                    for (const item of this.legendItems) {
                        if (tapX >= item.x && tapX <= item.x + item.width &&
                            tapY >= item.y && tapY <= item.y + item.height) {
                            //    (average:  moving: )
                            if (item.symbol.startsWith('average:') || item.symbol.startsWith('moving:')) {
                                //   (visible  )
                                if (item.symbol === 'average:') {
                                    //   
                                    const avgItem = this.state.showAverage.find(avg => avg.type === 'average');
                                    if (avgItem) {
                                        avgItem.visible = !avgItem.visible;
                                    }
                                }
                                else if (item.symbol.startsWith('moving:')) {
                                    //  
                                    const xWidth = parseInt(item.symbol.split(':')[1]);
                                    const avgItem = this.state.showAverage.find(avg => avg.type === 'moving' && avg.xWidth === xWidth);
                                    if (avgItem) {
                                        avgItem.visible = !avgItem.visible;
                                    }
                                }
                            }
                            else {
                                //  
                                const wasVisible = this.state.visibleTickers.has(item.symbol);
                                if (wasVisible) {
                                    this.state.visibleTickers.delete(item.symbol);
                                }
                                else {
                                    this.state.visibleTickers.add(item.symbol);
                                }
                                //  
                                if (this.config.onLegendClick) {
                                    this.config.onLegendClick(item.symbol, !wasVisible);
                                }
                            }
                            break;
                        }
                    }
                }
                this.isTouchDragging = false;
                this.isDragging = false;
                this.dragStartX = null;
                this.dragCurrentX = null;
                this.render();
                return;
            }
            if (this.isTouchPanning) {
                this.isTouchPanning = false;
                this.panStartX = null;
                this.render();
            }
            this.touchStartX = null;
            this.touchStartY = null;
        }, { passive: true });
        //  
        this.canvas.addEventListener('touchcancel', () => {
            this.isTouchDragging = false;
            this.isTouchPanning = false;
            this.isDragging = false;
            this.dragStartX = null;
            this.dragCurrentX = null;
            this.panStartX = null;
            this.touchStartX = null;
            this.touchStartY = null;
            this.lastPinchDistance = null;
            this.render();
        }, { passive: true });
    }
    render() {
        const dpr = (typeof window !== 'undefined' && window.devicePixelRatio) || 1;
        //   canvas width/height  
        let cssW, cssH;
        if (this.canvas.getBoundingClientRect) {
            const rect = this.canvas.getBoundingClientRect();
            cssW = rect.width;
            cssH = rect.height;
        }
        else {
            // getBoundingClientRect  canvas width/height  
            cssW = this.canvas.width;
            cssH = this.canvas.height;
        }
        const width = Math.max(300, cssW);
        let totalHeight = Math.max(200, cssH);
        //        
        this.canvas.width = width * dpr;
        this.canvas.height = totalHeight * dpr;
        this.width = width;
        this.height = totalHeight;
        this.canvasWidth = width;
        this.canvasHeight = totalHeight;
        this.ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
        //    
        const bgColor = this.config.backgroundColor || '#FFFFFF';
        this.ctx.fillStyle = bgColor;
        this.ctx.fillRect(0, 0, width, totalHeight);
        //   :  padding  
        // chartAreaLeft paddingLeft, chartAreaWidth   padding  
        this.chartAreaLeft = this.paddingLeft;
        this.chartAreaWidth = width - this.paddingLeft - this.paddingRight;
        //  padding    ( )
        this.padding = this.paddingTop;
        //   
        const chartCount = this.state.visibleChartKeys.length;
        const xAxisLabelHeight = this.paddingBottom;
        const availableHeight = totalHeight - this.paddingTop - xAxisLabelHeight;
        const heightPerChart = availableHeight / chartCount;
        //   DrawArea 
        const chartAreas = [];
        this.state.visibleChartKeys.forEach((key, index) => {
            chartAreas.push({
                key,
                x: this.paddingLeft,
                y: this.paddingTop + index * heightPerChart,
                width: this.chartAreaWidth,
                height: heightPerChart
            });
        });
        //   
        let filteredDataMap = new Map();
        this.dataMap.forEach((value, symbol) => {
            if (this.state.enabledTickers.has(symbol)) {
                filteredDataMap.set(symbol, value);
            }
        });
        //     (  )
        let globalMinTime = Infinity;
        let globalMaxTime = -Infinity;
        //      (config.xMin/xMax   )
        filteredDataMap.forEach((value) => {
            Object.values(value.data).forEach(chartDataObj => {
                chartDataObj.datas.forEach(d => {
                    const time = d.x;
                    if (time < globalMinTime)
                        globalMinTime = time;
                    if (time > globalMaxTime)
                        globalMaxTime = time;
                });
            });
        });
        const globalTimeRange = globalMaxTime - globalMinTime || 1;
        // rangeSlider   
        let targetMinTime = globalMinTime;
        let targetMaxTime = globalMaxTime;
        // 1. config.xMin/xMax   (  )
        if (this.config.xMin !== undefined || this.config.xMax !== undefined) {
            if (this.config.xMin !== undefined) {
                const configMin = typeof this.config.xMin === 'function' ? this.config.xMin('default') : this.config.xMin;
                if (configMin !== undefined) {
                    targetMinTime = configMin;
                }
            }
            if (this.config.xMax !== undefined) {
                const configMax = typeof this.config.xMax === 'function' ? this.config.xMax('default') : this.config.xMax;
                if (configMax !== undefined) {
                    targetMaxTime = configMax;
                }
            }
        }
        // 2. rangeMin/rangeMax    
        if (this.state.rangeMin !== undefined && this.state.rangeMax !== undefined) {
            // rangeMin/rangeMax timestamp  
            // timestamp     (1000000000000 )
            //  0-100 
            const isRangeTimestamp = this.state.rangeMin > 1000 || this.state.rangeMax > 1000;
            if (isRangeTimestamp) {
                // timestamp  
                targetMinTime = this.state.rangeMin;
                targetMaxTime = this.state.rangeMax;
            }
            else if (this.state.rangeMin > 0 || this.state.rangeMax < 100) {
                //   (config.xMin/xMax )
                const baseMinTime = targetMinTime;
                const baseMaxTime = targetMaxTime;
                const baseTimeRange = baseMaxTime - baseMinTime || 1;
                targetMinTime = baseMinTime + baseTimeRange * this.state.rangeMin / 100;
                targetMaxTime = baseMinTime + baseTimeRange * this.state.rangeMax / 100;
            }
        }
        // zoom  
        if (this.zoomStart > 0 || this.zoomEnd < 100) {
            const rangeTimeSpan = targetMaxTime - targetMinTime;
            const zoomMinTime = targetMinTime + rangeTimeSpan * this.zoomStart / 100;
            const zoomMaxTime = targetMinTime + rangeTimeSpan * this.zoomEnd / 100;
            targetMinTime = zoomMinTime;
            targetMaxTime = zoomMaxTime;
        }
        //     
        const hasRangeSet = this.state.rangeMin !== undefined && this.state.rangeMax !== undefined;
        const isRangeTimestamp = hasRangeSet && (this.state.rangeMin > 1000 || this.state.rangeMax > 1000);
        const isRangePercent = hasRangeSet && !isRangeTimestamp && (this.state.rangeMin > 0 || this.state.rangeMax < 100);
        const needsTimeFiltering = isRangeTimestamp ||
            isRangePercent ||
            this.zoomStart > 0 ||
            this.zoomEnd < 100;
        if (needsTimeFiltering) {
            const timeFilteredMap = new Map();
            filteredDataMap.forEach((value, symbol) => {
                const filteredData = {};
                Object.keys(value.data).forEach(dataType => {
                    const chartDataObj = value.data[dataType];
                    const data = chartDataObj.datas;
                    if (data.length === 0) {
                        filteredData[dataType] = {
                            datas: [],
                            events: chartDataObj.events,
                            lineMode: chartDataObj.lineMode // lineMode 
                        };
                        return;
                    }
                    let startIdx = -1;
                    let endIdx = -1;
                    for (let i = 0; i < data.length; i++) {
                        const time = data[i].x;
                        if (time >= targetMinTime && startIdx === -1) {
                            startIdx = i;
                        }
                        if (time <= targetMaxTime) {
                            endIdx = i;
                        }
                    }
                    if (startIdx === -1 || endIdx === -1) {
                        filteredData[dataType] = {
                            datas: [],
                            events: chartDataObj.events,
                            lineMode: chartDataObj.lineMode // lineMode 
                        };
                        return;
                    }
                    const actualStartIdx = Math.max(0, startIdx - 1);
                    const actualEndIdx = Math.min(data.length - 1, endIdx + 1);
                    filteredData[dataType] = {
                        datas: data.slice(actualStartIdx, actualEndIdx + 1),
                        events: chartDataObj.events,
                        lineMode: chartDataObj.lineMode // lineMode 
                    };
                });
                timeFilteredMap.set(symbol, {
                    color: value.color,
                    lineMode: value.lineMode, //  lineMode 
                    movingAverageXwidth: value.movingAverageXwidth, //   
                    data: filteredData
                });
            });
            filteredDataMap = timeFilteredMap;
        }
        //   
        const allTimePoints = new Set();
        filteredDataMap.forEach((value) => {
            Object.values(value.data).forEach(chartDataObj => {
                chartDataObj.datas.forEach(d => {
                    const time = d.x;
                    allTimePoints.add(time);
                });
            });
        });
        this.sortedTimes = Array.from(allTimePoints).sort((a, b) => a - b);
        const displayMinTime = targetMinTime;
        const displayMaxTime = targetMaxTime;
        //  
        const oldDataMap = this.dataMap;
        this.dataMap = filteredDataMap;
        // Chart options
        const chartOptions = {
            showCandles: this.state.showCandles,
            fillGaps: this.state.showGaps,
            lineMode: this.state.lineMode,
            showAverage: this.state.showAverage,
            hideValues: this.state.hideValues,
            hideLines: this.state.hideLines,
            showGrid: this.state.showGrid,
            displayMinTime,
            displayMaxTime
        };
        //    (DrawArea )
        let firstChartResult = null;
        const allMinMaxBySymbol = new Map();
        chartAreas.forEach((area, index) => {
            const result = this.drawChartKey(area.key, area, this.state.visibleTickers, this.sortedTimes, chartOptions);
            //  chartKey minMaxBySymbol 
            if (result && result.minMaxBySymbol) {
                allMinMaxBySymbol.set(area.key, result.minMaxBySymbol);
            }
            //     legend 
            if (index === 0 && result) {
                firstChartResult = result;
            }
        });
        //    (   ,   )
        const legendArea = {
            x: 10, //    10px 
            y: this.paddingTop - 25,
            width: this.canvasWidth - 20, //    
            height: 60 //  3     
        };
        //      (Y   )
        //     -     
        /*
        const legendBgColor = this.config.legendBackgroundColor || this.config.backgroundColor;
        if (legendBgColor) {
          this.ctx.fillStyle = legendBgColor;
          // Y   (paddingLeft)    
          // legendArea.y  Y    
          const legendBottomY = legendArea.y + legendArea.height;
          this.ctx.fillRect(this.paddingLeft, legendArea.y, this.canvasWidth - this.paddingLeft, legendArea.height);
        }
        */
        // Draw legend (DrawArea )
        if (firstChartResult && !this.config.hideLegend) {
            this.legendItems = this.drawLegend(legendArea, firstChartResult.dataBySymbol, this.state.visibleTickers);
        }
        //    
        chartAreas.forEach((area, index) => {
            if (index > 0) {
                this.ctx.strokeStyle = this.getAxisColor();
                this.ctx.lineWidth = 2;
                this.ctx.beginPath();
                this.ctx.moveTo(area.x, area.y);
                this.ctx.lineTo(area.x + area.width, area.y);
                this.ctx.stroke();
            }
        });
        //     
        const chartBottom = chartAreas.length > 0
            ? chartAreas[chartAreas.length - 1].y + chartAreas[chartAreas.length - 1].height
            : totalHeight - xAxisLabelHeight;
        // X 
        const xAxisArea = {
            x: this.paddingLeft,
            y: chartBottom,
            width: this.chartAreaWidth,
            height: xAxisLabelHeight
        };
        // X  ( )
        const baselineY = xAxisArea.y;
        this.ctx.strokeStyle = this.getAxisColor();
        this.ctx.lineWidth = 1;
        this.ctx.beginPath();
        this.ctx.moveTo(xAxisArea.x, baselineY);
        this.ctx.lineTo(xAxisArea.x + xAxisArea.width, baselineY);
        this.ctx.stroke();
        // X  (DrawArea )
        if (!this.config.hideXAxisLabels) {
            this.drawXAxisLabels(xAxisArea, this.sortedTimes, displayMinTime, displayMaxTime);
        }
        //  
        if (this.state.showPoints) {
            this.dataPoints = this.drawDataPoints(this.state.visibleTickers, chartAreas, this.sortedTimes, displayMinTime, displayMaxTime);
        }
        else {
            this.dataPoints = [];
        }
        //   (  )
        this.drawEventMarkers(this.sortedTimes, chartBottom, this.state.showEvents, chartAreas, displayMinTime, displayMaxTime, allMinMaxBySymbol);
        //   
        const canvasArea = {
            x: 0,
            y: 0,
            width: width,
            height: totalHeight
        };
        //    
        if (this.state.showPoints && this.hoveredPoint) {
            this.drawPointTooltip(this.hoveredPoint, canvasArea);
        }
        //    (      )
        this.eventTooltipsToRender.forEach(tooltip => {
            this.drawEventTooltip(tooltip.event, tooltip.x, tooltip.y, tooltip.pointsDown);
        });
        //   
        const buttonSize = 25;
        const buttonGap = 10;
        const totalButtonWidth = buttonSize * 3 + buttonGap * 2;
        const zoomButtonArea = {
            x: (width - totalButtonWidth) / 2,
            y: this.paddingTop + 5,
            width: totalButtonWidth,
            height: buttonSize
        };
        //    (showZoomButtons  true )
        if (this.config.showZoomButtons) {
            this.zoomButtons = this.drawZoomButtons(zoomButtonArea, this.zoomStart, this.zoomEnd, displayMinTime, displayMaxTime);
        }
        else {
            this.zoomButtons = [];
        }
        //    
        this.drawDragSelection(this.isDragging, this.dragStartX, this.dragCurrentX, chartBottom);
        //  
        if (this.mouseX !== null && this.mouseY !== null && !this.isDragging && !this.isPanning) {
            this.drawCrosshair(this.mouseX, this.mouseY, chartAreas, this.sortedTimes, displayMinTime, displayMaxTime);
        }
        //  
        this.dataMap = oldDataMap;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot-front/src/DomRenderRootObject.ts":
/*!********************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot-front/src/DomRenderRootObject.ts ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DomRenderRootDefaultStyle: () => (/* binding */ DomRenderRootDefaultStyle),
/* harmony export */   DomRenderRootDefaultTemplate: () => (/* binding */ DomRenderRootDefaultTemplate),
/* harmony export */   DomRenderRootObject: () => (/* binding */ DomRenderRootObject)
/* harmony export */ });
/* harmony import */ var _component_ComponentRouterBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./component/ComponentRouterBase */ "../../packages/@dooboostore/simple-boot-front/src/component/ComponentRouterBase.ts");
/* harmony import */ var _dooboostore_core_message_Subject__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/core/message/Subject */ "../../packages/@dooboostore/core/src/message/Subject.ts");
/* harmony import */ var _dooboostore_dom_render_rawsets_index__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/dom-render/rawsets/index */ "../../packages/@dooboostore/dom-render/src/rawsets/index.ts");



// export const DomRenderRootDefaultTemplate = '${@this@.name}$ <button dr-event-click="$router.go(\'/\')">aa</button><button dr-event-click="console.log(@this@.name); @this@.name = 22">aa</button>  ${@this@.rootRouter}$<dr-this value="${@this@.rootRouter}$"></dr-this>'
const DomRenderRootDefaultTemplate = '<dr-this value="${@this@.child}$"></dr-this>';
// export const DomRenderRootDefaultTemplate = '<div>zz${@this@.name}$z</div>'
// export const DomRenderRootDefaultTemplate = '[${@this@.name}$]'
const DomRenderRootDefaultStyle = '';
// export const DomRenderRootDefaultTemplate = '<dr-this value="222 ${@this@.child}$"></dr-this>'
// export const DomRenderRootDefaultTemplate = '<dr-router-outlet></dr-router-outlet>'
// @Router({
//   path: ''
// })
class DomRenderRootObject extends _component_ComponentRouterBase__WEBPACK_IMPORTED_MODULE_0__.ComponentRouterBase {
    name = 'domRenderRootObject' + new Date().toISOString();
    // rootRouter?: any;
    first = true;
    onInitCallbacks = [];
    onChildRawSetRenderedDebounceCallbacks = [];
    lifeCycleSubject = new _dooboostore_core_message_Subject__WEBPACK_IMPORTED_MODULE_1__.Subject();
    constructor() {
        super({ sameRouteNoApply: true, onChildRawSetRenderedOtherDataDebounce: 5 });
    }
    lifecycleObservable() {
        return this.lifeCycleSubject.asObservable();
    }
    addOnInitCallback(cb) {
        this.onInitCallbacks.push(async () => {
            await cb();
        });
    }
    addOnChildRawSetRenderedDebounceCallback(cb) {
        this.onChildRawSetRenderedDebounceCallbacks.push(async () => {
            await cb();
        });
    }
    async onInitRender(param, rawSet) {
        // console.log('1onInitRender DomRenderRootObject', this.name);
        if (this.first) {
            await super.onInitRender(param, rawSet);
            for (const callback of this.onInitCallbacks) {
                await callback();
            }
            this.first = false;
        }
        // console.log('2onInitRender DomRenderRootObject', this.name);
    }
    async canActivate(url, data) {
        await super.canActivate(url, data);
        // console.log('canActivate DomRenderRootObject', );
    }
    async onRouting(r) {
        await super.onRouting(r);
        // console.log('onRouting DomRenderRootObject', );
    }
    onCreatedThisChildDebounce(childrenSet) {
        super.onCreatedThisChildDebounce(childrenSet);
        // console.log('dddddddddddddddddo');
    }
    async onChildRawSetRenderedDebounce() {
        for (let onChildRawSetRenderedDebounceCallback of this.onChildRawSetRenderedDebounceCallbacks) {
            await onChildRawSetRenderedDebounceCallback();
        }
        this.lifeCycleSubject.next({ type: 'end' });
        // console.log('-------bbbbbbbbbbbcccccb')
    }
    onDestroy() {
        super.onDestroy();
        // console.log('DomRenderRootObject onDestroy');
        this.child = undefined;
        const componentObjet = this[_dooboostore_dom_render_rawsets_index__WEBPACK_IMPORTED_MODULE_2__.DomRenderComponentMetaKey.DOMRENDER_COMPONENTS_KEY];
        if (componentObjet) {
            for (const key of Object.keys(componentObjet)) {
                const comp = componentObjet[key];
                if (comp && typeof comp.onDestroy === 'function') {
                    try {
                        // console.log('Calling onDestroy for component:', key);
                        comp.onDestroy();
                    }
                    catch (e) {
                        // console.error('Error during component onDestroy:', e);
                    }
                }
            }
        }
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot-front/src/SimpleBootFront.ts":
/*!****************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot-front/src/SimpleBootFront.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SimpleBootFront: () => (/* binding */ SimpleBootFront)
/* harmony export */ });
/* harmony import */ var _option_SimFrontOption__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./option/SimFrontOption */ "../../packages/@dooboostore/simple-boot-front/src/option/SimFrontOption.ts");
/* harmony import */ var _dooboostore_core_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/core/types */ "../../packages/@dooboostore/core/src/types.ts");
/* harmony import */ var _decorators_Component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./decorators/Component */ "../../packages/@dooboostore/simple-boot-front/src/decorators/Component.ts");
/* harmony import */ var _decorators_Script__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./decorators/Script */ "../../packages/@dooboostore/simple-boot-front/src/decorators/Script.ts");
/* harmony import */ var _dooboostore_dom_render_DomRender__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dooboostore/dom-render/DomRender */ "../../packages/@dooboostore/dom-render/src/DomRender.ts");
/* harmony import */ var _dooboostore_simple_boot_SimpleApplication__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @dooboostore/simple-boot/SimpleApplication */ "../../packages/@dooboostore/simple-boot/src/SimpleApplication.ts");
/* harmony import */ var _dooboostore_simple_boot_intent_Intent__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @dooboostore/simple-boot/intent/Intent */ "../../packages/@dooboostore/simple-boot/src/intent/Intent.ts");
/* harmony import */ var _dooboostore_simple_boot_simstance_SimstanceManager__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @dooboostore/simple-boot/simstance/SimstanceManager */ "../../packages/@dooboostore/simple-boot/src/simstance/SimstanceManager.ts");
/* harmony import */ var _dooboostore_simple_boot_intent_IntentManager__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @dooboostore/simple-boot/intent/IntentManager */ "../../packages/@dooboostore/simple-boot/src/intent/IntentManager.ts");
/* harmony import */ var _dooboostore_simple_boot_route_RouterManager__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @dooboostore/simple-boot/route/RouterManager */ "../../packages/@dooboostore/simple-boot/src/route/RouterManager.ts");
/* harmony import */ var _dooboostore_dom_render_DomRenderProxy__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @dooboostore/dom-render/DomRenderProxy */ "../../packages/@dooboostore/dom-render/src/DomRenderProxy.ts");
/* harmony import */ var _dooboostore_dom_render_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @dooboostore/dom-render/rawsets/RawSet */ "../../packages/@dooboostore/dom-render/src/rawsets/RawSet.ts");
/* harmony import */ var _dooboostore_dom_render_routers_Router__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @dooboostore/dom-render/routers/Router */ "../../packages/@dooboostore/dom-render/src/routers/Router.ts");
/* harmony import */ var _dooboostore_dom_render_routers_HashRouter__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @dooboostore/dom-render/routers/HashRouter */ "../../packages/@dooboostore/dom-render/src/routers/HashRouter.ts");
/* harmony import */ var _dooboostore_dom_render_routers_PathRouter__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @dooboostore/dom-render/routers/PathRouter */ "../../packages/@dooboostore/dom-render/src/routers/PathRouter.ts");
/* harmony import */ var _DomRenderRootObject__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./DomRenderRootObject */ "../../packages/@dooboostore/simple-boot-front/src/DomRenderRootObject.ts");
/* harmony import */ var _dooboostore_simple_boot_decorators_route_Router__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/route/Router */ "../../packages/@dooboostore/simple-boot/src/decorators/route/Router.ts");
/* harmony import */ var _dooboostore_core_message_BehaviorSubject__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! @dooboostore/core/message/BehaviorSubject */ "../../packages/@dooboostore/core/src/message/BehaviorSubject.ts");
/* harmony import */ var _dooboostore_core_message_operators_filter__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @dooboostore/core/message/operators/filter */ "../../packages/@dooboostore/core/src/message/operators/filter.ts");
/* harmony import */ var _dooboostore_core_message_operators_first__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! @dooboostore/core/message/operators/first */ "../../packages/@dooboostore/core/src/message/operators/first.ts");
/* harmony import */ var _dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! @dooboostore/core-web/valid/ValidUtils */ "../../packages/@dooboostore/core-web/src/valid/ValidUtils.ts");





















const isPopStateDataType = (state) => {
    return state && state.type === 'popstateData' && 'router' in state;
};
class SimpleBootFront extends _dooboostore_simple_boot_SimpleApplication__WEBPACK_IMPORTED_MODULE_5__.SimpleApplication {
    option;
    domRendoerExcludeProxy = [
        _dooboostore_simple_boot_SimpleApplication__WEBPACK_IMPORTED_MODULE_5__.SimpleApplication,
        _dooboostore_simple_boot_intent_IntentManager__WEBPACK_IMPORTED_MODULE_8__.IntentManager,
        _dooboostore_simple_boot_route_RouterManager__WEBPACK_IMPORTED_MODULE_9__.RouterManager,
        _dooboostore_simple_boot_simstance_SimstanceManager__WEBPACK_IMPORTED_MODULE_7__.SimstanceManager,
        _DomRenderRootObject__WEBPACK_IMPORTED_MODULE_15__.DomRenderRootObject,
        _option_SimFrontOption__WEBPACK_IMPORTED_MODULE_0__.SimFrontOption,
        _dooboostore_dom_render_routers_Router__WEBPACK_IMPORTED_MODULE_12__.Router
    ];
    domRenderTargetElements = [];
    domRenderTargetAttrs = [];
    domRenderConfig;
    domRenderRouter;
    routerAndSettingData;
    // private rootRouterTargetElement?: Element;
    rootRouter;
    domRenderRootObject;
    routingSubject = new _dooboostore_core_message_BehaviorSubject__WEBPACK_IMPORTED_MODULE_17__.BehaviorSubject({ triggerPoint: 'initial' });
    constructor(option) {
        super(option);
        this.option = option;
        this.domRenderRootObject = new _DomRenderRootObject__WEBPACK_IMPORTED_MODULE_15__.DomRenderRootObject();
        this.domRendoerExcludeProxy = this.domRendoerExcludeProxy.filter(it => it !== null);
        if (typeof HTMLElement !== 'undefined') {
            this.domRendoerExcludeProxy.push(HTMLElement);
        }
        if (typeof CanvasRenderingContext2D !== 'undefined') {
            this.domRendoerExcludeProxy.push(CanvasRenderingContext2D);
        }
        if (typeof CanvasPattern !== 'undefined') {
            this.domRendoerExcludeProxy.push(CanvasPattern);
        }
        if (typeof CanvasGradient !== 'undefined') {
            this.domRendoerExcludeProxy.push(CanvasGradient);
        }
        // const navigation = new Navigation(this.simstanceManager, this.option);
        // console.log('-----', navigation)
        // this.simstanceManager.setStoreSet(Navigation, navigation);
        this.domRenderRouter =
            option.urlType === 'path'
                ? new _dooboostore_dom_render_routers_PathRouter__WEBPACK_IMPORTED_MODULE_14__.PathRouter({
                    window: option.window
                    // changeStateConvertDate:(data) =>({...data, type: 'popstateData', router: this.routerAndSettingData.routerAtomic.getValue()} as PopStateType)
                })
                : new _dooboostore_dom_render_routers_HashRouter__WEBPACK_IMPORTED_MODULE_13__.HashRouter({
                    window: option.window
                    // changeStateConvertDate:(data) =>({...data, type: 'popstateData', router: this.routerAndSettingData.routerAtomic.getValue()} as PopStateType)
                });
        this.simstanceManager.setStoreSet(_dooboostore_dom_render_routers_Router__WEBPACK_IMPORTED_MODULE_12__.Router, this.domRenderRouter);
        this.domRenderConfig = {
            window: option.window,
            targetElements: this.domRenderTargetElements,
            targetAttrs: this.domRenderTargetAttrs,
            onElementInit: (name, obj, rawSet, targetElement) => {
            },
            onAttrInit: (attrName, attrValue, obj, rawSet) => {
            },
            // routerType: option.urlType,
            routerType: this.domRenderRouter,
            scripts: {
                application: this
                // @Script   
                // concat: function (head: string, tail: string) {
                //   return head + tail;
                // }
            },
            // applyEvents: [{
            //     attrName: 'router-link',
            //     callBack: (elements: Element, attrValue: string, obj: any) => {
            //         elements.addEventListener('click', (event) => {
            //             this.getSimstanceManager().getOrNewSim({target:Navigation})?.go(attrValue)
            //         })
            //     }
            // }],
            eventVariables: {},
            proxyExcludeTyps: this.domRendoerExcludeProxy,
            operatorAround: {}
        };
        this.option.window.__dirname = 'simple-boot-front__dirname';
        this.option.window.__SimpleBootFront = this;
        option.proxy = {
            onAfterProxy: (it) => this.createDomRender(it)
        };
    }
    get routingSubjectObservable() {
        return this.routingSubject.asObservable();
    }
    getComponentInnerHtml(targetObj, id) {
        const component = (0,_decorators_Component__WEBPACK_IMPORTED_MODULE_2__.getComponent)(targetObj);
        const styles = _dooboostore_dom_render_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_11__.RawSet.generateStyleTransform(component?.styles ?? '', id);
        const template = component?.template ?? '';
        return styles + template;
    }
    createDomRender(obj) {
        const component = (0,_decorators_Component__WEBPACK_IMPORTED_MODULE_2__.getComponent)(obj);
        // console.log('onProxy!!!', obj, component);
        if (component && typeof obj === 'object') {
            //     //  ??   normalattribute  DomrenderPRoxy set   root  ref  .
            //     // console.log('fffffffffffffffffffffffffffff', obj);
            //     // root Router 
            //     if (this.option.rootRouter === obj.constructor) {
            //       // console.log('?')
            //       this.rootRouterTargetElement = this.option.window.document.querySelector(this.option.selector).cloneNode(true) as Element;
            //       this.rootRouterTargetElement.innerHTML = '';
            //       this.rootRouterTargetElement.setAttribute('hidden', '')
            //       this.option.window.document.body.appendChild(this.rootRouterTargetElement);
            //       const data = this.writeRootRouter(this.rootRouterTargetElement, obj);
            //       // this.rootRouterInstance = obj;
            //       const result = DomRender.run({rootObject: obj, config: this.domRenderConfig, target: this.rootRouterTargetElement});
            //       return result;
            //       // this.targetElement = data.target;
            //       // document.body.appendChild(this.targetElement);
            //     } else {
            // console.log('--DomRender.run({ rootObject: obj, config: this.domRenderConfig })---->',obj)
            const result = _dooboostore_dom_render_DomRender__WEBPACK_IMPORTED_MODULE_4__.DomRender.run({ rootObject: obj, config: this.domRenderConfig });
            // console.log('proxy end', result);
            return result;
            //     }
            //     // this.domRenderRouter = domRenderResult.config.router;
            //     // this.simstanceManager.getOrNewSim({target:Navigation})?.routers.push(this.domRenderRouter);
            //     // console.log('createDomRender', this.domRenderRouter)
            //     // return domRenderResult.rootObject;
        }
        return obj;
    }
    initRun(otherInstanceSim) {
        // console.log('!@!!', this.option.window.document.body.innerHTML);
        const targetUserElement = typeof this.option.selector === 'string'
            ? this.option.window.document.querySelector(this.option.selector)
            : this.option.selector;
        if (!(targetUserElement instanceof HTMLElement)) {
            throw new Error('HTMLElement is not Element');
        }
        const simstanceManager = super.run(otherInstanceSim);
        this.initDomRenderConfigSetting();
        this.option.window.addEventListener('intent', event => {
            const cevent = event;
            this.publishIntent(new _dooboostore_simple_boot_intent_Intent__WEBPACK_IMPORTED_MODULE_6__.Intent(cevent.detail.uri, cevent.detail.data, event));
        });
        let targetElement = targetUserElement;
        const rect = targetUserElement.getBoundingClientRect();
        const originPosition = targetElement.style.position;
        const originTop = targetElement.style.top;
        const originLeft = targetElement.style.left;
        const originWidth = targetElement.style.width;
        const originHeight = targetElement.style.height;
        const originZIndex = targetElement.style.zIndex;
        // console.log('-----rect-----', rect, originPosition, originTop, originLeft, originWidth, originHeight, originZIndex);
        if (_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_20__.ValidUtils.isBrowser()) {
            // console.log('none server side')
            targetUserElement.removeAttribute('id');
            targetElement = targetUserElement.cloneNode(true);
            if (!targetElement || !targetUserElement) {
                throw new Error('no element selector ' + this.option.selector);
            }
            targetElement.setAttribute('dom-render-side', 'client');
            targetElement.innerHTML = _DomRenderRootObject__WEBPACK_IMPORTED_MODULE_15__.DomRenderRootDefaultTemplate;
            targetElement.removeAttribute('dom-render-done');
            // targetElement = targetUserElement;
            //  console.log('------???????', targetUserElement, this.option.selector)
            targetElement.style.position = 'fixed';
            targetElement.style.top = `${rect.top}px`;
            targetElement.style.left = `${rect.left}px`;
            targetElement.style.width = `${rect.width}px`;
            targetElement.style.height = `${rect.height}px`;
            targetElement.style.zIndex = '999999';
            targetElement.setAttribute('random', Math.random().toString());
            // NodeUtils.insertAfter
            targetUserElement.parentNode.insertBefore(targetElement, targetUserElement.nextSibling);
        }
        else {
            targetElement.setAttribute('dom-render-side', 'server');
            targetElement.innerHTML = _DomRenderRootObject__WEBPACK_IMPORTED_MODULE_15__.DomRenderRootDefaultTemplate;
            // console.log('server side')
        }
        // const targetElement = this.option.window.document.querySelector(this.option.selector);
        // const {rootObject: domRenderRoot, config } = DomRender.runSet({rootObject: this.domRenderRootObject, target: targetElement, config: this.domRenderConfig});
        const domRender = new _dooboostore_dom_render_DomRender__WEBPACK_IMPORTED_MODULE_4__.DomRender({
            rootObject: this.domRenderRootObject,
            target: targetElement,
            config: this.domRenderConfig
        });
        this.simstanceManager.setStoreSet(_dooboostore_dom_render_DomRender__WEBPACK_IMPORTED_MODULE_4__.DomRender, domRender);
        this.domRenderRootObject = domRender.rootObject;
        (0,_dooboostore_simple_boot_decorators_route_Router__WEBPACK_IMPORTED_MODULE_16__.routerProcess)({ path: '', routers: [this.option.rootRouter] }, _DomRenderRootObject__WEBPACK_IMPORTED_MODULE_15__.DomRenderRootObject);
        //      .
        this.domRenderRootObject.addOnChildRawSetRenderedDebounceCallback(() => {
            const hasDone = targetElement.hasAttribute('dom-render-done');
            // console.log('----domRenderRootObject rendered-----', hasDone);
            if (!hasDone) {
                targetElement.setAttribute('dom-render-done', 'done');
                if (_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_20__.ValidUtils.isBrowser()) {
                    targetElement.style.position = originPosition;
                    targetElement.style.top = originTop;
                    targetElement.style.left = originLeft;
                    targetElement.style.width = originWidth;
                    targetElement.style.height = originHeight;
                    targetElement.style.zIndex = originZIndex;
                    targetUserElement.remove();
                }
                else {
                }
            }
        });
        // console.log('-----------aaaaaa', aaa);
        // this.domRenderRootObject.lifecycleObservable().pipe(first()).toPromise().then(() => {
        //   console.log('-----------lifecycleObservable toPromise done');
        // })
        // this.domRenderRootObject.lifecycleObservable().subscribe(it => {
        //   console.log('-----------lifecycleObservable', it);
        // })
        // dom-render  
        this.domRenderRouter.observable.pipe((0,_dooboostore_core_message_operators_filter__WEBPACK_IMPORTED_MODULE_18__.filter)(it => it.triggerPoint === 'end')).subscribe(it => {
            // console.log('this.domRenderRouter.observable.subscribe---------------', it)
            //   console.log('this.domRenderRouter.observable', it)
            // const intent = new Intent(it.path || '/');
            const targetPath = (it.path || '/') + (it.search);
            const intent = new _dooboostore_simple_boot_intent_Intent__WEBPACK_IMPORTED_MODULE_6__.Intent(targetPath);
            //   // TODO:  canActivate    !!  setTimeout     
            this.routing(intent, { router: this.domRenderRootObject }).then(async (it) => {
                // console.log('simplebootfront simpleboot routing-------->', it)
                // dom-render   -> simple-boot-front routing start!
                this.routingSubject.next({ triggerPoint: 'start', routerModule: it });
                let findFirstRouter = it.firstRouteChainValue;
                if (findFirstRouter && findFirstRouter.constructor === this.option.rootRouter) {
                    const rootRouter = (0,_dooboostore_dom_render_DomRenderProxy__WEBPACK_IMPORTED_MODULE_10__.getDomRenderOriginObject)(this.rootRouter?.obj);
                    const findRouter = (0,_dooboostore_dom_render_DomRenderProxy__WEBPACK_IMPORTED_MODULE_10__.getDomRenderOriginObject)(findFirstRouter);
                    await this.domRenderRootObject.canActivate(undefined, findRouter);
                    // const aaa = await this.domRenderRootObject.lifecycleObservable().toPromise();
                    await this.domRenderRootObject.onRouting({ intent, routerModule: it, routerManager: this.routerManager });
                    // console.log('-----> simplebootfront rootRouter onRouting done-------->', it, it.intent.uri)
                }
                // console.log('----> simplebootfront simpleboot routing done-------->', it, it.intent.uri)
                // console.log('-----> simplebootfront before wait domRenderRootObject rendered-------->', it, it.intent.uri)
                // if (ValidUtils.isBrowser()) {
                //   this.routingSubject.next({triggerPoint: 'end', routerModule: it});
                // } else {
                await this.domRenderRootObject.lifecycleObservable().pipe((0,_dooboostore_core_message_operators_first__WEBPACK_IMPORTED_MODULE_19__.first)()).toPromise();
                this.routingSubject.next({ triggerPoint: 'end', routerModule: it });
                // }
                //       }, 0);
            });
        });
        return simstanceManager;
    }
    async goRouting(url) {
        // console.log('simplebootfront goRouting-------->', url);
        await this.domRenderRouter?.go({ path: url });
        // this.afterSetting();
    }
    async getIntent(url) {
        const intent = typeof url === 'string' ? new _dooboostore_simple_boot_intent_Intent__WEBPACK_IMPORTED_MODULE_6__.Intent(url) : url;
        const data = await this.routing(intent);
        return data;
    }
    run(otherInstanceSim, url) {
        const simstanceManager = this.initRun(otherInstanceSim);
        // const currentUrl = UrlUtils.toUrl(this.option.window.location.href);
        // const origin = currentUrl.origin;
        // const path = `${url ? origin + (url ?? '/') : currentUrl.href}`;
        // console.log('gorouting!!',path);
        // this.domRenderRouter.go({path: path});
        return this;
    }
    // private dispatchPopStateEvent(noSimpleBootFrontRouting?: boolean) {
    //   const state: PopStateType = this.routerAndSettingData
    //     ? { type: 'popstateData', noSimpleBootFrontRouting, router: this.routerAndSettingData.routerAtomic.getValue() }
    //     : undefined;
    //   // console.log('dispatchPopState', state)
    //   this.option.window.dispatchEvent(new PopStateEvent('popstate', { triggerPoint: state }));
    // }
    // TODO:     .... ....
    //   private afterSetting() {
    //     this.option.window.document.querySelectorAll('[router-link]').forEach(it => {
    //       const link = it.getAttribute('router-link');
    //       if (link && this.domRenderRouter) {
    //         const activeClasss = it.getAttribute('router-active-class');
    //         const aClasss = activeClasss?.split(',');
    //         const inActiveClasss = it.getAttribute('router-inactive-class');
    //         const iClasss = inActiveClasss?.split(',');
    //         if (this.domRenderRouter.getPathName() === link) {
    //           if (aClasss && aClasss.length > 0) {
    //             it.classList.add(...aClasss);
    //           }
    //           if (iClasss && iClasss.length > 0) {
    //             it.classList.remove(...iClasss);
    //           }
    //         } else {
    //           if (aClasss && aClasss.length > 0) {
    //             it.classList.remove(...aClasss);
    //           }
    //           if (iClasss && iClasss.length > 0) {
    //             it.classList.add(...iClasss);
    //           }
    //         }
    //       }
    //     });
    //   }
    initDomRenderConfigSetting() {
        const simstanceManager = this.simstanceManager;
        _decorators_Script__WEBPACK_IMPORTED_MODULE_3__.scripts.forEach((val, name) => {
            this.domRenderConfig.scripts[name] = function (...args) {
                let obj;
                try {
                    obj = simstanceManager.getOrNewSim({ target: val });
                }
                catch (e) {
                    obj = simstanceManager.newSim({ target: val });
                }
                const render = this.__render;
                const scriptRunnable = obj;
                if (render.rawSet) {
                    scriptRunnable.rawSets.set(render.rawSet, this);
                }
                return scriptRunnable.run(...args);
            };
        });
        const selectors = _decorators_Component__WEBPACK_IMPORTED_MODULE_2__.componentSelectors;
        selectors.forEach((val, name) => {
            const component = (0,_decorators_Component__WEBPACK_IMPORTED_MODULE_2__.getComponent)(val);
            const items = _dooboostore_dom_render_rawsets_RawSet__WEBPACK_IMPORTED_MODULE_11__.RawSet.createComponentTargetElement({
                name: name,
                noStrip: component?.noStrip === true,
                objFactory: (e, obj, r, counstructorParam) => {
                    let newSim;
                    if (counstructorParam?.length) {
                        newSim = new val(...counstructorParam);
                    }
                    else {
                        newSim = this.simstanceManager.newSim({ target: val });
                    }
                    if (component) {
                        const proxys = (Array.isArray(component.proxy) ? component.proxy : [component.proxy]).filter(_dooboostore_core_types__WEBPACK_IMPORTED_MODULE_1__.isDefined);
                        proxys.forEach(it => {
                            if (typeof it === 'object') {
                                newSim = new Proxy(newSim, it);
                            }
                            else {
                                newSim = new Proxy(newSim, this.simstanceManager.newSim({ target: it }));
                            }
                        });
                    }
                    return newSim;
                },
                template: component?.template,
                styles: component?.styles
            });
            this.domRenderTargetElements.push(items);
        });
        this.domRenderConfig.eventVariables = {
            $router: this.domRenderRouter,
            $application: this
        };
        // console.log('---------------------scripts', this.domRenderConfig.scripts);
    }
    getSimstanceManager() {
        return this.simstanceManager;
    }
    onDestroy() {
        // console.log('SimpleBootFront onDestroy');
        this.domRenderRootObject.onDestroy();
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot-front/src/component/ComponentBase.ts":
/*!************************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot-front/src/component/ComponentBase.ts ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ComponentBase: () => (/* binding */ ComponentBase)
/* harmony export */ });
/* harmony import */ var _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/dom-render/components/ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");

class ComponentBase extends _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_0__.ComponentBase {
    async onRouting(r) {
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot-front/src/component/ComponentRouterBase.ts":
/*!******************************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot-front/src/component/ComponentRouterBase.ts ***!
  \******************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ComponentRouterBase: () => (/* binding */ ComponentRouterBase)
/* harmony export */ });
/* harmony import */ var _dooboostore_dom_render_components_ComponentRouterBase__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/dom-render/components/ComponentRouterBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentRouterBase.ts");
/* harmony import */ var _ComponentSet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ComponentSet */ "../../packages/@dooboostore/simple-boot-front/src/component/ComponentSet.ts");
/* harmony import */ var _dooboostore_dom_render_DomRenderProxy__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/dom-render/DomRenderProxy */ "../../packages/@dooboostore/dom-render/src/DomRenderProxy.ts");
/* harmony import */ var _dooboostore_dom_render_components_router_RouterOutlet__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/dom-render/components/router/RouterOutlet */ "../../packages/@dooboostore/dom-render/src/components/router/RouterOutlet.ts");




class ComponentRouterBase extends _dooboostore_dom_render_components_ComponentRouterBase__WEBPACK_IMPORTED_MODULE_0__.ComponentRouterBase {
    constructor(_config) {
        super(_config);
    }
    // get child() {
    //   return this._child;
    // }
    setChild(child) {
        // console.log('setChild!!', child, (this as any).name)
        if (child) {
            child = child instanceof _ComponentSet__WEBPACK_IMPORTED_MODULE_1__.ComponentSet ? child : new _ComponentSet__WEBPACK_IMPORTED_MODULE_1__.ComponentSet(child);
        }
        else {
            child = undefined;
        }
        super.setChild(child);
    }
    onDrThisUnBind() {
        super.onDrThisUnBind();
    }
    onCreatedThisChildDebounce(childrenSet) {
        super.onCreatedThisChildDebounce(childrenSet);
        // const routerOutlet = this.getChildren(RouterOutlet.RouterOutlet);
        // if (routerOutlet) {
        //   routerOutlet.forEach(it => it.setValue(this.child));
        // }
    }
    async canActivate(url, data) {
        // console.log('cccccccccccc', data, typeof data);
        if (!(this.componentConfig?.sameRouteNoApply &&
            (0,_dooboostore_dom_render_DomRenderProxy__WEBPACK_IMPORTED_MODULE_2__.getDomRenderOriginObject)(this.child?.obj) === (0,_dooboostore_dom_render_DomRenderProxy__WEBPACK_IMPORTED_MODULE_2__.getDomRenderOriginObject)(data))) {
            this.child = new _ComponentSet__WEBPACK_IMPORTED_MODULE_1__.ComponentSet(data);
            const routerOutlet = this.getChildren(_dooboostore_dom_render_components_router_RouterOutlet__WEBPACK_IMPORTED_MODULE_3__.RouterOutlet.RouterOutlet);
            if (routerOutlet) {
                routerOutlet.forEach(it => it.setValue(this.child));
            }
        }
    }
    async onRouting(r) {
        // if (RouterAction.isOnRouting(this.child?.obj)){
        //   await this.child.obj.onRouting(r);
        // }
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot-front/src/component/ComponentSet.ts":
/*!***********************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot-front/src/component/ComponentSet.ts ***!
  \***********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ComponentSet: () => (/* binding */ ComponentSet)
/* harmony export */ });
/* harmony import */ var _dooboostore_dom_render_components_ComponentSet__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/dom-render/components/ComponentSet */ "../../packages/@dooboostore/dom-render/src/components/ComponentSet.ts");
/* harmony import */ var _decorators_Component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../decorators/Component */ "../../packages/@dooboostore/simple-boot-front/src/decorators/Component.ts");


class ComponentSet extends _dooboostore_dom_render_components_ComponentSet__WEBPACK_IMPORTED_MODULE_0__.ComponentSet {
    constructor(data) {
        const component = (0,_decorators_Component__WEBPACK_IMPORTED_MODULE_1__.getComponent)(data);
        if (component) {
            const styles = component?.styles ?? [];
            const template = component?.template ?? '';
            super(data, { template, styles });
        }
        else {
            super(data, {});
        }
    }
}
// export const createComponentSet = (data: any) => {
//   const component = getComponent(data);
//      if (component) {
//      const styles = component?.styles ?? [];
//      const template = component?.template ?? '';
//      return new ComponentSet(data, template, styles, {objPath: null});
//    } else {
//        return new ComponentSet(data);
//    }
// }


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot-front/src/decorators/Component.ts":
/*!*********************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot-front/src/decorators/Component.ts ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Component: () => (/* binding */ Component),
/* harmony export */   ComponentMetadataKey: () => (/* binding */ ComponentMetadataKey),
/* harmony export */   componentSelectors: () => (/* binding */ componentSelectors),
/* harmony export */   getComponent: () => (/* binding */ getComponent)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/reflect/ReflectUtils */ "../../packages/@dooboostore/core/src/reflect/ReflectUtils.ts");

const componentSelectors = new Map();
const ComponentMetadataKey = Symbol('Component');
// Partial<ComponentConfig>
const componentProcess = (config, target) => {
    if (!config.selector) {
        config.selector = target.name.toLowerCase();
    }
    _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.defineMetadata(ComponentMetadataKey, config, target);
    componentSelectors.set(config.selector.toLowerCase(), target);
};
function Component(configOrTarget) {
    if (typeof configOrTarget === 'function') {
        componentProcess({}, configOrTarget);
    }
    else {
        return (target) => {
            componentProcess(configOrTarget, target);
        };
    }
}
const getComponent = (target) => {
    if (target && typeof target === 'object') {
        target = target.constructor;
    }
    try {
        return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(ComponentMetadataKey, target);
    }
    catch (e) {
    }
};


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot-front/src/decorators/Script.ts":
/*!******************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot-front/src/decorators/Script.ts ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Script: () => (/* binding */ Script),
/* harmony export */   ScriptMetadataKey: () => (/* binding */ ScriptMetadataKey),
/* harmony export */   getScript: () => (/* binding */ getScript),
/* harmony export */   scripts: () => (/* binding */ scripts)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/reflect/ReflectUtils */ "../../packages/@dooboostore/core/src/reflect/ReflectUtils.ts");

const scripts = new Map();
const ScriptMetadataKey = Symbol('Script');
const Script = (config) => {
    return (target) => {
        // default set
        if (!config) {
            config = {};
        }
        if (!config.name) {
            config.name = target.name;
        }
        scripts.set(config.name, target);
        _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.defineMetadata(ScriptMetadataKey, config, target);
        return target;
    };
};
const getScript = (target) => {
    if (target && typeof target === 'object') {
        target = target.constructor;
    }
    try {
        return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(ScriptMetadataKey, target);
    }
    catch (e) {
    }
};


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot-front/src/option/SimFrontOption.ts":
/*!**********************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot-front/src/option/SimFrontOption.ts ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SimFrontOption: () => (/* binding */ SimFrontOption),
/* harmony export */   UrlType: () => (/* binding */ UrlType)
/* harmony export */ });
/* harmony import */ var _dooboostore_simple_boot_SimOption__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/simple-boot/SimOption */ "../../packages/@dooboostore/simple-boot/src/SimOption.ts");

var UrlType;
(function (UrlType) {
    UrlType["path"] = "path";
    UrlType["hash"] = "hash";
})(UrlType || (UrlType = {}));
class SimFrontOption extends _dooboostore_simple_boot_SimOption__WEBPACK_IMPORTED_MODULE_0__.SimOption {
    config;
    constructor(config, initSimOption) {
        super(initSimOption);
        this.config = config;
    }
    get window() {
        return this.config.window;
    }
    get selector() {
        return this.config.selector ?? '#app';
    }
    get urlType() {
        return this.config.urlType ?? UrlType.path;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot-http-server-ssr/src/SimpleBootHttpSSRFactory.ts":
/*!***********************************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot-http-server-ssr/src/SimpleBootHttpSSRFactory.ts ***!
  \***********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SimpleBootHttpSSRFactory: () => (/* binding */ SimpleBootHttpSSRFactory)
/* harmony export */ });
class SimpleBootHttpSSRFactory {
    async create(simFrontOption, using = [], domExcludes = []) {
        const front = await this.factory(simFrontOption, using, domExcludes);
        return front;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot-http-server-ssr/src/proxy/SymbolIntentApiServiceProxy.ts":
/*!********************************************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot-http-server-ssr/src/proxy/SymbolIntentApiServiceProxy.ts ***!
  \********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SymbolIntentApiServiceProxy: () => (/* binding */ SymbolIntentApiServiceProxy)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_simple_boot_http_server_codes_HttpHeaders__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/simple-boot-http-server/codes/HttpHeaders */ "../../packages/@dooboostore/simple-boot-http-server/src/codes/HttpHeaders.ts");
/* harmony import */ var _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/core/convert/ConvertUtils */ "../../packages/@dooboostore/core/src/convert/ConvertUtils.ts");
/* harmony import */ var _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dooboostore/simple-boot/fetch/ApiService */ "../../packages/@dooboostore/simple-boot/src/fetch/ApiService.ts");
var SymbolIntentApiServiceProxy_1;
var _a;





const _ = _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_4__.ApiService;
let SymbolIntentApiServiceProxy = SymbolIntentApiServiceProxy_1 = class SymbolIntentApiServiceProxy {
    apiService;
    constructor(apiService) {
        this.apiService = apiService;
        // console.log('-------apiService', apiService);
    }
    static createHandler(apiService) {
        return {
            get(target, prop, receiver) {
                const simConfig = (0,_dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__.getSim)(target);
                const value = Reflect.get(target, prop, receiver);
                if (typeof value === 'function' && simConfig?.symbol) {
                    return function (...args) {
                        const f = value;
                        const p = (userConfig) => {
                            const headers = { ...(userConfig?.headers ?? {}), ...(0,_dooboostore_simple_boot_http_server_codes_HttpHeaders__WEBPACK_IMPORTED_MODULE_2__.makeIntentHeaderBySymbolFor)(simConfig.symbol) };
                            const method = userConfig?.method ?? 'post';
                            if (method === 'post' && userConfig?.multipartFormData) {
                                //@ts-ignore
                                return apiService.post({
                                    target: `/${String(prop)}`,
                                    config: {
                                        responseTransform: userConfig?.bypassTransform ? 'response' : undefined,
                                        transformText: userConfig?.transformText,
                                        config: userConfig?.config,
                                        fetch: {
                                            credentials: 'include',
                                            headers: headers,
                                            body: _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_3__.ConvertUtils.toFormData(userConfig?.body)
                                        }
                                    }
                                });
                            }
                            else if (method === 'post') {
                                //@ts-ignore
                                return apiService.postJson({
                                    target: `/${String(prop)}`,
                                    config: {
                                        responseTransform: userConfig?.bypassTransform ? 'response' : undefined,
                                        transformText: userConfig?.transformText,
                                        config: userConfig?.config,
                                        fetch: {
                                            credentials: 'include',
                                            headers: headers,
                                            body: userConfig?.body
                                        }
                                    }
                                });
                            }
                            else if (method === 'petch') {
                                //@ts-ignore
                                return apiService.patchJson({
                                    target: `/${String(prop)}`,
                                    config: {
                                        responseTransform: userConfig?.bypassTransform ? 'response' : undefined,
                                        transformText: userConfig?.transformText,
                                        config: userConfig?.config,
                                        fetch: {
                                            credentials: 'include',
                                            headers: headers,
                                            body: userConfig?.body
                                        }
                                    }
                                });
                            }
                            else {
                                //@ts-ignore
                                return apiService[method]({
                                    target: { url: `/${String(prop)}`, searchParams: userConfig?.body },
                                    config: {
                                        responseTransform: userConfig?.bypassTransform ? 'response' : undefined,
                                        transformText: userConfig?.transformText,
                                        config: userConfig?.config,
                                        fetch: {
                                            credentials: 'include',
                                            headers: headers,
                                        }
                                    }
                                });
                            }
                        };
                        args.push(p);
                        return Reflect.apply(f, target, args);
                    };
                }
                return Reflect.get(target, prop, receiver);
            },
            apply(target, thisArg, argArray) {
                console.log('SymbolIntentApiServiceProxy apply');
                // @ts-ignore
                return Reflect.apply(target, thisArg, argArray);
            }
        };
    }
    get(target, prop, receiver) {
        return SymbolIntentApiServiceProxy_1.createHandler(this.apiService).get(target, prop, receiver);
    }
    apply(target, thisArg, argArray) {
        return SymbolIntentApiServiceProxy_1.createHandler(this.apiService).apply(target, thisArg, argArray);
    }
};
SymbolIntentApiServiceProxy = SymbolIntentApiServiceProxy_1 = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__.Sim,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_4__.ApiService !== "undefined" && _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_4__.ApiService) === "function" ? _a : Object])
], SymbolIntentApiServiceProxy);



/***/ }),

/***/ "../../packages/@dooboostore/simple-boot-http-server/src/codes/HttpHeaders.ts":
/*!************************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot-http-server/src/codes/HttpHeaders.ts ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   HttpHeaders: () => (/* binding */ HttpHeaders),
/* harmony export */   makeIntentHeaderBySymbolFor: () => (/* binding */ makeIntentHeaderBySymbolFor)
/* harmony export */ });
/* harmony import */ var _Mimes__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Mimes */ "../../packages/@dooboostore/simple-boot-http-server/src/codes/Mimes.ts");

const HttpHeaders = {
    ContentLength: 'Content-Length',
    ContentType: 'Content-Type',
    ContentEncoding: 'Content-Encoding',
    Accept: 'Accept',
    Authorization: 'Authorization',
    CacheControl: 'Cache-Control',
    Connection: 'Connection',
    Date: 'Date',
    Host: 'Host',
    Pragma: 'Pragma',
    Trailer: 'Trailer',
    TransferEncoding: 'Transfer-Encoding',
    Upgrade: 'Upgrade',
    Via: 'Via',
    Warning: 'Warning',
    AcceptCharset: 'Accept-Charset',
    AcceptEncoding: 'Accept-Encoding',
    AcceptLanguage: 'Accept-Language',
    AccessControlAllowOrigin: 'Access-Control-Allow-Origin',
    AccessControlAllowMethods: 'Access-Control-Allow-Methods',
    AccessControlAllowHeaders: 'Access-Control-Allow-Headers',
    AccessControlExposeHeaders: 'Access-Control-Expose-Headers',
    Expect: 'Expect',
    From: 'From',
    MaxForwards: 'Max-Forwards',
    Referer: 'Referer',
    UserAgent: 'User-Agent',
    Cookie: 'Cookie',
    SetCookie: 'Set-Cookie',
    // SetHeader : 'Set-Header',
    Cookie2: 'Cookie2',
    SetCookie2: 'Set-Cookie2',
    Location: 'Location',
    IfModifiedSince: 'If-Modified-Since',
    IfUnmodifiedSince: 'If-Unmodified-Since',
    IfMatch: 'If-Match',
    IfNoneMatch: 'If-None-Match',
    IfRange: 'If-Range',
    Allow: 'Allow',
    Server: 'Server',
    XSimpleBootSsrIntentScheme: 'x-simple-boot-ssr-intent-scheme'
};
const makeIntentHeaderBySymbolFor = (symbol) => {
    return {
        [HttpHeaders.Accept]: _Mimes__WEBPACK_IMPORTED_MODULE_0__.Mimes.ApplicationJsonPostSimpleBootSsrIntentScheme,
        [HttpHeaders.XSimpleBootSsrIntentScheme]: `Symbol.for(${symbol.description})`
    };
};


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot-http-server/src/codes/Mimes.ts":
/*!******************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot-http-server/src/codes/Mimes.ts ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Mimes: () => (/* binding */ Mimes)
/* harmony export */ });
var Mimes;
(function (Mimes) {
    Mimes["ApplicationJson"] = "application/json";
    Mimes["ApplicationOctetStream"] = "application/octet-stream";
    Mimes["ApplicationXml"] = "application/xml";
    Mimes["ApplicationJsonPatch"] = "application/json-patch+json";
    Mimes["ApplicationXWwwFormUrlencoded"] = "application/x-www-form-urlencoded";
    Mimes["TextPlain"] = "text/plain";
    Mimes["TextHtml"] = "text/html";
    Mimes["All"] = "*/*";
    Mimes["TextCss"] = "text/css";
    Mimes["TextJavascript"] = "text/javascript";
    Mimes["TextXml"] = "text/xml";
    Mimes["TextXslt"] = "text/xslt";
    Mimes["TextXmlDtd"] = "text/xml-dtd";
    Mimes["TextPlainUtf8"] = "text/plain; charset=utf-8";
    Mimes["ImagePng"] = "image/png";
    Mimes["ImageGif"] = "image/gif";
    Mimes["ImageJpeg"] = "image/jpeg";
    Mimes["ImageSvg"] = "image/svg+xml";
    Mimes["ImageBmp"] = "image/bmp";
    Mimes["ImageTiff"] = "image/tiff";
    Mimes["ImagePdf"] = "application/pdf";
    Mimes["ImageXBmp"] = "image/x-bmp";
    Mimes["ImageXpixmap"] = "image/x-xpixmap";
    Mimes["ImageXxbm"] = "image/x-xbm";
    Mimes["MultipartFormData"] = "multipart/form-data";
    Mimes["ApplicationJsonPostSimpleBootSsrIntentScheme"] = "application/json-post+simple-boot-ssr-intent-scheme";
    Mimes["Intent"] = "intent";
})(Mimes || (Mimes = {}));


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/SimOption.ts":
/*!****************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/SimOption.ts ***!
  \****************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SimOption: () => (/* binding */ SimOption)
/* harmony export */ });
class SimOption {
    rootRouter;
    container;
    advice;
    proxy;
    // public excludeSim: ((ConstructorType<any> | Function)[]) | ((type: (ConstructorType<any> | Function)) => boolean);
    using;
    cache;
    constructor({ rootRouter, container, cache, advice = [], proxy, using } = {}) {
        this.rootRouter = rootRouter;
        this.container = container;
        this.advice = advice;
        // this.excludeSim = excludeSim;
        this.proxy = proxy;
        this.using = using;
        this.cache = cache;
    }
    addAdvicce(advice) {
        this.advice ??= [];
        this.advice.push(advice);
    }
    setAdvice(...advice) {
        this.advice = advice;
        return this;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/SimpleApplication.ts":
/*!************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/SimpleApplication.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SimpleApplication: () => (/* binding */ SimpleApplication)
/* harmony export */ });
/* harmony import */ var _simstance_SimstanceManager__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./simstance/SimstanceManager */ "../../packages/@dooboostore/simple-boot/src/simstance/SimstanceManager.ts");
/* harmony import */ var _SimOption__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SimOption */ "../../packages/@dooboostore/simple-boot/src/SimOption.ts");
/* harmony import */ var _intent_IntentManager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./intent/IntentManager */ "../../packages/@dooboostore/simple-boot/src/intent/IntentManager.ts");
/* harmony import */ var _route_RouterManager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./route/RouterManager */ "../../packages/@dooboostore/simple-boot/src/route/RouterManager.ts");
/* harmony import */ var _intent_Intent__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./intent/Intent */ "../../packages/@dooboostore/simple-boot/src/intent/Intent.ts");
/* harmony import */ var _throwable_SimNoSuch__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./throwable/SimNoSuch */ "../../packages/@dooboostore/simple-boot/src/throwable/SimNoSuch.ts");
/* harmony import */ var _decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");







class SimpleApplication {
    option;
    simstanceManager;
    intentManager;
    routerManager;
    // public rootRouter?: ConstructorType<any>;
    // constructor();
    // constructor(option: SimOption);
    // constructor(rootRouter?: ConstructorType<Object> | Function);
    // constructor(rootRouter?: ConstructorType<Object> | Function, option?: SimOption);
    // constructor(rootRouter?: (ConstructorType<Object> | Function) | SimOption, option = new SimOption()) {
    constructor(option = new _SimOption__WEBPACK_IMPORTED_MODULE_1__.SimOption()) {
        // if (option.rootRouter instanceof SimOption) {
        //   option = rootRouter;
        // } else if (typeof option.rootRouter === 'function') {
        //   this.rootRouter = rootRouter;
        // }
        this.option = option;
        this.simstanceManager = new _simstance_SimstanceManager__WEBPACK_IMPORTED_MODULE_0__.SimstanceManager(this, option);
        // this.simstanceManager.setStoreSet(SimpleApplication, this);
        this.simstanceManager.setStoreSet(_simstance_SimstanceManager__WEBPACK_IMPORTED_MODULE_0__.SimstanceManager, this.simstanceManager);
        // cacheManager    .  .
        this.routerManager = this.simstanceManager.proxy(new _route_RouterManager__WEBPACK_IMPORTED_MODULE_3__.RouterManager(this.simstanceManager, option));
        this.intentManager = this.simstanceManager.proxy(new _intent_IntentManager__WEBPACK_IMPORTED_MODULE_2__.IntentManager(this.simstanceManager, this.routerManager, option));
        this.simstanceManager.setStoreSet(_intent_IntentManager__WEBPACK_IMPORTED_MODULE_2__.IntentManager, this.intentManager);
        this.simstanceManager.setStoreSet(_route_RouterManager__WEBPACK_IMPORTED_MODULE_3__.RouterManager, this.routerManager);
        _decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_6__.containers.add(this);
    }
    getSimstanceManager() {
        return this.simstanceManager;
    }
    getIntentManager() {
        return this.intentManager;
    }
    getRouterManager() {
        return this.routerManager;
    }
    run(otherInstanceSim) {
        this.simstanceManager.run(otherInstanceSim);
        return this;
        // return this.simstanceManager;
    }
    simAtomic(type) {
        if (typeof type === 'symbol') {
            return this.simstanceManager.findFirstSim(type);
        }
        else if (typeof type === 'function') {
            return this.simstanceManager.findFirstSim({ type: type });
            // return new SimAtomic<T>(type, this.simstanceManager);
        }
    }
    simAtomics(type) {
        if (typeof type === 'symbol') {
            return this.simstanceManager.findSims(type) ?? [];
        }
        else if (typeof type === 'function') {
            return this.simstanceManager.findSims({ type }) ?? [];
        }
        else {
            return [];
        }
    }
    getInstance(type) {
        const i = this.sim(type);
        if (i) {
            return i;
        }
        else {
            throw new _throwable_SimNoSuch__WEBPACK_IMPORTED_MODULE_5__.SimNoSuch('SimNoSuch: no simple instance(getInstance) ' + 'name:' + type?.prototype?.constructor?.name + ',' + type);
        }
    }
    sim(type) {
        return this.simAtomic(type)?.getValue();
    }
    sims(type) {
        return this.simAtomics(type).map(it => it.getValue());
    }
    addSim(configOrTarget, target) {
        const r = (0,_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_6__.Sim)(configOrTarget);
        if (typeof r === 'function' && target) {
            r(target);
        }
    }
    publishIntent(i, data) {
        if (i instanceof _intent_Intent__WEBPACK_IMPORTED_MODULE_4__.Intent) {
            return this.intentManager.publish(i);
        }
        else if ((0,_intent_IntentManager__WEBPACK_IMPORTED_MODULE_2__.isRouterPublishType)(i)) {
            return this.intentManager.publish(i, data);
        }
        else {
            return this.intentManager.publish(i, data);
        }
    }
    routing(i, option) {
        if (i instanceof _intent_Intent__WEBPACK_IMPORTED_MODULE_4__.Intent) {
            return this.routerManager.routing(i, option);
        }
        else if (typeof i === 'string') {
            const intent = new _intent_Intent__WEBPACK_IMPORTED_MODULE_4__.Intent(i);
            return this.routerManager.routing(intent, option);
        }
        else {
            const intent = new _intent_Intent__WEBPACK_IMPORTED_MODULE_4__.Intent(i.path, i.data);
            return this.routerManager.routing(intent, option);
        }
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/alert/Alert.ts":
/*!******************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/alert/Alert.ts ***!
  \******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Alert: () => (/* binding */ Alert)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_random_RandomUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/random/RandomUtils */ "../../packages/@dooboostore/core/src/random/RandomUtils.ts");
/* harmony import */ var _AlertAction__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./AlertAction */ "../../packages/@dooboostore/simple-boot/src/alert/AlertAction.ts");


class Alert {
    alertService;
    config;
    result;
    isActive = false;
    activateBefore = [];
    activateAfter = [];
    deActivateBefore = [];
    deActivateAfter = [];
    data = new Map();
    uuid;
    constructor(alertService, config) {
        this.alertService = alertService;
        this.config = config;
        if (config?.uuid) {
            this.uuid = config.uuid;
        }
        else {
            this.uuid = _dooboostore_core_random_RandomUtils__WEBPACK_IMPORTED_MODULE_0__.RandomUtils.uuid();
        }
    }
    addOpenBefore(fn) {
        this.activateBefore.push(fn);
    }
    addOpenAfter(fn) {
        this.activateAfter.push(fn);
    }
    addCloseBefore(fn) {
        this.deActivateBefore.push(fn);
    }
    addCloseAfter(fn) {
        this.deActivateAfter.push(fn);
    }
    setData(key, value) {
        this.data.set(key, value);
    }
    getData(key) {
        return this.data.get(key);
    }
    async activate() {
        try {
            await Promise.allSettled(this.activateBefore.map(it => it()))
                .then(it => {
                this.result = this.make();
                this.alertService?.publish({ action: _AlertAction__WEBPACK_IMPORTED_MODULE_1__.AlertAction.ACTIVE, alert: this });
                this.isActive = true;
                if (this.config?.closeTime !== undefined && this.config?.closeTime > 0) {
                    setTimeout(() => {
                        this.deActivate();
                    }, this.config.closeTime);
                }
                this.config?.activate?.(this.result, this);
            });
        }
        catch (e) {
        }
        finally {
            await Promise.allSettled(this.activateAfter.map(it => it())).then(it => {
            });
        }
    }
    async deActivate() {
        try {
            await Promise.allSettled(this.deActivateBefore.map(it => it()))
                .then(it => {
                this.alertService?.publish({ action: _AlertAction__WEBPACK_IMPORTED_MODULE_1__.AlertAction.IN_ACTIVE, alert: this });
                this.isActive = false;
                this.config?.deActivate?.(this.result, this);
            });
        }
        catch (e) {
        }
        finally {
            await Promise.allSettled(this.deActivateAfter.map(it => it())).then(it => {
            });
        }
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/alert/AlertAction.ts":
/*!************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/alert/AlertAction.ts ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AlertAction: () => (/* binding */ AlertAction)
/* harmony export */ });
var AlertAction;
(function (AlertAction) {
    AlertAction["ACTIVE"] = "ACTIVE";
    AlertAction["IN_ACTIVE"] = "IN_ACTIVE";
})(AlertAction || (AlertAction = {}));


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/alert/AlertFactory.ts":
/*!*************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/alert/AlertFactory.ts ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AlertFactory: () => (/* binding */ AlertFactory),
/* harmony export */   DefaultAlertFactory: () => (/* binding */ DefaultAlertFactory)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");


var AlertFactory;
(function (AlertFactory) {
    AlertFactory.SYMBOL = Symbol('AlertFactory');
})(AlertFactory || (AlertFactory = {}));
let DefaultAlertFactory = class DefaultAlertFactory {
    create(data) {
        return undefined;
    }
};
DefaultAlertFactory = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    (0,_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__.Sim)({ symbol: AlertFactory.SYMBOL })
], DefaultAlertFactory);



/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/alert/AlertService.ts":
/*!*************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/alert/AlertService.ts ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AlertService: () => (/* binding */ AlertService)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _Alert__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Alert */ "../../packages/@dooboostore/simple-boot/src/alert/Alert.ts");
/* harmony import */ var _decorators_inject_Inject__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../decorators/inject/Inject */ "../../packages/@dooboostore/simple-boot/src/decorators/inject/Inject.ts");
/* harmony import */ var _AlertFactory__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./AlertFactory */ "../../packages/@dooboostore/simple-boot/src/alert/AlertFactory.ts");
/* harmony import */ var _AlertType__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./AlertType */ "../../packages/@dooboostore/simple-boot/src/alert/AlertType.ts");
/* harmony import */ var _decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_core_message_ReplaySubject__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @dooboostore/core/message/ReplaySubject */ "../../packages/@dooboostore/core/src/message/ReplaySubject.ts");
var _a;







let AlertService = class AlertService {
    name = new Date().toUTCString();
    subject = new _dooboostore_core_message_ReplaySubject__WEBPACK_IMPORTED_MODULE_6__.ReplaySubject();
    alertFactory;
    constructor(alertFactory) {
        this.alertFactory = alertFactory;
        // console.log('%c AlertService constructor 55555', 'color: #ff0000', this.alertFactory)
        // this.observable.subscribe(it => {
        //   console.log('subscribe!!!!!selft!', it, this)
        // })
    }
    // @PostConstruct
    // postConstruct(
    // ) {
    //   this.alertFactory = alertFactory;
    // }
    get observable() {
        return this.subject.asObservable();
    }
    publish(data) {
        // console.log('publicsh------------', data)
        this.subject.next(data);
    }
    create(factory, config) {
        return new (class extends _Alert__WEBPACK_IMPORTED_MODULE_1__.Alert {
            make() {
                return factory(this);
            }
        })(this, config);
    }
    createFromFactory(type, config) {
        return this.alertFactory?.create({ caller: this, type, config: config });
    }
    danger(config) {
        // config = config ?? {};
        // config.closeTime ??= AlertService.DEFAULT_CLOSE_TIME;
        return this.createFromFactory(_AlertType__WEBPACK_IMPORTED_MODULE_4__.AlertType.DANGER, config);
    }
    progress(config) {
        config = config ?? {};
        return this.createFromFactory(_AlertType__WEBPACK_IMPORTED_MODULE_4__.AlertType.PROGRESS, config);
    }
    success(config) {
        // config = config ?? {};
        // config.closeTime ??= AlertService.DEFAULT_CLOSE_TIME;
        return this.createFromFactory(_AlertType__WEBPACK_IMPORTED_MODULE_4__.AlertType.SUCCESS, config);
    }
    info(config) {
        // config = config ?? {};
        // config.closeTime ??= AlertService.DEFAULT_CLOSE_TIME;
        return this.createFromFactory(_AlertType__WEBPACK_IMPORTED_MODULE_4__.AlertType.INFO, config);
    }
    error(config) {
        // config = config ?? {};
        // config.closeTime ??= AlertService.DEFAULT_CLOSE_TIME;
        return this.createFromFactory(_AlertType__WEBPACK_IMPORTED_MODULE_4__.AlertType.ERROR, config);
    }
    warning(config) {
        // config = config ?? {};
        // config.closeTime ??= AlertService.DEFAULT_CLOSE_TIME;
        return this.createFromFactory(_AlertType__WEBPACK_IMPORTED_MODULE_4__.AlertType.WARNING, config);
    }
};
AlertService = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_5__.Sim,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__param)(0, (0,_decorators_inject_Inject__WEBPACK_IMPORTED_MODULE_2__.Inject)({ symbol: _AlertFactory__WEBPACK_IMPORTED_MODULE_3__.AlertFactory.SYMBOL })),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _AlertFactory__WEBPACK_IMPORTED_MODULE_3__.AlertFactory !== "undefined" && _AlertFactory__WEBPACK_IMPORTED_MODULE_3__.AlertFactory) === "function" ? _a : Object])
], AlertService);



/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/alert/AlertType.ts":
/*!**********************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/alert/AlertType.ts ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AlertType: () => (/* binding */ AlertType)
/* harmony export */ });
var AlertType;
(function (AlertType) {
    AlertType["DANGER"] = "DANGER";
    AlertType["NORMAL"] = "NORMAL";
    AlertType["PROGRESS"] = "PROGRESS";
    AlertType["SUCCESS"] = "SUCCESS";
    AlertType["ERROR"] = "ERROR";
    AlertType["INFO"] = "INFO";
    AlertType["WARNING"] = "WARNING";
    AlertType["CONSOLE"] = "CONSOLE";
    AlertType["ETC"] = "ETC";
})(AlertType || (AlertType = {}));


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/decorators/MetaDataAtomic.ts":
/*!********************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/decorators/MetaDataAtomic.ts ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   MetaDataAtomic: () => (/* binding */ MetaDataAtomic),
/* harmony export */   MetaDataPropertyAtomic: () => (/* binding */ MetaDataPropertyAtomic)
/* harmony export */ });
class MetaDataAtomic {
    target;
    metaData;
    constructor(target, metaData) {
        this.target = target;
        this.metaData = metaData;
    }
}
class MetaDataPropertyAtomic extends MetaDataAtomic {
    property;
    parameter;
    constructor(target, metaData, property, parameter) {
        super(target, metaData);
        this.property = property;
        this.parameter = parameter;
    }
    call(...parameter) {
        return this.target[this.property](...parameter);
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts":
/*!******************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Lifecycle: () => (/* binding */ Lifecycle),
/* harmony export */   PostConstruct: () => (/* binding */ PostConstruct),
/* harmony export */   Sim: () => (/* binding */ Sim),
/* harmony export */   SimMetadataKey: () => (/* binding */ SimMetadataKey),
/* harmony export */   containers: () => (/* binding */ containers),
/* harmony export */   getPostConstructs: () => (/* binding */ getPostConstructs),
/* harmony export */   getSim: () => (/* binding */ getSim),
/* harmony export */   simProcess: () => (/* binding */ simProcess),
/* harmony export */   sims: () => (/* binding */ sims)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/reflect/ReflectUtils */ "../../packages/@dooboostore/core/src/reflect/ReflectUtils.ts");
/* harmony import */ var _dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/core/valid/ValidUtils */ "../../packages/@dooboostore/core/src/valid/ValidUtils.ts");


var Lifecycle;
(function (Lifecycle) {
    /**
     * The default registration scope, Each resolve will return the same instance (including resolves from child containers)
     */
    Lifecycle["Singleton"] = "Singleton";
    /**
     * a new instance will be created with each resolve
     */
    Lifecycle["Transient"] = "Transient";
})(Lifecycle || (Lifecycle = {}));
const sims = new Map();
const containers = new Set();
const SimMetadataKey = Symbol('Sim');
const isNotNullObjetInstance = (target) => target != null && target !== undefined && typeof target === 'object';
const simProcess = (config, inputTarget) => {
    // default setting
    /*
    // Sim({symbol: TTSymbol, scope: Lifecycle.Transient})(function (){
    //   console.log('new TT')
    //   return {a: 'name'}
    // })
    // Sim({symbol: TTSymbol, scope: Lifecycle.Transient})(() =>{
    //   console.log('new TT')
    //   return {a: 'name'}
    // })
    Sim({symbol: TTSymbol, scope: Lifecycle.Transient})({a: 'name'})
     */
    const target = (() => {
        if (typeof inputTarget === 'object') {
            return config.scope === Lifecycle.Singleton ? inputTarget : (_dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_1__.ValidUtils.isPlainObject(inputTarget) ? { ...inputTarget } : inputTarget);
        }
        if (_dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_1__.ValidUtils.isArrowFunction(inputTarget)) {
            return () => inputTarget();
        }
        return inputTarget;
    })();
    let targetType;
    if (isNotNullObjetInstance(target)) {
        targetType = target.constructor;
    }
    else {
        targetType = target;
    }
    config.scope = config?.scope ?? Lifecycle.Singleton;
    _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.defineMetadata(SimMetadataKey, config, targetType);
    const adding = (targetKey, target = targetKey) => {
        const items = sims.get(targetKey) ?? new Set();
        items.add(target);
        sims.set(targetKey, items);
    };
    if (Array.isArray(config?.type)) {
        config?.type.forEach(it => {
            adding(it, target);
        });
    }
    else if (config.type) {
        adding(config?.type, target);
    }
    else {
        adding(target);
    }
    // adding(targetType)
    // console.log('----------->', sims)
};
function Sim(configOrTarget) {
    // console.group('sim')
    // sims.forEach((v,k) => {
    //   console.log('sssss->', v, k)
    // })
    // console.groupEnd()
    if (typeof configOrTarget === 'function') {
        simProcess({}, configOrTarget);
        // console.log('---!', Reflect.getMetadata('design:paramtypes', configOrTarget))
    }
    else {
        return (target) => {
            simProcess(configOrTarget, target);
        };
    }
}
const getSim = (target) => {
    if (target != null && target !== undefined && typeof target === 'object') {
        target = target.constructor;
    }
    try {
        return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(SimMetadataKey, target);
    }
    catch (e) {
    }
};
const PostConstructMetadataKey = Symbol('PostConstruct');
const postConstructProcess = (target, config) => {
    const metas = getPostConstructs(target) ?? [];
    metas.push(config);
    _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.defineMetadata(PostConstructMetadataKey, metas, target);
};
const PostConstruct = (target, propertyKey, descriptor) => {
    postConstructProcess(target, { property: propertyKey });
};
const getPostConstructs = (target) => {
    return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(PostConstructMetadataKey, target) ?? [];
};


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/decorators/SimNoProxy.ts":
/*!****************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/decorators/SimNoProxy.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SimNoProxy: () => (/* binding */ SimNoProxy),
/* harmony export */   SimNoProxyKey: () => (/* binding */ SimNoProxyKey),
/* harmony export */   getSimNoProxy: () => (/* binding */ getSimNoProxy),
/* harmony export */   isSimNoProxy: () => (/* binding */ isSimNoProxy)
/* harmony export */ });
const SimNoProxyKey = Symbol('Sim:NoProxy');
const SimNoProxy = (target, propertyKey) => {
    //    
    if (propertyKey === undefined) {
        // target  
        Reflect.defineMetadata(SimNoProxyKey, true, target);
        return;
    }
    //    
    // target , propertyKey  
    Reflect.defineMetadata(SimNoProxyKey, true, target, propertyKey);
};
const getSimNoProxy = (target, propertyKey) => {
    try {
        // if (ValidUtils.isNotNullUndefined(target)) {
        //  
        if (propertyKey === undefined) {
            return Reflect.getMetadata(SimNoProxyKey, target);
        }
        //  
        return Reflect.getMetadata(SimNoProxyKey, target, propertyKey);
    }
    catch (e) {
        return undefined;
    }
    // } else {
    //   return undefined;
    // }
};
const isSimNoProxy = (target, propertyKey) => {
    if (target === null || target === undefined) {
        return false;
    }
    return getSimNoProxy(target, propertyKey) === true;
};


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/decorators/aop/AOPDecorator.ts":
/*!**********************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/decorators/aop/AOPDecorator.ts ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   After: () => (/* binding */ After),
/* harmony export */   Around: () => (/* binding */ Around),
/* harmony export */   AroundForceReturn: () => (/* binding */ AroundForceReturn),
/* harmony export */   Before: () => (/* binding */ Before),
/* harmony export */   getAfter: () => (/* binding */ getAfter),
/* harmony export */   getAfters: () => (/* binding */ getAfters),
/* harmony export */   getAround: () => (/* binding */ getAround),
/* harmony export */   getBefore: () => (/* binding */ getBefore),
/* harmony export */   getBefores: () => (/* binding */ getBefores),
/* harmony export */   getProtoAfters: () => (/* binding */ getProtoAfters),
/* harmony export */   getProtoBefores: () => (/* binding */ getProtoBefores)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/reflect/ReflectUtils */ "../../packages/@dooboostore/core/src/reflect/ReflectUtils.ts");
/* harmony import */ var _MetaDataAtomic__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../MetaDataAtomic */ "../../packages/@dooboostore/simple-boot/src/decorators/MetaDataAtomic.ts");
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");



const AfterMetadataKey = Symbol('After');
const BeforeMetadataKey = Symbol('Before');
const AroundMetadataKey = Symbol('Around');
// after
const After = (data) => {
    return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.metadata(AfterMetadataKey, data);
};
const getAfter = (target, propertyKey) => {
    return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(AfterMetadataKey, target, propertyKey);
};
const getAfters = (target) => {
    return (_dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_2__.ObjectUtils.allProtoTypeName(target)
        .map(it => new _MetaDataAtomic__WEBPACK_IMPORTED_MODULE_1__.MetaDataPropertyAtomic(target, getAfter(target, it), it))
        .filter(it => it.metaData !== undefined) || []);
};
const getProtoAfters = (target, propertyKey, type) => {
    return (getAfters(target).filter(it => propertyKey === it.metaData?.property && type === it.metaData.type?.prototype) || []);
};
// before
const Before = (data) => {
    return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.metadata(BeforeMetadataKey, data);
};
const getBefore = (target, propertyKey) => {
    return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(BeforeMetadataKey, target, propertyKey);
};
const getBefores = (target) => {
    return (_dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_2__.ObjectUtils.allProtoTypeName(target)
        .map(it => new _MetaDataAtomic__WEBPACK_IMPORTED_MODULE_1__.MetaDataPropertyAtomic(target, getBefore(target, it), it))
        .filter(it => it.metaData !== undefined) || []);
};
const getProtoBefores = (target, propertyKey, type) => {
    return (getBefores(target).filter(it => propertyKey === it.metaData?.property && type === it.metaData.type?.prototype) || []);
};
class AroundForceReturn {
    value;
    constructor(value) {
        this.value = value;
    }
}
// around
const Around = (config) => {
    return (target, propertyKey, descriptor) => {
        _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.defineMetadata(AroundMetadataKey, config, target, propertyKey);
        const method = descriptor.value;
        descriptor.value = function (...args) {
            // console.log('check method')
            let before = undefined;
            let r = undefined;
            if (config.before) {
                try {
                    before = config.before?.(this, propertyKey, args);
                }
                catch (e) {
                    if (e instanceof AroundForceReturn) {
                        return e.value;
                    }
                }
                r = method.apply(this, before);
            }
            else {
                r = method.apply(this, args);
            }
            if (config.after) {
                try {
                    r = config.after?.(this, propertyKey, args, r);
                }
                catch (e) {
                    if (e instanceof AroundForceReturn) {
                        return e.value;
                    }
                }
            }
            return r;
        };
    };
};
const getAround = (target, propertyKey) => {
    return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(AroundMetadataKey, target, propertyKey);
};


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/decorators/aop/index.ts":
/*!***************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/decorators/aop/index.ts ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   After: () => (/* reexport safe */ _AOPDecorator__WEBPACK_IMPORTED_MODULE_0__.After),
/* harmony export */   Around: () => (/* reexport safe */ _AOPDecorator__WEBPACK_IMPORTED_MODULE_0__.Around),
/* harmony export */   AroundForceReturn: () => (/* reexport safe */ _AOPDecorator__WEBPACK_IMPORTED_MODULE_0__.AroundForceReturn),
/* harmony export */   Before: () => (/* reexport safe */ _AOPDecorator__WEBPACK_IMPORTED_MODULE_0__.Before),
/* harmony export */   getAfter: () => (/* reexport safe */ _AOPDecorator__WEBPACK_IMPORTED_MODULE_0__.getAfter),
/* harmony export */   getAfters: () => (/* reexport safe */ _AOPDecorator__WEBPACK_IMPORTED_MODULE_0__.getAfters),
/* harmony export */   getAround: () => (/* reexport safe */ _AOPDecorator__WEBPACK_IMPORTED_MODULE_0__.getAround),
/* harmony export */   getBefore: () => (/* reexport safe */ _AOPDecorator__WEBPACK_IMPORTED_MODULE_0__.getBefore),
/* harmony export */   getBefores: () => (/* reexport safe */ _AOPDecorator__WEBPACK_IMPORTED_MODULE_0__.getBefores),
/* harmony export */   getProtoAfters: () => (/* reexport safe */ _AOPDecorator__WEBPACK_IMPORTED_MODULE_0__.getProtoAfters),
/* harmony export */   getProtoBefores: () => (/* reexport safe */ _AOPDecorator__WEBPACK_IMPORTED_MODULE_0__.getProtoBefores)
/* harmony export */ });
/* harmony import */ var _AOPDecorator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./AOPDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/aop/AOPDecorator.ts");



/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/decorators/cache/CacheDecorator.ts":
/*!**************************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/decorators/cache/CacheDecorator.ts ***!
  \**************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Cache: () => (/* binding */ Cache),
/* harmony export */   DefaultCacheStorage: () => (/* binding */ DefaultCacheStorage),
/* harmony export */   deleteCacheByKey: () => (/* binding */ deleteCacheByKey),
/* harmony export */   deleteCacheByKeyStartWith: () => (/* binding */ deleteCacheByKeyStartWith),
/* harmony export */   findCacheByKey: () => (/* binding */ findCacheByKey),
/* harmony export */   findCacheByKeyStartWith: () => (/* binding */ findCacheByKeyStartWith),
/* harmony export */   getCacheSet: () => (/* binding */ getCacheSet)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/reflect/ReflectUtils */ "../../packages/@dooboostore/core/src/reflect/ReflectUtils.ts");

class DefaultCacheStorage {
    storage = new Map();
    delete(key) {
        return this.storage.delete(key);
    }
    get(key) {
        return this.storage.get(key);
    }
    has(key) {
        return this.storage.has(key);
    }
    set(key, value) {
        this.storage.set(key, value);
    }
}
const isNoAllKey = (cacheOption) => {
    return !('key' in cacheOption) && !('deleteKey' in cacheOption) && !('setKey' in cacheOption);
};
const isKey = (cacheOption) => {
    return 'key' in cacheOption && (typeof cacheOption.key === 'string' || typeof cacheOption.key === 'function');
};
const isChildrenKey = (cacheOption) => {
    return 'key' in cacheOption && typeof cacheOption.key === 'object' && cacheOption.key !== null && 'key' in cacheOption.key && 'childrenKey' in cacheOption.key;
};
const isDeleteKey = (cacheOption) => {
    return 'deleteKey' in cacheOption && (typeof cacheOption.deleteKey === 'string' || typeof cacheOption.deleteKey === 'function');
};
const isDeleteChildrenKey = (cacheOption) => {
    return 'deleteKey' in cacheOption && typeof cacheOption.deleteKey === 'object' && cacheOption.deleteKey !== null && 'key' in cacheOption.deleteKey && 'childrenKey' in cacheOption.deleteKey;
};
const isSetKey = (cacheOption) => {
    return 'setKey' in cacheOption && (typeof cacheOption.setKey === 'string' || typeof cacheOption.setKey === 'function');
};
const isSetChildrenKey = (cacheOption) => {
    return 'setKey' in cacheOption && typeof cacheOption.setKey === 'object' && cacheOption.setKey !== null && 'key' in cacheOption.setKey && 'childrenKey' in cacheOption.setKey;
};
const isUpdate = (cacheOption) => {
    return isSetKey(cacheOption) || isSetChildrenKey(cacheOption);
};
const simpleApplicationCache = new WeakMap();
// setInterval(() => {
//   // console.log('debug cache', simpleApplicationCache.values())
//   console.dir(simpleApplicationCache.values(), {depth: 10, colors: true});
// }, 1000)
const getCacheSet = (simpleApplication) => {
    return simpleApplicationCache.get(simpleApplication);
};
const findCacheByKey = (simpleApplication, key) => {
    const storage = simpleApplicationCache.get(simpleApplication);
    if (storage) {
        return Array.from(storage.config.entries()).find(([k, v]) => k === key);
    }
};
const findCacheByKeyStartWith = (simpleApplication, key) => {
    const storage = simpleApplicationCache.get(simpleApplication);
    if (storage) {
        return Array.from(storage.config.entries()).filter(([k, v]) => k.startsWith(key));
    }
    else {
        return [];
    }
};
const deleteCacheByKey = (simpleApplication, key) => {
    const storage = simpleApplicationCache.get(simpleApplication);
    if (storage) {
        // delete rootKey    .
        storage.storage.delete(key);
        findCacheByKeyStartWith(simpleApplication, key).forEach(([k, v]) => {
            const data = storage.config.get(k);
            if (data?.expireTimeout) {
                clearTimeout(data.expireTimeout);
            }
            storage.config.delete(k);
            storage.storage.delete(k);
        });
    }
};
const deleteCacheByKeyStartWith = (simpleApplication, key) => {
    findCacheByKeyStartWith(simpleApplication, key).forEach(([key, data]) => deleteCacheByKey(simpleApplication, key));
};
const CacheMetadataKey = Symbol('Cache');
const cacheProcess = (data, target, propertyKey, descriptor) => {
    //   
    const originalMethod = descriptor.value;
    // function  proxy  this   .
    descriptor.value = function (...args) {
        const data = _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(CacheMetadataKey, target, propertyKey);
        const simpleApplication = this._SimpleBoot_application;
        const simstanceManager = this._SimpleBoot_simstanceManager;
        const simOption = this._SimpleBoot_simOption;
        if (simpleApplication && simstanceManager && simOption && simOption.cache?.enable && data) {
            const simpleApplicationStorage = simpleApplicationCache.get(simpleApplication) ?? { storage: simOption.cache?.storage ?? new DefaultCacheStorage(), config: new Map() };
            simpleApplicationCache.set(simpleApplication, simpleApplicationStorage);
            let rootKey;
            if (isNoAllKey(data)) {
                rootKey = data.key = target.constructor.name + '.' + propertyKey.toString();
            }
            if (isKey(data)) {
                rootKey = typeof data.key === 'function' ? data.key.apply(this, args) : data.key;
            }
            else if (isChildrenKey(data)) {
                rootKey = typeof data.key.key === 'function' ? data.key.key.apply(this, args) : data.key.key;
            }
            else if (isDeleteKey(data)) {
                rootKey = typeof data.deleteKey === 'function' ? data.deleteKey.apply(this, args) : data.deleteKey;
            }
            else if (isDeleteChildrenKey(data)) {
                rootKey = typeof data.deleteKey.key === 'function' ? data.deleteKey.key.apply(this, args) : data.deleteKey.key;
            }
            else if (isSetKey(data)) {
                rootKey = typeof data.setKey === 'function' ? data.setKey.apply(this, args) : data.setKey;
            }
            else if (isSetChildrenKey(data)) {
                rootKey = typeof data.setKey.key === 'function' ? data.setKey.key.apply(this, args) : data.setKey.key;
            }
            if (isUpdate(data)) {
            }
            else {
                if (isKey(data) && rootKey) {
                    const findTarget = findCacheByKey(simpleApplication, rootKey);
                    // console.log('findSingleKey', findTarget, data)
                    if (findTarget) {
                        const key = findTarget[0];
                        return simpleApplicationStorage.storage.get(key);
                    }
                }
                else if (isChildrenKey(data) && rootKey) {
                    const findTargets = findCacheByKeyStartWith(simpleApplication, rootKey);
                    const rdata = findTargets.filter(([k, v]) => simpleApplicationStorage.storage.has(k)).map(([k, v]) => simpleApplicationStorage.storage?.get(k));
                    if (rdata.length > 0) {
                        return rdata;
                    }
                }
            }
            const result = originalMethod.apply(this, args);
            if (isDeleteKey(data) && rootKey) {
                deleteCacheByKey(simpleApplication, rootKey);
            }
            else if (isDeleteChildrenKey(data) && rootKey) {
                const key = typeof data.deleteKey.childrenKey === 'function' ? data.deleteKey.childrenKey.call(this, result) : data.deleteKey.childrenKey;
                const keys = key instanceof Array ? key : [key];
                keys.forEach(it => deleteCacheByKey(simpleApplication, `${rootKey}${data.deleteKey.join ?? '.'}${it}`));
            }
            else if ((isSetKey(data) || isKey(data)) && rootKey) {
                const ms = data.ms ?? simOption.cache?.ms;
                const expireTimeout = ms !== undefined ? setTimeout(() => deleteCacheByKey(simpleApplication, rootKey), ms) : undefined;
                simpleApplicationStorage.config.set(rootKey, { data: data, expireTimeout });
                simpleApplicationStorage.storage?.set(rootKey, result);
            }
            else if ((isSetChildrenKey(data) || isChildrenKey(data)) && rootKey) {
                const key = isSetChildrenKey(data) ? data.setKey : data.key;
                const childrenKeys = typeof key.childrenKey === 'function' ? key.childrenKey.call(this, result) : key.childrenKey;
                const keys = childrenKeys instanceof Array ? childrenKeys : [childrenKeys];
                keys.forEach(it => {
                    const childKey = `${rootKey}${key.join ?? '.'}${it.key}`;
                    const ms = it.ms ?? data.ms ?? simOption.cache?.ms;
                    const expireTimeout = ms !== undefined ? setTimeout(() => deleteCacheByKey(simpleApplication, childKey), ms) : undefined;
                    simpleApplicationStorage.config.set(childKey, { data: data, expireTimeout });
                    simpleApplicationStorage.storage?.set(childKey, it.data);
                });
            }
            return result;
        }
        else {
            return originalMethod.apply(this, args);
        }
    };
    // console.log('--------->', (target as any)._SimpleBoot_simstanceManager);
    // console.log('--------->', target, propertyKey, descriptor);
    _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.defineMetadata(CacheMetadataKey, data, target, propertyKey);
};
function Cache(targetOrOption, propertyKey, descriptor) {
    if (typeof targetOrOption === 'object' && propertyKey && descriptor) {
        // @Cache
        cacheProcess({}, targetOrOption, propertyKey, descriptor);
    }
    else if (typeof targetOrOption === 'object') {
        // @Cache({})
        return (target, propertyKey, descriptor) => {
            const data = targetOrOption;
            return cacheProcess(data, target, propertyKey, descriptor);
        };
    }
    else {
        throw new Error('Invalid arguments for Cache decorator');
    }
    // return (target: Object, propertyKey: string | symbol, descriptor: TypedPropertyDescriptor<any>) => {
    //   //   
    //   const originalMethod = descriptor.value;
    //
    //   // function  proxy  this   .
    //   descriptor.value = function (...args: Parameters<M>) {
    //
    //     const data = ReflectUtils.getMetadata<CacheOption<M>>(CacheMetadataKey, target, propertyKey);
    //     const simpleApplication: SimpleApplication = (this as any)._SimpleBoot_application as SimpleApplication;
    //     const simstanceManager: SimstanceManager = (this as any)._SimpleBoot_simstanceManager as SimstanceManager;
    //     const simOption: SimOption = (this as any)._SimpleBoot_simOption as SimOption;
    //     if (simpleApplication && simstanceManager && simOption && simOption.cache?.enable && data) {
    //       const simpleApplicationStorage = simpleApplicationCache.get(simpleApplication) ?? {storage: simOption.cache?.storage ?? new DefaultCacheStorage(), config: new Map<string, ConfigDataSet>()};
    //       simpleApplicationCache.set(simpleApplication, simpleApplicationStorage);
    //
    //
    //       let rootKey: undefined | string;
    //       if (isSingleKey(data)) {
    //         rootKey = typeof data.key === 'function' ? data.key.apply(this, args) : data.key;
    //         const findTarget = findCacheByKey(simpleApplication, rootKey);
    //         // console.log('findSingleKey', findTarget, data)
    //         if (findTarget) {
    //           const key = findTarget[0];
    //           return simpleApplicationStorage.storage.get(key)
    //         }
    //       } else if (isChildrenKey(data)) {
    //         rootKey = typeof data.key.key === 'function' ? data.key.key.apply(this, args) : data.key.key;
    //         const findTargets = findCacheByKeyStartWith(simpleApplication, rootKey);
    //         const rdata = findTargets.filter(([k,v]) => simpleApplicationStorage.storage.has(k)).map(([k, v]) => simpleApplicationStorage.storage?.get(k));
    //         if (rdata.length > 0) {
    //           return rdata;
    //         }
    //       } else if (isDeleteKey(data)) {
    //         rootKey = typeof data.deleteKey === 'function' ? data.deleteKey.apply(this, args) : data.deleteKey;
    //       } else if (isDeleteChildrenKey(data)) {
    //         rootKey = typeof data.deleteKey.key === 'function' ? data.deleteKey.key.apply(this, args) : data.deleteKey.key;
    //       }
    //
    //       const result = originalMethod.apply(this, args);
    //
    //       if (isDeleteKey(data) && rootKey) {
    //         deleteCacheByKey(simpleApplication, rootKey);
    //       } else if (isDeleteChildrenKey(data) && rootKey) {
    //         const key = typeof data.deleteKey.childrenKey === 'function' ? data.deleteKey.childrenKey.call(this, result) : data.deleteKey.childrenKey;
    //         const keys = key instanceof Array ? key : [key];
    //         keys.forEach(it =>deleteCacheByKey(simpleApplication, it));
    //       } else if (isSingleKey(data) && rootKey) {
    //         const ms = data.ms ?? simOption.cache?.ms;
    //         const expireTimeout = ms !== undefined ? setTimeout(() => deleteCacheByKey(simpleApplication, rootKey!), ms) : undefined;
    //         simpleApplicationStorage.config.set(rootKey, {data: data as CacheOption<any> , expireTimeout});
    //         simpleApplicationStorage.storage?.set(rootKey, result);
    //       } else if (isChildrenKey(data) && rootKey) {
    //         const childrenKeys = typeof data.key.childrenKey === 'function' ? data.key.childrenKey.call(this, result) : data.key.childrenKey;
    //         const keys = childrenKeys instanceof Array ? childrenKeys : [childrenKeys];
    //         keys.forEach(it => {
    //           const childKey = `${rootKey}${data.key.join ?? '.'}${it.key}`;
    //           const ms = data.ms ?? data.ms ?? simOption.cache?.ms;
    //           const expireTimeout = ms !== undefined ? setTimeout(() => deleteCacheByKey(simpleApplication, childKey), ms) : undefined;
    //           simpleApplicationStorage.config.set(childKey, {data: data as CacheOption<any>, expireTimeout});
    //           simpleApplicationStorage.storage?.set(childKey, it.data);
    //         });
    //       }
    //
    //       return result;
    //
    //       // simOption.cache.storage.
    //       // const s = typeof data.type === 'symbol'
    //       //      ? simstanceManager.findFirstSim<Storage>(data.type)
    //       //      : simstanceManager.findFirstSim<Storage>({ type: data.type as ConstructorType<any> });
    //       // const storage = s?.getValue();
    //       // if (storage) {
    //       //
    //       // }
    //     } else {
    //       return originalMethod.apply(this, args);
    //     }
    //   };
    //   // console.log('--------->', (target as any)._SimpleBoot_simstanceManager);
    //   // console.log('--------->', target, propertyKey, descriptor);
    //   ReflectUtils.defineMetadata(CacheMetadataKey, data, target, propertyKey);
    // }
}


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/decorators/cache/index.ts":
/*!*****************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/decorators/cache/index.ts ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Cache: () => (/* reexport safe */ _CacheDecorator__WEBPACK_IMPORTED_MODULE_0__.Cache),
/* harmony export */   DefaultCacheStorage: () => (/* reexport safe */ _CacheDecorator__WEBPACK_IMPORTED_MODULE_0__.DefaultCacheStorage),
/* harmony export */   deleteCacheByKey: () => (/* reexport safe */ _CacheDecorator__WEBPACK_IMPORTED_MODULE_0__.deleteCacheByKey),
/* harmony export */   deleteCacheByKeyStartWith: () => (/* reexport safe */ _CacheDecorator__WEBPACK_IMPORTED_MODULE_0__.deleteCacheByKeyStartWith),
/* harmony export */   findCacheByKey: () => (/* reexport safe */ _CacheDecorator__WEBPACK_IMPORTED_MODULE_0__.findCacheByKey),
/* harmony export */   findCacheByKeyStartWith: () => (/* reexport safe */ _CacheDecorator__WEBPACK_IMPORTED_MODULE_0__.findCacheByKeyStartWith),
/* harmony export */   getCacheSet: () => (/* reexport safe */ _CacheDecorator__WEBPACK_IMPORTED_MODULE_0__.getCacheSet)
/* harmony export */ });
/* harmony import */ var _CacheDecorator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./CacheDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/cache/CacheDecorator.ts");



/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/decorators/event/EventListener.ts":
/*!*************************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/decorators/event/EventListener.ts ***!
  \*************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   EventListener: () => (/* binding */ EventListener),
/* harmony export */   getEventListener: () => (/* binding */ getEventListener)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/reflect/ReflectUtils */ "../../packages/@dooboostore/core/src/reflect/ReflectUtils.ts");

const EventListenerMetadataKey = Symbol('EventListener');
const EventListener = (option) => {
    return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.metadata(EventListenerMetadataKey, option);
};
const getEventListener = (target, propertyKey) => {
    return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(EventListenerMetadataKey, target, propertyKey);
};


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/decorators/event/index.ts":
/*!*****************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/decorators/event/index.ts ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   EventListener: () => (/* reexport safe */ _EventListener__WEBPACK_IMPORTED_MODULE_0__.EventListener),
/* harmony export */   getEventListener: () => (/* reexport safe */ _EventListener__WEBPACK_IMPORTED_MODULE_0__.getEventListener)
/* harmony export */ });
/* harmony import */ var _EventListener__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./EventListener */ "../../packages/@dooboostore/simple-boot/src/decorators/event/EventListener.ts");



/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/decorators/exception/ExceptionDecorator.ts":
/*!**********************************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/decorators/exception/ExceptionDecorator.ts ***!
  \**********************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ExceptionHandler: () => (/* binding */ ExceptionHandler),
/* harmony export */   ExceptionHandlerSituationType: () => (/* binding */ ExceptionHandlerSituationType),
/* harmony export */   getExceptionHandler: () => (/* binding */ getExceptionHandler),
/* harmony export */   getExceptionHandlers: () => (/* binding */ getExceptionHandlers),
/* harmony export */   targetExceptionHandler: () => (/* binding */ targetExceptionHandler),
/* harmony export */   targetExceptionHandlers: () => (/* binding */ targetExceptionHandlers)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/reflect/ReflectUtils */ "../../packages/@dooboostore/core/src/reflect/ReflectUtils.ts");
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");


var ExceptionHandlerSituationType;
(function (ExceptionHandlerSituationType) {
    ExceptionHandlerSituationType["ERROR_OBJECT"] = "SIMPLE_BOOT_CORE://ExceptionHandler/ERROR_OBJECT";
    ExceptionHandlerSituationType["PARAMETER"] = "SIMPLE_BOOT_CORE://ExceptionHandler/PARAMETER";
})(ExceptionHandlerSituationType || (ExceptionHandlerSituationType = {}));
const ExceptionHandlerMetadataKey = Symbol('ExceptionHandler');
const ExceptionHandler = (config = {}) => {
    return (target, propertyKey, descriptor) => {
        const saveMappingConfigs = (_dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(ExceptionHandlerMetadataKey, target.constructor) ?? []);
        const method = target[propertyKey];
        saveMappingConfigs.push({ propertyKey, method, config });
        _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.defineMetadata(ExceptionHandlerMetadataKey, saveMappingConfigs, target.constructor);
        _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.defineMetadata(ExceptionHandlerMetadataKey, config, target, propertyKey);
    };
};
const getExceptionHandler = (target, propertyKey) => {
    return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(ExceptionHandlerMetadataKey, target, propertyKey);
};
const getExceptionHandlers = (target) => {
    if (target !== null && undefined !== target && typeof target === 'object') {
        target = target.constructor;
    }
    return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(ExceptionHandlerMetadataKey, target);
};
const targetExceptionHandlers = (target, error) => {
    const exceptionHandlers = getExceptionHandlers(target);
    const emptyTargets = exceptionHandlers?.filter(it => it.config.type === undefined);
    const targets = exceptionHandlers?.filter(it => _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_1__.ObjectUtils.isPrototypeOfTarget(it.config.type, error));
    const targetSorts = targets?.sort((a, b) => {
        const aPrototypeOfDepth = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_1__.ObjectUtils.prototypeOfDepth(error, a.config.type);
        const bPrototypeOfDepth = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_1__.ObjectUtils.prototypeOfDepth(error, b.config.type);
        return aPrototypeOfDepth.length - bPrototypeOfDepth.length;
    });
    return (targetSorts ?? []).concat(...emptyTargets ?? []);
};
const targetExceptionHandler = (target, error, excludeMethods = []) => {
    let exceptionHandlers = targetExceptionHandlers(target, error);
    exceptionHandlers = exceptionHandlers?.filter(it => !excludeMethods.includes(it.method));
    if (exceptionHandlers && exceptionHandlers.length > 0) {
        return exceptionHandlers[0];
    }
    else {
        return undefined;
    }
};


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/decorators/exception/index.ts":
/*!*********************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/decorators/exception/index.ts ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ExceptionHandler: () => (/* reexport safe */ _ExceptionDecorator__WEBPACK_IMPORTED_MODULE_0__.ExceptionHandler),
/* harmony export */   ExceptionHandlerSituationType: () => (/* reexport safe */ _ExceptionDecorator__WEBPACK_IMPORTED_MODULE_0__.ExceptionHandlerSituationType),
/* harmony export */   getExceptionHandler: () => (/* reexport safe */ _ExceptionDecorator__WEBPACK_IMPORTED_MODULE_0__.getExceptionHandler),
/* harmony export */   getExceptionHandlers: () => (/* reexport safe */ _ExceptionDecorator__WEBPACK_IMPORTED_MODULE_0__.getExceptionHandlers),
/* harmony export */   targetExceptionHandler: () => (/* reexport safe */ _ExceptionDecorator__WEBPACK_IMPORTED_MODULE_0__.targetExceptionHandler),
/* harmony export */   targetExceptionHandlers: () => (/* reexport safe */ _ExceptionDecorator__WEBPACK_IMPORTED_MODULE_0__.targetExceptionHandlers)
/* harmony export */ });
/* harmony import */ var _ExceptionDecorator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./ExceptionDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/exception/ExceptionDecorator.ts");



/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/decorators/index.ts":
/*!***********************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/decorators/index.ts ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   After: () => (/* reexport safe */ _aop__WEBPACK_IMPORTED_MODULE_3__.After),
/* harmony export */   Around: () => (/* reexport safe */ _aop__WEBPACK_IMPORTED_MODULE_3__.Around),
/* harmony export */   AroundForceReturn: () => (/* reexport safe */ _aop__WEBPACK_IMPORTED_MODULE_3__.AroundForceReturn),
/* harmony export */   Before: () => (/* reexport safe */ _aop__WEBPACK_IMPORTED_MODULE_3__.Before),
/* harmony export */   Cache: () => (/* reexport safe */ _cache__WEBPACK_IMPORTED_MODULE_4__.Cache),
/* harmony export */   DefaultCacheStorage: () => (/* reexport safe */ _cache__WEBPACK_IMPORTED_MODULE_4__.DefaultCacheStorage),
/* harmony export */   EventListener: () => (/* reexport safe */ _event__WEBPACK_IMPORTED_MODULE_5__.EventListener),
/* harmony export */   ExceptionHandler: () => (/* reexport safe */ _exception__WEBPACK_IMPORTED_MODULE_6__.ExceptionHandler),
/* harmony export */   ExceptionHandlerSituationType: () => (/* reexport safe */ _exception__WEBPACK_IMPORTED_MODULE_6__.ExceptionHandlerSituationType),
/* harmony export */   Inject: () => (/* reexport safe */ _inject__WEBPACK_IMPORTED_MODULE_7__.Inject),
/* harmony export */   InjectSituationType: () => (/* reexport safe */ _inject__WEBPACK_IMPORTED_MODULE_7__.InjectSituationType),
/* harmony export */   Injection: () => (/* reexport safe */ _inject__WEBPACK_IMPORTED_MODULE_7__.Injection),
/* harmony export */   Lifecycle: () => (/* reexport safe */ _SimDecorator__WEBPACK_IMPORTED_MODULE_1__.Lifecycle),
/* harmony export */   MetaDataAtomic: () => (/* reexport safe */ _MetaDataAtomic__WEBPACK_IMPORTED_MODULE_0__.MetaDataAtomic),
/* harmony export */   MetaDataPropertyAtomic: () => (/* reexport safe */ _MetaDataAtomic__WEBPACK_IMPORTED_MODULE_0__.MetaDataPropertyAtomic),
/* harmony export */   NotEmpty: () => (/* reexport safe */ _validate__WEBPACK_IMPORTED_MODULE_9__.NotEmpty),
/* harmony export */   NotNull: () => (/* reexport safe */ _validate__WEBPACK_IMPORTED_MODULE_9__.NotNull),
/* harmony export */   PostConstruct: () => (/* reexport safe */ _SimDecorator__WEBPACK_IMPORTED_MODULE_1__.PostConstruct),
/* harmony export */   Regexp: () => (/* reexport safe */ _validate__WEBPACK_IMPORTED_MODULE_9__.Regexp),
/* harmony export */   Route: () => (/* reexport safe */ _route__WEBPACK_IMPORTED_MODULE_8__.Route),
/* harmony export */   RouteMetadataKey: () => (/* reexport safe */ _route__WEBPACK_IMPORTED_MODULE_8__.RouteMetadataKey),
/* harmony export */   Router: () => (/* reexport safe */ _route__WEBPACK_IMPORTED_MODULE_8__.Router),
/* harmony export */   RouterMetadataKey: () => (/* reexport safe */ _route__WEBPACK_IMPORTED_MODULE_8__.RouterMetadataKey),
/* harmony export */   Sim: () => (/* reexport safe */ _SimDecorator__WEBPACK_IMPORTED_MODULE_1__.Sim),
/* harmony export */   SimMetadataKey: () => (/* reexport safe */ _SimDecorator__WEBPACK_IMPORTED_MODULE_1__.SimMetadataKey),
/* harmony export */   SimNoProxy: () => (/* reexport safe */ _SimNoProxy__WEBPACK_IMPORTED_MODULE_2__.SimNoProxy),
/* harmony export */   SimNoProxyKey: () => (/* reexport safe */ _SimNoProxy__WEBPACK_IMPORTED_MODULE_2__.SimNoProxyKey),
/* harmony export */   SituationTypeContainer: () => (/* reexport safe */ _inject__WEBPACK_IMPORTED_MODULE_7__.SituationTypeContainer),
/* harmony export */   SituationTypeContainers: () => (/* reexport safe */ _inject__WEBPACK_IMPORTED_MODULE_7__.SituationTypeContainers),
/* harmony export */   Valid: () => (/* reexport safe */ _validate__WEBPACK_IMPORTED_MODULE_9__.Valid),
/* harmony export */   Validation: () => (/* reexport safe */ _validate__WEBPACK_IMPORTED_MODULE_9__.Validation),
/* harmony export */   containers: () => (/* reexport safe */ _SimDecorator__WEBPACK_IMPORTED_MODULE_1__.containers),
/* harmony export */   deleteCacheByKey: () => (/* reexport safe */ _cache__WEBPACK_IMPORTED_MODULE_4__.deleteCacheByKey),
/* harmony export */   deleteCacheByKeyStartWith: () => (/* reexport safe */ _cache__WEBPACK_IMPORTED_MODULE_4__.deleteCacheByKeyStartWith),
/* harmony export */   execValidation: () => (/* reexport safe */ _validate__WEBPACK_IMPORTED_MODULE_9__.execValidation),
/* harmony export */   execValidationInValid: () => (/* reexport safe */ _validate__WEBPACK_IMPORTED_MODULE_9__.execValidationInValid),
/* harmony export */   findCacheByKey: () => (/* reexport safe */ _cache__WEBPACK_IMPORTED_MODULE_4__.findCacheByKey),
/* harmony export */   findCacheByKeyStartWith: () => (/* reexport safe */ _cache__WEBPACK_IMPORTED_MODULE_4__.findCacheByKeyStartWith),
/* harmony export */   getAfter: () => (/* reexport safe */ _aop__WEBPACK_IMPORTED_MODULE_3__.getAfter),
/* harmony export */   getAfters: () => (/* reexport safe */ _aop__WEBPACK_IMPORTED_MODULE_3__.getAfters),
/* harmony export */   getAround: () => (/* reexport safe */ _aop__WEBPACK_IMPORTED_MODULE_3__.getAround),
/* harmony export */   getBefore: () => (/* reexport safe */ _aop__WEBPACK_IMPORTED_MODULE_3__.getBefore),
/* harmony export */   getBefores: () => (/* reexport safe */ _aop__WEBPACK_IMPORTED_MODULE_3__.getBefores),
/* harmony export */   getCacheSet: () => (/* reexport safe */ _cache__WEBPACK_IMPORTED_MODULE_4__.getCacheSet),
/* harmony export */   getEventListener: () => (/* reexport safe */ _event__WEBPACK_IMPORTED_MODULE_5__.getEventListener),
/* harmony export */   getExceptionHandler: () => (/* reexport safe */ _exception__WEBPACK_IMPORTED_MODULE_6__.getExceptionHandler),
/* harmony export */   getExceptionHandlers: () => (/* reexport safe */ _exception__WEBPACK_IMPORTED_MODULE_6__.getExceptionHandlers),
/* harmony export */   getInject: () => (/* reexport safe */ _inject__WEBPACK_IMPORTED_MODULE_7__.getInject),
/* harmony export */   getInjection: () => (/* reexport safe */ _inject__WEBPACK_IMPORTED_MODULE_7__.getInjection),
/* harmony export */   getPostConstructs: () => (/* reexport safe */ _SimDecorator__WEBPACK_IMPORTED_MODULE_1__.getPostConstructs),
/* harmony export */   getProtoAfters: () => (/* reexport safe */ _aop__WEBPACK_IMPORTED_MODULE_3__.getProtoAfters),
/* harmony export */   getProtoBefores: () => (/* reexport safe */ _aop__WEBPACK_IMPORTED_MODULE_3__.getProtoBefores),
/* harmony export */   getRoute: () => (/* reexport safe */ _route__WEBPACK_IMPORTED_MODULE_8__.getRoute),
/* harmony export */   getRouter: () => (/* reexport safe */ _route__WEBPACK_IMPORTED_MODULE_8__.getRouter),
/* harmony export */   getRoutes: () => (/* reexport safe */ _route__WEBPACK_IMPORTED_MODULE_8__.getRoutes),
/* harmony export */   getSim: () => (/* reexport safe */ _SimDecorator__WEBPACK_IMPORTED_MODULE_1__.getSim),
/* harmony export */   getSimNoProxy: () => (/* reexport safe */ _SimNoProxy__WEBPACK_IMPORTED_MODULE_2__.getSimNoProxy),
/* harmony export */   getValidIndex: () => (/* reexport safe */ _validate__WEBPACK_IMPORTED_MODULE_9__.getValidIndex),
/* harmony export */   getValidator: () => (/* reexport safe */ _validate__WEBPACK_IMPORTED_MODULE_9__.getValidator),
/* harmony export */   getValidators: () => (/* reexport safe */ _validate__WEBPACK_IMPORTED_MODULE_9__.getValidators),
/* harmony export */   isSimNoProxy: () => (/* reexport safe */ _SimNoProxy__WEBPACK_IMPORTED_MODULE_2__.isSimNoProxy),
/* harmony export */   routerProcess: () => (/* reexport safe */ _route__WEBPACK_IMPORTED_MODULE_8__.routerProcess),
/* harmony export */   simProcess: () => (/* reexport safe */ _SimDecorator__WEBPACK_IMPORTED_MODULE_1__.simProcess),
/* harmony export */   sims: () => (/* reexport safe */ _SimDecorator__WEBPACK_IMPORTED_MODULE_1__.sims),
/* harmony export */   targetExceptionHandler: () => (/* reexport safe */ _exception__WEBPACK_IMPORTED_MODULE_6__.targetExceptionHandler),
/* harmony export */   targetExceptionHandlers: () => (/* reexport safe */ _exception__WEBPACK_IMPORTED_MODULE_6__.targetExceptionHandlers)
/* harmony export */ });
/* harmony import */ var _MetaDataAtomic__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./MetaDataAtomic */ "../../packages/@dooboostore/simple-boot/src/decorators/MetaDataAtomic.ts");
/* harmony import */ var _SimDecorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _SimNoProxy__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./SimNoProxy */ "../../packages/@dooboostore/simple-boot/src/decorators/SimNoProxy.ts");
/* harmony import */ var _aop__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./aop */ "../../packages/@dooboostore/simple-boot/src/decorators/aop/index.ts");
/* harmony import */ var _cache__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./cache */ "../../packages/@dooboostore/simple-boot/src/decorators/cache/index.ts");
/* harmony import */ var _event__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./event */ "../../packages/@dooboostore/simple-boot/src/decorators/event/index.ts");
/* harmony import */ var _exception__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./exception */ "../../packages/@dooboostore/simple-boot/src/decorators/exception/index.ts");
/* harmony import */ var _inject__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./inject */ "../../packages/@dooboostore/simple-boot/src/decorators/inject/index.ts");
/* harmony import */ var _route__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./route */ "../../packages/@dooboostore/simple-boot/src/decorators/route/index.ts");
/* harmony import */ var _validate__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./validate */ "../../packages/@dooboostore/simple-boot/src/decorators/validate/index.ts");












/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/decorators/inject/Inject.ts":
/*!*******************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/decorators/inject/Inject.ts ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Inject: () => (/* binding */ Inject),
/* harmony export */   InjectSituationType: () => (/* binding */ InjectSituationType),
/* harmony export */   SituationTypeContainer: () => (/* binding */ SituationTypeContainer),
/* harmony export */   SituationTypeContainers: () => (/* binding */ SituationTypeContainers),
/* harmony export */   getInject: () => (/* binding */ getInject)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/reflect/ReflectUtils */ "../../packages/@dooboostore/core/src/reflect/ReflectUtils.ts");

var InjectSituationType;
(function (InjectSituationType) {
    InjectSituationType["INDEX"] = "SIMPLE_BOOT_CORE://Inject/INDEX";
})(InjectSituationType || (InjectSituationType = {}));
class SituationTypeContainer {
    situationType;
    data;
    index;
    constructor({ situationType, data, index }) {
        this.situationType = situationType;
        this.data = data;
        this.index = index;
    }
}
class SituationTypeContainers {
    containers = [];
    constructor(containers) {
        if (containers) {
            this.containers.push(...containers);
        }
    }
    push(...item) {
        this.containers.push(...item);
    }
    get length() {
        return this.containers.length;
    }
    find(predicate, thisArg) {
        return this.containers.find(predicate);
    }
}
const InjectMetadataKey = Symbol('Inject');
const injectProcess = (config, target, propertyKey, parameterIndex) => {
    if (propertyKey && typeof target === 'object') { // <-- object: method
        const otarget = target;
        target = target.constructor;
        const saves = (Reflect.getOwnMetadata(InjectMetadataKey, target, propertyKey) || []);
        const type = _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getParameterTypes(otarget, propertyKey)[parameterIndex];
        saves.push({ index: parameterIndex, config: config, propertyKey, type });
        _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.defineMetadata(InjectMetadataKey, saves, target, propertyKey);
    }
    else if (!propertyKey || typeof target === 'function') { // <-- function: constructor
        const existingInjectdParameters = (_dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(InjectMetadataKey, target) || []);
        const type = _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getParameterTypes(target)[parameterIndex];
        existingInjectdParameters.push({ index: parameterIndex, config: config, type });
        _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.defineMetadata(InjectMetadataKey, existingInjectdParameters, target);
    }
};
function Inject(configOrTarget, propertyKey, parameterIndex) {
    if (propertyKey && parameterIndex !== undefined) {
        injectProcess({}, configOrTarget, propertyKey, parameterIndex);
    }
    else {
        return (target, propertyKey, parameterIndex) => {
            injectProcess(configOrTarget, target, propertyKey, parameterIndex);
        };
    }
}
const getInject = (target, propertyKey) => {
    if (target != null && target !== undefined && typeof target === 'object') {
        target = target.constructor;
    }
    if (propertyKey) {
        const parameters = Reflect.getOwnMetadata(InjectMetadataKey, target, propertyKey);
        return parameters;
    }
    else {
        return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(InjectMetadataKey, target) ?? [];
    }
};


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/decorators/inject/Injection.ts":
/*!**********************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/decorators/inject/Injection.ts ***!
  \**********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Injection: () => (/* binding */ Injection),
/* harmony export */   getInjection: () => (/* binding */ getInjection)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/reflect/ReflectUtils */ "../../packages/@dooboostore/core/src/reflect/ReflectUtils.ts");

const InjectionMetadataKey = Symbol('Injection');
function Injection(configOrTarget, propertyKey, descriptor) {
    if (propertyKey && descriptor) {
        const target = configOrTarget;
        _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.defineMetadata(InjectionMetadataKey, {}, target, propertyKey);
    }
    else {
        return (target, propertyKey, descriptor) => {
            const config = configOrTarget;
            _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.defineMetadata(InjectionMetadataKey, config ?? {}, target, propertyKey);
        };
    }
}
const getInjection = (target, propertyKey) => {
    return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(InjectionMetadataKey, target, propertyKey);
};


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/decorators/inject/index.ts":
/*!******************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/decorators/inject/index.ts ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Inject: () => (/* reexport safe */ _Inject__WEBPACK_IMPORTED_MODULE_0__.Inject),
/* harmony export */   InjectSituationType: () => (/* reexport safe */ _Inject__WEBPACK_IMPORTED_MODULE_0__.InjectSituationType),
/* harmony export */   Injection: () => (/* reexport safe */ _Injection__WEBPACK_IMPORTED_MODULE_1__.Injection),
/* harmony export */   SituationTypeContainer: () => (/* reexport safe */ _Inject__WEBPACK_IMPORTED_MODULE_0__.SituationTypeContainer),
/* harmony export */   SituationTypeContainers: () => (/* reexport safe */ _Inject__WEBPACK_IMPORTED_MODULE_0__.SituationTypeContainers),
/* harmony export */   getInject: () => (/* reexport safe */ _Inject__WEBPACK_IMPORTED_MODULE_0__.getInject),
/* harmony export */   getInjection: () => (/* reexport safe */ _Injection__WEBPACK_IMPORTED_MODULE_1__.getInjection)
/* harmony export */ });
/* harmony import */ var _Inject__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Inject */ "../../packages/@dooboostore/simple-boot/src/decorators/inject/Inject.ts");
/* harmony import */ var _Injection__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Injection */ "../../packages/@dooboostore/simple-boot/src/decorators/inject/Injection.ts");

// export * from './Injectable';

// export * from './InjectArgumentFactory';


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/decorators/route/Router.ts":
/*!******************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/decorators/route/Router.ts ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Route: () => (/* binding */ Route),
/* harmony export */   RouteMetadataKey: () => (/* binding */ RouteMetadataKey),
/* harmony export */   Router: () => (/* binding */ Router),
/* harmony export */   RouterMetadataKey: () => (/* binding */ RouterMetadataKey),
/* harmony export */   getRoute: () => (/* binding */ getRoute),
/* harmony export */   getRouter: () => (/* binding */ getRouter),
/* harmony export */   getRoutes: () => (/* binding */ getRoutes),
/* harmony export */   routerProcess: () => (/* binding */ routerProcess)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/reflect/ReflectUtils */ "../../packages/@dooboostore/core/src/reflect/ReflectUtils.ts");

const RouterMetadataKey = Symbol('Router');
const routerProcess = (config, target) => {
    getRoutes(target)?.forEach(it => {
        config.route = (config.route ?? {});
        const paths = Array.isArray(it.config.path) ? it.config.path : [it.config.path];
        for (const path of paths) {
            if (config.route[path]) {
                const route = config.route[path];
                route.propertyKeys.push(it.propertyKey);
                route.filters = route.filters ?? [];
                if (Array.isArray(it.config.filters)) {
                    route.filters.push(...it.config.filters);
                }
                else if (it.config.filters) {
                    route.filters.push(it.config.filters);
                }
            }
            else {
                config.route[path] = { target, propertyKeys: [it.propertyKey], filters: it.config.filters };
            }
        }
    });
    _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.defineMetadata(RouterMetadataKey, config, target);
};
function Router(configOrTarget) {
    if (typeof configOrTarget === 'function') {
        const routerConfig = {
            path: ''
        };
        routerProcess(routerConfig, configOrTarget);
    }
    else {
        return (target) => {
            configOrTarget.path = configOrTarget.path ?? '';
            routerProcess(configOrTarget, target);
        };
    }
}
const getRouter = (target) => {
    if (target != null && typeof target === 'object') {
        target = target.constructor;
    }
    try {
        return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(RouterMetadataKey, target);
    }
    catch (e) { }
};
const RouteMetadataKey = Symbol('RouteMetadataKey');
const Route = (config) => {
    return (target, propertyKey, descriptor) => {
        const saveRouteConfigs = (_dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(RouteMetadataKey, target.constructor) ?? []);
        const method = target[propertyKey];
        saveRouteConfigs.push({ propertyKey, method, config });
        _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.defineMetadata(RouteMetadataKey, saveRouteConfigs, target.constructor);
        _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.defineMetadata(RouteMetadataKey, config, target, propertyKey);
    };
};
const getRoute = (target, propertyKey) => {
    return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(RouteMetadataKey, target, propertyKey);
};
const getRoutes = (target) => {
    if (target !== null && undefined !== target && typeof target === 'object') {
        target = target.constructor;
    }
    return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(RouteMetadataKey, target);
};


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/decorators/route/index.ts":
/*!*****************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/decorators/route/index.ts ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Route: () => (/* reexport safe */ _Router__WEBPACK_IMPORTED_MODULE_0__.Route),
/* harmony export */   RouteMetadataKey: () => (/* reexport safe */ _Router__WEBPACK_IMPORTED_MODULE_0__.RouteMetadataKey),
/* harmony export */   Router: () => (/* reexport safe */ _Router__WEBPACK_IMPORTED_MODULE_0__.Router),
/* harmony export */   RouterMetadataKey: () => (/* reexport safe */ _Router__WEBPACK_IMPORTED_MODULE_0__.RouterMetadataKey),
/* harmony export */   getRoute: () => (/* reexport safe */ _Router__WEBPACK_IMPORTED_MODULE_0__.getRoute),
/* harmony export */   getRouter: () => (/* reexport safe */ _Router__WEBPACK_IMPORTED_MODULE_0__.getRouter),
/* harmony export */   getRoutes: () => (/* reexport safe */ _Router__WEBPACK_IMPORTED_MODULE_0__.getRoutes),
/* harmony export */   routerProcess: () => (/* reexport safe */ _Router__WEBPACK_IMPORTED_MODULE_0__.routerProcess)
/* harmony export */ });
/* harmony import */ var _Router__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Router */ "../../packages/@dooboostore/simple-boot/src/decorators/route/Router.ts");
// export * from './OnRoute';



/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/decorators/validate/Validation.ts":
/*!*************************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/decorators/validate/Validation.ts ***!
  \*************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   NotEmpty: () => (/* binding */ NotEmpty),
/* harmony export */   NotNull: () => (/* binding */ NotNull),
/* harmony export */   Regexp: () => (/* binding */ Regexp),
/* harmony export */   Valid: () => (/* binding */ Valid),
/* harmony export */   Validation: () => (/* binding */ Validation),
/* harmony export */   execValidation: () => (/* binding */ execValidation),
/* harmony export */   execValidationInValid: () => (/* binding */ execValidationInValid),
/* harmony export */   getValidIndex: () => (/* binding */ getValidIndex),
/* harmony export */   getValidator: () => (/* binding */ getValidator),
/* harmony export */   getValidators: () => (/* binding */ getValidators)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/reflect/ReflectUtils */ "../../packages/@dooboostore/core/src/reflect/ReflectUtils.ts");

const ValidMetadataKey = Symbol('ValidMetadataKey');
const Valid = (target, propertyKey, parameterIndex) => {
    if (propertyKey && typeof target === 'object') { // <-- object: method
        target = target.constructor;
        const existingRequiredParameters = Reflect.getOwnMetadata(ValidMetadataKey, target, propertyKey) || [];
        existingRequiredParameters.push(parameterIndex);
        Reflect.defineMetadata(ValidMetadataKey, existingRequiredParameters, target, propertyKey);
    }
    else if (!propertyKey || typeof target === 'function') { // <-- function: constructor
        const existingRequiredParameters = Reflect.getOwnMetadata(ValidMetadataKey, target) || [];
        existingRequiredParameters.push(parameterIndex);
        Reflect.defineMetadata(ValidMetadataKey, existingRequiredParameters, target);
    }
};
const getValidIndex = (target, propertyKey) => {
    if (target !== null && undefined !== target && typeof target === 'object') {
        target = target.constructor;
    }
    if (propertyKey) {
        const parameters = Reflect.getOwnMetadata(ValidMetadataKey, target, propertyKey);
        return parameters ?? [];
    }
    else {
        return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(ValidMetadataKey, target) ?? [];
    }
};
const ValidationMetadataKey = Symbol('ValidationMetadataKey');
const Validation = (validator) => {
    return (target, propertyKey) => {
        const saves = (_dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(ValidationMetadataKey, target.constructor) ?? []);
        saves.push({
            propertyKey,
            validator
        });
        _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.defineMetadata(ValidationMetadataKey, saves, target.constructor);
        _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.defineMetadata(ValidationMetadataKey, validator, target, propertyKey);
    };
};
const getValidator = (target, propertyKey) => {
    return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(ValidationMetadataKey, target, propertyKey);
};
const getValidators = (target) => {
    if (target !== null && undefined !== target && typeof target === 'object') {
        target = target.constructor;
    }
    return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_0__.ReflectUtils.getMetadata(ValidationMetadataKey, target) ?? [];
};
const Regexp = (regexp) => {
    const content = (value, ...params) => {
        return regexp.test(value);
    };
    return content;
};
const NotNull = (value, ...params) => {
    return value !== null;
};
const NotEmpty = (value, ...params) => {
    return value !== null && value !== undefined && (typeof value === 'string' && value.length > 0 || Array.isArray(value) && value.length > 0);
};
const execValidationInValid = (obj) => {
    return execValidation(obj).filter(it => !it.valid);
};
const execValidation = (obj) => {
    const validators = getValidators(obj);
    const reesults = [];
    validators.forEach(it => {
        reesults.push({
            name: it.propertyKey,
            valid: it.validator(it.propertyKey, it),
            message: ''
        });
    });
    return reesults;
};


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/decorators/validate/index.ts":
/*!********************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/decorators/validate/index.ts ***!
  \********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   NotEmpty: () => (/* reexport safe */ _Validation__WEBPACK_IMPORTED_MODULE_0__.NotEmpty),
/* harmony export */   NotNull: () => (/* reexport safe */ _Validation__WEBPACK_IMPORTED_MODULE_0__.NotNull),
/* harmony export */   Regexp: () => (/* reexport safe */ _Validation__WEBPACK_IMPORTED_MODULE_0__.Regexp),
/* harmony export */   Valid: () => (/* reexport safe */ _Validation__WEBPACK_IMPORTED_MODULE_0__.Valid),
/* harmony export */   Validation: () => (/* reexport safe */ _Validation__WEBPACK_IMPORTED_MODULE_0__.Validation),
/* harmony export */   execValidation: () => (/* reexport safe */ _Validation__WEBPACK_IMPORTED_MODULE_0__.execValidation),
/* harmony export */   execValidationInValid: () => (/* reexport safe */ _Validation__WEBPACK_IMPORTED_MODULE_0__.execValidationInValid),
/* harmony export */   getValidIndex: () => (/* reexport safe */ _Validation__WEBPACK_IMPORTED_MODULE_0__.getValidIndex),
/* harmony export */   getValidator: () => (/* reexport safe */ _Validation__WEBPACK_IMPORTED_MODULE_0__.getValidator),
/* harmony export */   getValidators: () => (/* reexport safe */ _Validation__WEBPACK_IMPORTED_MODULE_0__.getValidators)
/* harmony export */ });
/* harmony import */ var _Validation__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Validation */ "../../packages/@dooboostore/simple-boot/src/decorators/validate/Validation.ts");



/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/fetch/ApiService.ts":
/*!***********************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/fetch/ApiService.ts ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ApiService: () => (/* binding */ ApiService),
/* harmony export */   ApiServiceInterceptor: () => (/* binding */ ApiServiceInterceptor),
/* harmony export */   isStoreAfterFetch: () => (/* binding */ isStoreAfterFetch),
/* harmony export */   isStoreAfterFetchData: () => (/* binding */ isStoreAfterFetchData),
/* harmony export */   isStoreBeforeFetch: () => (/* binding */ isStoreBeforeFetch),
/* harmony export */   isStoreBeforeFetchData: () => (/* binding */ isStoreBeforeFetchData),
/* harmony export */   isStoreError: () => (/* binding */ isStoreError),
/* harmony export */   isStoreFinal: () => (/* binding */ isStoreFinal),
/* harmony export */   isStoreProgress: () => (/* binding */ isStoreProgress),
/* harmony export */   isStoreSuccess: () => (/* binding */ isStoreSuccess)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _alert_AlertService__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../alert/AlertService */ "../../packages/@dooboostore/simple-boot/src/alert/AlertService.ts");
/* harmony import */ var _simstance_SimstanceManager__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../simstance/SimstanceManager */ "../../packages/@dooboostore/simple-boot/src/simstance/SimstanceManager.ts");
/* harmony import */ var _dooboostore_core_types__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dooboostore/core/types */ "../../packages/@dooboostore/core/src/types.ts");
/* harmony import */ var _dooboostore_core_message_Subject__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @dooboostore/core/message/Subject */ "../../packages/@dooboostore/core/src/message/Subject.ts");
/* harmony import */ var _dooboostore_core_fetch_HttpJsonFetcher__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @dooboostore/core/fetch/HttpJsonFetcher */ "../../packages/@dooboostore/core/src/fetch/HttpJsonFetcher.ts");
var _a, _b;







var ApiServiceInterceptor;
(function (ApiServiceInterceptor) {
    ApiServiceInterceptor.TOKEN = Symbol('ApiServiceInterceptor');
    ApiServiceInterceptor.resolveAll = (simstanceManager) => {
        try {
            return (simstanceManager.findSims(ApiServiceInterceptor.TOKEN) ?? []).map(it => it.getValue()).filter(_dooboostore_core_types__WEBPACK_IMPORTED_MODULE_4__.isDefined);
        }
        catch (e) {
            return [];
        }
    };
})(ApiServiceInterceptor || (ApiServiceInterceptor = {}));
const isStoreAfterFetch = (data) => {
    return data.type === 'afterFetch';
};
const isStoreAfterFetchData = (data) => {
    return data.type === 'afterFetchData';
};
const isStoreBeforeFetch = (data) => {
    return data.type === 'beforeFetch';
};
const isStoreBeforeFetchData = (data) => {
    return data.type === 'beforeFetchData';
};
const isStoreProgress = (data) => {
    return data.type === 'progress';
};
const isStoreSuccess = (data) => {
    return data.type === 'success';
};
const isStoreError = (data) => {
    return data.type === 'error';
};
const isStoreFinal = (data) => {
    return data.type === 'final';
};
let ApiService = class ApiService extends _dooboostore_core_fetch_HttpJsonFetcher__WEBPACK_IMPORTED_MODULE_6__.HttpJsonFetcher {
    simstanceManager;
    subject = new _dooboostore_core_message_Subject__WEBPACK_IMPORTED_MODULE_5__.Subject();
    alertService;
    constructor(simstanceManager, alertService) {
        super();
        this.simstanceManager = simstanceManager;
        this.alertService = alertService;
        // console.log('%c ApiService constructor', 'color: #ff0000');
    }
    // @PostConstruct
    // postConstruct(alertService: AlertService<any>) {
    //   this.alertService = alertService;
    // }
    get observable() {
        return this.subject.asObservable();
    }
    createPipe(config) {
        return {};
    }
    async beforeProxyFetch(config) {
        let interceptors = ApiServiceInterceptor.resolveAll(this.simstanceManager);
        for (const interceptor of interceptors) {
            if (interceptor.beforeProxyFetch) {
                config = await interceptor.beforeProxyFetch(config);
            }
        }
        // @ts-ignore
        this.subject.next({ type: 'beforeFetchData', config: config });
        return config;
    }
    async afterProxyFetch(config) {
        // console.log('afterProxyFetch!!!!11', config);
        let interceptors = ApiServiceInterceptor.resolveAll(this.simstanceManager);
        let r = config.response;
        for (const interceptor of interceptors) {
            if (interceptor.afterProxyFetch) {
                r = await interceptor.afterProxyFetch(config);
            }
        }
        // console.log('afterProxyFetch!!!!22', r);
        this.subject.next({ type: 'afterFetchData', response: r });
        return r;
    }
    beforeFetch(fetch) {
        this.subject.next({ type: 'beforeFetch', fetch });
    }
    afterFetch(fetch, response) {
        this.subject.next({ type: 'afterFetch', fetch, response });
    }
    before(config, pipe) {
        this.subject.next({ type: 'progress', config, pipe });
        config.config?.config?.callBackProgress?.(config, pipe);
        if (config.config?.config?.alertProgress) {
            const alert = this.alertService?.progress({ title: config.config.config.title });
            if (alert) {
                pipe.progress = alert;
                alert.activate();
            }
        }
    }
    afterSuccess(config, pipe) {
        this.subject.next({ type: 'success', config, pipe });
        config.config?.config?.callBackSuccess?.(config, pipe);
        if (config.config?.config?.alertSuccessMsg) {
            this.alertService?.success({ title: config.config.config.title })?.activate();
        }
    }
    afterSuccessTransform(config, pipe) {
    }
    finally(config, pipe) {
        this.subject.next({ type: 'final', config, pipe });
        config.config?.config?.callBackFinal?.(config, pipe);
        pipe.progress?.deActivate();
    }
    error(config, pipe, e) {
        console.log('error', e);
        this.subject.next({ type: 'error', config, pipe, e });
        config.config?.config?.callBackError?.(config, pipe, e);
        if (config.config?.config?.alertErrorMsg) {
            this.alertService?.danger({
                title: `${config.config.config.title ? config.config.config.title : ''}${e.message ? `(${e.message})` : ''}`
            })
                ?.activate();
        }
        if (config.config?.config?.enableErrorConsole) {
            console.error(`apiService Error ${config?.config?.config?.title}`, e);
        }
    }
    async execute(fetcherRequest
    // target: HttpFetcherTarget,
    // config?: HttpFetcherConfig<ApiService.ApiServiceConfig>
    ) {
        const target = fetcherRequest.target;
        const config = fetcherRequest.config;
        let r = { target, config };
        const interceptor = ApiServiceInterceptor.resolveAll(this.simstanceManager) ?? [];
        for (const apiServiceInterceptor of interceptor) {
            if (apiServiceInterceptor.beforeProxyExecute) {
                r = await apiServiceInterceptor.beforeProxyExecute?.(r);
            }
        }
        return super.execute(r);
    }
};
ApiService = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__.Sim,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _simstance_SimstanceManager__WEBPACK_IMPORTED_MODULE_3__.SimstanceManager !== "undefined" && _simstance_SimstanceManager__WEBPACK_IMPORTED_MODULE_3__.SimstanceManager) === "function" ? _a : Object, typeof (_b = typeof _alert_AlertService__WEBPACK_IMPORTED_MODULE_2__.AlertService !== "undefined" && _alert_AlertService__WEBPACK_IMPORTED_MODULE_2__.AlertService) === "function" ? _b : Object])
], ApiService);



/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/intent/Intent.ts":
/*!********************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/intent/Intent.ts ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Intent: () => (/* binding */ Intent),
/* harmony export */   PublishType: () => (/* binding */ PublishType)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_expression_Expression__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/expression/Expression */ "../../packages/@dooboostore/core/src/expression/Expression.ts");

var PublishType;
(function (PublishType) {
    PublishType["DATA_PARAMETERS"] = "DATA_PARAMETERS";
    PublishType["INLINE_DATA_PARAMETERS"] = "INLINE_DATA_PARAMETERS";
})(PublishType || (PublishType = {}));
/* uri struct
    scheme uri example: mymodule://asd/asd/b?a=545&aa=33&wow=wow
    global uri example: ://asd/asd/b?a=545&aa=33&wow=wow
    route uri example: Router(/users/aa/ffw)://asd/asd/b?a=545&aa=33&wow=wow
    Symbol.for uri example: Symbol.for(zzz)://asd/asd/b?a=545&aa=33&wow=wow
    <>://<>:<>@<>:<>/<>?<>#<>
*/
class Intent {
    uri;
    data;
    event;
    publishType;
    sessionData = new Map();
    constructor(uri, data, event) {
        this.uri = uri;
        this.data = data;
        this.event = event;
        if (typeof uri === 'string') {
            const match = uri.match(/^Symbol\.for\((.+)\):\/(.*)$/);
            if (match) {
                const symbol = Symbol.for(match[1]);
                this.uri = {
                    symbol: symbol,
                    uri: match[2],
                };
            }
        }
    }
    get symbols() {
        if (typeof this.uri === 'object') {
            // ensure symbol is always an array
            return Array.isArray(this.uri.symbol) ? this.uri.symbol : [this.uri.symbol];
        }
        return undefined;
    }
    get scheme() {
        if (typeof this.uri === 'string') {
            const parts = this.uri.split('://');
            if (parts.length > 1) {
                return parts[0];
            }
            return undefined;
        }
        else {
            return undefined;
        }
    }
    get paths() {
        return (this.pathname.split('/') ?? []);
    }
    get fullPath() {
        const uri = typeof this.uri === 'string' ? this.uri : this.uri.uri;
        const paths = uri.split('://');
        return paths[paths.length >= 2 ? 1 : 0] ?? '';
    }
    get pathname() {
        const paths = this.fullPath.split('?');
        return paths[0];
    }
    get query() {
        const paths = this.fullPath.split('?');
        // console.log('fullPath', this.fullPath, paths)
        return paths[1] ?? '';
    }
    getQueryParamDecodeURI(key) {
        const p = this.queryParamsDecodeURI;
        if (key) {
            return p[key];
        }
        else {
            return p;
        }
    }
    getQueryParamDecodeURIFirst(key) {
        const param = this.getQueryParamDecodeURI(key);
        if (Array.isArray(param)) {
            return param[0];
        }
        else {
            return param;
        }
    }
    ;
    getQueryParam(key) {
        const p = this.queryParams;
        if (key) {
            return p[key];
        }
        else {
            return p;
        }
    }
    getQueryParamFirst(key) {
        const param = this.getQueryParam(key);
        if (Array.isArray(param)) {
            return param[0];
        }
        else {
            return param;
        }
    }
    get queryParams() {
        const param = {};
        this.query.split('&')?.forEach(it => {
            const a = it.split('=');
            if (param[a[0]]) {
                if (Array.isArray(param[a[0]])) {
                    param[a[0]].push(a[1]);
                }
                else {
                    param[a[0]] = [param[a[0]], a[1]];
                }
            }
            else {
                param[a[0]] = a[1];
            }
        });
        return param;
    }
    get queryParamsDecodeURI() {
        const params = this.queryParams;
        for (const key in params) {
            if (params.hasOwnProperty(key)) {
                const param = params[key];
                if (Array.isArray(param)) {
                    params[key] = param.map(p => decodeURIComponent(p));
                }
                else {
                    params[key] = decodeURIComponent(param);
                }
            }
        }
        return params;
    }
    getPathnameData(urlExpression) {
        return _dooboostore_core_expression_Expression__WEBPACK_IMPORTED_MODULE_0__.Expression.Path.pathNameData(this.pathname, urlExpression);
    }
    get isSymbolScheme() {
        return this.symbols !== undefined;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/intent/IntentManager.ts":
/*!***************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/intent/IntentManager.ts ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   IntentManager: () => (/* binding */ IntentManager),
/* harmony export */   isRouterPublishType: () => (/* binding */ isRouterPublishType)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _Intent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Intent */ "../../packages/@dooboostore/simple-boot/src/intent/Intent.ts");
/* harmony import */ var _simstance_SimstanceManager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../simstance/SimstanceManager */ "../../packages/@dooboostore/simple-boot/src/simstance/SimstanceManager.ts");
/* harmony import */ var _decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _simstance_SimAtomic__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../simstance/SimAtomic */ "../../packages/@dooboostore/simple-boot/src/simstance/SimAtomic.ts");
/* harmony import */ var _dooboostore_core_message_Subject__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @dooboostore/core/message/Subject */ "../../packages/@dooboostore/core/src/message/Subject.ts");
/* harmony import */ var _route_RouterManager__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../route/RouterManager */ "../../packages/@dooboostore/simple-boot/src/route/RouterManager.ts");
/* harmony import */ var _SimOption__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../SimOption */ "../../packages/@dooboostore/simple-boot/src/SimOption.ts");
/* harmony import */ var _IntentSubscribe__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./IntentSubscribe */ "../../packages/@dooboostore/simple-boot/src/intent/IntentSubscribe.ts");
/* harmony import */ var _decorators__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../decorators */ "../../packages/@dooboostore/simple-boot/src/decorators/index.ts");
var _a, _b, _c;










const isRouterPublishType = (it) => typeof it === 'object' &&
    typeof it.router === 'string' &&
    typeof it.rootRouter === 'function';
let IntentManager = class IntentManager {
    simstanceManager;
    routerManager;
    simOption;
    subject = new _dooboostore_core_message_Subject__WEBPACK_IMPORTED_MODULE_5__.Subject();
    constructor(simstanceManager, routerManager, simOption) {
        this.simstanceManager = simstanceManager;
        this.routerManager = routerManager;
        this.simOption = simOption;
    }
    get observable() {
        return this.subject.asObservable();
    }
    async makeIntentData(it, data) {
        const target = [];
        const rootRouter = isRouterPublishType(it) ? it.rootRouter : this.simOption.rootRouter;
        it = isRouterPublishType(it) ? it.router : it;
        const routerMatch = typeof it === 'string' && it.match(/^Router\((.+)\):\/(.*)$/); // Escaped parentheses and slash, no quotes
        if (routerMatch && typeof it === 'string') {
            const routerBasePath = routerMatch[1];
            const actualPath = routerMatch[2];
            const routerModule = await this.routerManager.routing(routerBasePath, { router: rootRouter });
            const instance = routerModule.getModuleInstance();
            if (instance) {
                target.push(instance);
            }
            it = new _Intent__WEBPACK_IMPORTED_MODULE_1__.Intent(actualPath, data);
        }
        else if (typeof it === 'string') {
            it = new _Intent__WEBPACK_IMPORTED_MODULE_1__.Intent(it, data);
        }
        const intent = it;
        if (!routerMatch) {
            if (intent.symbols) {
                target.push(...intent.symbols.map(sym => this.simstanceManager.findSims(sym)).flat());
            }
            else if (intent.scheme) {
                target.push(...this.simstanceManager.getSimConfig(intent.scheme));
            }
            else {
                target.push(...this.simstanceManager.getSimAtomics());
            }
        }
        return { intent, target };
    }
    async publishMeta(it, data) {
        const { intent, target } = await this.makeIntentData(it, data);
        const r = [];
        const targetInstances = target.map(it => {
            if (it instanceof _simstance_SimAtomic__WEBPACK_IMPORTED_MODULE_4__.SimAtomic) {
                return it.getValue();
            }
            else {
                return it;
            }
        });
        this.subject.next(intent);
        for (let data of targetInstances) {
            let orNewSim = data;
            if (orNewSim) {
                if (intent.paths.length > 0) {
                    let callthis = orNewSim;
                    let lastProp = '';
                    // path '/'   .
                    intent.paths
                        .filter(i => i)
                        .forEach(i => {
                        callthis = orNewSim;
                        orNewSim = orNewSim?.[i];
                        lastProp = i;
                    });
                    if (orNewSim && typeof orNewSim === 'function') {
                        const injects = (0,_decorators__WEBPACK_IMPORTED_MODULE_9__.getInject)(callthis, orNewSim.name);
                        // console.log('-------params', injects);
                        if (injects) {
                            for (const inject of injects) {
                                let v = this.simstanceManager.findLastSim(inject.config).getValue();
                                if (typeof inject.config.returnFactory === "function") {
                                    v = await inject.config.returnFactory({ instance: callthis, methodName: orNewSim.name, parameter: intent.data }, v);
                                }
                                else if (typeof inject.config.returnFactory === "string") {
                                    v = await v[inject.config.returnFactory]({ instance: callthis, methodName: orNewSim.name, parameter: intent.data }, v);
                                }
                                intent.data[inject.index] = v;
                            }
                        }
                        if (_Intent__WEBPACK_IMPORTED_MODULE_1__.PublishType.DATA_PARAMETERS === intent.publishType) {
                            r.push(orNewSim.call(callthis, intent.data));
                        }
                        else if (_Intent__WEBPACK_IMPORTED_MODULE_1__.PublishType.INLINE_DATA_PARAMETERS === intent.publishType) {
                            r.push(orNewSim.call(callthis, ...intent.data));
                        }
                        else {
                            r.push(orNewSim.call(callthis, intent));
                        }
                    }
                    else if (orNewSim) {
                        callthis[lastProp] = intent.data;
                        r.push(callthis[lastProp]);
                    }
                }
                else {
                    if (_Intent__WEBPACK_IMPORTED_MODULE_1__.PublishType.DATA_PARAMETERS === intent.publishType) {
                        if ((0,_IntentSubscribe__WEBPACK_IMPORTED_MODULE_8__.isIntentSubscribe)(orNewSim)) {
                            r.push(orNewSim.intentSubscribe(intent.data));
                        }
                    }
                    else if (_Intent__WEBPACK_IMPORTED_MODULE_1__.PublishType.INLINE_DATA_PARAMETERS === intent.publishType) {
                        if ((0,_IntentSubscribe__WEBPACK_IMPORTED_MODULE_8__.isIntentSubscribe)(orNewSim)) {
                            r.push(orNewSim.intentSubscribe(...intent.data));
                        }
                    }
                    else {
                        if ((0,_IntentSubscribe__WEBPACK_IMPORTED_MODULE_8__.isIntentSubscribe)(orNewSim)) {
                            r.push(orNewSim?.intentSubscribe?.(intent));
                        }
                    }
                }
            }
        }
        return { return: r, target };
    }
    async publish(it, data) {
        const rdata = await this.publishMeta(it, data);
        return rdata.return;
    }
};
IntentManager = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_3__.Sim,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _simstance_SimstanceManager__WEBPACK_IMPORTED_MODULE_2__.SimstanceManager !== "undefined" && _simstance_SimstanceManager__WEBPACK_IMPORTED_MODULE_2__.SimstanceManager) === "function" ? _a : Object, typeof (_b = typeof _route_RouterManager__WEBPACK_IMPORTED_MODULE_6__.RouterManager !== "undefined" && _route_RouterManager__WEBPACK_IMPORTED_MODULE_6__.RouterManager) === "function" ? _b : Object, typeof (_c = typeof _SimOption__WEBPACK_IMPORTED_MODULE_7__.SimOption !== "undefined" && _SimOption__WEBPACK_IMPORTED_MODULE_7__.SimOption) === "function" ? _c : Object])
], IntentManager);



/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/intent/IntentSubscribe.ts":
/*!*****************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/intent/IntentSubscribe.ts ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isIntentSubscribe: () => (/* binding */ isIntentSubscribe)
/* harmony export */ });
const isIntentSubscribe = (obj) => {
    return !!obj && typeof obj.intentSubscribe === 'function';
};


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/lifecycle/OnSimCreate.ts":
/*!****************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/lifecycle/OnSimCreate.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isOnSimCreate: () => (/* binding */ isOnSimCreate)
/* harmony export */ });
const isOnSimCreate = (obj) => {
    return typeof obj?.onSimCreate === 'function';
};


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/lifecycle/OnSimCreateCompleted.ts":
/*!*************************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/lifecycle/OnSimCreateCompleted.ts ***!
  \*************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   isOnSimCreateProxyCompleted: () => (/* binding */ isOnSimCreateProxyCompleted)
/* harmony export */ });
const isOnSimCreateProxyCompleted = (obj) => {
    return typeof obj?.onSimCreateProxyCompleted === 'function';
};


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/proxy/SimProxyHandler.ts":
/*!****************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/proxy/SimProxyHandler.ts ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SimProxyHandler: () => (/* binding */ SimProxyHandler)
/* harmony export */ });
/* harmony import */ var _decorators_aop_AOPDecorator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../decorators/aop/AOPDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/aop/AOPDecorator.ts");
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");
/* harmony import */ var _decorators_exception_ExceptionDecorator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../decorators/exception/ExceptionDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/exception/ExceptionDecorator.ts");
/* harmony import */ var _decorators_inject_Inject__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../decorators/inject/Inject */ "../../packages/@dooboostore/simple-boot/src/decorators/inject/Inject.ts");




class SimProxyHandler {
    simpleApplication;
    simstanceManager;
    simOption;
    constructor(simpleApplication, simstanceManager, simOption) {
        this.simpleApplication = simpleApplication;
        this.simstanceManager = simstanceManager;
        this.simOption = simOption;
        // console.log('SimProxyHandler', simstanceManager, simOption)
    }
    //     simstanceManager
    get(target, name) {
        if (name === '_SimpleBoot_application') {
            return this.simpleApplication;
        }
        else if (name === '_SimpleBoot_simstanceManager') {
            return this.simstanceManager;
        }
        else if (name === '_SimpleBoot_simOption') {
            return this.simOption;
        }
        else {
            return target[name];
        }
    }
    set(obj, prop, value, receiver) {
        value = this.simstanceManager?.proxy(value);
        obj[prop] = value;
        return true;
    }
    apply(target, thisArg, argumentsList) {
        let r;
        try {
            this.aopBefore(thisArg, target);
            try {
                // @ts-ignore
                r = Reflect.apply(target, thisArg, argumentsList);
                // r = target.apply(thisArg, argumentsList);
                // eslint-disable-next-line no-useless-catch
            }
            catch (e) {
                throw e;
            }
            finally {
                this.aopAfter(thisArg, target);
            }
        }
        catch (e) {
            console.error(e);
            const inHandlers = this.getExceptionHandler(e, thisArg, target);
            if (inHandlers.length > 0 && inHandlers[0]) {
                const inHandler = inHandlers[0];
                this.executeExceptionHandler(e, inHandler, argumentsList);
            }
            else {
                throw e;
            }
        }
        return r;
    }
    executeExceptionHandler(e, inHandler, argumentsList) {
        const otherStorage = new Map();
        otherStorage.set(e.constructor, e);
        const situationErrorTypeContainer = new _decorators_inject_Inject__WEBPACK_IMPORTED_MODULE_3__.SituationTypeContainer({
            situationType: _decorators_exception_ExceptionDecorator__WEBPACK_IMPORTED_MODULE_2__.ExceptionHandlerSituationType.ERROR_OBJECT,
            data: e
        });
        const situationParameterTypeContainer = new _decorators_inject_Inject__WEBPACK_IMPORTED_MODULE_3__.SituationTypeContainer({
            situationType: _decorators_exception_ExceptionDecorator__WEBPACK_IMPORTED_MODULE_2__.ExceptionHandlerSituationType.PARAMETER,
            data: argumentsList
        });
        otherStorage.set(_decorators_inject_Inject__WEBPACK_IMPORTED_MODULE_3__.SituationTypeContainers, new _decorators_inject_Inject__WEBPACK_IMPORTED_MODULE_3__.SituationTypeContainers([situationErrorTypeContainer, situationParameterTypeContainer]));
        argumentsList?.forEach(it => {
            otherStorage.set(it.constructor, it);
        });
        try {
            this.simstanceManager.executeBindParameterSim({
                target: inHandler.thisArg,
                targetKey: inHandler.config.propertyKey
            }, otherStorage);
        }
        catch (es) {
            e = es;
        }
        if (inHandler.config.config.throw) {
            const exceptionHandler = this.getExceptionHandler(e, inHandler.thisArg, inHandler.config.method);
            if ((exceptionHandler?.length ?? 0) > 0) {
                this.executeExceptionHandler(e, exceptionHandler[0], argumentsList);
            }
        }
    }
    getExceptionHandler(e, thisArg, target) {
        const globalConfigSets = this.simOption.advice.map(it => this.simstanceManager?.getOrNewSim({ target: it })).filter(it => it).map(it => {
            return { thisArg: it, config: (0,_decorators_exception_ExceptionDecorator__WEBPACK_IMPORTED_MODULE_2__.targetExceptionHandler)(it, e, [target]) };
        }) ?? [];
        const thisConfigSet = { thisArg: thisArg, config: (0,_decorators_exception_ExceptionDecorator__WEBPACK_IMPORTED_MODULE_2__.targetExceptionHandler)(thisArg, e, [target]) };
        const inHandlers = [thisConfigSet, ...globalConfigSets].filter(it => it && it.config);
        return inHandlers;
    }
    aopBefore(obj, protoType) {
        const propertyName = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_1__.ObjectUtils.prototypeName(obj, protoType);
        if (propertyName && obj) {
            (0,_decorators_aop_AOPDecorator__WEBPACK_IMPORTED_MODULE_0__.getProtoBefores)(obj, propertyName).forEach(it => {
                it.call(obj, protoType, propertyName);
            });
            for (let i = 0; i < this.simOption.advice.length; i++) {
                const sim = this.simstanceManager?.getOrNewSim({ target: this.simOption.advice[i] });
                const protoBefores = (0,_decorators_aop_AOPDecorator__WEBPACK_IMPORTED_MODULE_0__.getProtoBefores)(sim, propertyName, Object.getPrototypeOf(obj));
                protoBefores.forEach(it => {
                    it.call(obj, protoType, propertyName);
                });
            }
        }
    }
    aopAfter(obj, protoType) {
        const propertyName = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_1__.ObjectUtils.prototypeName(obj, protoType);
        if (propertyName) {
            (0,_decorators_aop_AOPDecorator__WEBPACK_IMPORTED_MODULE_0__.getProtoAfters)(obj, propertyName).forEach(it => {
                it.call(obj, protoType, propertyName);
            });
            for (let i = 0; i < this.simOption.advice.length; i++) {
                const sim = this.simstanceManager?.getOrNewSim({ target: this.simOption.advice[i] });
                const protoBefores = (0,_decorators_aop_AOPDecorator__WEBPACK_IMPORTED_MODULE_0__.getProtoAfters)(sim, propertyName, Object.getPrototypeOf(obj));
                protoBefores.forEach(it => {
                    it.call(obj, protoType, propertyName);
                });
            }
        }
    }
    has(target, key) {
        if (key === '_SimpleBoot_isProxy') {
            return true;
        }
        return key in target;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/route/RouterAction.ts":
/*!*************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/route/RouterAction.ts ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   RouterAction: () => (/* binding */ RouterAction)
/* harmony export */ });
var RouterAction;
(function (RouterAction) {
    RouterAction.isCanActivate = (obj) => {
        return typeof obj?.canActivate === 'function';
    };
    RouterAction.isOnRouting = (obj) => {
        return typeof obj?.onRouting === 'function';
    };
    RouterAction.isHasActivate = (obj) => {
        return typeof obj?.hasActivate === 'function';
    };
})(RouterAction || (RouterAction = {}));


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/route/RouterManager.ts":
/*!**************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/route/RouterManager.ts ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   RouterManager: () => (/* binding */ RouterManager)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _intent_Intent__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../intent/Intent */ "../../packages/@dooboostore/simple-boot/src/intent/Intent.ts");
/* harmony import */ var _RouterModule__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./RouterModule */ "../../packages/@dooboostore/simple-boot/src/route/RouterModule.ts");
/* harmony import */ var _decorators_route_Router__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../decorators/route/Router */ "../../packages/@dooboostore/simple-boot/src/decorators/route/Router.ts");
/* harmony import */ var _simstance_SimAtomic__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../simstance/SimAtomic */ "../../packages/@dooboostore/simple-boot/src/simstance/SimAtomic.ts");
/* harmony import */ var _simstance_SimstanceManager__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../simstance/SimstanceManager */ "../../packages/@dooboostore/simple-boot/src/simstance/SimstanceManager.ts");
/* harmony import */ var _decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_core_expression_Expression__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @dooboostore/core/expression/Expression */ "../../packages/@dooboostore/core/src/expression/Expression.ts");
/* harmony import */ var _route_RouterAction__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../route/RouterAction */ "../../packages/@dooboostore/simple-boot/src/route/RouterAction.ts");
/* harmony import */ var _SimOption__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../SimOption */ "../../packages/@dooboostore/simple-boot/src/SimOption.ts");
/* harmony import */ var _dooboostore_core_message_Subject__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @dooboostore/core/message/Subject */ "../../packages/@dooboostore/core/src/message/Subject.ts");
var _a, _b;











let RouterManager = class RouterManager {
    simstanceManager;
    simOption;
    activeRouterModule;
    subject = new _dooboostore_core_message_Subject__WEBPACK_IMPORTED_MODULE_10__.Subject();
    constructor(simstanceManager, simOption) {
        this.simstanceManager = simstanceManager;
        this.simOption = simOption;
    }
    // @SimNoProxy
    get observable() {
        // this.subject.asObservable
        return this.subject.asObservable();
    }
    routingMap(option) {
        const targetRouter = option?.router ?? this.simOption.rootRouter;
        if (!targetRouter) {
            throw new Error('no router');
        }
        const map = {};
        if (targetRouter) {
            const targetType = (typeof targetRouter === 'object') ? targetRouter.constructor : targetRouter;
            const targetValue = (typeof targetRouter === 'object') ? targetRouter : undefined;
            const routerAtomic = new _simstance_SimAtomic__WEBPACK_IMPORTED_MODULE_4__.SimAtomic({ targetKeyType: targetType, originalType: targetType, value: targetValue }, this.simstanceManager);
            const routerData = routerAtomic.getConfig(_decorators_route_Router__WEBPACK_IMPORTED_MODULE_3__.RouterMetadataKey);
            if (routerData) {
                const currentPrefix = (option?.prefix ?? '') + routerData.path;
                // Add the current router's path if it has a default route
                if (routerData.route && routerData.route['']) {
                    map[currentPrefix] = routerData.route[''];
                }
                if (routerData.route) {
                    Object.entries(routerData.route).forEach(([key, value]) => {
                        map[currentPrefix + key] = value;
                    });
                }
                routerData.routers?.forEach(it => {
                    Object.assign(map, this.routingMap({ ...option, router: it, prefix: currentPrefix }));
                });
            }
        }
        return map;
    }
    /**  lifecycle   find.. .
     * @deprecated
     */
    async routings(intent, option) {
        const targetRouter = option?.router ?? this.simOption.rootRouter;
        if (!targetRouter) {
            throw new Error('no router');
        }
        const targetType = (typeof targetRouter === 'object') ? targetRouter.constructor : targetRouter;
        const targetValue = (typeof targetRouter === 'object') ? targetRouter : undefined;
        const routerAtomic = new _simstance_SimAtomic__WEBPACK_IMPORTED_MODULE_4__.SimAtomic({ targetKeyType: targetType, originalType: targetType, value: targetValue }, this.simstanceManager);
        const allMatches = this._collectAllMatchingModules(routerAtomic, intent, []);
        // Priority 1: Exact path match with a module
        const exactModuleMatches = allMatches.filter(rm => rm.path === intent.pathname && rm.module);
        if (exactModuleMatches.length > 0) {
            exactModuleMatches.forEach(it => this.subject.next(({ intent, routerManager: this, routerModule: it })));
            return exactModuleMatches;
        }
        // Priority 2: Exact path match without a module (if no module matches found)
        const exactPathMatches = allMatches.filter(rm => rm.path === intent.pathname);
        if (exactPathMatches.length > 0) {
            exactPathMatches.forEach(it => this.subject.next(({ intent, routerManager: this, routerModule: it })));
            return exactPathMatches;
        }
        return [];
    }
    async routing(intent, option) {
        if (typeof intent === 'string') {
            intent = new _intent_Intent__WEBPACK_IMPORTED_MODULE_1__.Intent(intent);
        }
        const targetRouter = option?.router ?? this.simOption.rootRouter;
        if (!targetRouter) {
            throw new Error('no router');
        }
        // await new Promise((r)=> setTimeout(r, 0)); // <--    ?  event loop ?
        const targetType = (typeof targetRouter === 'object') ? targetRouter.constructor : targetRouter;
        const targetValue = (typeof targetRouter === 'object') ? targetRouter : undefined;
        const routerAtomic = new _simstance_SimAtomic__WEBPACK_IMPORTED_MODULE_4__.SimAtomic({ targetKeyType: targetType, originalType: targetType, value: targetValue }, this.simstanceManager);
        const rootRouter = routerAtomic.getValue();
        const executeModuleResult = this.getExecuteModule(routerAtomic, intent, [], option);
        if (executeModuleResult) {
            const [executeModule, routerChains] = executeModuleResult;
            executeModule.routerChains = routerChains;
            this.activeRouterModule = executeModule;
            const routingDataSet = { intent, routerModule: executeModule, routerManager: this };
            // ---  (Chain)       ---
            //       (: RootRouter -> UserRouter) 
            //   canActivate onRouting .
            //           .
            if (routerChains.length > 0) {
                for (let i = 0; i < routerChains.length; i++) {
                    const current = routerChains[i];
                    const next = routerChains[i + 1];
                    const value = current.getValue();
                    if (_route_RouterAction__WEBPACK_IMPORTED_MODULE_8__.RouterAction.isCanActivate(value) && next) {
                        await value.canActivate(routingDataSet, next.getValue());
                    }
                    if (_route_RouterAction__WEBPACK_IMPORTED_MODULE_8__.RouterAction.isOnRouting(value) && next) {
                        await value.onRouting(routingDataSet);
                    }
                }
            }
            this.activeRouterModule = executeModule;
            const moduleInstance = executeModule.getModuleInstance();
            // --- Case 1:   ( ,     ) ---
            // URL   ,    `route`     .
            //  ,      .
            if (!executeModule?.module) {
                const routerChain = executeModule.routerChains[executeModule.routerChains.length - 1];
                const value = routerChain?.getValue();
                if (_route_RouterAction__WEBPACK_IMPORTED_MODULE_8__.RouterAction.isCanActivate(value)) {
                    await value.canActivate(routingDataSet, moduleInstance);
                }
                if (_route_RouterAction__WEBPACK_IMPORTED_MODULE_8__.RouterAction.isOnRouting(value)) {
                    await value.onRouting(routingDataSet);
                }
            }
            // --- Case 2:   (     ) ---
            //   .
            //         .
            else { // find page
                const value = executeModule.router?.getValue();
                if (_route_RouterAction__WEBPACK_IMPORTED_MODULE_8__.RouterAction.isCanActivate(value)) {
                    await value.canActivate(routingDataSet, moduleInstance);
                }
                if (_route_RouterAction__WEBPACK_IMPORTED_MODULE_8__.RouterAction.isOnRouting(value)) {
                    await value.onRouting(routingDataSet);
                }
                //   Route isRouting
                if (moduleInstance && _route_RouterAction__WEBPACK_IMPORTED_MODULE_8__.RouterAction.isOnRouting(moduleInstance)) {
                    await moduleInstance.onRouting(routingDataSet);
                }
            }
            const find = this.activeRouterModule;
            this.subject.next({ intent: intent, routerModule: find, routerManager: this });
            return find;
        }
        else {
            const empty = await this._handleNotFoundRouting(rootRouter, intent);
            this.subject.next({ intent: intent, routerModule: empty, routerManager: this });
            return empty;
        }
    }
    /**
     * URL      .
     * "Not Found"    RouterModule   .
     *   rootRouter       .
     * @param rootRouter    
     * @param intent    Intent 
     * @private
     */
    async _handleNotFoundRouting(rootRouter, intent) {
        /*
         *    ()
         * const routers: SimAtomic[] = [];   if  false    .
         *
         * const routers: SimAtomic[] = [];
         * const routerModule = new RouterModule(this.simstanceManager, rootRouter, undefined, routers);
         * const routingDataSet = {intent, routerModule: routerModule, routerManager: this};
         * if (routers.length && routers.length > 0) {
         *   for (let i = 0; i < routers.length; i++) {
         *     const current = routers[i];
         *     const next = routers[i + 1];
         *     const value = current.getValue()! as any;
         *     // console.log('routerAction!!!!!!!!!3')
         *     if (RouterAction.isCanActivate(value)) {
         *       await value.canActivate(routingDataSet, next?.getValue() ?? null);
         *     }
         *     if (RouterAction.isOnRouting(value)) {
         *       await value.onRouting(routingDataSet);
         *     }
         *   }
         * }
         * this.activeRouterModule = routerModule;
         * return this.activeRouterModule as RouterModule<any, any>;
        */
        const routerModule = new _RouterModule__WEBPACK_IMPORTED_MODULE_2__.RouterModule(this.simstanceManager, rootRouter, undefined, []);
        const routingDataSet = { intent, routerModule: routerModule, routerManager: this };
        const value = rootRouter;
        if (_route_RouterAction__WEBPACK_IMPORTED_MODULE_8__.RouterAction.isCanActivate(value)) {
            await value.canActivate(routingDataSet, null);
        }
        if (_route_RouterAction__WEBPACK_IMPORTED_MODULE_8__.RouterAction.isOnRouting(value)) {
            await value.onRouting(routingDataSet);
        }
        this.activeRouterModule = routerModule;
        return this.activeRouterModule;
    }
    getExecuteModule(router, intent, parentRouters, option) {
        const path = intent.pathname;
        const routerConfig = router.getConfig(_decorators_route_Router__WEBPACK_IMPORTED_MODULE_3__.RouterMetadataKey);
        if (routerConfig) {
            // filter
            const filters = [];
            if (Array.isArray(routerConfig.filters)) {
                filters.push(...routerConfig.filters);
            }
            else if (routerConfig.filters) {
                filters.push(routerConfig.filters);
            }
            const noAccept = filters.some(it => (typeof it === 'function' ? this.simstanceManager.getOrNewSim({ target: it }) : it)?.isAccept(intent) === false);
            if (noAccept) {
                return;
            }
            const routerStrings = parentRouters.map(it => it.getConfig(_decorators_route_Router__WEBPACK_IMPORTED_MODULE_3__.RouterMetadataKey)?.path || '');
            const isRoot = this.isRootUrl(routerConfig.path, routerStrings, path);
            // console.log('----------routerConfig.path', routerConfig.path, 'isRoot', isRoot, 'routerStrings', routerStrings, 'path', path);
            if (isRoot) {
                const currentParentRouters = [...parentRouters, router];
                // first find child routers
                if (routerConfig.routers && routerConfig.routers.length > 0) {
                    let bestMatchModule = undefined;
                    let bestMatchLength = -1;
                    for (const child of routerConfig.routers) {
                        const routerAtomic = new _simstance_SimAtomic__WEBPACK_IMPORTED_MODULE_4__.SimAtomic({ targetKeyType: child, originalType: child }, this.simstanceManager);
                        const executeModule = this.getExecuteModule(routerAtomic, intent, currentParentRouters, option);
                        if (executeModule) {
                            const [rm, chains] = executeModule;
                            const currentMatchLength = rm.path?.length || 0;
                            if (currentMatchLength > bestMatchLength) {
                                bestMatchLength = currentMatchLength;
                                bestMatchModule = executeModule;
                            }
                            else if (currentMatchLength === bestMatchLength) {
                                if (option?.find?.router === 'last') {
                                    bestMatchModule = executeModule;
                                }
                            }
                        }
                    }
                    if (bestMatchModule) {
                        return bestMatchModule;
                    }
                }
                // second find my child routers
                const module = this.findRouterOrModule(router, routerConfig, routerStrings, intent);
                if (module) {
                    return [module, currentParentRouters];
                }
            }
        }
    }
    // path:    path,  parentRoots: router path,  url:   full intent url
    isRootUrl(path, parentRoots, url) {
        const searchString = parentRoots.join('') + (path || ''); //  
        if (searchString === '/') {
            return true;
        }
        const searchs = searchString.split('/');
        const urls = url.split('/');
        const trimmedUrls = urls.slice(0, searchs.length).join('/');
        // console.log('!!searchString', searchString, 'url', trimmedUrls);
        return !!_dooboostore_core_expression_Expression__WEBPACK_IMPORTED_MODULE_7__.Expression.Path.pathNameData(trimmedUrls, searchString);
        // return url.startsWith(searchString)
    }
    _collectAllMatchingModules(router, intent, parentRouters) {
        const matches = [];
        const path = intent.pathname;
        const routerConfig = router.getConfig(_decorators_route_Router__WEBPACK_IMPORTED_MODULE_3__.RouterMetadataKey);
        if (routerConfig) {
            const filters = [];
            if (Array.isArray(routerConfig.filters)) {
                filters.push(...routerConfig.filters);
            }
            else if (routerConfig.filters) {
                filters.push(routerConfig.filters);
            }
            const noAccept = filters.some(it => (typeof it === 'function' ? this.simstanceManager.getOrNewSim({ target: it }) : it)?.isAccept(intent) === false);
            if (noAccept) {
                return matches;
            }
            const routerStrings = parentRouters.map(it => it.getConfig(_decorators_route_Router__WEBPACK_IMPORTED_MODULE_3__.RouterMetadataKey)?.path || '');
            const isRoot = this.isRootUrl(routerConfig.path, routerStrings, path);
            if (isRoot) {
                const currentParentRouters = [...parentRouters, router];
                // Collect matches from child routers
                if (routerConfig.routers && routerConfig.routers.length > 0) {
                    for (const child of routerConfig.routers) {
                        const routerAtomic = new _simstance_SimAtomic__WEBPACK_IMPORTED_MODULE_4__.SimAtomic({ targetKeyType: child, originalType: child }, this.simstanceManager);
                        matches.push(...this._collectAllMatchingModules(routerAtomic, intent, currentParentRouters));
                    }
                }
                // Collect matches from current router's routes or the router itself
                const module = this.findRouterOrModule(router, routerConfig, routerStrings, intent);
                if (module) {
                    module.routerChains = currentParentRouters;
                    matches.push(module);
                }
            }
        }
        return matches;
    }
    findRouterOrModule(router, routerData, parentRoots, intent) {
        // 1. Try to find an exact route module match
        const module = this.findRouting(router, routerData, parentRoots, intent);
        if (module?.module) {
            module.intent = intent;
            return module;
        }
        // 2. If no exact module, check if the intent path matches the router's path
        const urlRoot = parentRoots.join('') + (routerData.path || '');
        if (this.isRootUrl(routerData.path, parentRoots, intent.pathname)) {
            const rm = new _RouterModule__WEBPACK_IMPORTED_MODULE_2__.RouterModule(this.simstanceManager, router);
            rm.intent = intent;
            rm.path = urlRoot;
            rm.pathData = intent.getPathnameData(urlRoot);
            return rm;
        }
        return undefined;
    }
    findRouting(router, routerData, parentRoots, intent) {
        // console.log('findRouting', routerData.route);
        const urlRoot = parentRoots.join('') + routerData.path;
        if (routerData.route) {
            for (const it of Object.keys(routerData.route).filter(it => !it.startsWith('_'))) {
                const path = urlRoot + it;
                const pathnameData = intent.getPathnameData(path);
                if (pathnameData) {
                    try {
                        const dataSet = this.findRouteProperty(routerData.route, it, intent);
                        const rm = new _RouterModule__WEBPACK_IMPORTED_MODULE_2__.RouterModule(this.simstanceManager, router, dataSet.child);
                        rm.data = dataSet.data;
                        rm.path = path;
                        rm.pathData = pathnameData;
                        rm.propertyKeys = dataSet.propertyKeys;
                        return rm;
                    }
                    catch (e) {
                    }
                }
            }
        }
    }
    findRouteProperty(route, propertyName, intent) {
        let child;
        let data;
        let propertyKeys;
        const routeElement = route[propertyName];
        if (typeof routeElement === 'function') {
            child = { targetKeyType: routeElement, originalType: routeElement };
        }
        else if (typeof routeElement === 'symbol') {
            child = this.simstanceManager.findLastSim(routeElement)?.type;
        }
        else if (typeof routeElement === 'string') {
            return this.findRouteProperty(route, routeElement, intent);
        }
        else if (Array.isArray(routeElement)) {
            const r = routeElement?.[0];
            if (typeof r === 'object' && 'filters' in r && 'target' in r) {
                const filters = [];
                if (Array.isArray(r.filters)) {
                    filters.push(...r.filters);
                }
                else if (r.filters) {
                    filters.push(r.filters);
                }
                const noAccept = filters.some(it => (typeof it === 'function' ? this.simstanceManager.getOrNewSim({ target: it }) : it)?.isAccept(intent) === false);
                if (!noAccept) {
                    child = { targetKeyType: r.target, originalType: r.target };
                }
            }
            else {
                child = { targetKeyType: r, originalType: r };
            }
            data = routeElement?.[1];
        }
        else if (typeof routeElement === 'object' && 'target' in routeElement && 'propertyKeys' in routeElement) { // RouteTargetMethod
            const noAccept = routeElement.filters?.filter(it => it).some(it => (typeof it === 'function' ? this.simstanceManager.getOrNewSim({ target: it }) : it)?.isAccept(intent) === false);
            if (!noAccept) {
                child = { targetKeyType: routeElement.target, originalType: routeElement.target };
                propertyKeys = routeElement.propertyKeys;
            }
        }
        else if (typeof routeElement === 'object' && 'filters' in routeElement && 'target' in routeElement) {
            const filters = [];
            if (Array.isArray(routeElement.filters)) {
                filters.push(...routeElement.filters);
            }
            else if (routeElement.filters) {
                filters.push(routeElement.filters);
            }
            const noAccept = filters.some(it => (typeof it === 'function' ? this.simstanceManager.getOrNewSim({ target: it }) : it)?.isAccept(intent) === false);
            if (!noAccept) {
                child = { targetKeyType: routeElement.target, originalType: routeElement.target };
            }
        }
        return {
            child,
            data,
            propertyKeys
        };
    }
};
RouterManager = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_6__.Sim,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _simstance_SimstanceManager__WEBPACK_IMPORTED_MODULE_5__.SimstanceManager !== "undefined" && _simstance_SimstanceManager__WEBPACK_IMPORTED_MODULE_5__.SimstanceManager) === "function" ? _a : Object, typeof (_b = typeof _SimOption__WEBPACK_IMPORTED_MODULE_9__.SimOption !== "undefined" && _SimOption__WEBPACK_IMPORTED_MODULE_9__.SimOption) === "function" ? _b : Object])
], RouterManager);



/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/route/RouterModule.ts":
/*!*************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/route/RouterModule.ts ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   RouterModule: () => (/* binding */ RouterModule)
/* harmony export */ });
/* harmony import */ var _simstance_SimAtomic__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../simstance/SimAtomic */ "../../packages/@dooboostore/simple-boot/src/simstance/SimAtomic.ts");
/* harmony import */ var _decorators_inject_Injection__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../decorators/inject/Injection */ "../../packages/@dooboostore/simple-boot/src/decorators/inject/Injection.ts");
/* harmony import */ var _throwable_MethodNoSuch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../throwable/MethodNoSuch */ "../../packages/@dooboostore/simple-boot/src/throwable/MethodNoSuch.ts");
/* harmony import */ var _decorators_route_Router__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../decorators/route/Router */ "../../packages/@dooboostore/simple-boot/src/decorators/route/Router.ts");
/* harmony import */ var _dooboostore_core_expression_Expression__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dooboostore/core/expression/Expression */ "../../packages/@dooboostore/core/src/expression/Expression.ts");





class RouterModule {
    simstanceManager;
    router;
    module;
    routerChains;
    _pathData;
    _data;
    _intent;
    _propertyKeys;
    _path;
    get path() {
        return this._path;
    }
    set path(value) {
        this._path = value;
    }
    get data() {
        return this._data;
    }
    set data(value) {
        this._data = value;
    }
    get intent() {
        return this._intent;
    }
    set intent(value) {
        this._intent = value;
    }
    get propertyKeys() {
        return this._propertyKeys;
    }
    set propertyKeys(value) {
        this._propertyKeys = value;
    }
    get pathData() {
        return this._pathData;
    }
    set pathData(value) {
        this._pathData = value;
    }
    constructor(simstanceManager, router, module, routerChains = []) {
        this.simstanceManager = simstanceManager;
        this.router = router;
        this.module = module;
        this.routerChains = routerChains;
    }
    getRouterPath(join = '') {
        return this.getRouterPaths().map(it => it ?? '').join(join);
    }
    getRouterPaths() {
        return this.routerChains.map(it => (0,_decorators_route_Router__WEBPACK_IMPORTED_MODULE_3__.getRouter)(it instanceof _simstance_SimAtomic__WEBPACK_IMPORTED_MODULE_0__.SimAtomic ? it.type.targetKeyType : it)?.path);
    }
    getRouterPathData(pathName) {
        return _dooboostore_core_expression_Expression__WEBPACK_IMPORTED_MODULE_4__.Expression.Path.pathNameData(pathName, this.getRouterPath());
    }
    getModuleInstance(propertyKey, instanceBind = true) {
        const instance = this.simstanceManager.getOrNewSim({ target: this.module?.targetKeyType, originTypeTarget: this.module?.originalType });
        if (propertyKey && this.propertyKeys && this.propertyKeys.includes(propertyKey)) {
            let instanceElement = instance[propertyKey];
            if (instanceBind && typeof instanceBind === 'boolean') {
                instanceElement = instanceElement.bind(instance);
            }
            else if (instanceBind && typeof instanceBind === 'object') {
                instanceElement = instanceElement.bind(instanceBind);
            }
            return instanceElement;
        }
        else {
            return instance;
        }
    }
    executeModuleProperty(propertyKey, ...param) {
        const target = this.getModuleInstance();
        if (propertyKey) {
            const config = (0,_decorators_inject_Injection__WEBPACK_IMPORTED_MODULE_1__.getInjection)(target, propertyKey);
            if (config) {
                const other = new Map();
                param.forEach(it => other.set(it.constructor, it));
                return this.simstanceManager.executeBindParameterSim({ target, targetKey: propertyKey }, other);
            }
            else {
                if (target[propertyKey]) {
                    return target[propertyKey]?.(...param);
                }
                else {
                    throw new _throwable_MethodNoSuch__WEBPACK_IMPORTED_MODULE_2__.MethodNoSuch(`${propertyKey.toString()} noSuch`, propertyKey.toString(), propertyKey);
                }
            }
        }
    }
    get firstRouteChain() {
        return this.routerChains[0];
    }
    get firstRouteChainValue() {
        return this.firstRouteChain?.getValue();
    }
    get lastRouteChain() {
        return this.routerChains[this.routerChains.length - 1];
    }
    get lastRouteChainValue() {
        return this.lastRouteChain?.getValue();
    }
    hasActivateInLastRoute(obj) {
        return this.lastRouteChainValue?.hasActivate(obj) === true;
    }
    getQueryParamDecodeURI(key) {
        if (this.intent) {
            return this.intent.getQueryParamDecodeURI(key);
        }
    }
    getQueryParamDecodeURIFirst(key) {
        if (this.intent) {
            return this.intent.getQueryParamDecodeURIFirst(key);
        }
    }
    getQueryParam(key) {
        if (this.intent) {
            return this.intent.getQueryParam(key);
        }
    }
    getQueryParamFirst(key) {
        if (this.intent) {
            return this.intent.getQueryParamFirst(key);
        }
    }
    get queryParams() {
        if (this.intent) {
            return this.intent.queryParams;
        }
    }
    get queryParamsAfterDecodeURI() {
        if (this.intent) {
            return this.intent.queryParamsDecodeURI;
        }
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/simstance/SimAtomic.ts":
/*!**************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/simstance/SimAtomic.ts ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SimAtomic: () => (/* binding */ SimAtomic)
/* harmony export */ });
/* harmony import */ var _decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/core/reflect/ReflectUtils */ "../../packages/@dooboostore/core/src/reflect/ReflectUtils.ts");


class SimAtomic {
    type;
    simstanceManager;
    config;
    value;
    constructor(type, simstanceManager, config) {
        this.type = type;
        this.simstanceManager = simstanceManager;
        this.config = config;
        this.value = type.value;
    }
    getConfig(key = _decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_0__.SimMetadataKey) {
        return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_1__.ReflectUtils.getMetadata(key, this.type.originalType);
    }
    getConfigs() {
        return _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_1__.ReflectUtils.getMetadatas(this.type.originalType);
    }
    getValue(config) {
        if (config?.refresh) {
            this.value = undefined;
        }
        // console.log('------value?', this.type, this.simstanceManager.storage)
        // return this.simstanceManager.getOrNewSim({target:this.type, newInstanceCarrier: config?.newInstanceCarrier});
        if (!this.value) {
            this.value = this.simstanceManager.getOrNewSim({ target: this.type.targetKeyType, originTypeTarget: this.type.originalType, newInstanceCarrier: config?.newInstanceCarrier });
            // const findFirstSim = this.simstanceManager.findFirstSim({type: this.type});
            // if (findFirstSim) {
            //   this.value = findFirstSim.getValue(config);
            // } else {
            //   this.value = this.simstanceManager.getOrNewSim({target: this.type, newInstanceCarrier: config?.newInstanceCarrier});
            // }
        }
        return this.value;
        // const types = ConvertUtils.flatArray(this.getConfig()?.type);
        // types.push(this.type);
        // for (const typeElement of types) {
        //   const instance = this.simstanceManager.getOrNewSim(typeElement, this.type);
        //   if (instance) {
        //     return instance;
        //   }
        // }
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/simstance/SimstanceManager.ts":
/*!*********************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/simstance/SimstanceManager.ts ***!
  \*********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SimstanceManager: () => (/* binding */ SimstanceManager)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_types__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/types */ "../../packages/@dooboostore/core/src/types.ts");
/* harmony import */ var _throwable_SimNoSuch__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../throwable/SimNoSuch */ "../../packages/@dooboostore/simple-boot/src/throwable/SimNoSuch.ts");
/* harmony import */ var _decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/core/object/ObjectUtils */ "../../packages/@dooboostore/core/src/object/ObjectUtils.ts");
/* harmony import */ var _SimAtomic__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./SimAtomic */ "../../packages/@dooboostore/simple-boot/src/simstance/SimAtomic.ts");
/* harmony import */ var _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @dooboostore/core/reflect/ReflectUtils */ "../../packages/@dooboostore/core/src/reflect/ReflectUtils.ts");
/* harmony import */ var _decorators_inject_Inject__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../decorators/inject/Inject */ "../../packages/@dooboostore/simple-boot/src/decorators/inject/Inject.ts");
/* harmony import */ var _SimOption__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../SimOption */ "../../packages/@dooboostore/simple-boot/src/SimOption.ts");
/* harmony import */ var _proxy_SimProxyHandler__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../proxy/SimProxyHandler */ "../../packages/@dooboostore/simple-boot/src/proxy/SimProxyHandler.ts");
/* harmony import */ var _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @dooboostore/core/convert/ConvertUtils */ "../../packages/@dooboostore/core/src/convert/ConvertUtils.ts");
/* harmony import */ var _lifecycle_OnSimCreate__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../lifecycle/OnSimCreate */ "../../packages/@dooboostore/simple-boot/src/lifecycle/OnSimCreate.ts");
/* harmony import */ var _lifecycle_OnSimCreateCompleted__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../lifecycle/OnSimCreateCompleted */ "../../packages/@dooboostore/simple-boot/src/lifecycle/OnSimCreateCompleted.ts");
/* harmony import */ var _SimpleApplication__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../SimpleApplication */ "../../packages/@dooboostore/simple-boot/src/SimpleApplication.ts");
/* harmony import */ var _decorators_SimNoProxy__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../decorators/SimNoProxy */ "../../packages/@dooboostore/simple-boot/src/decorators/SimNoProxy.ts");
/* harmony import */ var _dooboostore_core_random_RandomUtils__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @dooboostore/core/random/RandomUtils */ "../../packages/@dooboostore/core/src/random/RandomUtils.ts");















class SimstanceManager {
    simpleApplication;
    option;
    _storage = new Map();
    simProxyHandler;
    name = 'simstanceManager-' + _dooboostore_core_random_RandomUtils__WEBPACK_IMPORTED_MODULE_14__.RandomUtils.uuid4();
    // private otherInstanceSim?: Map<ConstructorType<any> | Function, any>;
    constructor(simpleApplication, option) {
        this.simpleApplication = simpleApplication;
        this.option = option;
        this.setStoreSet(_SimpleApplication__WEBPACK_IMPORTED_MODULE_12__.SimpleApplication, this.simpleApplication);
        this.setStoreSet(SimstanceManager, this);
        this.setStoreSet(option.constructor, option);
        this.setStoreSet(_SimOption__WEBPACK_IMPORTED_MODULE_7__.SimOption, option);
        this.simProxyHandler = new _proxy_SimProxyHandler__WEBPACK_IMPORTED_MODULE_8__.SimProxyHandler(this.simpleApplication, this, option);
    }
    get storage() {
        return this._storage;
    }
    getSimAtomics() {
        const r = [];
        Array.from(this.storage.entries()).forEach(([targetKeyType, targetMap]) => {
            // Array.from(targetMap).forEach(it => {
            r.push(...Array.from(Array.from(targetMap.keys())).map(sit => new _SimAtomic__WEBPACK_IMPORTED_MODULE_4__.SimAtomic({ targetKeyType, originalType: sit }, this)));
            // });
        });
        return r;
    }
    getSimConfig(schemeOrSymbol) {
        const newVar = this.getSimAtomics().filter(it => {
            const config = it?.getConfig();
            const symbols = _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_9__.ConvertUtils.flatArray(config?.symbol);
            const schemes = _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_9__.ConvertUtils.flatArray(config?.scheme);
            if (typeof schemeOrSymbol === 'symbol') {
                return schemeOrSymbol && it && symbols.includes(schemeOrSymbol);
            }
            else if (typeof schemeOrSymbol === 'string') {
                return schemeOrSymbol && it && schemes.includes(schemeOrSymbol);
            }
            else {
                return false;
            }
        }) || [];
        return newVar;
    }
    findSims(data) {
        let r = [];
        if (data) {
            const simAtomics = this.getSimAtomics();
            r = simAtomics.filter(it => {
                let b = false;
                const config = it.getConfig();
                // console.log('-=--', config)
                const symbols = _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_9__.ConvertUtils.flatArray(config?.symbol).filter(_dooboostore_core_types__WEBPACK_IMPORTED_MODULE_0__.isDefined);
                const schemes = _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_9__.ConvertUtils.flatArray(config?.scheme).filter(_dooboostore_core_types__WEBPACK_IMPORTED_MODULE_0__.isDefined);
                if (typeof data === 'symbol') {
                    b = symbols.includes(data);
                }
                else {
                    const { scheme, type } = data;
                    b = (scheme ? schemes.includes(scheme) : true) && (type ? it.type.targetKeyType === type : true);
                    // if (type) {
                    //   const configTypes = ConvertUtils.flatArray(config?.type).filter(isDefined);
                    //   const match = configTypes.includes(type)
                    //   if (match) {
                    //     b = true;
                    //   }
                    // }
                }
                return b;
            });
        }
        return r;
    }
    findFirstSim(data) {
        if (typeof data === 'symbol') {
            return this.findSims(data)[0];
        }
        else {
            return this.findSims(data)[0];
        }
    }
    findLastSim(data) {
        if (typeof data === 'symbol') {
            return this.findSims(data).reverse()[0];
        }
        else {
            return this.findSims(data).reverse()[0];
        }
    }
    flatStoreSets() {
        return new Map(Array.from(this.storage.values())
            .map(it => Array.from(it.entries()))
            .flat());
    }
    getStoreSets(targetKey) {
        const map = this.storage.get(targetKey);
        const datas = (Array.from(map?.entries?.() ?? []) ?? []).reverse();
        return datas.map(it => ({ type: it[0], instance: it[1] }));
    }
    getStoreSet(targetKey, target) {
        const find = this.getStoreSets(targetKey).find(it => it.type === target);
        // console.log('getStoreSet', targetKey, target, find)
        if (!find?.instance) {
            const type = target ?? targetKey;
            //      instance.
            if (typeof type === 'object') {
                const find = this.storage.get(type);
                if (find) {
                    return { type: type, instance: type };
                }
            }
            const flatStoreSets = this.flatStoreSets();
            const data = flatStoreSets.get(type);
            // console.log('--->target?', target, targetKey, type, data);
            if (data) {
                this.setStoreSet(targetKey, data, type);
            }
            return { type: type, instance: data };
        }
        else {
            return find;
        }
        // return find ?? this.getStoreSets(targetKey)[0];
    }
    getStoreInstance(targetKey, target) {
        return this.getStoreSet(targetKey, target)?.instance;
    }
    getOrNewSim({ target, originTypeTarget = target, newInstanceCarrier }) {
        if (target) {
            const registed = this.getStoreSet(target, originTypeTarget);
            if (registed?.type && !registed?.instance) {
                return this.resolve({ targetKey: target, target: originTypeTarget, newInstanceCarrier: newInstanceCarrier });
            }
            return registed?.instance;
        }
    }
    setStoreSet(targetKey, obj, target = targetKey) {
        const itemMap = this.storage.get(targetKey) ?? new Map();
        itemMap.set(target, obj);
        this.storage.set(targetKey, itemMap);
    }
    registerStore(targetKey, regTyps) {
        const itemMap = this.storage.get(targetKey) ?? new Map();
        regTyps.forEach(it => {
            const { type, value } = (typeof it === 'object' ? { type: it.constructor, value: it } : { type: it, value: undefined });
            if (!itemMap.has(type)) {
                itemMap.set(type, value);
            }
        });
        this.storage.set(targetKey, itemMap);
    }
    // 
    resolve({ target, targetKey, newInstanceCarrier = { newInstances: [], depth: 0 } }) {
        // console.group('resolve')
        const registed = this.getStoreSet(targetKey, target);
        if (registed?.instance) {
            return registed.instance;
        }
        // console.log('resolve--', targetKey, target, registed?.instance);
        if (this.storage.has(targetKey) && undefined === registed?.instance) {
            newInstanceCarrier.depth++;
            const newSim = this.newSim({
                target: registed?.type ?? targetKey,
                newInstanceCarrier: newInstanceCarrier,
                simCreateAfter: data => {
                    // console.log('resolve--newSim', targetKey, target, data);
                    if ((0,_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_2__.getSim)(registed?.type ?? target ?? targetKey)?.scope === _decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_2__.Lifecycle.Singleton) {
                        this.setStoreSet(targetKey, data, target);
                        // console.log('-----------set', targetKey, data, target, this.storage.get(targetKey))
                    }
                }
            });
            newInstanceCarrier.depth--;
            //  
            if (newInstanceCarrier.depth === 0) {
                newInstanceCarrier.newInstances.forEach(it => {
                    this.callBindPostConstruct(it);
                });
            }
            // console.log('%c *************************','color: blue', registed?.type ?? targetKey ,newInstanceCarrier, newInstanceCarrier?.newInstances.length)
            // console.dir(newInstanceCarrier, {depth:10});
            // console.table(newInstanceCarrier);
            if ((0,_lifecycle_OnSimCreate__WEBPACK_IMPORTED_MODULE_10__.isOnSimCreate)(newSim)) {
                newSim.onSimCreate();
            }
            // console.groupEnd();
            return newSim;
        }
        console.log('simstanceManager', this._storage, this.name);
        const simNoSuch = new _throwable_SimNoSuch__WEBPACK_IMPORTED_MODULE_1__.SimNoSuch('SimNoSuch: no simple instance(resolve) ' + 'name:' + targetKey?.prototype?.constructor?.name + ',' + targetKey);
        console.error(simNoSuch);
        // console.groupEnd();
        throw simNoSuch;
    }
    newSim({ target, simCreateAfter, otherStorage, newInstanceCarrier }) {
        // @ts-ignore TODO:  
        const r = new target(...this.getParameterSim({ target: target, otherStorage: otherStorage, newInstanceCarrier: newInstanceCarrier }));
        let p = this.proxy(r);
        const config = (0,_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_2__.getSim)(target);
        if (config?.proxy) {
            const proxys = (Array.isArray(config.proxy) ? config.proxy : [config.proxy]).filter(_dooboostore_core_types__WEBPACK_IMPORTED_MODULE_0__.isDefined);
            proxys.forEach(it => {
                // console.log('proxy-----------------', p)
                if (typeof it === 'object') {
                    p = new Proxy(p, it);
                }
                else {
                    const simConfig = (0,_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_2__.getSim)(it);
                    p = new Proxy(p, simConfig ? this.getOrNewSim({ target: it }) : this.newSim({ target: it }));
                }
                // console.log('proxy-pp----------------', p)
            });
        }
        newInstanceCarrier?.newInstances.push(p);
        //    
        simCreateAfter?.(p);
        if ((0,_lifecycle_OnSimCreateCompleted__WEBPACK_IMPORTED_MODULE_11__.isOnSimCreateProxyCompleted)(p)) {
            p.onSimCreateProxyCompleted(p);
        }
        // this.callBindPostConstruct(p);
        return p;
    }
    callBindPostConstruct(obj) {
        // const set = new Set(ObjectUtils.getAllProtoTypeName(obj));
        // console.log('callBindPostConstruct', obj, set, ObjectUtils.getAllProtoTypeName(obj));
        // set.forEach(it => {
        //   const postConstruct = getPostConstruct(obj, it);
        //   if (postConstruct) {
        //     (obj as any)[it](...this.getParameterSim({target: obj, targetKey: it}))
        //   }
        // })
        const postConstruct = (0,_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_2__.getPostConstructs)(obj);
        postConstruct.forEach(it => {
            obj[it.property](...this.getParameterSim({ target: obj, targetKey: it.property }));
        });
    }
    async executeBindParameterSimPromise({ target, targetKey, firstCheckMaker }, otherStorage) {
        let value = this.executeBindParameterSim({ target, targetKey, firstCheckMaker }, otherStorage);
        if (value instanceof Promise) {
            value = await value;
        }
        return value;
    }
    executeBindParameterSim({ target, targetKey, firstCheckMaker }, otherStorage) {
        const binds = this.getParameterSim({ target, targetKey, firstCheckMaker, otherStorage });
        if (typeof target === 'object' && targetKey) {
            const targetMethod = target[targetKey];
            return targetMethod?.bind(target)?.(...binds);
        }
        else if (typeof target === 'function' && !targetKey) {
            return new target(...binds);
        }
    }
    getParameterSim({ target, targetKey, firstCheckMaker, otherStorage, newInstanceCarrier }) {
        const paramTypes = _dooboostore_core_reflect_ReflectUtils__WEBPACK_IMPORTED_MODULE_5__.ReflectUtils.getParameterTypes(target, targetKey);
        // const paramNames = FunctionUtils.getParameterNames(target, targetKey);
        // const a = ReflectUtils.getType(target, 'user');
        let injections = [];
        const injects = (0,_decorators_inject_Inject__WEBPACK_IMPORTED_MODULE_6__.getInject)(target, targetKey);
        // const da = JSON.stringify(this.storage);
        // this.storage map to json String
        injections = paramTypes.map((token, idx) => {
            const saveInject = injects?.find(it => it.index === idx);
            if (saveInject?.config.disabled) {
                return undefined;
            }
            for (const f of firstCheckMaker ?? []) {
                const firstCheckObj = f({ target, targetKey }, token, idx, saveInject);
                if (undefined !== firstCheckObj) {
                    return firstCheckObj;
                }
            }
            if (saveInject) {
                const inject = saveInject.config;
                let obj = otherStorage?.get(token);
                // console.log('vvvvv----->', obj, token, inject);
                if (token === Array && (inject.type || inject.scheme || inject.symbol)) {
                    const p = [];
                    if (inject.type) {
                        p.push(...this.getStoreSets(inject.type)
                            .map(it => this.resolve({ targetKey: inject.type, target: it.type, newInstanceCarrier: newInstanceCarrier }))
                            .reverse());
                    }
                    if (inject.symbol) {
                        p.push(...this.getSimConfig(inject.symbol).map(it => it.getValue({ newInstanceCarrier: newInstanceCarrier })));
                    }
                    if (inject.scheme) {
                        p.push(...this.getSimConfig(inject.scheme).map(it => it.getValue({ newInstanceCarrier: newInstanceCarrier })));
                    }
                    return p;
                }
                // situational
                if (inject.situationType && otherStorage) {
                    // TODO:  other ?
                    const situations = otherStorage.get(_decorators_inject_Inject__WEBPACK_IMPORTED_MODULE_6__.SituationTypeContainers);
                    const situation = otherStorage.get(_decorators_inject_Inject__WEBPACK_IMPORTED_MODULE_6__.SituationTypeContainer);
                    if (inject.situationType === situation?.situationType) {
                        obj = situation.data;
                    }
                    else if (situations && situations.length > 0) {
                        const find = situations.find(a => {
                            if (a.index !== undefined) {
                                return a.situationType === inject.situationType && a.index === idx;
                            }
                            else {
                                return a.situationType === inject.situationType;
                            }
                        });
                        if (find) {
                            obj = find.data;
                        }
                    }
                }
                if (!obj) {
                    const findLastSim = inject.symbol
                        ? this.findLastSim(inject.symbol)
                        : this.findLastSim({ scheme: inject.scheme, type: inject.type });
                    try {
                        obj = findLastSim
                            ? this.resolve({
                                targetKey: findLastSim?.type.targetKeyType ?? token,
                                newInstanceCarrier: newInstanceCarrier
                            })
                            : this.resolve({ targetKey: token, newInstanceCarrier: newInstanceCarrier });
                    }
                    catch (e) {
                        // Inject optional 
                        if (inject.optional) {
                            return undefined;
                        }
                        else {
                            throw e;
                        }
                    }
                }
                if (inject.applyProxy && obj) {
                    if (inject.applyProxy.param) {
                        obj = new Proxy(obj, new inject.applyProxy.type(...inject.applyProxy.param));
                    }
                    else {
                        obj = new Proxy(obj, new inject.applyProxy.type());
                    }
                }
                return obj;
            }
            else if (token) {
                // TODO:  other ?  ->      
                // console.log('oooooooooooooooo', token, otherStorage)
                return otherStorage?.get(token) ?? this.resolve({ targetKey: token, newInstanceCarrier });
            }
            return undefined;
        });
        return injections;
    }
    proxy(target) {
        try {
            const noProxy = (0,_decorators_SimNoProxy__WEBPACK_IMPORTED_MODULE_13__.isSimNoProxy)(target);
            if (!noProxy &&
                target !== null &&
                (0,_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_2__.getSim)(target) &&
                typeof target === 'object' &&
                !('_SimpleBoot_isProxy' in target)) {
                for (const key in target) {
                    if (!(0,_decorators_SimNoProxy__WEBPACK_IMPORTED_MODULE_13__.isSimNoProxy)(target, key)) {
                        target[key] = this.proxy(target[key]);
                    }
                }
                // function apply proxy
                const protoTypeName = _dooboostore_core_object_ObjectUtils__WEBPACK_IMPORTED_MODULE_3__.ObjectUtils.ownPropertyNames(target);
                protoTypeName
                    .filter(it => typeof target[it] === 'function')
                    .filter(it => !(0,_decorators_SimNoProxy__WEBPACK_IMPORTED_MODULE_13__.isSimNoProxy)(target, it))
                    .filter(it => !('_SimpleBoot_isProxy' in target[it]))
                    .forEach(it => {
                    target[it] = new Proxy(target[it], this.simProxyHandler);
                });
                if (this.simProxyHandler) {
                    target = new Proxy(target, this.simProxyHandler);
                }
            }
            if (this.option.proxy) {
                target = this.option.proxy.onAfterProxy(target);
            }
            return target;
        }
        catch (e) {
            console.log('sim proxy error');
            throw e;
        }
    }
    run(otherInstanceSim = new Map()) {
        // this.otherInstanceSim = new Map();
        for (const [k, v] of Array.from(otherInstanceSim.entries())) {
            if (typeof k === 'symbol') {
                (0,_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_2__.simProcess)({ symbol: k }, v);
            }
            else if (typeof k === 'object') {
                //  instance       .
                (0,_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_2__.simProcess)(k, v);
            }
            else {
                (0,_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_2__.simProcess)({ type: k }, v);
            }
            // this.otherInstanceSim.set(type, v);
            // it => ({type: it[0], value: it[1], action: this.setStoreSet.bind(this)})
        }
        // this.otherInstanceSim = otherInstanceSim;
        // const types = Array.from(this.otherInstanceSim?.entries()).map(it => ({type: it[0], value: it[1], action: this.setStoreSet.bind(this)}));
        // types.push(...Array.from(sims.entries()).map(it => ({type: it[0], value: it[1], action: this.registerStore.bind(this)})));
        const myContainers = _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_9__.ConvertUtils.flatArray(this.option.container).filter(_dooboostore_core_types__WEBPACK_IMPORTED_MODULE_0__.isDefined);
        // console.log('simstanceManager run!!', Array.from(sims.entries()));
        // Array.from(sims.entries()).map(it => ({type: it[0], value: it[1], action: this.registerStore.bind(this)}))
        Array.from(_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_2__.sims.entries()).forEach(([type, value]) => {
            const targetContainers = _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_9__.ConvertUtils.flatArray((0,_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_2__.getSim)(type)?.container).filter(_dooboostore_core_types__WEBPACK_IMPORTED_MODULE_0__.isDefined);
            let isInclude = false;
            if (myContainers.length <= 0 && targetContainers.length <= 0) {
                isInclude = true;
            }
            else if (targetContainers.length <= 0) {
                isInclude = true;
            }
            else {
                isInclude = myContainers.some(it => targetContainers.includes(it));
            }
            this.registerStore(type, value);
            // const isInclude = (myContainers.length <= 0 || targetContainers.length <= 0) ? true : myContainers.some(it => targetContainers.includes(it));
            // const isInclude = (targetContainers.length <= 0) ? true : (myContainers.length > 0 ? true : (myContainers.some(it => targetContainers.includes(it))));
            // const isInclude = (myContainers.length <= 0 || targetContainers.length <= 0) ? true : (myContainers.some(it => containers.includes(it)));
            // if (typeof this.option.excludeSim === 'function' && this.option.excludeSim(type)) {
            //   if (isInclude) {
            //     it.action(type, it.value);
            //   }
            // } else if (Array.isArray(this.option.excludeSim) && !this.option.excludeSim.includes(type)) {
            //   if (isInclude) {
            //     it.action(type, it.value);
            //   }
            // }
        });
        this.callBindPostConstruct(this);
        // auto start run
        this.getSimAtomics().forEach(it => {
            if (it.getConfig()?.autoCreate) {
                // console.log('autoStart---?', it.type);
                it.getValue();
            }
        });
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/throwable/MethodNoSuch.ts":
/*!*****************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/throwable/MethodNoSuch.ts ***!
  \*****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   MethodNoSuch: () => (/* binding */ MethodNoSuch)
/* harmony export */ });
/* harmony import */ var _SimError__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./SimError */ "../../packages/@dooboostore/simple-boot/src/throwable/SimError.ts");

class MethodNoSuch extends _SimError__WEBPACK_IMPORTED_MODULE_0__.SimError {
    propertyKeys;
    constructor(message, name, propertyKeys, stack) {
        super(message, name, stack);
        this.propertyKeys = propertyKeys;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/throwable/SimError.ts":
/*!*************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/throwable/SimError.ts ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SimError: () => (/* binding */ SimError)
/* harmony export */ });
class SimError {
    message;
    name;
    stack;
    constructor(message, name, stack) {
        this.message = message;
        this.name = name;
        this.stack = stack;
    }
}


/***/ }),

/***/ "../../packages/@dooboostore/simple-boot/src/throwable/SimNoSuch.ts":
/*!**************************************************************************!*\
  !*** ../../packages/@dooboostore/simple-boot/src/throwable/SimNoSuch.ts ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   SimNoSuch: () => (/* binding */ SimNoSuch)
/* harmony export */ });
/* harmony import */ var _SimError__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./SimError */ "../../packages/@dooboostore/simple-boot/src/throwable/SimError.ts");

class SimNoSuch extends _SimError__WEBPACK_IMPORTED_MODULE_0__.SimError {
    constructor(message, name, stack) {
        super(message, name, stack);
    }
}


/***/ }),

/***/ "./back-end/environments/environment.ts":
/*!**********************************************!*\
  !*** ./back-end/environments/environment.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   environment: () => (/* binding */ environment)
/* harmony export */ });
/* harmony import */ var _dooboostore_core_logger_Logger__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/core/logger/Logger */ "../../packages/@dooboostore/core/src/logger/Logger.ts");

const environment = {
    name: 'default-template',
    environment: 'local',
    host: 'https://dooboostore.github.io',
    production: false,
    frontDistPath: 'dist-front-end',
    frontDistIndexFileName: 'index.html',
    loggerConfig: {
        level: _dooboostore_core_logger_Logger__WEBPACK_IMPORTED_MODULE_0__.LoggerLevel.DEBUG,
        format: '[${date:\'yyyy-MM-dd HH:mm:ss\'}] ${file}(${line}):${message}'
    },
    httpServerConfig: {
        listen: {
            port: 8081
        }
    }
};


/***/ }),

/***/ "./front-end/service/FrontEndCodeFetchService.ts":
/*!*******************************************************!*\
  !*** ./front-end/service/FrontEndCodeFetchService.ts ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FrontEndCodeFetchService: () => (/* binding */ FrontEndCodeFetchService)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _src_service_CodeFetchService__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @src/service/CodeFetchService */ "./src/service/CodeFetchService.ts");
/* harmony import */ var _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/simple-boot/fetch/ApiService */ "../../packages/@dooboostore/simple-boot/src/fetch/ApiService.ts");
/* harmony import */ var _dooboostore_simple_boot_http_server_ssr_proxy_SymbolIntentApiServiceProxy__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dooboostore/simple-boot-http-server-ssr/proxy/SymbolIntentApiServiceProxy */ "../../packages/@dooboostore/simple-boot-http-server-ssr/src/proxy/SymbolIntentApiServiceProxy.ts");
/* harmony import */ var _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @dooboostore/core/convert/ConvertUtils */ "../../packages/@dooboostore/core/src/convert/ConvertUtils.ts");
/* harmony import */ var _src_environments_environment__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @src/environments/environment */ "./src/environments/environment.ts");
var _a;







let FrontEndCodeFetchService = class FrontEndCodeFetchService {
    apiService;
    constructor(apiService) {
        this.apiService = apiService;
    }
    async fetch(request, data) {
        const rawData = await this.apiService.get({
            target: `${_src_environments_environment__WEBPACK_IMPORTED_MODULE_6__.environment.packageGithubIoUrl}/${request.path}`,
            config: { transformText: true },
        });
        return { rawData: _dooboostore_core_convert_ConvertUtils__WEBPACK_IMPORTED_MODULE_5__.ConvertUtils.escapeHTML(rawData, { targets: ['$', '<', '>', '&'] }) };
    }
};
FrontEndCodeFetchService = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    (0,_dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_2__.Sim)({
        symbol: _src_service_CodeFetchService__WEBPACK_IMPORTED_MODULE_1__.CodeFetchService.SYMBOL,
        proxy: _dooboostore_simple_boot_http_server_ssr_proxy_SymbolIntentApiServiceProxy__WEBPACK_IMPORTED_MODULE_4__.SymbolIntentApiServiceProxy,
    }),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_3__.ApiService !== "undefined" && _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_3__.ApiService) === "function" ? _a : Object])
], FrontEndCodeFetchService);



/***/ }),

/***/ "./front-end/service/index.ts":
/*!************************************!*\
  !*** ./front-end/service/index.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   services: () => (/* binding */ services)
/* harmony export */ });
/* harmony import */ var _front_end_service_FrontEndCodeFetchService__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @front-end/service/FrontEndCodeFetchService */ "./front-end/service/FrontEndCodeFetchService.ts");

const services = [_front_end_service_FrontEndCodeFetchService__WEBPACK_IMPORTED_MODULE_0__.FrontEndCodeFetchService];


/***/ }),

/***/ "./src/bootfactory.ts":
/*!****************************!*\
  !*** ./src/bootfactory.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   MakeSimFrontOption: () => (/* binding */ MakeSimFrontOption),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _dooboostore_simple_boot_front_option_SimFrontOption__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @dooboostore/simple-boot-front/option/SimFrontOption */ "../../packages/@dooboostore/simple-boot-front/src/option/SimFrontOption.ts");
/* harmony import */ var _dooboostore_simple_boot_http_server_ssr_SimpleBootHttpSSRFactory__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/simple-boot-http-server-ssr/SimpleBootHttpSSRFactory */ "../../packages/@dooboostore/simple-boot-http-server-ssr/src/SimpleBootHttpSSRFactory.ts");
/* harmony import */ var _dooboostore_core_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/core/types */ "../../packages/@dooboostore/core/src/types.ts");
/* harmony import */ var _dooboostore_simple_boot_front_SimpleBootFront__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/simple-boot-front/SimpleBootFront */ "../../packages/@dooboostore/simple-boot-front/src/SimpleBootFront.ts");
/* harmony import */ var _src_pages_index_router_component__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @src/pages/index.router.component */ "./src/pages/index.router.component.ts");
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! rxjs */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/Observable.js");
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! rxjs */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/Subject.js");
/* harmony import */ var rxjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! rxjs */ "../../node_modules/.pnpm/rxjs@7.8.2/node_modules/rxjs/dist/esm5/internal/Subscription.js");
/* harmony import */ var _dooboostore_simple_boot_alert_AlertService__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @dooboostore/simple-boot/alert/AlertService */ "../../packages/@dooboostore/simple-boot/src/alert/AlertService.ts");
/* harmony import */ var _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @dooboostore/simple-boot/fetch/ApiService */ "../../packages/@dooboostore/simple-boot/src/fetch/ApiService.ts");








const MakeSimFrontOption = (window) => {
    return new _dooboostore_simple_boot_front_option_SimFrontOption__WEBPACK_IMPORTED_MODULE_0__.SimFrontOption({ window, urlType: _dooboostore_simple_boot_front_option_SimFrontOption__WEBPACK_IMPORTED_MODULE_0__.UrlType.path }, { rootRouter: _src_pages_index_router_component__WEBPACK_IMPORTED_MODULE_4__.IndexRouterComponent });
};
class Factory extends _dooboostore_simple_boot_http_server_ssr_SimpleBootHttpSSRFactory__WEBPACK_IMPORTED_MODULE_1__.SimpleBootHttpSSRFactory {
    async factory(simFrontOption, using, domExcludes) {
        // console.log('create simplefront--->', (simFrontOption.window as any).uuid, simFrontOption.window.location.href);
        // const simFrontOption = new SimFrontOption(window).setUrlType(UrlType.path);
        simFrontOption.using ??= [];
        if (Array.isArray(simFrontOption.using)) {
            simFrontOption.using.push(...using);
        }
        else {
            simFrontOption.using = [simFrontOption.using, using].filter(_dooboostore_core_types__WEBPACK_IMPORTED_MODULE_2__.isDefined);
        }
        const simpleBootFront = new _dooboostore_simple_boot_front_SimpleBootFront__WEBPACK_IMPORTED_MODULE_3__.SimpleBootFront(simFrontOption);
        // const simpleBootFront = new SimpleBootFront(TestRouterComponent, simFrontOption);
        // @ts-ignore
        simpleBootFront.domRendoerExcludeProxy.push(rxjs__WEBPACK_IMPORTED_MODULE_6__.Subject, rxjs__WEBPACK_IMPORTED_MODULE_5__.Observable, rxjs__WEBPACK_IMPORTED_MODULE_7__.Subscription, _dooboostore_simple_boot_alert_AlertService__WEBPACK_IMPORTED_MODULE_8__.AlertService, _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_9__.ApiService, ...domExcludes);
        return simpleBootFront;
    }
}
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (new Factory());


/***/ }),

/***/ "./src/component/breadcrumb/breadcrumb.component.css":
/*!***********************************************************!*\
  !*** ./src/component/breadcrumb/breadcrumb.component.css ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (".breadcrumb {\n  font-size: 0.875rem;\n  color: #a0a0a0;\n  display: flex;\n  align-items: center;\n  flex-wrap: wrap;\n  gap: 0;\n}\n\n.breadcrumb-item {\n  color: #a0a0a0;\n  text-decoration: none;\n  transition: color 0.2s ease;\n  cursor: pointer;\n}\n\n.breadcrumb-item:hover {\n  color: #ffffff;\n}\n\n.breadcrumb-current {\n  color: #e5e5e5;\n  font-weight: 500;\n}\n\n.breadcrumb-separator {\n  margin: 0 0.5rem;\n  color: #606060;\n  user-select: none;\n}\n\n/* Dropdown styles */\n.breadcrumb-dropdown {\n  position: relative;\n  display: inline-flex;\n  align-items: center;\n  gap: 0.25rem;\n}\n\n.breadcrumb-select {\n  position: relative;\n  display: inline-block;\n}\n\n.breadcrumb-select-summary {\n  cursor: pointer;\n}\n\n.breadcrumb-select-body {\n  position: absolute;\n  top: 100%;\n  left: 0;\n  z-index: 1000;\n  min-width: 150px;\n  background: #1a1a1a;\n  border: 1px solid #2a2a2a;\n  border-radius: 6px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n  padding: 0.5rem 0;\n  margin-top: 0.25rem;\n}\n\n.breadcrumb-select-option {\n  cursor: pointer;\n}\n\n.breadcrumb-option-content {\n  padding: 0.5rem 1rem;\n  color: #e5e5e5;\n  transition: all 0.2s ease;\n  font-size: 0.875rem;\n}\n\n.breadcrumb-option-content:hover {\n  background-color: #2a2a2a;\n  color: #ffffff;\n}\n\n.breadcrumb-option-content.selected {\n  background-color: #ffffff;\n  color: #0a0a0a;\n}\n\n.breadcrumb-option-content.selected:hover {\n  background-color: #f0f0f0;\n}\n\n/* Responsive */\n@media (max-width: 768px) {\n  .breadcrumb {\n    font-size: 0.8rem;\n  }\n  \n  .breadcrumb-separator {\n    margin: 0 0.25rem;\n  }\n}");

/***/ }),

/***/ "./src/component/breadcrumb/breadcrumb.component.html":
/*!************************************************************!*\
  !*** ./src/component/breadcrumb/breadcrumb.component.html ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("<div class=\"breadcrumb\">\n  <span dr-for-of=\"@this@.items\">\n    <!-- Single item case -->\n    <span dr-if=\"@this@.isItem(#it#)\">\n      <a\n        dr-if=\"@this@.getSingleItem(#it#).link && #index# < @this@.items.length - 1\"\n        href=\"${@this@.getSingleItem(#it#).link}$\" \n        class=\"breadcrumb-item\"\n        dr-event-click=\"@this@.handleItemClick(@this@.getSingleItem(#it#), $event)\"\n      >\n        ${@this@.getSingleItem(#it#).text}$\n      </a>\n      <span \n        dr-if=\"!@this@.getSingleItem(#it#).link || #index# === @this@.items.length - 1\"\n        class=\"breadcrumb-current\"\n        dr-event-click=\"@this@.handleItemClick(@this@.getSingleItem(#it#), $event)\"\n      >\n        ${@this@.getSingleItem(#it#).text}$\n      </span>\n    </span>\n\n    <!-- Dropdown case -->\n    <span dr-if=\"@this@.isDropdownInComponent(#it#)\">\n      <dr-select class=\"breadcrumb-select\" changeSelected=\"${(data) => @this@?.handleSelectChange?.(data, #it#)}$\">\n        <dr-select-summary class=\"breadcrumb-select-summary\">\n          <dr-select-summary-placeholder>\n            <span class=\"${#index# === @this@.items.length - 1 ? 'breadcrumb-current breadcrumb-dropdown' : 'breadcrumb-item breadcrumb-dropdown'}$\">\n              ${@this@.getSingleItem(#it#)?.text??''}$ \n            </span>\n          </dr-select-summary-placeholder>\n          <dr-select-summary-selected>\n            <span class=\"${#index# === @this@.items.length - 1 ? 'breadcrumb-current breadcrumb-dropdown' : 'breadcrumb-item breadcrumb-dropdown'}$\">\n                ${#it#.selected.text}$ \n            </span>\n          </dr-select-summary-selected>\n        </dr-select-summary>\n\n        <dr-select-body float=\"bottom-left\" class=\"breadcrumb-select-body\">\n          <dr-select-option\n            dr-for-of=\"@this@.getArrayItems(#it#)\"\n            value=\"${#nearForOfIt#.uuid}$\"\n            class=\"breadcrumb-select-option\"\n          >\n              <div class=\"breadcrumb-option-content\">\n                ${#it#.text}$\n              </div>\n          </dr-select-option>\n        </dr-select-body>\n      </dr-select>\n    </span>\n\n    <!-- Separator -->\n    <span dr-if=\"#index# < @this@.items.length - 1\" class=\"breadcrumb-separator\">/</span>\n  </span>\n</div>");

/***/ }),

/***/ "./src/component/breadcrumb/breadcrumb.component.ts":
/*!**********************************************************!*\
  !*** ./src/component/breadcrumb/breadcrumb.component.ts ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   BreadcrumbComponent: () => (/* binding */ BreadcrumbComponent),
/* harmony export */   isBreadcrumbDropdown: () => (/* binding */ isBreadcrumbDropdown),
/* harmony export */   isBreadcrumbItem: () => (/* binding */ isBreadcrumbItem)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/dom-render/components/ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/simple-boot-front/decorators/Component */ "../../packages/@dooboostore/simple-boot-front/src/decorators/Component.ts");
/* harmony import */ var _breadcrumb_component_html__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./breadcrumb.component.html */ "./src/component/breadcrumb/breadcrumb.component.html");
/* harmony import */ var _breadcrumb_component_css__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./breadcrumb.component.css */ "./src/component/breadcrumb/breadcrumb.component.css");
/* harmony import */ var _dooboostore_core_random_RandomUtils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @dooboostore/core/random/RandomUtils */ "../../packages/@dooboostore/core/src/random/RandomUtils.ts");






const isBreadcrumbItem = (item) => {
    return typeof item === 'object' && 'text' in item;
};
const isBreadcrumbDropdown = (item) => {
    return typeof item === 'object' && 'items' in item;
};
let BreadcrumbComponent = class BreadcrumbComponent extends _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.ComponentBase {
    items = [];
    onNavigate;
    constructor() {
        super();
    }
    async onInitRender(param, rawSet) {
        await super.onInitRender(param, rawSet);
        // console.log('--------->', this.items);
    }
    setValue(value) {
        if (!value)
            return;
        // console.log('---------v', value);
        this.items = value.map(it => {
            if (this.isBreadcrumbDropdown(it)) {
                const items = it.items.map(sit => ({ ...sit, uuid: _dooboostore_core_random_RandomUtils__WEBPACK_IMPORTED_MODULE_5__.RandomUtils.uuid() }));
                const dropdown = {
                    selectedIndex: it.selectedIndex,
                    items,
                    selected: it.selectedIndex !== undefined ? items[it.selectedIndex] : undefined
                };
                return dropdown;
            }
            else {
                return { ...it, uuid: _dooboostore_core_random_RandomUtils__WEBPACK_IMPORTED_MODULE_5__.RandomUtils.uuid() };
            }
        });
    }
    setProps(props) {
        this.setValue(props.items);
        this.onNavigate = props.onNavigate;
    }
    handleItemClick(item, event) {
        event.preventDefault();
        if (this.onNavigate && item) {
            this.onNavigate(item);
        }
    }
    handleSelectChange(selectedValues, item) {
        // console.log('----handleSelectChange-------', selectedValues, item);
        const selectedLink = selectedValues[0];
        const findItem = this.findItemByUUID(selectedLink);
        if (selectedLink && this.onNavigate && findItem) {
            item.selected = findItem;
            this.onNavigate(findItem);
        }
        else {
            item.selected = undefined;
        }
    }
    flatItems() {
        const z = this.items?.map(it => {
            if (this.isDropdownInComponent(it)) {
                return it.items ?? [];
            }
            else {
                return [it];
            }
        }) ?? [];
        return z.flat();
    }
    findItemByUUID(uuid) {
        if (uuid) {
            const items = this.flatItems();
            return items.find((it) => it.uuid === uuid);
        }
    }
    isItem(item) {
        return !this.isDropdownInComponent(item);
    }
    isBreadcrumbDropdown(item) {
        return typeof item === 'object' && 'items' in item;
    }
    isDropdownInComponent(item) {
        return typeof item === 'object' && 'items' in item;
    }
    getSingleItem(item) {
        if (this.isDropdownInComponent(item)) {
            return item.selected || item.items[0];
        }
        else {
            return item;
        }
    }
    getArrayItems(item) {
        if (this.isDropdownInComponent(item)) {
            return item.items ?? [];
        }
        else {
            return [item];
        }
    }
};
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)("onNavigate"),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Function)
], BreadcrumbComponent.prototype, "onNavigate", void 0);
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)("value"),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Function),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [Array]),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:returntype", void 0)
], BreadcrumbComponent.prototype, "setValue", null);
BreadcrumbComponent = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    (0,_dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_2__.Component)({ selector: "breadcrumb", template: _breadcrumb_component_html__WEBPACK_IMPORTED_MODULE_3__["default"], styles: _breadcrumb_component_css__WEBPACK_IMPORTED_MODULE_4__["default"] }),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [])
], BreadcrumbComponent);



/***/ }),

/***/ "./src/component/breadcrumb/index.ts":
/*!*******************************************!*\
  !*** ./src/component/breadcrumb/index.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   BreadcrumbComponent: () => (/* reexport safe */ _breadcrumb_component__WEBPACK_IMPORTED_MODULE_0__.BreadcrumbComponent),
/* harmony export */   isBreadcrumbDropdown: () => (/* reexport safe */ _breadcrumb_component__WEBPACK_IMPORTED_MODULE_0__.isBreadcrumbDropdown),
/* harmony export */   isBreadcrumbItem: () => (/* reexport safe */ _breadcrumb_component__WEBPACK_IMPORTED_MODULE_0__.isBreadcrumbItem)
/* harmony export */ });
/* harmony import */ var _breadcrumb_component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./breadcrumb.component */ "./src/component/breadcrumb/breadcrumb.component.ts");



/***/ }),

/***/ "./src/component/code/code-snippet/code-snippet-code.component.css":
/*!*************************************************************************!*\
  !*** ./src/component/code/code-snippet/code-snippet-code.component.css ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("/* Code Snippet -  code-example   */\n:host {\n    display: block;\n}\n\n.code-snippet-pre {\n    padding: 1rem;\n    margin: 0;\n    overflow-x: auto;\n    background: #1a1a1a;\n    position: relative;\n}\n\ncode {\n    color: #e5e5e5;\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    font-size: 0.875rem;\n    line-height: 1.6;\n}\n\n.language-indicator:hover {\n    opacity: 1;\n}\n\n@media (max-width: 768px) {\n    .code-snippet-pre {\n        padding: 1rem;\n        overflow-x: auto;\n        font-size: 0.8rem;\n    }\n    \n\n}");

/***/ }),

/***/ "./src/component/code/code-snippet/code-snippet-code.component.html":
/*!**************************************************************************!*\
  !*** ./src/component/code/code-snippet/code-snippet-code.component.html ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("<pre  class=\"code-snippet-pre\"><code class=\"language-${@this@.type}$\"><p dr-pre>#innerHTML#</p></code></pre>");

/***/ }),

/***/ "./src/component/code/code-snippet/code-snippet-container.component.css":
/*!******************************************************************************!*\
  !*** ./src/component/code/code-snippet/code-snippet-container.component.css ***!
  \******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("@keyframes flash {\n  from {\n    background-color: #777;\n  }\n  to {\n    background-color: #0d5126;\n  }\n}\n\n/* Code Snippet Container -  code-example   */\n.code-snippet-container {\n    background: #1a1a1a;\n    border: 1px solid #2a2a2a;\n    border-radius: 8px;\n    overflow: hidden;\n    /*margin-bottom: 1.5rem;*/\n}\n\n.code-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    background: #2a2a2a;\n    padding: 0;\n    border-bottom: 1px solid #3a3a3a;\n}\n\n.code-copy-btn {\n    background: #575757;\n    color: #d8d8d8;\n    border: none;\n    padding: 2px 8px;\n    border-radius: 4px;\n    cursor: pointer;\n    transition: background-color 0.3s ease, transform 0.1s ease;\n    margin: 0.3rem;\n    flex-shrink: 0;\n}\n\n.code-copy-btn:active {\n    transform: scale(0.95);\n}\n\n.code-copy-btn.copied {\n    background-color: #0d5126;\n    animation: flash 0.4s ease-out;\n}\n\n/*   -    */\n.code-tabs {\n    display: flex;\n    background: transparent;\n    overflow-x: auto;\n    flex: 1;\n}\n\n.tab-btn {\n    background: #2a2a2a;\n    color: #9ca3af;\n    border: none;\n    padding: 0.5rem 0.8rem;\n    cursor: pointer;\n    border-right: 1px solid #222;\n    font-size: 0.875rem;\n    font-family: inherit;\n    transition: all 0.2s ease;\n    border-bottom: 3px solid transparent;\n    white-space: nowrap;\n    min-width: fit-content;\n}\n\n.tab-btn:hover {\n    background: #3a3a3a;\n    color: #e5e5e5;\n}\n\n.tab-btn.active {\n    background: #1a1a1a;\n    color: #e5e5e5;\n    border-bottom-color: #0366d6;\n    font-weight: 500;\n}\n\n.code-content {\n    position: relative;\n    background: #1a1a1a;\n}\n\n@media (max-width: 768px) {\n    .code-tabs {\n        overflow-x: auto;\n        scrollbar-width: thin;\n    }\n    \n    .tab-btn {\n        padding: 0.5rem 0.75rem;\n        font-size: 0.8rem;\n    }\n}");

/***/ }),

/***/ "./src/component/code/code-snippet/code-snippet-container.component.html":
/*!*******************************************************************************!*\
  !*** ./src/component/code/code-snippet/code-snippet-container.component.html ***!
  \*******************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("<div class=\"code-snippet-container\">\n    <div class=\"code-header\">\n        <div class=\"code-tabs\" dr-query=\"tabs\">\n            <button dr-for-of=\"@this@.childSnippetComponents\"\n                    class=\"tab-btn\"\n                    data-uuid=\"${#nearForOfIt#.uuid}$\"\n                    dr-event-click=\"@this@.activateSnippet(#nearForOfIt#.uuid)\"\n            >\n                ${#it#.name}$\n            </button>\n        </div>\n\n        <button class=\"code-copy-btn\" dr-event-click=\"@this@.copyCode($element)\"><i class=\"fa-solid fa-floppy-disk\"></i></button>\n    </div>\n    <div class=\"code-content\" dr-query=\"content\">\n        #innerHTML#\n    </div>\n</div>");

/***/ }),

/***/ "./src/component/code/code-snippet/code-snippet-result.component.css":
/*!***************************************************************************!*\
  !*** ./src/component/code/code-snippet/code-snippet-result.component.css ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("/* Code Snippet -  code-example   */\n:host {\n    display: block;\n}\n\n.code-snippet-pre {\n    padding: 0.5rem;\n    border-radius: 0;\n    border-top: 1px solid #444;\n    border-left: 0.2rem solid #999911;\n    background-color: #111;\n    margin: 0;\n    overflow-x: auto;\n    /*background: #1a1a1a;*/\n    position: relative;\n    font-size: 0.5rem;\n}\n\ncode {\n    color: #e5e5e5;\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    font-size: 0.875rem;\n    line-height: 1.6;\n}\n\n.language-indicator:hover {\n    opacity: 1;\n}\n\n@media (max-width: 768px) {\n    .code-snippet-pre {\n        /*padding: 1rem;*/\n        /*overflow-x: auto;*/\n        /*font-size: 0.5rem;*/\n    }\n    \n\n}");

/***/ }),

/***/ "./src/component/code/code-snippet/code-snippet-result.component.html":
/*!****************************************************************************!*\
  !*** ./src/component/code/code-snippet/code-snippet-result.component.html ***!
  \****************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("<pre style=\"display: none\" class=\"code-snippet-pre\"><code class=\"language-${@this@.type}$\">#innerHTML#</code></pre>");

/***/ }),

/***/ "./src/component/code/code-snippet/code-snippet.component.css":
/*!********************************************************************!*\
  !*** ./src/component/code/code-snippet/code-snippet.component.css ***!
  \********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("/* Code Snippet -  code-example   */\n\n\n/*   floating  */\n.language-type-indicator {\n    position: absolute;\n    top: 0.1rem;\n    left: 0.1rem;\n    background: rgba(0, 0, 0, 0.7);\n    color: #9ca3af;\n    padding: 0rem 0.2rem;\n    border-radius: 4px;\n    font-size: 0.5rem;\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    font-weight: 500;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    backdrop-filter: blur(4px);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    opacity: 0.8;\n    transition: opacity 0.2s ease;\n    z-index: 10;\n    pointer-events: none;\n}\n\n.language-type-indicator:hover {\n    opacity: 1;\n}\n.language-result-indicator {\n    position: absolute;\n    bottom: 0rem;\n    right: 0.1rem;\n    background: rgba(0, 0, 0, 0.7);\n    color: #9ca3af;\n    padding: 0rem 0.2rem;\n    border-radius: 4px;\n    font-size: 0.5rem;\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    font-weight: 500;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    backdrop-filter: blur(4px);\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    opacity: 0.8;\n    transition: opacity 0.2s ease;\n    z-index: 10;\n}\n\n.language-result-indicator:hover {\n    opacity: 1;\n}\n\n@media (max-width: 768px) {\n}");

/***/ }),

/***/ "./src/component/code/code-snippet/code-snippet.component.html":
/*!*********************************************************************!*\
  !*** ./src/component/code/code-snippet/code-snippet.component.html ***!
  \*********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("<div style=\"display: none;\" class=\"code-snippet\">#innerHTML#</div>\n<button dr-if=\"@this@.hasResult\" style=\"display: none\" class=\"language-result-indicator\" dr-event-click=\"@this@.toggleResultVisible()\">result</button>\n<div style=\"display: none\" class=\"language-type-indicator\">${@this@.type}$</div>");

/***/ }),

/***/ "./src/component/code/code-snippet/code-snippet.component.ts":
/*!*******************************************************************!*\
  !*** ./src/component/code/code-snippet/code-snippet.component.ts ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   CodeSnippet: () => (/* binding */ CodeSnippet)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/dom-render/components/ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/simple-boot-front/decorators/Component */ "../../packages/@dooboostore/simple-boot-front/src/decorators/Component.ts");
/* harmony import */ var _dooboostore_core_web_clipboard_ClipBoardUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/core-web/clipboard/ClipBoardUtils */ "../../packages/@dooboostore/core-web/src/clipboard/ClipBoardUtils.ts");
/* harmony import */ var _code_snippet_container_component_html__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./code-snippet-container.component.html */ "./src/component/code/code-snippet/code-snippet-container.component.html");
/* harmony import */ var _code_snippet_container_component_css__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./code-snippet-container.component.css */ "./src/component/code/code-snippet/code-snippet-container.component.css");
/* harmony import */ var _code_snippet_component_html__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./code-snippet.component.html */ "./src/component/code/code-snippet/code-snippet.component.html");
/* harmony import */ var _code_snippet_component_css__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./code-snippet.component.css */ "./src/component/code/code-snippet/code-snippet.component.css");
/* harmony import */ var _code_snippet_code_component_html__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./code-snippet-code.component.html */ "./src/component/code/code-snippet/code-snippet-code.component.html");
/* harmony import */ var _code_snippet_code_component_css__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./code-snippet-code.component.css */ "./src/component/code/code-snippet/code-snippet-code.component.css");
/* harmony import */ var _code_snippet_result_component_html__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./code-snippet-result.component.html */ "./src/component/code/code-snippet/code-snippet-result.component.html");
/* harmony import */ var _code_snippet_result_component_css__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./code-snippet-result.component.css */ "./src/component/code/code-snippet/code-snippet-result.component.css");
/* harmony import */ var _dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @dooboostore/core/valid/ValidUtils */ "../../packages/@dooboostore/core/src/valid/ValidUtils.ts");













var CodeSnippet;
(function (CodeSnippet) {
    var _a, _b, _c, _d, _e, _f, _g, _h;
    let CodeSnippetContainerComponent = class CodeSnippetContainerComponent extends _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.ComponentBase {
        tabsElement;
        activeSnippetUuid;
        childSnippetComponents;
        tabButtonsElements;
        async onInitRender(param, rawSet) {
            await super.onInitRender(param, rawSet);
        }
        findTabButtonsElements(elements, data) {
            this.tabButtonsElements = data.all;
            const active = this.childSnippetComponents?.find((it) => it.active) ?? this.childSnippetComponents?.[0];
            // console.log('--------->', active, this.tabButtonsElements);
            if (active) {
                this.tabButtonsElements.forEach((it) => {
                    if (it.dataset.uuid === active.uuid) {
                        it.classList.add("active");
                        this.activateSnippet(active.uuid);
                    }
                    else {
                        it.classList.remove("active");
                    }
                });
            }
        }
        onCreatedThisChildDebounce(childrenSet) {
            super.onCreatedThisChildDebounce(childrenSet);
            this.childSnippetComponents = this.getChildren(CodeSnippetComponent);
        }
        activateSnippet(uuid) {
            this.activeSnippetUuid = uuid;
            this.tabButtonsElements?.forEach((it) => {
                if (it.dataset.uuid === uuid) {
                    it.classList.add("active");
                }
                else {
                    it.classList.remove("active");
                }
            });
            const snippets = this.getChildren(CodeSnippetComponent);
            //   
            snippets.forEach((snippet) => {
                snippet.hide();
            });
            //   
            const activeSnippet = snippets.find((s) => s.uuid === uuid);
            if (activeSnippet) {
                activeSnippet.show();
            }
            //   
            // this.buildTabs();
        }
        getActiveCodeSnipet() {
            const snippets = this.getChildren(CodeSnippetComponent);
            const activeSnippet = snippets.find((s) => s.uuid === this.activeSnippetUuid);
            return activeSnippet;
        }
        copyCode(e) {
            this.getActiveCodeSnipet()?.copyCode();
            e.classList.add("copied");
            setTimeout(() => {
                e.classList.remove("copied");
            }, 1500);
        }
    };
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.query)(".tabs"),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", typeof (_a = typeof HTMLElement !== "undefined" && HTMLElement) === "function" ? _a : Object)
    ], CodeSnippetContainerComponent.prototype, "tabsElement", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.query)({ selector: ".tab-btn", refreshRawSetRendered: true }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Function),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [Array, Object]),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:returntype", void 0)
    ], CodeSnippetContainerComponent.prototype, "findTabButtonsElements", null);
    CodeSnippetContainerComponent = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_2__.Component)({
            selector: "code-snippet-container",
            template: _code_snippet_container_component_html__WEBPACK_IMPORTED_MODULE_4__["default"],
            styles: _code_snippet_container_component_css__WEBPACK_IMPORTED_MODULE_5__["default"],
        })
    ], CodeSnippetContainerComponent);
    CodeSnippet.CodeSnippetContainerComponent = CodeSnippetContainerComponent;
    let CodeSnippetComponent = class CodeSnippetComponent extends _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.ComponentBase {
        name = "";
        active = false;
        //
        // @attribute("type")
        // type?: "bash" | "javascript" | "typescript" = "javascript";
        //
        codeSnippetElement;
        languageResultIndicatElement;
        languageTypeIndicatoElement;
        type = "text";
        hasResult = false;
        constructor() {
            super({ onlyParentType: CodeSnippetContainerComponent });
        }
        async onInitRender(param, rawSet) {
            await super.onInitRender(param, rawSet);
            // Prism  
            // const prism = (this.domRenderConfig?.window as any)?.Prism;
            // if (prism && this.codeElement) {
            //   prism.highlightElement(this.codeElement);
            // }
        }
        onCreatedThisChildDebounce(childrenSet) {
            super.onCreatedThisChildDebounce(childrenSet);
            // console.log("snippet", this.children);
            let firstChild = this.getFirstChild(CodeSnippetCodeComponent);
            this.type = firstChild?.type;
            this.hasResult = !!this.getFirstChild(CodeSnippetResultComponent);
            // console.log('--', this.type);
        }
        copyCode() {
            this.getFirstChild(CodeSnippetCodeComponent)?.copyCode();
        }
        show() {
            if (this.codeSnippetElement) {
                this.codeSnippetElement.style.display = "block";
                if (this.languageResultIndicatElement)
                    this.languageResultIndicatElement.style.display = "block";
                if (this.languageTypeIndicatoElement)
                    this.languageTypeIndicatoElement.style.display = "block";
                this.active = true;
            }
        }
        hide() {
            if (this.codeSnippetElement) {
                this.codeSnippetElement.style.display = "none";
                if (this.languageResultIndicatElement)
                    this.languageResultIndicatElement.style.display = "none";
                if (this.languageTypeIndicatoElement)
                    this.languageTypeIndicatoElement.style.display = "none";
                this.active = false;
            }
        }
        toggleResultVisible() {
            // console.log('toogle',this.hasResult);
            if (this.hasResult) {
                this.getFirstChild(CodeSnippetResultComponent)?.toggleVisible();
            }
        }
    };
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)("name"),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", String)
    ], CodeSnippetComponent.prototype, "name", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({
            name: "active",
            converter: (d) => _dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_12__.ValidUtils.isNotNullUndefined(d),
        }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Boolean)
    ], CodeSnippetComponent.prototype, "active", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.query)(".code-snippet"),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", typeof (_b = typeof HTMLElement !== "undefined" && HTMLElement) === "function" ? _b : Object)
    ], CodeSnippetComponent.prototype, "codeSnippetElement", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.query)(".language-result-indicator"),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", typeof (_c = typeof HTMLElement !== "undefined" && HTMLElement) === "function" ? _c : Object)
    ], CodeSnippetComponent.prototype, "languageResultIndicatElement", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.query)(".language-type-indicator"),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", typeof (_d = typeof HTMLElement !== "undefined" && HTMLElement) === "function" ? _d : Object)
    ], CodeSnippetComponent.prototype, "languageTypeIndicatoElement", void 0);
    CodeSnippetComponent = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_2__.Component)({
            selector: "code-snippet",
            template: _code_snippet_component_html__WEBPACK_IMPORTED_MODULE_6__["default"],
            styles: _code_snippet_component_css__WEBPACK_IMPORTED_MODULE_7__["default"],
        }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [])
    ], CodeSnippetComponent);
    CodeSnippet.CodeSnippetComponent = CodeSnippetComponent;
    let CodeSnippetCodeComponent = class CodeSnippetCodeComponent extends _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.ComponentBase {
        type = "text";
        codeSnippetPreElement;
        codeElement;
        constructor() {
            super({ onlyParentType: CodeSnippetComponent });
        }
        async onInitRender(param, rawSet) {
            const prism = this.domRenderConfig?.window?.Prism;
            // console.log("snippetCode1",this.type, prism, this.codeElement, this.codeElement?.innerHTML);
            await super.onInitRender(param, rawSet);
            // console.log("snippetCode2",this.type, prism, this.codeElement, this.codeElement?.innerHTML);
            setTimeout(() => {
                // Prism  
                //   console.log('this.codeElement', this.codeSnippetPreElement,this.codeSnippetPreElement?.innerHTML);
                if (prism && this.codeElement) {
                    // this.codeElement.innerHTML = this.codeElement.innerHTML.replaceAll('&lt;','<').replaceAll('&gt;','>').replaceAll('&amp;','&');
                    // this.codeElement.innerHTML = this.codeElement.innerHTML.replaceAll('&gt;','>');
                    prism.highlightElement(this.codeElement, prism.languages.haml, 'haml');
                }
            }, 1);
        }
        copyCode() {
            if (this.rawSet?.dataSet.render?.innerHTML &&
                this.domRenderConfig?.window) {
                _dooboostore_core_web_clipboard_ClipBoardUtils__WEBPACK_IMPORTED_MODULE_3__.ClipBoardUtils.writeText(this.rawSet.dataSet.render.innerHTML, this.domRenderConfig.window);
            }
        }
    };
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)("type"),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", String)
    ], CodeSnippetCodeComponent.prototype, "type", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.query)(".code-snippet-pre"),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", typeof (_e = typeof HTMLElement !== "undefined" && HTMLElement) === "function" ? _e : Object)
    ], CodeSnippetCodeComponent.prototype, "codeSnippetPreElement", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.query)("code"),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", typeof (_f = typeof HTMLElement !== "undefined" && HTMLElement) === "function" ? _f : Object)
    ], CodeSnippetCodeComponent.prototype, "codeElement", void 0);
    CodeSnippetCodeComponent = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_2__.Component)({
            selector: "code-snippet-code",
            template: _code_snippet_code_component_html__WEBPACK_IMPORTED_MODULE_8__["default"],
            styles: _code_snippet_code_component_css__WEBPACK_IMPORTED_MODULE_9__["default"],
        }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [])
    ], CodeSnippetCodeComponent);
    CodeSnippet.CodeSnippetCodeComponent = CodeSnippetCodeComponent;
    let CodeSnippetResultComponent = class CodeSnippetResultComponent extends _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.ComponentBase {
        name = "";
        open = false;
        type = "text";
        codeSnippetPreElement;
        codeElement;
        constructor() {
            super({ onlyParentType: CodeSnippetComponent });
        }
        async onInitRender(param, rawSet) {
            const prism = this.domRenderConfig?.window?.Prism;
            // console.log("snippetCode1",this.type, prism, this.codeElement, this.codeElement?.innerHTML);
            await super.onInitRender(param, rawSet);
            // console.log("snippetCode2",this.type, prism, this.codeElement, this.codeElement?.innerHTML);
            if (this.open) {
                this.show();
            }
            else {
                this.hide();
            }
            setTimeout(() => {
                // Prism  
                if (prism && this.codeElement) {
                    prism.highlightElement(this.codeElement);
                }
            }, 10);
        }
        toggleVisible() {
            // console.log('--?', this.open, this.codeSnippetPreElement);
            if (this.open) {
                this.hide();
            }
            else {
                this.show();
            }
        }
        show() {
            if (this.codeSnippetPreElement) {
                this.codeSnippetPreElement.style.display = "block";
                this.open = true;
            }
        }
        hide() {
            if (this.codeSnippetPreElement) {
                this.codeSnippetPreElement.style.display = "none";
                this.open = false;
            }
        }
    };
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)("name"),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", String)
    ], CodeSnippetResultComponent.prototype, "name", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)({
            name: "open",
            converter: (d) => _dooboostore_core_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_12__.ValidUtils.isNotNullUndefined(d),
        }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Boolean)
    ], CodeSnippetResultComponent.prototype, "open", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)("type"),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", String)
    ], CodeSnippetResultComponent.prototype, "type", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.query)(".code-snippet-pre"),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", typeof (_g = typeof HTMLElement !== "undefined" && HTMLElement) === "function" ? _g : Object)
    ], CodeSnippetResultComponent.prototype, "codeSnippetPreElement", void 0);
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.query)("code"),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", typeof (_h = typeof HTMLElement !== "undefined" && HTMLElement) === "function" ? _h : Object)
    ], CodeSnippetResultComponent.prototype, "codeElement", void 0);
    CodeSnippetResultComponent = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
        (0,_dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_2__.Component)({
            selector: "code-snippet-result",
            template: _code_snippet_result_component_html__WEBPACK_IMPORTED_MODULE_10__["default"],
            styles: _code_snippet_result_component_css__WEBPACK_IMPORTED_MODULE_11__["default"],
        }),
        (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [])
    ], CodeSnippetResultComponent);
    CodeSnippet.CodeSnippetResultComponent = CodeSnippetResultComponent;
})(CodeSnippet || (CodeSnippet = {}));


/***/ }),

/***/ "./src/component/code/code-snippet/index.ts":
/*!**************************************************!*\
  !*** ./src/component/code/code-snippet/index.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   CodeSnippet: () => (/* reexport safe */ _code_snippet_component__WEBPACK_IMPORTED_MODULE_0__.CodeSnippet)
/* harmony export */ });
/* harmony import */ var _code_snippet_component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./code-snippet.component */ "./src/component/code/code-snippet/code-snippet.component.ts");



/***/ }),

/***/ "./src/component/code/index.ts":
/*!*************************************!*\
  !*** ./src/component/code/index.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   CodeSnippet: () => (/* reexport safe */ _code_snippet__WEBPACK_IMPORTED_MODULE_1__.CodeSnippet),
/* harmony export */   MermaidDiagramComponent: () => (/* reexport safe */ _mermaid_diagram__WEBPACK_IMPORTED_MODULE_0__.MermaidDiagramComponent)
/* harmony export */ });
/* harmony import */ var _mermaid_diagram__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./mermaid-diagram */ "./src/component/code/mermaid-diagram/index.ts");
/* harmony import */ var _code_snippet__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./code-snippet */ "./src/component/code/code-snippet/index.ts");




/***/ }),

/***/ "./src/component/code/mermaid-diagram/index.ts":
/*!*****************************************************!*\
  !*** ./src/component/code/mermaid-diagram/index.ts ***!
  \*****************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   MermaidDiagramComponent: () => (/* reexport safe */ _mermaid_diagram_component__WEBPACK_IMPORTED_MODULE_0__.MermaidDiagramComponent)
/* harmony export */ });
/* harmony import */ var _mermaid_diagram_component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./mermaid-diagram.component */ "./src/component/code/mermaid-diagram/mermaid-diagram.component.ts");



/***/ }),

/***/ "./src/component/code/mermaid-diagram/mermaid-diagram.component.css":
/*!**************************************************************************!*\
  !*** ./src/component/code/mermaid-diagram/mermaid-diagram.component.css ***!
  \**************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("@keyframes flash {\n  from {\n    background-color: #777;\n  }\n  to {\n    background-color: #22c55e;\n  }\n}\n\n/* Code Examples */\n\n/* Code Examples */\n.code-example {\n    background: #1a1a1a;\n    /*width: 500px;*/\n    /*height: 500px;*/\n    border: 1px solid #2a2a2a;\n    border-radius: 8px;\n    overflow: hidden;\n    margin-bottom: 1.5rem;\n}\n.code-example {\n    overflow-x: auto;\n}\n\n.code-example svg {\n    width: 100%;\n    height: auto;\n    max-width: none;\n}\n\n.code-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    background: #2a2a2a;\n    padding: 0.2rem 0.2rem 0.2rem 1rem;\n    border-bottom: 1px solid #3a3a3a;\n}\n\n.code-title {\n    font-size: 0.875rem;\n    font-weight: 500;\n    color: #e5e5e5;\n}\n\n.code-example pre {\n    padding: 1.5rem;\n    margin: 0;\n    overflow-x: auto;\n    background: transparent;\n}\n\n.code-example code {\n    color: #e5e5e5;\n    font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\n    font-size: 0.875rem;\n    line-height: 1.6;\n}\n\n\n.code-copy-btn {\n    background: #555;\n    color: white;\n    border: none;\n    padding: 2px 8px;\n    border-radius: 4px;\n    cursor: pointer;\n    transition: background-color 0.3s ease, transform 0.1s ease;\n}\n\n.code-copy-btn:active {\n    transform: scale(0.95);\n}\n\n.code-copy-btn.copied {\n    background-color: #22c55e;\n    animation: flash 0.4s ease-out;\n}\n\n\n\n.actor {\n    stroke: #ccccff;\n    fill: #ececff;\n}\ntext.actor {\n    fill: black;\n    stroke: none;\n    font-family: Helvetica;\n}\n\n.actor-line {\n    stroke: #c3c3c3;\n}\n\n.messageLine0 {\n    stroke-width: 1.5;\n    stroke-dasharray: '2 2';\n    marker-end: 'url(#arrowhead)';\n    stroke: #d1d1d1;\n}\n\n.messageLine1 {\n    stroke-width: 1.5;\n    stroke-dasharray: '2 2';\n    stroke: #e4e4e4;\n}\n\n#arrowhead {\n    fill: #b3b3b3;\n}\n\n.messageText {\n    fill: #d3d3d3;\n    stroke: none;\n    font-family: 'trebuchet ms', verdana, arial;\n    font-size: 14px;\n}\n\n.labelBox {\n    stroke: #ccccff;\n    fill: #ececff;\n}\n\n.labelText {\n    fill: #d7d7d7;\n    stroke: none;\n    font-family: 'trebuchet ms', verdana, arial;\n}\n\n.loopText {\n    fill: #c5c5c5;\n    stroke: none;\n    font-family: 'trebuchet ms', verdana, arial;\n}\n\n.loopLine {\n    stroke-width: 2;\n    stroke-dasharray: '2 2';\n    marker-end: 'url(#arrowhead)';\n    stroke: #ccccff;\n}\n\n.note {\n    stroke: #decc93;\n    fill: #fff5ad;\n}\n\n.noteText {\n    fill: #c8c8c8;\n    stroke: none;\n    font-family: 'trebuchet ms', verdana, arial;\n    font-size: 14px;\n}\n\n/*.mermaid .customEdge path {*/\n/*    stroke: #ff0000; !*   *!*/\n/*    fill: #ff0000; !*    *!*/\n/*}*/\n/*.mermaid .customEdge marker path {*/\n/*    fill: #ff0000; !*     *!*/\n/*}*/\n/*.link, .link path,*/\n/*.edgePath path {*/\n/*    stroke: #b10606 !important;  !*    *!*/\n/*    stroke-width: 2px !important;*/\n/*}*/\n@media (max-width: 768px) {\n    .code-example pre {\n        padding: 1rem;\n        overflow-x: auto;\n        font-size: 0.8rem;\n    }\n}");

/***/ }),

/***/ "./src/component/code/mermaid-diagram/mermaid-diagram.component.html":
/*!***************************************************************************!*\
  !*** ./src/component/code/mermaid-diagram/mermaid-diagram.component.html ***!
  \***************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("<div class=\"code-example\">\n    <div class=\"code-header\">\n        <span class=\"code-title\">${@this@.title}$</span>\n        <button class=\"code-copy-btn\" dr-event-click=\"@this@.copyCode($element)\">Copy</button>\n    </div>\n    <pre class=\"${@this@.codeClass}$\">#innerHTML#</pre>\n</div>");

/***/ }),

/***/ "./src/component/code/mermaid-diagram/mermaid-diagram.component.ts":
/*!*************************************************************************!*\
  !*** ./src/component/code/mermaid-diagram/mermaid-diagram.component.ts ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   MermaidDiagramComponent: () => (/* binding */ MermaidDiagramComponent)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/dom-render/components/ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/simple-boot-front/decorators/Component */ "../../packages/@dooboostore/simple-boot-front/src/decorators/Component.ts");
/* harmony import */ var _dooboostore_core_web_clipboard_ClipBoardUtils__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/core-web/clipboard/ClipBoardUtils */ "../../packages/@dooboostore/core-web/src/clipboard/ClipBoardUtils.ts");
/* harmony import */ var _mermaid_diagram_component_html__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./mermaid-diagram.component.html */ "./src/component/code/mermaid-diagram/mermaid-diagram.component.html");
/* harmony import */ var _mermaid_diagram_component_css__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./mermaid-diagram.component.css */ "./src/component/code/mermaid-diagram/mermaid-diagram.component.css");
var _a;






let MermaidDiagramComponent = class MermaidDiagramComponent extends _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.ComponentBase {
    title = "";
    codeElement;
    codeClass = "";
    async onInitRender(param, rawSet) {
        await super.onInitRender(param, rawSet);
        // console.log('--aa------', this.codesElement);
        //   <code>  Prism  
        const mermaid = this.domRenderConfig?.window?.Mermaid;
        // console.log(
        //   "-------",
        //   mermaid,
        //   this.codeElement?.hasAttribute("data-mermaid-processed"),
        // );
        if (mermaid &&
            this.codeElement &&
            !this.codeElement.hasAttribute("data-mermaid-processed")) {
            mermaid.init(undefined, this.codeElement);
            this.codeElement.setAttribute("data-mermaid-processed", "true");
            // mermaid.highlightElement(this.codeElement);
        }
    }
    copyCode(e) {
        if (this.rawSet?.dataSet.render?.innerHTML &&
            this.domRenderConfig?.window) {
            _dooboostore_core_web_clipboard_ClipBoardUtils__WEBPACK_IMPORTED_MODULE_3__.ClipBoardUtils.writeText(this.rawSet.dataSet.render.innerHTML, this.domRenderConfig.window);
            e.classList.add("copied");
            setTimeout(() => {
                e.classList.remove("copied");
            }, 1500);
        }
        // console.log('-----', this.rawSet?.point.innerHTML);
    }
};
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)("title"),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", String)
], MermaidDiagramComponent.prototype, "title", void 0);
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.query)("pre"),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", typeof (_a = typeof HTMLElement !== "undefined" && HTMLElement) === "function" ? _a : Object)
], MermaidDiagramComponent.prototype, "codeElement", void 0);
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)("codeClass"),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", String)
], MermaidDiagramComponent.prototype, "codeClass", void 0);
MermaidDiagramComponent = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    (0,_dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_2__.Component)({
        selector: "mermaid-diagram",
        template: _mermaid_diagram_component_html__WEBPACK_IMPORTED_MODULE_4__["default"],
        styles: _mermaid_diagram_component_css__WEBPACK_IMPORTED_MODULE_5__["default"],
    })
], MermaidDiagramComponent);



/***/ }),

/***/ "./src/component/hello/hello.component.html":
/*!**************************************************!*\
  !*** ./src/component/hello/hello.component.html ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("<div>\n    <h2>${@this@.message}$</h2>\n    <button dr-event-click=\"@this@.sayHello()\">Say Hello to Server</button>\n</div>\n");

/***/ }),

/***/ "./src/component/hello/hello.component.ts":
/*!************************************************!*\
  !*** ./src/component/hello/hello.component.ts ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   HelloComponent: () => (/* binding */ HelloComponent)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/dom-render/components/ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _hello_component_html__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./hello.component.html */ "./src/component/hello/hello.component.html");
/* harmony import */ var _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/simple-boot/fetch/ApiService */ "../../packages/@dooboostore/simple-boot/src/fetch/ApiService.ts");
/* harmony import */ var _dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dooboostore/simple-boot-front/decorators/Component */ "../../packages/@dooboostore/simple-boot-front/src/decorators/Component.ts");
var _a;





let HelloComponent = class HelloComponent extends _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.ComponentBase {
    apiService;
    message = 'loading...';
    constructor(apiService) {
        super();
        this.apiService = apiService;
    }
    async sayHello() {
        try {
            const res = await this.apiService.get({ target: '/api/hello' });
            this.message = res.message;
        }
        catch (e) {
            this.message = 'Error: ' + e.message;
        }
    }
};
HelloComponent = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    (0,_dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_4__.Component)({ template: _hello_component_html__WEBPACK_IMPORTED_MODULE_2__["default"] }),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_3__.ApiService !== "undefined" && _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_3__.ApiService) === "function" ? _a : Object])
], HelloComponent);



/***/ }),

/***/ "./src/component/hello/index.ts":
/*!**************************************!*\
  !*** ./src/component/hello/index.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   HelloComponent: () => (/* reexport safe */ _hello_component__WEBPACK_IMPORTED_MODULE_0__.HelloComponent)
/* harmony export */ });
/* harmony import */ var _hello_component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./hello.component */ "./src/component/hello/hello.component.ts");



/***/ }),

/***/ "./src/component/index.ts":
/*!********************************!*\
  !*** ./src/component/index.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   breadcrumb: () => (/* reexport module object */ _breadcrumb__WEBPACK_IMPORTED_MODULE_3__),
/* harmony export */   code: () => (/* reexport module object */ _code__WEBPACK_IMPORTED_MODULE_0__),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__),
/* harmony export */   hello: () => (/* reexport module object */ _hello__WEBPACK_IMPORTED_MODULE_2__),
/* harmony export */   test: () => (/* reexport module object */ _test__WEBPACK_IMPORTED_MODULE_1__)
/* harmony export */ });
/* harmony import */ var _code__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./code */ "./src/component/code/index.ts");
/* harmony import */ var _test__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./test */ "./src/component/test/index.ts");
/* harmony import */ var _hello__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./hello */ "./src/component/hello/index.ts");
/* harmony import */ var _breadcrumb__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./breadcrumb */ "./src/component/breadcrumb/index.ts");




/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ({});


/***/ }),

/***/ "./src/component/test/index.ts":
/*!*************************************!*\
  !*** ./src/component/test/index.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   TestComponent: () => (/* reexport safe */ _test_component__WEBPACK_IMPORTED_MODULE_0__.TestComponent)
/* harmony export */ });
/* harmony import */ var _test_component__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./test.component */ "./src/component/test/test.component.ts");



/***/ }),

/***/ "./src/component/test/test.component.css":
/*!***********************************************!*\
  !*** ./src/component/test/test.component.css ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("");

/***/ }),

/***/ "./src/component/test/test.component.html":
/*!************************************************!*\
  !*** ./src/component/test/test.component.html ***!
  \************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("<div dr-if=\"true\">\n    test #innerHTML# test\n</div>");

/***/ }),

/***/ "./src/component/test/test.component.ts":
/*!**********************************************!*\
  !*** ./src/component/test/test.component.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   TestComponent: () => (/* binding */ TestComponent)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/dom-render/components/ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/simple-boot-front/decorators/Component */ "../../packages/@dooboostore/simple-boot-front/src/decorators/Component.ts");
/* harmony import */ var _test_component_html__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./test.component.html */ "./src/component/test/test.component.html");
/* harmony import */ var _test_component_css__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./test.component.css */ "./src/component/test/test.component.css");
var _a;





let TestComponent = class TestComponent extends _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.ComponentBase {
    title = "";
    codeElement;
    codeClass = "";
    onInitRender(param, rawSet) {
        super.onInitRender(param, rawSet);
    }
};
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)("title"),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", String)
], TestComponent.prototype, "title", void 0);
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.query)("pre"),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", typeof (_a = typeof HTMLElement !== "undefined" && HTMLElement) === "function" ? _a : Object)
], TestComponent.prototype, "codeElement", void 0);
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_1__.attribute)("codeClass"),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", String)
], TestComponent.prototype, "codeClass", void 0);
TestComponent = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    (0,_dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_2__.Component)({
        selector: "test",
        template: _test_component_html__WEBPACK_IMPORTED_MODULE_3__["default"],
        styles: _test_component_css__WEBPACK_IMPORTED_MODULE_4__["default"],
    })
], TestComponent);



/***/ }),

/***/ "./src/environments/environment.ts":
/*!*****************************************!*\
  !*** ./src/environments/environment.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   environment: () => (/* binding */ environment)
/* harmony export */ });
const environment = {
    packageGithubIoUrl: 'https://dooboostore-develop.github.io/packages',
    cookie: {
        accessTokenName: 'ACCESS_TOKEN',
        refreshTokenName: 'REFRESH_TOKEN',
    },
    header: {
        authorizationHeaderBearer: 'Bearer'
    }
};


/***/ }),

/***/ "./src/pages/english/english.route.component.css":
/*!*******************************************************!*\
  !*** ./src/pages/english/english.route.component.css ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("/* Content Sections */\n.content-section {\n  margin-bottom: 25px;\n}\n\n.section-title {\n  font-size: 18px;\n  font-weight: 600;\n  color: #2c3e50;\n  margin: 0 0 12px 20px;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.section-title i {\n  color: #3498db;\n  font-size: 16px;\n}\n\n.section-title .fa-youtube {\n  color: #ff0000;\n}\n\n.movie-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n  gap: 20px;\n  padding: 0 20px 20px 20px;\n}\n\n.movie-card {\n  position: relative;\n  border-radius: 8px;\n  overflow: hidden;\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n  transition: transform 0.3s ease, box-shadow 0.3s ease;\n}\n\n.movie-poster-link {\n  display: block;\n  text-decoration: none;\n  color: inherit;\n}\n\n.movie-card:hover {\n  transform: translateY(-5px);\n  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);\n}\n\n.movie-card:hover .movie-title {\n  background: #f8f9fa;\n  color: #1976d2;\n  border-top-color: #2196f3;\n}\n\n.movie-poster {\n  position: relative;\n  width: 100%;\n  height: 0;\n  overflow: hidden;\n}\n\n/* Default movie poster ratio (2:3) */\n.movie-poster.movie {\n  padding-bottom: 150%;\n  /* 2:3 ratio (3/2 = 1.5 = 150%) - Movie poster ratio */\n}\n\n/* YouTube thumbnail ratio (16:9) */\n.movie-poster.youtube {\n  padding-bottom: 56.25%;\n  /* 16:9 ratio (9/16 = 0.5625 = 56.25%) - YouTube thumbnail ratio */\n}\n\n/* Fallback for items without type - use movie ratio */\n.movie-poster:not(.youtube):not(.movie) {\n  padding-bottom: 150%;\n  /* Default to movie poster ratio */\n}\n\n.movie-poster img {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  object-position: center;\n  display: block;\n}\n\n/* Enhanced title card below image */\n.movie-title {\n  margin: 0;\n  padding: 10px 8px;\n  font-size: 13px;\n  font-weight: 600;\n  line-height: 1.3;\n  color: #2c3e50;\n  text-align: center;\n  background: #ffffff;\n  border-top: 1px solid #dee2e6;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  transition: all 0.3s ease;\n  position: relative;\n  word-break: break-word;\n  hyphens: auto;\n}\n\n.movie-actions {\n  position: absolute;\n  top: 8px;\n  right: 8px;\n  display: flex;\n  justify-content: flex-end;\n}\n\n.external-link {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  width: 32px;\n  height: 32px;\n  background: rgba(255, 255, 255, 0.2);\n  border-radius: 50%;\n  color: white;\n  text-decoration: none;\n  transition: background-color 0.3s ease;\n}\n\n.external-link:hover {\n  background: rgba(255, 255, 255, 0.3);\n}\n\n.external-link i {\n  font-size: 14px;\n}\n\n/* Responsive breakpoints */\n@media (max-width: 768px) {\n  .movie-grid {\n    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));\n    gap: 15px;\n    padding: 15px;\n  }\n\n  .movie-title {\n    font-size: 12px;\n    padding: 8px 6px;\n  }\n}\n\n@media (max-width: 480px) {\n  .movie-grid {\n    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\n    gap: 10px;\n    padding: 10px;\n  }\n\n  .movie-overlay {\n    padding: 15px 10px 10px;\n  }\n\n  .movie-title {\n    font-size: 11px;\n    padding: 6px 4px;\n  }\n\n  .external-link {\n    width: 28px;\n    height: 28px;\n  }\n\n  .external-link i {\n    font-size: 12px;\n  }\n}");

/***/ }),

/***/ "./src/pages/english/english.route.component.html":
/*!********************************************************!*\
  !*** ./src/pages/english/english.route.component.html ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("<!-- YouTube Section -->\n<section class=\"content-section\" dr-if=\"@this@.youtubeItems && @this@.youtubeItems.length > 0\">\n    <h2 class=\"section-title\">\n        <i class=\"fab fa-youtube\"></i>\n        YouTube Videos\n    </h2>\n    <div class=\"movie-grid\">\n        <div class=\"movie-card\" dr-for-of=\"@this@.youtubeItems\" dr-option-item-variable-name=\"item\">\n            <dr-a dr-if=\"#item#\" href=\"${'/english/' + #item#.name}$\" class=\"movie-poster-link\">\n                <div class=\"movie-poster youtube\">\n                    <img dr-attr=\"{src: #item#.img, alt: #item#.name}\" />\n                    <div class=\"movie-actions\" dr-if=\"#item#.link\">\n                        <a dr-attr=\"{href: #item#.link}\" target=\"_blank\" rel=\"noopener noreferrer\"\n                            class=\"external-link\">\n                            <i class=\"fa-solid fa-link\"></i>\n                        </a>\n                    </div>\n                </div>\n                <h3 class=\"movie-title\">${#item#.name}$</h3>\n            </dr-a>\n            <iframe dr-if=\"!#item#\" src=\"https://lazycollect.com/assets/dooboostore/adfit/255x255.html\" style=\"width: 100%; height: 100%; overflow: hidden\" scrolling=\"false\" frameborder=\"0\"></iframe>\n        </div>\n    </div>\n</section>\n\n");

/***/ }),

/***/ "./src/pages/english/english.route.component.ts":
/*!******************************************************!*\
  !*** ./src/pages/english/english.route.component.ts ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   EnglishRouteComponent: () => (/* binding */ EnglishRouteComponent)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/simple-boot-front/decorators/Component */ "../../packages/@dooboostore/simple-boot-front/src/decorators/Component.ts");
/* harmony import */ var _english_route_component_html__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./english.route.component.html */ "./src/pages/english/english.route.component.html");
/* harmony import */ var _english_route_component_css__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./english.route.component.css */ "./src/pages/english/english.route.component.css");
/* harmony import */ var _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @dooboostore/core-web/valid/ValidUtils */ "../../packages/@dooboostore/core-web/src/valid/ValidUtils.ts");
/* harmony import */ var _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @dooboostore/dom-render/components/ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _src_service_english_VideoItemService__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @src/service/english/VideoItemService */ "./src/service/english/VideoItemService.ts");
var _a;








let EnglishRouteComponent = class EnglishRouteComponent extends _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_6__.ComponentBase {
    videoItemService;
    name = 'english-route';
    items = undefined;
    movieItems = undefined;
    youtubeItems = undefined;
    constructor(videoItemService) {
        super();
        this.videoItemService = videoItemService;
    }
    async onRawSetRendered(rawSet, otherData) {
        await super.onRawSetRendered(rawSet, otherData);
    }
    //
    async onRouting(r) {
        await new Promise((r, j) => setTimeout(r, 0));
        // this.items = [{},{}]
    }
    async onInitRender(param, rawSet) {
        await super.onInitRender(param, rawSet);
        this.name = 'english-route' + Date.now();
        if (_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_5__.ValidUtils.isBrowser()) {
            this.items = await this.videoItemService.items();
            // Separate items by type
            this.movieItems = this.items.filter(item => !item.type || item.type === 'movie');
            this.youtubeItems = [];
            this.items.filter(item => item.type === 'youtube').forEach((it, index) => {
                this.youtubeItems.push(it);
                if (index > 0 && Math.random() < 0.2) {
                    this.youtubeItems.push(null);
                }
            });
            console.log('Movies:', this.movieItems.length);
            console.log('YouTube videos:', this.youtubeItems.length);
        }
    }
    async add() {
    }
    onDestroy() {
        super.onDestroy();
    }
};
EnglishRouteComponent = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_4__.Sim,
    (0,_dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_1__.Component)({
        template: _english_route_component_html__WEBPACK_IMPORTED_MODULE_2__["default"],
        styles: _english_route_component_css__WEBPACK_IMPORTED_MODULE_3__["default"]
    }),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _src_service_english_VideoItemService__WEBPACK_IMPORTED_MODULE_7__.VideoItemService !== "undefined" && _src_service_english_VideoItemService__WEBPACK_IMPORTED_MODULE_7__.VideoItemService) === "function" ? _a : Object])
], EnglishRouteComponent);



/***/ }),

/***/ "./src/pages/english/english.router.component.css":
/*!********************************************************!*\
  !*** ./src/pages/english/english.router.component.css ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("/* Fixed Header */\n.english-header {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  z-index: 1000;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n}\n\n.header-content {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.75rem 1.5rem;\n  max-width: 1200px;\n  margin: 0 auto;\n}\n\n.header-left {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  flex: 1;\n  min-width: 0; /* Allow shrinking */\n}\n\n.header-title {\n  font-size: 1.1rem;\n  font-weight: 500;\n  margin: 0;\n}\n\n/* Home Button - Always at the left edge */\n.home-btn {\n  background: rgba(255, 255, 255, 0.1);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  color: white;\n  cursor: pointer;\n  padding: 0.5rem;\n  transition: all 0.3s ease;\n  font-size: 1.1rem;\n  min-width: 40px;\n  height: 40px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-shrink: 0; /* Don't shrink */\n}\n\n.home-btn:hover {\n  background: rgba(255, 255, 255, 0.2);\n  transform: translateY(-1px);\n}\n\n/* Current Item Info - Horizontal layout with image */\n.current-item-info {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  background: rgba(255, 255, 255, 0.1);\n  padding: 0.4rem 0.8rem;\n  border-radius: 8px;\n  min-width: 0; /* Allow shrinking */\n  max-width: 400px; /* Limit max width */\n}\n\n.item-image {\n  width: 32px;\n  height: 32px;\n  border-radius: 4px;\n  object-fit: cover;\n  flex-shrink: 0; /* Don't shrink image */\n  border: 1px solid rgba(255, 255, 255, 0.2);\n}\n\n.item-details {\n  display: flex;\n  flex-direction: column;\n  gap: 0.1rem;\n  min-width: 0; /* Allow shrinking */\n  flex: 1;\n}\n\n.item-name {\n  font-weight: 500;\n  font-size: 0.9rem;\n  color: white;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis; /* Add ... for long names */\n}\n\n.item-type {\n  font-size: 0.75rem;\n  opacity: 0.8;\n  color: rgba(255, 255, 255, 0.8);\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.user-menu {\n  display: flex;\n  gap: 0.3rem;\n  align-items: center;\n}\n\n.menu-btn {\n  display: flex;\n  align-items: center;\n  gap: 0.4rem;\n  padding: 0.4rem 0.8rem;\n  background: rgba(255, 255, 255, 0.1);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  color: white;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  font-size: 0.8rem;\n}\n\n.menu-btn:hover {\n  background: rgba(255, 255, 255, 0.2);\n  transform: translateY(-1px);\n}\n\n.favorites-count {\n  background: #ff4757;\n  color: white;\n  border-radius: 50%;\n  padding: 0.15rem 0.4rem;\n  font-size: 0.7rem;\n  min-width: 1.2rem;\n  text-align: center;\n}\n\n/* Favorites Panel */\n.favorites-panel {\n  position: absolute;\n  top: 100%;\n  right: 2rem;\n  width: 400px;\n  max-height: 500px;\n  background: white;\n  color: #333;\n  border-radius: 12px;\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);\n  overflow: hidden;\n  transform: translateY(-10px);\n  opacity: 0;\n  visibility: hidden;\n  transition: all 0.3s ease;\n}\n\n.favorites-panel.show {\n  transform: translateY(0);\n  opacity: 1;\n  visibility: visible;\n}\n\n.panel-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1rem 1.5rem;\n  background: #f8f9fa;\n  border-bottom: 1px solid #e9ecef;\n}\n\n.panel-header h3 {\n  margin: 0;\n  font-size: 1.1rem;\n  color: #495057;\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  color: #6c757d;\n  cursor: pointer;\n  padding: 0.5rem;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n}\n\n.close-btn:hover {\n  background: #e9ecef;\n  color: #495057;\n}\n\n.favorites-content {\n  max-height: 400px;\n  overflow-y: auto;\n  padding: 1rem;\n}\n\n.empty-message {\n  text-align: center;\n  color: #6c757d;\n  padding: 2rem;\n  font-style: italic;\n}\n\n.favorite-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.75rem;\n  border-radius: 8px;\n  margin-bottom: 0.5rem;\n  background: #f8f9fa;\n  transition: all 0.2s ease;\n}\n\n.favorite-item:hover {\n  background: #e9ecef;\n}\n\n.word-info {\n  flex: 1;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border-radius: 4px;\n  padding: 0.25rem;\n  margin: -0.25rem;\n}\n\n.word-info:hover {\n  background-color: rgba(33, 150, 243, 0.05);\n}\n\n.word-text {\n  font-weight: 600;\n  color: #495057;\n  display: block;\n  margin-bottom: 0.25rem;\n}\n\n.clickable-word {\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border-radius: 3px;\n  padding: 2px 4px;\n  margin: -2px -4px;\n}\n\n.clickable-word:hover {\n  background-color: #e3f2fd;\n  color: #1976d2;\n}\n\n.word-meaning {\n  font-size: 0.9rem;\n  color: #6c757d;\n}\n\n.remove-btn {\n  background: none;\n  border: none;\n  color: #dc3545;\n  cursor: pointer;\n  padding: 0.5rem;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n}\n\n.remove-btn:hover {\n  background: rgba(220, 53, 69, 0.1);\n}\n\n/* Main Content */\n.english-main {\n  margin-top: 60px; /* Header height + some spacing */\n  min-height: calc(100vh - 60px);\n}\n\n/* Player page - no margin (both PC and mobile) */\n.english-main:has(.player-container) {\n  margin-top: 0;\n  height: 100vh; /*  100vh, min-height  */\n  overflow: hidden; /*    */\n}\n\n/* Mobile Responsive */\n@media (max-width: 768px) {\n  .header-content {\n    padding: 0.6rem 1rem;\n  }\n  \n  .header-left {\n    gap: 0.5rem;\n  }\n  \n  .header-title {\n    font-size: 1rem;\n  }\n  \n  .home-btn {\n    min-width: 36px;\n    height: 36px;\n    font-size: 1rem;\n  }\n  \n  .current-item-info {\n    padding: 0.3rem 0.6rem;\n    gap: 0.5rem;\n    max-width: 250px; /* Smaller max width on mobile */\n  }\n  \n  .item-image {\n    width: 28px;\n    height: 28px;\n  }\n  \n  .item-name {\n    font-size: 0.8rem;\n  }\n  \n  .item-type {\n    display: none; /* Hide type on mobile to save space */\n  }\n  \n  /* Hide current item info in landscape mode */\n  @media (max-height: 500px) and (orientation: landscape) {\n    .current-item-info {\n      display: none;\n    }\n    \n    .header-content {\n      padding: 0.4rem 1rem; /*    */\n    }\n    \n    .home-btn {\n      min-width: 32px;\n      height: 32px;\n    }\n  }\n  \n  .menu-btn span {\n    display: none;\n  }\n  \n  .menu-btn {\n    padding: 0.4rem;\n    min-width: 36px;\n    justify-content: center;\n  }\n  \n  .favorites-panel {\n    right: 1rem;\n    left: 1rem;\n    width: auto;\n  }\n  \n  .english-main {\n    margin-top: 50px;\n  }\n}");

/***/ }),

/***/ "./src/pages/english/english.router.component.html":
/*!*********************************************************!*\
  !*** ./src/pages/english/english.router.component.html ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("<!-- Fixed Header -->\n<header class=\"english-header\">\n    <div class=\"header-content\">\n        <div class=\"header-left\">\n            <!-- Show home button when in sub-route (always at the left edge) -->\n            <dr-a href=\"/english/\" class=\"home-btn\" dr-if=\"@this@.isInSubRoute\" title=\" \">\n                <i class=\"fas fa-home\"></i>\n            </dr-a>\n            \n            <!-- Show title when on main page -->\n            <h1 class=\"header-title\" dr-if=\"!@this@.isInSubRoute\">English Learning</h1>\n            \n            <!-- Show current item info when in sub-route -->\n            <div class=\"current-item-info\" dr-if=\"@this@.currentItem\">\n                <img class=\"item-image\" dr-attr=\"{src: @this@.currentItem.img}\" alt=\"Item image\">\n                <div class=\"item-details\">\n                    <span class=\"item-name\">${@this@.currentItem.name}$</span>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"user-menu\">\n            <div>\n                <img alt=\"Hits\" src=\"https://hits.sh/hits.sh/dooboostore.github.io.svg?style=plastic&amp;\">\n            </div>\n            <button class=\"menu-btn favorites-btn\" dr-event-click=\"@this@.toggleFavorites()\">\n                <i class=\"fas fa-star\"></i>\n                <span></span>\n                <span class=\"favorites-count\"\n                    dr-if=\"@this@.favoriteWords.length > 0\">${@this@.favoriteWords.length}$</span>\n            </button>\n        </div>\n    </div>\n\n    <!-- Favorites Panel -->\n    <div class=\"favorites-panel\" dr-if=\"@this@.showFavorites\"\n        dr-attr=\"{class: 'favorites-panel' + (@this@.showFavorites ? ' show' : '')}\">\n        <div class=\"panel-header\">\n            <h3> </h3>\n            <button class=\"close-btn\" dr-event-click=\"@this@.toggleFavorites()\">\n                <i class=\"fas fa-times\"></i>\n            </button>\n        </div>\n\n        <div class=\"favorites-content\">\n            <div class=\"empty-message\" dr-if=\"@this@.favoriteWords.length === 0\">\n                   .\n            </div>\n\n            <div class=\"favorite-item\" dr-for-of=\"@this@.favoriteWords\" dr-option-item-variable-name=\"word\">\n                <div class=\"word-info\" dr-event-click=\"@this@.onFavoriteWordClick(#word#.text, $event)\">\n                    <span class=\"word-text clickable-word\">${#word#.text}$</span>\n                    <span class=\"word-meaning\">${#word#.meaning}$</span>\n                </div>\n                <button class=\"remove-btn\" dr-event-click=\"@this@.removeFavorite(#word#.text)\">\n                    <i class=\"fas fa-trash\"></i>\n                </button>\n            </div>\n        </div>\n    </div>\n</header>\n\n<main class=\"english-main\">\n    <dr-router-outlet createArguments=\"${@this@.getChildArguments()}$\"></dr-router-outlet>\n</main>");

/***/ }),

/***/ "./src/pages/english/english.router.component.ts":
/*!*******************************************************!*\
  !*** ./src/pages/english/english.router.component.ts ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   EnglishRouterComponent: () => (/* binding */ EnglishRouterComponent)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_simple_boot_decorators_route_Router__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/route/Router */ "../../packages/@dooboostore/simple-boot/src/decorators/route/Router.ts");
/* harmony import */ var _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/simple-boot-front/decorators/Component */ "../../packages/@dooboostore/simple-boot-front/src/decorators/Component.ts");
/* harmony import */ var _english_router_component_html__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./english.router.component.html */ "./src/pages/english/english.router.component.html");
/* harmony import */ var _english_router_component_css__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./english.router.component.css */ "./src/pages/english/english.router.component.css");
/* harmony import */ var _dooboostore_simple_boot_front_component_ComponentRouterBase__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @dooboostore/simple-boot-front/component/ComponentRouterBase */ "../../packages/@dooboostore/simple-boot-front/src/component/ComponentRouterBase.ts");
/* harmony import */ var _english_route_component__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./english.route.component */ "./src/pages/english/english.route.component.ts");
/* harmony import */ var _dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @dooboostore/core-web/valid/ValidUtils */ "../../packages/@dooboostore/core-web/src/valid/ValidUtils.ts");
/* harmony import */ var _dooboostore_simple_boot_front_option_SimFrontOption__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @dooboostore/simple-boot-front/option/SimFrontOption */ "../../packages/@dooboostore/simple-boot-front/src/option/SimFrontOption.ts");
/* harmony import */ var _src_pages_english_player_player_route_component__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @src/pages/english/player/player.route.component */ "./src/pages/english/player/player.route.component.ts");
/* harmony import */ var _src_service_english_VideoItemService__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @src/service/english/VideoItemService */ "./src/service/english/VideoItemService.ts");
/* harmony import */ var _src_service_VoiceService__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @src/service/VoiceService */ "./src/service/VoiceService.ts");
/* harmony import */ var _back_end_environments_environment__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @back-end/environments/environment */ "./back-end/environments/environment.ts");
var _a, _b, _c;














let EnglishRouterComponent = class EnglishRouterComponent extends _dooboostore_simple_boot_front_component_ComponentRouterBase__WEBPACK_IMPORTED_MODULE_6__.ComponentRouterBase {
    config;
    videoItemService;
    voiceService;
    favoriteWords = [];
    showFavorites = false;
    // Current item info
    currentItemName;
    currentItem;
    // items?: Item[];
    isInSubRoute = false; // Track if we're in a sub-route
    name = 'zzz';
    constructor(config, videoItemService, voiceService) {
        super({ sameRouteNoApply: true });
        this.config = config;
        this.videoItemService = videoItemService;
        this.voiceService = voiceService;
    }
    onCreateRenderData(data) {
        super.onCreateRenderData(data);
        console.log('english.router.component onCreateRenderData-------');
    }
    onCreateRender(...param) {
        console.log('english.router.component onCreateRender-------');
    }
    async onInitRender(param, rawSet) {
        await super.onInitRender(param, rawSet);
        this.name = new Date().toISOString();
        console.log('english.router.component onInitRender-------');
        // Load favorite words from localStorage
        this.loadFavoriteWords();
        // Initialize speech synthesis voices
        this.initializeSpeechSynthesis();
    }
    async onRouting(r) {
        await super.onRouting(r);
        this.currentItemName = decodeURIComponent(r.routerModule.pathData?.name ?? '');
        this.currentItem = this.currentItemName ? await this.videoItemService.item(this.currentItemName) : undefined;
        if (this.config?.window) {
            const doc = this.config.window.document;
            const setMetaByProperty = (property, content) => {
                const d = doc.querySelector(`meta[property="${property}"]`);
                doc.querySelector(`meta[property="${property}"]`)?.setAttribute('content', content);
            };
            const setMetaByName = (name, content) => {
                doc.querySelector(`meta[name="${name}"]`)?.setAttribute('content', content);
            };
            const setLink = (rel, href) => {
                doc.querySelector(`link[rel="${rel}"]`)?.setAttribute('href', href);
            };
            const setTitle = (title) => {
                doc.title = title;
            };
            let pageTitle = 'English Learning';
            let pageDescription = 'Learn English with videos, movies, and interactive content.';
            let pageUrl = _back_end_environments_environment__WEBPACK_IMPORTED_MODULE_13__.environment.host + this.config.window.window.location.pathname;
            let pageImage = 'assets/images/dooboostore.png';
            if (this.currentItem) {
                // Page-specific SEO content
                pageTitle = this.currentItem.name;
                pageDescription = this.currentItem.name;
                pageImage = this.currentItem.img;
                // Set Title, Description, Canonical URL
            }
            console.log('Setting SEO tags:', { pageTitle, pageDescription, pageUrl, pageImage });
            setTitle(pageTitle);
            setMetaByName('description', pageDescription);
            setLink('canonical', pageUrl);
            // Set Open Graph (OG) tags for social sharing
            setMetaByProperty('og:title', pageTitle);
            setMetaByProperty('og:description', pageDescription);
            setMetaByProperty('og:image', pageImage);
            setMetaByProperty('og:url', pageUrl);
            setMetaByProperty('og:type', 'website');
        }
        if (_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_8__.ValidUtils.isBrowser()) {
            // Get current item name from route
            // console.log('------->', r, this.currentItemName);
            // Check if we're in a sub-route (has name parameter)
            this.isInSubRoute = !!this.currentItemName;
        }
    }
    onCreatedThisChild(child, data) {
        super.onCreatedThisChild(child, data);
    }
    onCreatedThisChildDebounce(childrenSet) {
        super.onCreatedThisChildDebounce(childrenSet);
    }
    onDrThisUnBind() {
        super.onDrThisUnBind();
        this.onDestroyRender();
    }
    onDestroyRender(data) {
        super.onDestroyRender(data);
    }
    onCreatedOutletDebounce(a) {
        // Prism.highlightAll()   
    }
    // Load favorite words from localStorage
    loadFavoriteWords() {
        if (!_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_8__.ValidUtils.isBrowser())
            return;
        try {
            const stored = localStorage.getItem('english-favorite-words');
            if (stored) {
                this.favoriteWords = JSON.parse(stored);
            }
        }
        catch (error) {
            console.error('Failed to load favorite words:', error);
            this.favoriteWords = [];
        }
    }
    // Save favorite words to localStorage
    saveFavoriteWords() {
        if (!_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_8__.ValidUtils.isBrowser())
            return;
        try {
            localStorage.setItem('english-favorite-words', JSON.stringify(this.favoriteWords));
        }
        catch (error) {
            console.error('Failed to save favorite words:', error);
        }
    }
    // Add word to favorites
    addToFavorites = (word, meaning) => {
        // Check if word already exists
        const exists = this.favoriteWords.some(fav => fav.text.toLowerCase() === word.toLowerCase());
        if (exists) {
            console.log('Word already in favorites:', word);
            return false;
        }
        // Add new favorite word
        const newFavorite = {
            text: word,
            meaning: meaning,
            addedAt: Date.now()
        };
        this.favoriteWords.unshift(newFavorite); // Add to beginning
        this.saveFavoriteWords();
        console.log('Added to favorites:', word);
        return true;
    };
    // Remove word from favorites
    removeFavorite(word) {
        this.favoriteWords = this.favoriteWords.filter(fav => fav.text.toLowerCase() !== word.toLowerCase());
        this.saveFavoriteWords();
        console.log('Removed from favorites:', word);
    }
    // Check if word is in favorites
    isWordFavorite = (word) => {
        return this.favoriteWords.some(fav => fav.text.toLowerCase() === word.toLowerCase());
    };
    // Toggle favorites panel
    toggleFavorites() {
        this.showFavorites = !this.showFavorites;
    }
    initializeSpeechSynthesis() {
        // VoiceService handles initialization automatically
        console.log(' Voice service initialized in router');
    }
    // Speak word using TTS
    speakWord(word) {
        if (!_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_8__.ValidUtils.isBrowser())
            return;
        this.voiceService.speakWord(word);
    }
    // Handle word click in favorites
    onFavoriteWordClick(word, event) {
        event.preventDefault();
        event.stopPropagation();
        this.speakWord(word);
    }
    // Get arguments to pass to child components
    getChildArguments() {
        return {
            addToFavorites: this.addToFavorites,
            removeFavorite: this.removeFavorite.bind(this),
            isWordFavorite: this.isWordFavorite
        };
    }
};
EnglishRouterComponent = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_2__.Sim,
    (0,_dooboostore_simple_boot_decorators_route_Router__WEBPACK_IMPORTED_MODULE_1__.Router)({
        path: '/english',
        route: {
            '': '/',
            '/': _english_route_component__WEBPACK_IMPORTED_MODULE_7__.EnglishRouteComponent,
            '/{name}': _src_pages_english_player_player_route_component__WEBPACK_IMPORTED_MODULE_10__.PlayerRouteComponent,
            '/{name}/': _src_pages_english_player_player_route_component__WEBPACK_IMPORTED_MODULE_10__.PlayerRouteComponent
        },
        routers: []
    }),
    (0,_dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_3__.Component)({
        template: _english_router_component_html__WEBPACK_IMPORTED_MODULE_4__["default"],
        styles: _english_router_component_css__WEBPACK_IMPORTED_MODULE_5__["default"]
    }),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _dooboostore_simple_boot_front_option_SimFrontOption__WEBPACK_IMPORTED_MODULE_9__.SimFrontOption !== "undefined" && _dooboostore_simple_boot_front_option_SimFrontOption__WEBPACK_IMPORTED_MODULE_9__.SimFrontOption) === "function" ? _a : Object, typeof (_b = typeof _src_service_english_VideoItemService__WEBPACK_IMPORTED_MODULE_11__.VideoItemService !== "undefined" && _src_service_english_VideoItemService__WEBPACK_IMPORTED_MODULE_11__.VideoItemService) === "function" ? _b : Object, typeof (_c = typeof _src_service_VoiceService__WEBPACK_IMPORTED_MODULE_12__.VoiceService !== "undefined" && _src_service_VoiceService__WEBPACK_IMPORTED_MODULE_12__.VoiceService) === "function" ? _c : Object])
], EnglishRouterComponent);



/***/ }),

/***/ "./src/pages/english/player/player.route.component.css":
/*!*************************************************************!*\
  !*** ./src/pages/english/player/player.route.component.css ***!
  \*************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (".player-container {\n  display: flex;\n  height: 100svh;\n  width: 100%;\n  position: fixed; /*     */\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n}\n\n/* Mobile - full viewport */\n@media (max-width: 768px) {\n  .player-container {\n    position: fixed; /*   */\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    height: 100svh; /* Full viewport height */\n    max-height: 100svh; /*    */\n  }\n}\n\n.player-container.swapped {\n  flex-direction: row-reverse;\n}\n\n.dictionary-section,\n.scripts-section {\n  flex: 1;\n  overflow-y: auto;\n  /*padding: 20px;*/\n  border-right: 1px solid #e0e0e0;\n}\n\n/* PC    */\n.dictionary-section {\n  padding: 70px 15px 15px 15px;\n}\n\n.scripts-section {\n  padding-top: 70px;\n}\n\n.scripts-section {\n  border-right: none;\n  border-left: 1px solid #e0e0e0;\n  display: flex;\n  flex-direction: column;\n  overflow: hidden; /*     */\n}\n\n/* YouTube Section Styles */\n.youtube-section {\n  height: 40%; /*   */\n  border-bottom: 1px solid #e0e0e0;\n  background: #000;\n  flex-shrink: 0;\n  z-index: 10;\n}\n\n#youtube-player-container {\n  width: 100%;\n  height: 100%;\n  background: #000;\n  overflow: hidden;\n}\n\n#youtube-player-container iframe {\n  width: 100%;\n  height: 100%;\n  border: none;\n}\n\n\n\n/* Dictionary Styles */\n.dictionary-content {\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n  padding-top: 10px;\n  padding-bottom: 80px;\n  /* Space for floating controller */\n}\n\n.dictionary-item {\n  background: #f8f9fa;\n  border-radius: 6px;\n  padding: 12px;\n  border: 1px solid #e9ecef;\n  scroll-margin-top: 80px; /* Account for fixed header */\n}\n\n.clickable-dictionary {\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.clickable-title {\n  cursor: pointer;\n  transition: color 0.2s ease;\n}\n\n.clickable-title:hover {\n  color: #1976d2;\n  text-decoration: underline;\n}\n\n.clickable-example {\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border-radius: 3px;\n  padding: 2px 4px;\n  margin: -2px -4px;\n}\n\n.clickable-example:hover {\n  background-color: #e3f2fd;\n  color: #1976d2;\n}\n\n.word-entry {\n  margin-bottom: 10px;\n}\n\n.entry-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  gap: 0.5rem;\n  margin-bottom: 0.5rem;\n}\n\n.entry-title {\n  font-size: 16px;\n  font-weight: 700;\n  color: #2c3e50;\n  margin: 0;\n  flex: 1;\n}\n\n/* Favorite Checkbox Styles */\n.favorite-checkbox-label {\n  cursor: pointer;\n  padding: 0.25rem;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n  min-width: 28px;\n  height: 28px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  position: relative;\n}\n\n.favorite-checkbox {\n  position: absolute;\n  opacity: 0;\n  pointer-events: none;\n}\n\n.favorite-icon {\n  color: #ccc;\n  font-size: 1.1rem;\n  transition: all 0.2s ease;\n}\n\n.favorite-checkbox-label:hover .favorite-icon {\n  color: #ffc107;\n  transform: scale(1.1);\n}\n\n.favorite-checkbox-label:hover {\n  background: rgba(255, 193, 7, 0.1);\n}\n\n.favorite-checkbox:checked + .favorite-icon {\n  color: #ffc107;\n}\n\n.favorite-checkbox-label:has(.favorite-checkbox:checked) .favorite-icon {\n  color: #ffc107;\n}\n\n.favorite-checkbox-label:has(.favorite-checkbox:checked):hover .favorite-icon {\n  color: #e0a800;\n}\n\n\n\n.pos-type {\n  background: #3498db;\n  color: white;\n  padding: 3px 6px;\n  border-radius: 3px;\n  font-size: 10px;\n  font-weight: 600;\n  display: inline-block;\n  margin-bottom: 6px;\n}\n\n/* Null type styling */\n.pos-type-null {\n  background: #95a5a6 !important;\n}\n\n/* Original word styling */\n.dictionary-item[data-match-type=\"original\"] {\n  background: #f8f9fa;\n  border: 1px dashed #dee2e6;\n  opacity: 0.8;\n}\n\n.dictionary-item[data-match-type=\"original\"] .pos-type {\n  background: #6c757d;\n}\n\n.dictionary-item[data-match-type=\"original\"] .meaning-text {\n  font-style: italic;\n  color: #6c757d;\n}\n\n.meanings {\n  margin-left: 10px;\n}\n\n.meaning-item {\n  margin-bottom: 8px;\n  padding: 6px;\n  background: white;\n  border-radius: 3px;\n  border-left: 3px solid #3498db;\n}\n\n.meaning-text {\n  font-weight: 500;\n  margin-bottom: 6px;\n  color: #2c3e50;\n  font-size: 14px;\n}\n\n.examples {\n  margin-left: 15px;\n}\n\n.example-item {\n  margin-bottom: 6px;\n  padding: 4px;\n  background: #f1f2f6;\n  border-radius: 3px;\n}\n\n.example-text {\n  font-style: italic;\n  color: #34495e;\n  margin-bottom: 3px;\n  font-size: 13px;\n}\n\n.example-translation {\n  color: #7f8c8d;\n  font-size: 12px;\n}\n\n/* Dictionary Examples Section */\n.examples-section {\n  margin-top: 15px;\n  border-top: 1px solid #e9ecef;\n  padding-top: 10px;\n}\n\n.examples-summary {\n  cursor: pointer;\n  padding: 8px 12px;\n  background: #f8f9fa;\n  border: 1px solid #dee2e6;\n  border-radius: 4px;\n  font-size: 13px;\n  font-weight: 600;\n  color: #495057;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  transition: all 0.2s ease;\n  user-select: none;\n}\n\n.examples-summary:hover {\n  background: #e9ecef;\n  color: #343a40;\n}\n\n.examples-summary i {\n  color: #6c757d;\n  font-size: 12px;\n}\n\n.examples-content {\n  margin-top: 10px;\n  padding: 0 5px;\n}\n\n.examples-content .example-item {\n  margin-bottom: 12px;\n  padding: 10px;\n  background: #ffffff;\n  border: 1px solid #e9ecef;\n  border-radius: 4px;\n  border-left: 3px solid #17a2b8;\n}\n\n.examples-content .example-text {\n  font-size: 14px;\n  line-height: 1.4;\n  color: #2c3e50;\n  margin-bottom: 6px;\n  cursor: pointer;\n  transition: color 0.2s ease;\n}\n\n.examples-content .example-text:hover {\n  color: #1976d2;\n}\n\n.examples-content .example-translation {\n  font-size: 13px;\n  color: #6c757d;\n  font-style: italic;\n}\n\n/* Translation Items Section */\n.translation-items-section {\n  flex: 1;\n  overflow-y: auto;\n  padding: 8px;\n  padding-bottom: 80px; /* Space for floating controller */\n}\n\n.translation-content {\n  display: flex;\n  flex-direction: column;\n  gap: 1px;\n}\n\n.translation-item {\n  background: #ffffff;\n  border: 1px solid #e9ecef;\n  border-radius: 3px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  scroll-margin-top: 20vh; /*   20%   */\n  overflow: hidden;\n}\n\n.translation-item:hover {\n  background: #f8f9fa;\n  border-color: #dee2e6;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);\n}\n\n/* Korean translation item - thinner and smaller */\n.translation-item[data-type=\"ko\"] {\n  background: #f8f9fa;\n  border: 1px solid #dee2e6;\n  opacity: 0.85;\n}\n\n.translation-item[data-type=\"ko\"]:hover {\n  background: #e9ecef;\n  opacity: 1;\n}\n\n.translation-item.active {\n  background: #e3f2fd;\n  border-left: 3px solid #2196f3;\n  border-color: #2196f3;\n  box-shadow: 0 1px 4px rgba(33, 150, 243, 0.2);\n}\n\n/*     ( ) */\n.translation-item.active.last-active {\n  background: #bbdefb;\n  border-left: 4px solid #1976d2;\n  border-color: #1976d2;\n  box-shadow: 0 2px 6px rgba(25, 118, 210, 0.3);\n}\n\n.translation-text {\n  font-size: 14px;\n  line-height: 1.4;\n  color: #2c3e50;\n  padding: 6px 10px;\n}\n\n.translation-text.english-text {\n  margin-bottom: 0;\n}\n\n.translation-text.korean-text {\n  font-size: 11px;\n  color: #666;\n  font-style: italic;\n  font-weight: 400;\n  padding: 3px 8px;\n  margin-top: 0;\n  border-top: none;\n}\n\n.translation-item.active .translation-text {\n  color: #1976d2;\n  font-weight: 600;\n}\n\n.translation-item.active .translation-text.korean-text {\n  color: #555;\n  font-weight: 400;\n}\n\n.translation-item.active.last-active .translation-text {\n  color: #0d47a1;\n  font-weight: 700;\n}\n\n.translation-item.active.last-active .translation-text.korean-text {\n  color: #444;\n  font-weight: 400;\n}\n\n/* Korean item active states */\n\n.translation-item[data-type=\"ko\"] {\n    pointer-events: none;\n    border:unset;\n}\n.translation-item[data-type=\"ko\"].active {\n  background: #e3f2fd;\n  border-left: 2px solid #90caf9;\n  opacity: 1;\n}\n\n.translation-item[data-type=\"ko\"].active.last-active {\n  background: #bbdefb;\n  border-left: 3px solid #64b5f6;\n\n}\n\n\n\n/* Floating Controller */\n.floating-controller {\n  position: fixed;\n  bottom: 20px;\n  right: 20px;\n  left: 20px;\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  background: rgba(255, 255, 255, 0.95);\n  padding: 2px 12px;\n  border-radius: 12px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n  z-index: 1000;\n  backdrop-filter: blur(10px);\n}\n\n.control-btn {\n  width: 44px;\n  height: 44px;\n  border: none;\n  border-radius: 8px;\n  background: #f0f0f0;\n  color: #666;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s ease;\n  font-size: 18px;\n  padding: 0;\n  flex-shrink: 0;\n}\n\n.control-btn:hover {\n  background: #e0e0e0;\n  transform: scale(1.05);\n}\n\n.control-btn:active {\n  transform: scale(0.95);\n}\n\n/* Translation button */\n.translation-btn.active {\n  background: #2196f3;\n  color: white;\n}\n\n.translation-btn.active:hover {\n  background: #1976d2;\n}\n\n/* Hide words button */\n.hide-words-btn.active {\n  background: #ff9800;\n  color: white;\n}\n\n.hide-words-btn.active:hover {\n  background: #f57c00;\n}\n\n/* Auto play button */\n.auto-play-btn.active {\n  background: #4caf50;\n  color: white;\n}\n\n.auto-play-btn.active:hover {\n  background: #388e3c;\n}\n\n/* Korean translation button */\n.korean-translation-btn {\n  background: #f0f0f0;\n  color: #666;\n}\n\n.korean-translation-btn:hover {\n  background: #e0e0e0;\n}\n\n.korean-translation-btn.active {\n  background: #673ab7;\n  color: white;\n}\n\n.korean-translation-btn.active:hover {\n  background: #5e35b1;\n}\n\n/* Replay button */\n.replay-btn {\n  background: #f0f0f0;\n  color: #666;\n}\n\n.replay-btn:hover {\n  background: #9c27b0;\n  color: white;\n}\n\n.replay-btn:active {\n  transform: scale(0.95) rotate(360deg);\n  transition: transform 0.3s ease;\n}\n\n/* Navigation Buttons */\n.nav-btn {\n  width: 36px;\n  height: 36px;\n  border: none;\n  border-radius: 8px;\n  background: #f0f0f0;\n  color: #666;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s ease;\n  font-size: 14px;\n  padding: 0;\n  flex-shrink: 0;\n}\n\n.nav-btn:hover {\n  background: #2196f3;\n  color: white;\n  transform: scale(1.05);\n}\n\n.nav-btn:active {\n  transform: scale(0.95);\n}\n\n/* Slider Container */\n.slider-container {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n  min-width: 200px;\n}\n\n.slider-label-container {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  gap: 8px;\n}\n\n.word-nav-btn {\n  width: 24px;\n  height: 24px;\n  border: none;\n  border-radius: 6px;\n  background: #f0f0f0;\n  color: #666;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s ease;\n  font-size: 12px;\n  padding: 0;\n  flex-shrink: 0;\n}\n\n.word-nav-btn:hover {\n  background: #2196f3;\n  color: white;\n  transform: scale(1.1);\n}\n\n.word-nav-btn:active {\n  transform: scale(0.95);\n}\n\n.global-word-slider {\n  width: 100%;\n  height: 6px;\n  border-radius: 3px;\n  background: #e0e0e0;\n  outline: none;\n  -webkit-appearance: none;\n  appearance: none;\n  cursor: pointer;\n}\n\n.global-word-slider::-webkit-slider-thumb {\n  -webkit-appearance: none;\n  appearance: none;\n  width: 18px;\n  height: 18px;\n  border-radius: 50%;\n  background: #2196f3;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.global-word-slider::-webkit-slider-thumb:hover {\n  background: #1976d2;\n  transform: scale(1.2);\n}\n\n.global-word-slider::-moz-range-thumb {\n  width: 18px;\n  height: 18px;\n  border-radius: 50%;\n  background: #2196f3;\n  cursor: pointer;\n  border: none;\n  transition: all 0.2s ease;\n}\n\n.global-word-slider::-moz-range-thumb:hover {\n  background: #1976d2;\n  transform: scale(1.2);\n}\n\n.slider-label {\n  font-size: 11px;\n  color: #666;\n  text-align: center;\n  font-weight: 500;\n}\n\n/* Mobile adjustments */\n@media (max-width: 768px) {\n  .floating-controller {\n    bottom: 10px;\n    right: 10px;\n    left: 10px;\n    padding: 10px 8px;\n    gap: 4px;\n  }\n  \n  .control-btn {\n    width: 40px;\n    height: 40px;\n    font-size: 16px;\n  }\n  \n  .nav-btn {\n    width: 32px;\n    height: 32px;\n    font-size: 12px;\n  }\n  \n  .slider-container {\n    min-width: 100px;\n  }\n  \n  .slider-label {\n    font-size: 10px;\n  }\n  \n  .word-nav-btn {\n    width: 20px;\n    height: 20px;\n    font-size: 10px;\n  }\n  \n  .slider-label-container {\n    gap: 6px;\n  }\n}\n\n.cue-time-container {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 2px;\n  /*min-width: 30px;*/\n  flex-shrink: 0;\n}\n\n.cue-play-btn {\n  width: 16px;\n  height: 16px;\n  border: none;\n  border-radius: 3px;\n  background: #e0e0e0;\n  color: #666;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.2s ease;\n  font-size: 8px;\n  padding: 0;\n}\n\n.cue-play-btn:hover {\n  background: #4caf50;\n  color: white;\n  transform: scale(1.1);\n}\n\n\n\n.vtt-content {\n  flex: 1;\n  overflow-y: auto;\n  /*padding: 8px;*/\n}\n\n.vtt-cue {\n  display: flex;\n  align-items: flex-start;\n  /*gap: 8px;*/\n  /*padding: 6px 8px;*/\n  margin-bottom: 2px;\n  border-radius: 4px;\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.vtt-cue:hover {\n  background-color: #f8f9fa;\n}\n\n.vtt-cue.active {\n  background-color: #e3f2fd;\n}\n\n.vtt-cue.active.last-active {\n  background-color: #bbdefb;\n  font-weight: 500;\n}\n\n.cue-time {\n  font-size: 10px;\n  color: #888;\n  font-family: monospace;\n  min-width: 30px;\n  flex-shrink: 0;\n  cursor: pointer;\n  /*padding: 2px 4px;*/\n  border-radius: 3px;\n  transition: all 0.2s ease;\n  display: none; /* Hide time display */\n}\n\n.cue-time:hover {\n  background-color: #e3f2fd;\n  color: #1976d2;\n}\n\n.cue-text {\n  font-size: 13px;\n  line-height: 1.3;\n  color: #333;\n}\n\n/* Korean subtitles - smaller font size */\n.korean-vtt-area .cue-text {\n  font-size: 11px;\n  line-height: 1.2;\n}\n\n.no-content {\n  height: calc(35vh - 40px);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: #888;\n  font-style: italic;\n}\n\n/* Script Item Styles - Dictionary   */\n.script-item {\n  background: #ffffff !important;\n  border: 1px solid #e9ecef !important;\n  border-radius: 6px;\n  padding: 0 !important;\n  margin-bottom: 4px;\n  overflow: visible !important;\n  transition: all 0.2s ease;\n  display: block !important;\n  visibility: visible !important;\n  scroll-margin-top: 0 !important;\n}\n\n.script-item:hover {\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n  border-color: #dee2e6;\n}\n\n.script-item:has(.script-radio:checked) {\n  border-left: 3px solid #2196f3;\n  background-color: #e3f2fd;\n  border-color: #2196f3;\n}\n\n.script-block {\n  display: block !important;\n  padding: 0 !important;\n  margin: 0 !important;\n  cursor: pointer;\n  position: relative;\n  transition: all 0.2s ease;\n  visibility: visible !important;\n}\n\n.script-radio {\n  position: absolute;\n  opacity: 0;\n  pointer-events: none;\n}\n\n.script-content {\n  transition: all 0.2s ease;\n  display: block !important;\n  visibility: visible !important;\n}\n\n.english-text {\n  font-size: 14px !important;\n  line-height: 1.3;\n  color: #2c3e50 !important;\n  margin-bottom: 3px;\n  font-weight: 500;\n  display: block !important;\n  visibility: visible !important;\n  padding: 8px 10px !important;\n}\n\n.script-item:has(.script-radio:checked) .english-text {\n  color: #1976d2 !important;\n  font-weight: 600;\n}\n\n\n\n.script-item:has(.script-radio:checked) .korean-text {\n  color: #1565c0 !important;\n}\n\n.script-item {\n  background: #ffffff;\n  border: 1px solid #e9ecef;\n  border-radius: 6px;\n  overflow: hidden;\n  scroll-margin-top: 80px; /* Account for fixed header */\n}\n\n.script-item:hover {\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);\n}\n\n.script-block {\n  display: block;\n  padding: 10px 12px;\n  cursor: pointer;\n  border-radius: 6px;\n  position: relative;\n  transition: background-color 0.2s ease;\n}\n\n.script-block:hover {\n  background-color: #f8f9fa;\n}\n\n.script-radio {\n  position: absolute;\n  opacity: 0;\n  pointer-events: none;\n}\n\n.script-radio:checked + .script-content,\n.script-radio:checked ~ .script-content {\n  background-color: #e3f2fd;\n}\n\n.script-item:has(.script-radio:checked) {\n  border-left: 3px solid #2196f3;\n  background-color: #e3f2fd;\n}\n\n.script-content {\n  transition: background-color 0.2s ease;\n}\n\n/* Mobile Layout */\n@media (max-width: 768px) {\n  .player-container {\n    flex-direction: column;\n    height: 100svh;\n  }\n\n  .dictionary-section {\n    flex: 0 0 30%; /* 30%  - 3:7  */\n    border-right: none;\n    border-left: none;\n    border-bottom: 1px solid #e0e0e0;\n    padding: 60px 15px 15px 15px; /*      */\n    overflow-y: auto;\n  }\n\n  .scripts-section {\n    flex: 0 0 70%; /* 70%  - 3:7  */\n    border-right: none;\n    border-left: none;\n    border-bottom: none;\n    border-top: 1px solid #e0e0e0;\n    padding: 0; /*   */\n    overflow: hidden; /*   */\n  }\n\n\n  .entry-title {\n    font-size: 18px;\n  }\n\n  /* Mobile adjustments for favorite checkbox */\n  .favorite-checkbox-label {\n    min-width: 24px;\n    height: 24px;\n    padding: 0.2rem;\n  }\n  \n  .favorite-icon {\n    font-size: 1rem;\n  }\n\n  .english-text {\n    font-size: 14px;\n  }\n\n  .korean-text {\n    font-size: 12px;\n  }\n\n  /* Better spacing for mobile dictionary items */\n  .dictionary-item {\n    margin-bottom: 15px;\n  }\n\n  /* Extra padding for mobile floating controller */\n  .scripts-content,\n  .dictionary-content {\n    padding-bottom: 80px;\n    /* Space for fixed bottom controller */\n  }\n\n  /* Mobile YouTube adjustments */\n  .youtube-section {\n    height: 35%; /*    */\n    z-index: 10;\n    flex-shrink: 0;\n  }\n  \n  .translation-items-section {\n    flex: 1;\n    padding: 8px;\n    padding-bottom: 70px;\n  }\n  \n  .translation-item {\n    margin-bottom: 3px;\n  }\n  \n  .translation-text {\n    font-size: 14px;\n  }\n\n  .scripts-content.with-youtube {\n    height: calc(45vh - 40px);\n    overflow-y: auto;\n    padding: 0;\n  }\n\n  .script-item {\n    border-radius: 6px;\n    padding: 0 !important;\n    margin-bottom: 3px;\n  }\n\n  .script-block {\n    padding: 0 !important;\n    margin: 0 !important;\n  }\n\n  .english-text {\n    font-size: 13px;\n    margin-bottom: 2px;\n    padding: 6px 8px !important;\n  }\n\n  .korean-text {\n    font-size: 11px;\n    margin-top: 1px;\n      border-top: 0px solid #e0e0e0;\n    padding: 0 !important;\n  }\n\n  .scripts-content {\n    gap: 3px;\n    padding: 8px;\n  }\n}\n\n/* Scrollbar Styling */\n.dictionary-section::-webkit-scrollbar,\n.scripts-section::-webkit-scrollbar {\n  width: 6px;\n}\n\n.dictionary-section::-webkit-scrollbar-track,\n.scripts-section::-webkit-scrollbar-track {\n  background: #f1f1f1;\n}\n\n.dictionary-section::-webkit-scrollbar-thumb,\n.scripts-section::-webkit-scrollbar-thumb {\n  background: #c1c1c1;\n  border-radius: 3px;\n}\n\n.dictionary-section::-webkit-scrollbar-thumb:hover,\n.scripts-section::-webkit-scrollbar-thumb:hover {\n  background: #a8a8a8;\n}\n\n/* W\nord highlighting */\n.word {\n  display: inline-block;\n  margin-right: 1px;\n  padding: 1px 2px;\n  border-radius: 2px;\n  transition: all 0.3s ease;\n  -webkit-tap-highlight-color: transparent;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  user-select: none;\n  border: 2px solid transparent;\n}\n\n.word.highlighted {\n  background-color: #ffeb3b !important;\n  color: #333 !important;\n  font-weight: 600 !important;\n  box-shadow: 0 2px 4px rgba(255, 235, 59, 0.4) !important;\n  border: 2px solid #fdd835 !important;\n  outline: none !important;\n  -webkit-tap-highlight-color: transparent !important;\n}\n\n.clickable-word {\n  cursor: pointer;\n  transition: all 0.2s ease;\n  -webkit-tap-highlight-color: transparent;\n}\n\n.clickable-word:hover:not(.highlighted) {\n  background-color: #e3f2fd;\n  color: #1976d2;\n  transform: scale(1.05);\n}\n\n/* iOS specific styles */\n@media (max-width: 768px) {\n  .clickable-word:active:not(.highlighted) {\n    background-color: #e3f2fd;\n    color: #1976d2;\n    transform: scale(1.02);\n  }\n}\n\n/* Floating Controller */\n.floating-controller {\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background: rgba(255, 255, 255, 0.95);\n  backdrop-filter: blur(10px);\n  padding: 12px 20px;\n  box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.15);\n  border-top: 1px solid rgba(0, 0, 0, 0.1);\n  z-index: 1000;\n}\n\n.controller-content {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n}\n\n.control-btn {\n  width: 32px;\n  height: 32px;\n  border: none;\n  border-radius: 50%;\n  background: #f5f5f5;\n  color: #666;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.3s ease;\n  font-size: 12px;\n}\n\n.control-btn:hover:not(:disabled) {\n  background: #e0e0e0;\n  color: #333;\n  transform: scale(1.05);\n}\n\n.control-btn:disabled {\n  opacity: 0.4;\n  cursor: not-allowed;\n}\n\n.translation-btn.active {\n  background: #2196f3;\n  color: white;\n}\n\n.translation-btn.active:hover {\n  background: #1976d2;\n}\n\n.sound-btn.active {\n  background: #4caf50;\n  color: white;\n}\n\n.sound-btn.active:hover {\n  background: #388e3c;\n}\n\n.play-btn {\n  background: #f5f5f5;\n  color: #666;\n}\n\n.play-btn:hover {\n  background: #e0e0e0;\n  color: #333;\n}\n\n.play-btn.playing {\n  background: #ff9800;\n  color: white;\n  animation: pulse 1.5s infinite;\n}\n\n.play-btn.playing:hover {\n  background: #f57c00;\n}\n\n@keyframes pulse {\n  0% {\n    transform: scale(1);\n  }\n\n  50% {\n    transform: scale(1.05);\n  }\n\n  100% {\n    transform: scale(1);\n  }\n}\n\n.word-slider-container {\n  flex: 1;\n  min-width: 200px;\n  display: flex;\n  align-items: center;\n}\n\n.word-slider {\n  width: 100%;\n  height: 6px;\n  border-radius: 3px;\n  background: #ddd;\n  outline: none;\n  -webkit-appearance: none;\n  appearance: none;\n}\n\n.word-slider::-webkit-slider-thumb {\n  -webkit-appearance: none;\n  appearance: none;\n  width: 20px;\n  height: 20px;\n  border-radius: 50%;\n  background: #2196f3;\n  cursor: pointer;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n  transition: all 0.3s ease;\n}\n\n.word-slider::-webkit-slider-thumb:hover {\n  transform: scale(1.2);\n  background: #1976d2;\n}\n\n.word-slider::-moz-range-thumb {\n  width: 20px;\n  height: 20px;\n  border-radius: 50%;\n  background: #2196f3;\n  cursor: pointer;\n  border: none;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n}\n\n/* Tablet adjustments (medium screens) */\n@media (max-width: 1024px) and (min-width: 769px) {\n  .floating-controller {\n    padding: 10px 18px;\n  }\n\n  .controller-content {\n    gap: 10px;\n  }\n\n  .control-btn {\n    width: 30px;\n    height: 30px;\n    font-size: 11px;\n  }\n\n  .word-slider-container {\n    flex: 1;\n    min-width: 160px;\n  }\n}\n\n/* Mobile adjustments (small screens) */\n@media (max-width: 768px) {\n  .floating-controller {\n    padding: 10px 15px;\n  }\n\n  .controller-content {\n    gap: 8px;\n  }\n\n  .control-btn {\n    width: 28px;\n    height: 28px;\n    font-size: 10px;\n  }\n\n  .word-slider-container {\n    flex: 1;\n    min-width: 120px;\n  }\n\n  .word {\n    margin-right: 1px;\n    padding: 1px 1px;\n  }\n\n  .script-block {\n    padding: 8px 10px;\n  }\n}\n\n/* Loading Spinner */\n.loading-container {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 200px;\n  gap: 20px;\n}\n\n.loading-spinner {\n  width: 40px;\n  height: 40px;\n  border: 4px solid #f3f3f3;\n  border-top: 4px solid #2196f3;\n  border-radius: 50%;\n  animation: spin 1s linear infinite;\n}\n\n@keyframes spin {\n  0% { transform: rotate(0deg); }\n  100% { transform: rotate(360deg); }\n}\n\n.loading-text {\n  color: #666;\n  font-size: 14px;\n  font-weight: 500;\n  animation: pulse-text 1.5s ease-in-out infinite;\n}\n\n@keyframes pulse-text {\n  0%, 100% { opacity: 0.6; }\n  50% { opacity: 1; }\n}\n\n/* Dictionary highlight effect */\n.dictionary-item.highlighted-dictionary {\n  background: linear-gradient(135deg, #fff3cd, #ffeaa7);\n  border: 2px solid #f39c12;\n  box-shadow: 0 8px 25px rgba(243, 156, 18, 0.3);\n  transform: scale(1.02);\n  transition: all 0.3s ease;\n}\n\n.dictionary-item.highlighted-dictionary .entry-title {\n  color: #d68910;\n  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n}\n\n/* Swap Button */\n.swap-button {\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 32px;\n  height: 32px;\n  background: rgba(255, 255, 255, 0.95);\n  border: 1px solid #e0e0e0;\n  border-radius: 50%;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  box-shadow: 0 3px 8px rgba(0, 0, 0, 0.12);\n  backdrop-filter: blur(10px);\n  z-index: 999;\n  color: #666;\n  transition: all 0.3s ease;\n  font-size: 14px;\n}\n\n.swap-button:hover {\n  background: #2196f3;\n  color: white;\n  transform: translate(-50%, -50%) scale(1.1);\n  box-shadow: 0 6px 16px rgba(33, 150, 243, 0.3);\n}\n\n/* Mobile adjustments for swap button */\n@media (max-width: 768px) {\n  .swap-button {\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    width: 28px;\n    height: 28px;\n    font-size: 12px;\n  }\n\n  .swap-button:hover {\n    transform: translate(-50%, -50%) scale(1.1);\n  }\n\n  .player-container.swapped {\n    flex-direction: column-reverse;\n  }\n\n  /* Maintain borders when swapped on mobile */\n  .player-container.swapped .scripts-section {\n    border-top: none;\n    border-bottom: 1px solid #e0e0e0;\n  }\n\n  .player-container.swapped .dictionary-section {\n    border-bottom: none;\n    border-top: 1px solid #e0e0e0;\n  }\n  \n  /* Mobile padding for floating controller */\n  .vtt-subtitles-section {\n    padding-bottom: 70px; /* Slightly less padding on mobile */\n  }\n}\n/* E\nntry Header with Favorite Button */\n.entry-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: flex-start;\n  gap: 0.5rem;\n  margin-bottom: 0.5rem;\n}\n\n.entry-title {\n  flex: 1;\n  margin: 0;\n}\n\n.favorite-btn {\n  background: none;\n  border: none;\n  color: #ccc;\n  cursor: pointer;\n  padding: 0.25rem;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n  font-size: 1.1rem;\n  min-width: 28px;\n  height: 28px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.favorite-btn:hover {\n  color: #ffc107;\n  background: rgba(255, 193, 7, 0.1);\n  transform: scale(1.1);\n}\n\n.favorite-btn.active {\n  color: #ffc107;\n}\n\n.favorite-btn.active:hover {\n  color: #e0a800;\n}\n\n/* Mobile adjustments for favorite button */\n@media (max-width: 768px) {\n  .entry-header {\n    gap: 0.25rem;\n  }\n  \n  .favorite-btn {\n    font-size: 1rem;\n    min-width: 24px;\n    height: 24px;\n    padding: 0.2rem;\n  }\n}/* Respo\nnsive scroll margins for mobile */\n@media (max-width: 768px) {\n  .dictionary-item,\n  .script-item {\n    scroll-margin-top: 60px; /* Smaller margin for mobile header */\n  }\n}\n/*\n Hidden Words Styles */\n.clickable-word.hidden-word {\n  background: #ffecb3;\n  padding: 2px 4px;\n  border-radius: 3px;\n  color: #f57c00;\n  font-weight: 500;\n  transition: all 0.3s ease;\n}\n\n.clickable-word.hidden-word:hover {\n  background: #ffe082;\n  transform: scale(1.05);\n}\n\n.clickable-word.hidden-word.revealed {\n  background: #c8e6c9;\n  color: #2e7d32;\n  animation: revealWord 0.3s ease;\n}\n\n@keyframes revealWord {\n  0% {\n    transform: scale(1);\n    opacity: 0.5;\n  }\n  50% {\n    transform: scale(1.1);\n    opacity: 1;\n  }\n  100% {\n    transform: scale(1);\n    opacity: 1;\n  }\n}\n\n.clickable-word {\n  cursor: pointer;\n  transition: all 0.2s ease;\n  position: relative;\n  z-index: 10; /* Ensure words are above parent */\n}\n\n.clickable-word:hover {\n  color: #1976d2;\n  text-decoration: underline;\n}\n\n.clickable-word.highlighted {\n  background: #fff59d;\n  padding: 2px 4px;\n  border-radius: 3px;\n  font-weight: 600;\n}\n\n/* Prevent parent cue click when clicking on words */\n.vtt-cue .cue-text {\n  pointer-events: none; /* Disable parent text clicks */\n}\n\n.vtt-cue .cue-text .clickable-word {\n  pointer-events: auto; /* Re-enable clicks only on words */\n}\n");

/***/ }),

/***/ "./src/pages/english/player/player.route.component.html":
/*!**************************************************************!*\
  !*** ./src/pages/english/player/player.route.component.html ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("<div class=\"player-container\" dr-attr=\"{class: 'player-container' + (@this@.isSwapped ? ' swapped' : '')}\">\n    <div class=\"dictionary-section\">\n        <!-- Dictionary Loading -->\n        <div class=\"loading-container\" dr-if=\"@this@.isLoadingDictionaries\">\n            <div class=\"loading-spinner\"></div>\n            <div class=\"loading-text\">Loading dictionary...</div>\n        </div>\n        <!-- <button dr-event-click=\"@this@.test()\">zzzzzzzzzzzzzzz</button> -->\n        <div class=\"dictionary-content\" dr-if=\"@this@.dictionaries && !@this@.isLoadingDictionaries\">\n            <div class=\"dictionary-item\" dr-for-of=\"@this@.dictionaries\" dr-option-item-variable-name=\"dict\"\n                dr-attr=\"{'data-original-word': #dict#.originalWord, 'data-match-type': #dict#?.items?.[0].matchType}\">\n                <div dr-if=\"#dict#\" class=\"word-items\" dr-for-of=\"#dict#.items\" dr-option-item-variable-name=\"item\">\n                    <div dr-if=\"#item#\" class=\"word-entry\">\n                        <div class=\"entry-header\">\n                            <h3 class=\"entry-title clickable-title\"\n                                dr-event-click=\"@this@.onEntryTitleClick($element, $event)\">\n                                ${#item#.entry}$</h3>\n                            <label class=\"favorite-checkbox-label\" title=\" /\" dr-if=\"#item#.entry\">\n                                <input type=\"checkbox\" class=\"favorite-checkbox\"\n                                    dr-attr=\"{checked: @this@.checkWordFavorite(#item#?.entry || '') ? 'checked' : null}\"\n                                    dr-event-change=\"@this@?.toggleFavorite(#item#?.entry || '', #item#?.pos?.[0]?.meanings?.[0]?.meaning || #item#?.entry || '')\">\n                                <i class=\"fas fa-star favorite-icon\"></i>\n                            </label>\n                        </div>\n                        <div class=\"pos-list\" dr-for-of=\"#item#.pos\" dr-option-item-variable-name=\"pos\">\n                            <div class=\"pos-type\" dr-attr=\"{class: 'pos-type' + (#pos#.type ? '' : ' pos-type-null')}\">\n                                ${#pos#.type || ''}$</div>\n                            <div class=\"meanings\" dr-for-of=\"#pos#.meanings\" dr-option-item-variable-name=\"meaning\">\n                                <div class=\"meaning-item\">\n                                    <div class=\"meaning-text\">${#meaning#?.meaning}$</div>\n                                    <div class=\"examples\" dr-if=\"#meaning#.examples.length > 0\"\n                                        dr-for-of=\"#meaning#.examples\" dr-option-item-variable-name=\"example\">\n                                        <div class=\"example-item\">\n                                            <div class=\"example-text clickable-example\"\n                                                dr-event-click=\"@this@.onExampleClick($element, $event)\">\n                                                #{#example#?.text}#</div>\n                                            <div class=\"example-translation\">#{#example#?.translatedText}#</div>\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <!-- Dictionary Examples Section -->\n                    <details class=\"examples-section\" dr-if=\"#dict#?.examples && #dict#?.examples?.length > 0\">\n                        <summary class=\"examples-summary\">\n                            <i class=\"fas fa-book-open\"></i>\n                              (${#dict#?.examples.length}$)\n                        </summary>\n                        <div class=\"examples-content\">\n                            <div class=\"example-item\" dr-for-of=\"#dict#?.examples\"\n                                dr-option-item-variable-name=\"example\">\n                                <div class=\"example-text clickable-example\"\n                                    dr-event-click=\"@this@.onExampleClick($element, $event)\">\n                                    #{#example#?.text}#</div>\n                                <div class=\"example-translation\">#{#example#?.translatedText}#</div>\n                            </div>\n                        </div>\n                    </details>\n                </div>\n                <div>\n                    <iframe dr-if=\"!#dict#\" src=\"https://lazycollect.com/assets/dooboostore/adfit/320x50.html\" style=\"width: 100%; height: 50px;\" frameborder=\"0\"></iframe>\n                </div>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"scripts-section\">\n        <!-- Scripts Loading -->\n        <div class=\"loading-container\" dr-if=\"@this@.isLoadingScripts\">\n            <div class=\"loading-spinner\"></div>\n            <div class=\"loading-text\">Loading scripts...</div>\n        </div>\n\n        <!-- YouTube Video Section (only for YouTube content) -->\n        <div class=\"youtube-section\" dr-if=\"@this@.currentItem?.type === 'youtube'\">\n            <div id=\"youtube-player-container\">\n                <!-- YouTube iframe will be inserted here -->\n            </div>\n        </div>\n\n        <!-- Translation Items Section (YouTube only) -->\n        <div class=\"translation-items-section\" dr-if=\"@this@.currentItem?.type === 'youtube'\">\n            <div class=\"translation-content\" dr-if=\"@this@.translations\">\n                <div class=\"translation-item\" dr-for-of=\"@this@.translations\" dr-option-item-variable-name=\"item\"\n                    dr-option-item-index-variable-name=\"index\"\n                    dr-attr=\"{'data-index': #index#, 'data-start-ms': #item#.startMs, 'data-end-ms': #item#.endMs, 'data-type': #item#.type}\"\n                    dr-event-click=\"#item#.type === 'en' && @this@.onTranslationItemClick(#index#, #item#.startMs, #item#.endMs, $event)\">\n                    <div class=\"translation-text\" dr-attr=\"{class: 'translation-text ' + (#item#.type === 'en' ? 'english-text' : 'korean-text')}\">${#item#?.text}$</div>\n                </div>\n            </div>\n        </div>\n        \n        <!-- Fallback for non-YouTube content -->\n        <div class=\"no-content\" dr-if=\"@this@.currentItem?.type !== 'youtube'\">\n            <div class=\"no-content-message\">Only YouTube content is supported</div>\n        </div>\n    </div>\n</div>\n\n<!-- Floating Controller -->\n<div class=\"floating-controller\">\n    <button class=\"control-btn hide-words-btn\" \n        dr-event-click=\"@this@.toggleHideWords()\"\n        dr-attr=\"{class: 'control-btn hide-words-btn' + (@this@.hideWordsEnabled ? ' active' : '')}\"\n        title=\"Hide random words\">\n        <i class=\"fas fa-eye-slash\"></i>\n    </button>\n    \n    <button class=\"control-btn auto-play-btn\" \n        dr-event-click=\"@this@.toggleAutoPlay()\"\n        dr-attr=\"{class: 'control-btn auto-play-btn' + (@this@.autoPlayEnabled ? ' active' : '')}\"\n        title=\"Toggle auto play\">\n        <i class=\"fas fa-circle-play\"></i>\n    </button>\n    \n    <button class=\"control-btn replay-btn\" \n        dr-event-click=\"@this@.replayCurrentCue()\"\n        title=\"Replay current subtitle\">\n        <i class=\"fas fa-rotate-right\"></i>\n    </button>\n    \n    <button class=\"nav-btn prev-btn\" \n        dr-event-click=\"@this@.previousCue()\"\n        title=\"Previous subtitle\">\n        <i class=\"fas fa-chevron-left\"></i>\n    </button>\n    \n    <div class=\"slider-container\">\n        <input type=\"range\" \n            class=\"global-word-slider\" \n            min=\"-1\" \n            dr-attr=\"{max: @this@.maxGlobalWordIndex, value: @this@.globalWordIndex}\"\n            dr-event-input=\"@this@.onGlobalWordSliderChange(parseInt($event.target.value))\"\n            title=\"Navigate through all words\">\n        <div class=\"slider-label-container\">\n            <button class=\"word-nav-btn\" \n                dr-event-click=\"@this@.previousWord()\"\n                title=\"Previous word\">\n                <i class=\"fas fa-chevron-left\"></i>\n            </button>\n            <div class=\"slider-label\" dr-if=\"@this@.globalWordIndex >= 0\">${@this@.globalWordIndex + 1}$ / ${@this@.maxGlobalWordIndex + 1}$</div>\n            <div class=\"slider-label\" dr-if=\"@this@.globalWordIndex < 0\">Select word</div>\n            <button class=\"word-nav-btn\" \n                dr-event-click=\"@this@.nextWord()\"\n                title=\"Next word\">\n                <i class=\"fas fa-chevron-right\"></i>\n            </button>\n        </div>\n    </div>\n    \n    <button class=\"nav-btn next-btn\" \n        dr-event-click=\"@this@.nextCue()\"\n        title=\"Next subtitle\">\n        <i class=\"fas fa-chevron-right\"></i>\n    </button>\n    \n    <button class=\"control-btn korean-translation-btn\" \n        dr-event-click=\"@this@.toggleKoreanTranslation()\"\n        dr-attr=\"{class: 'control-btn korean-translation-btn' + (@this@.showKoreanTranslation ? ' active' : '')}\"\n        title=\"Toggle Korean translation\">\n        <i class=\"fas fa-language\"></i>\n    </button>\n</div>\n\n");

/***/ }),

/***/ "./src/pages/english/player/player.route.component.ts":
/*!************************************************************!*\
  !*** ./src/pages/english/player/player.route.component.ts ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   PlayerRouteComponent: () => (/* binding */ PlayerRouteComponent)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/simple-boot-front/decorators/Component */ "../../packages/@dooboostore/simple-boot-front/src/decorators/Component.ts");
/* harmony import */ var _player_route_component_html__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./player.route.component.html */ "./src/pages/english/player/player.route.component.html");
/* harmony import */ var _player_route_component_css__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./player.route.component.css */ "./src/pages/english/player/player.route.component.css");
/* harmony import */ var _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @dooboostore/simple-boot/fetch/ApiService */ "../../packages/@dooboostore/simple-boot/src/fetch/ApiService.ts");
/* harmony import */ var _dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @dooboostore/core-web/valid/ValidUtils */ "../../packages/@dooboostore/core-web/src/valid/ValidUtils.ts");
/* harmony import */ var _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @dooboostore/dom-render/components/ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _src_service_english_VideoItemService__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @src/service/english/VideoItemService */ "./src/service/english/VideoItemService.ts");
/* harmony import */ var _src_service_VoiceService__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @src/service/VoiceService */ "./src/service/VoiceService.ts");
/* harmony import */ var _src_service_english_AutoTranslationService__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @src/service/english/AutoTranslationService */ "./src/service/english/AutoTranslationService.ts");
/* harmony import */ var _src_service_english_DictionaryService__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @src/service/english/DictionaryService */ "./src/service/english/DictionaryService.ts");
var _a, _b, _c, _d, _e;












let PlayerRouteComponent = class PlayerRouteComponent extends _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_7__.ComponentBase {
    apiService;
    videoItemService;
    voiceService;
    autoTranslationService;
    dictionaryService;
    name;
    dictionaries;
    currentItem;
    translations;
    allTranslations; //   ( + )
    currentActiveIndex = -1;
    // Favorite functions passed from parent router
    addToFavorites;
    removeFavorite;
    isWordFavorite;
    showTranslation = false;
    autoPlayEnabled = false;
    hideWordsEnabled = false;
    soundEnabled = true;
    showKoreanTranslation = false;
    isPlayingScript = false;
    isPlayingWord = false;
    isLoadingScripts = true;
    isLoadingDictionaries = false;
    scrollTimeout;
    wordHighlightInterval;
    youtubePlayer;
    youtubePlayerReady = false;
    userManuallySelected = false;
    lastManualSelectionTime = 0;
    playButtonClicked = false;
    cuePlayCheckInterval;
    hiddenWordIndices = new Set();
    youtubeTimeMonitoringInterval;
    timeouts = [];
    intervals = [];
    // Global word slider for all items
    globalWordIndex = -1;
    maxGlobalWordIndex = 0;
    allWords = [];
    wordToItemMap = new Map();
    constructor(apiService, videoItemService, voiceService, autoTranslationService, dictionaryService) {
        super();
        this.apiService = apiService;
        this.videoItemService = videoItemService;
        this.voiceService = voiceService;
        this.autoTranslationService = autoTranslationService;
        this.dictionaryService = dictionaryService;
    }
    onCreateRender(param) {
        console.log('PlayerRouteComponent onCreateRender called with params:', param);
        if (param && param) {
            this.addToFavorites = param.addToFavorites;
            this.removeFavorite = param.removeFavorite;
            this.isWordFavorite = param.isWordFavorite;
            console.log('Received favorite functions from parent router');
        }
        else {
            console.warn('No createArguments found in param');
        }
    }
    async onRawSetRendered(rawSet, otherData) {
        await super.onRawSetRendered(rawSet, otherData);
    }
    async onRouting(r) {
        this.name = undefined;
        this.dictionaries = undefined;
        this.currentItem = undefined;
        this.translations = undefined;
        this.allTranslations = undefined;
        this.currentActiveIndex = -1;
        const routingStartTime = performance.now();
        console.log(' [PERF] onRouting started');
        this.name = decodeURIComponent(r.routerModule.pathData?.name ?? '');
        console.log('Routing to PlayerRouteComponent with name:', this.name);
        if (_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_6__.ValidUtils.isBrowser() && this.name) {
            try {
                this.isLoadingScripts = true;
                console.log(` [PERF] isLoadingScripts set to true: ${(performance.now() - routingStartTime).toFixed(2)}ms`);
                // Load video item first
                const itemStartTime = performance.now();
                this.currentItem = await this.videoItemService.item(this.name);
                console.log(` [PERF] videoItemService.item loaded: ${(performance.now() - itemStartTime).toFixed(2)}ms`);
                console.log(` Current item:`, this.currentItem);
                // Load translations (all content is YouTube type)
                const translationStartTime = performance.now();
                await this.loadTranslations();
                console.log(` [PERF] loadTranslations completed: ${(performance.now() - translationStartTime).toFixed(2)}ms`);
                // Hide loading screen immediately after translations are loaded
                this.isLoadingScripts = false;
                console.log(` [PERF] isLoadingScripts set to false: ${(performance.now() - routingStartTime).toFixed(2)}ms`);
                // Initialize YouTube player after translations are loaded
                setTimeout(() => {
                    const youtubeStartTime = performance.now();
                    this.createYouTubeEmbed();
                    console.log(` [PERF] createYouTubeEmbed called: ${(performance.now() - youtubeStartTime).toFixed(2)}ms`);
                }, 300);
                console.log(' Voice service ready');
                console.log(` [PERF]  Total onRouting time: ${(performance.now() - routingStartTime).toFixed(2)}ms`);
            }
            catch (error) {
                console.error('Failed to load data:', error);
                this.isLoadingScripts = false;
            }
        }
    }
    async onInitRender(param, rawSet) {
        await super.onInitRender(param, rawSet);
    }
    async loadTranslations() {
        if (!this.name)
            return;
        const loadStartTime = performance.now();
        try {
            console.log(' Loading translations...');
            // Load translation script (English + Korean)
            const fetchStart = performance.now();
            this.allTranslations = await this.autoTranslationService.getTranslationScript(this.name);
            console.log(` [PERF] Translation fetch: ${(performance.now() - fetchStart).toFixed(2)}ms`);
            // console.log('allTranslations------->', this.allTranslations);
            console.log(` Loaded ${this.allTranslations.length} translation items`);
            //   
            this.filterTranslations();
            // Build global word index from all translations
            const buildIndexStart = performance.now();
            this.buildGlobalWordIndex();
            console.log(` [PERF] buildGlobalWordIndex: ${(performance.now() - buildIndexStart).toFixed(2)}ms`);
            //      - UI  
            if (this.translations && this.translations.length > 0) {
                console.log(` [PERF] About to call requestAnimationFrame for selectFirstItem`);
                const beforeRAF = performance.now();
                requestAnimationFrame(() => {
                    const rafStart = performance.now();
                    console.log(` [PERF] requestAnimationFrame delay: ${(rafStart - beforeRAF).toFixed(2)}ms`);
                    this.selectFirstItem();
                    console.log(` [PERF] selectFirstItem callback completed: ${(performance.now() - rafStart).toFixed(2)}ms`);
                });
                console.log(` [PERF] requestAnimationFrame scheduled: ${(performance.now() - beforeRAF).toFixed(2)}ms`);
            }
            console.log(` [PERF]  Total loadTranslations time: ${(performance.now() - loadStartTime).toFixed(2)}ms`);
        }
        catch (error) {
            console.error('Failed to load translations:', error);
            this.translations = [];
        }
    }
    buildGlobalWordIndex() {
        const buildStartTime = performance.now();
        if (!this.allTranslations)
            return;
        const allWords = [];
        const wordToItemMap = new Map();
        let globalIndex = 0;
        const items = this.allTranslations; //     
        const itemsLength = items.length;
        for (let itemIndex = 0; itemIndex < itemsLength; itemIndex++) {
            const item = items[itemIndex];
            //     
            if (item.type === 'en') {
                const words = item.text.split(/\s+/);
                const wordsLength = words.length;
                for (let i = 0; i < wordsLength; i++) {
                    allWords.push(words[i]);
                    wordToItemMap.set(globalIndex, itemIndex); // allTranslations   
                    globalIndex++;
                }
            }
        }
        this.allWords = allWords;
        this.wordToItemMap = wordToItemMap;
        this.maxGlobalWordIndex = Math.max(0, allWords.length - 1);
        console.log(` Built global word index: ${allWords.length} words across ${itemsLength} items`);
        console.log(` [PERF] buildGlobalWordIndex actual time: ${(performance.now() - buildStartTime).toFixed(2)}ms`);
    }
    selectFirstItem() {
        if (!_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_6__.ValidUtils.isBrowser() || !this.translations || this.translations.length === 0) {
            return;
        }
        const selectStartTime = performance.now();
        console.log(' Auto-selecting first translation item');
        this.currentActiveIndex = 0;
        console.log(` [PERF] Set currentActiveIndex: ${(performance.now() - selectStartTime).toFixed(2)}ms`);
        const stylingStart = performance.now();
        this.updateActiveItemStyling();
        console.log(` [PERF] updateActiveItemStyling: ${(performance.now() - stylingStart).toFixed(2)}ms`);
        const sliderStart = performance.now();
        this.updateItemWordSliderRange();
        console.log(` [PERF] updateItemWordSliderRange: ${(performance.now() - sliderStart).toFixed(2)}ms`);
        requestAnimationFrame(() => {
            const clickableStart = performance.now();
            this.makeActiveItemWordsClickable();
            console.log(` [PERF] makeActiveItemWordsClickable: ${(performance.now() - clickableStart).toFixed(2)}ms`);
            console.log(' First item auto-selected and words made clickable');
        });
        setTimeout(() => {
            if (this.translations && this.translations.length > 0) {
                const dictStart = performance.now();
                //     
                const firstEnglishItem = this.translations.find(item => item.type === 'en');
                if (firstEnglishItem) {
                    this.setScript(firstEnglishItem.text);
                }
                console.log(` [PERF] setScript called (async): ${(performance.now() - dictStart).toFixed(2)}ms`);
            }
        }, 50);
        const scrollStart = performance.now();
        this.scrollToActiveItem(0);
        console.log(` [PERF] scrollToActiveItem: ${(performance.now() - scrollStart).toFixed(2)}ms`);
        console.log(` [PERF]  Total selectFirstItem time: ${(performance.now() - selectStartTime).toFixed(2)}ms`);
    }
    updateActiveItemStyling(activeIndices) {
        if (!_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_6__.ValidUtils.isBrowser())
            return;
        const items = document.querySelectorAll('.translation-item');
        if (activeIndices && activeIndices.length > 0) {
            //    
            items.forEach((item, index) => {
                if (activeIndices.includes(index)) {
                    item.classList.add('active');
                    //     
                    if (index === activeIndices[activeIndices.length - 1]) {
                        item.classList.add('last-active');
                    }
                    else {
                        item.classList.remove('last-active');
                    }
                }
                else {
                    item.classList.remove('active', 'last-active');
                }
            });
        }
        else {
            //    ( )
            items.forEach((item, index) => {
                if (index === this.currentActiveIndex) {
                    item.classList.add('active', 'last-active');
                }
                else {
                    item.classList.remove('active', 'last-active');
                }
            });
        }
    }
    updateItemWordSliderRange() {
        if (!_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_6__.ValidUtils.isBrowser() || this.currentActiveIndex < 0 || !this.translations)
            return;
        const item = this.translations[this.currentActiveIndex];
        if (!item || item.type !== 'en')
            return;
        const words = item.text.split(/\s+/);
        const maxIndex = Math.max(0, words.length - 1);
        const slider = document.querySelector('.word-slider');
        if (slider) {
            slider.max = maxIndex.toString();
            slider.value = '-1';
        }
    }
    makeActiveItemWordsClickable() {
        if (!_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_6__.ValidUtils.isBrowser() || this.currentActiveIndex < 0 || !this.translations)
            return;
        const item = this.translations[this.currentActiveIndex];
        if (!item || item.type !== 'en')
            return;
        const items = document.querySelectorAll('.translation-item');
        //       ( )
        items.forEach((itemElement, index) => {
            if (index !== this.currentActiveIndex) {
                const textElement = itemElement.querySelector('.translation-text.english-text');
                if (textElement && this.translations && this.translations[index] && this.translations[index].type === 'en') {
                    const itemData = this.translations[index];
                    //    ( )
                    textElement.textContent = itemData.text;
                }
            }
        });
        const activeItemElement = items[this.currentActiveIndex];
        if (!activeItemElement)
            return;
        const textElement = activeItemElement.querySelector('.translation-text.english-text');
        if (!textElement)
            return;
        const words = item.text.split(/\s+/);
        const htmlContent = words
            .map((word, index) => {
            const isHidden = this.hideWordsEnabled && this.hiddenWordIndices.has(index);
            const displayText = isHidden ? '___' : word;
            const hiddenClass = isHidden ? ' hidden-word' : '';
            return `<span class="word clickable-word${hiddenClass}" data-word-index="${index}" data-original-word="${word}">${displayText}</span>`;
        })
            .join(' ');
        textElement.innerHTML = htmlContent;
        textElement.querySelectorAll('.clickable-word').forEach((wordElement, index) => {
            wordElement.addEventListener('click', (event) => {
                event.preventDefault();
                event.stopPropagation();
                event.stopImmediatePropagation();
                console.log(` Word clicked: ${wordElement.textContent}`);
                if (wordElement.classList.contains('hidden-word')) {
                    const originalWord = wordElement.getAttribute('data-original-word');
                    if (originalWord) {
                        wordElement.textContent = originalWord;
                        wordElement.classList.add('revealed');
                        setTimeout(() => {
                            if (this.hideWordsEnabled && wordElement.classList.contains('hidden-word')) {
                                wordElement.textContent = '___';
                                wordElement.classList.remove('revealed');
                            }
                        }, 2000);
                    }
                }
                const slider = document.querySelector('.word-slider');
                if (slider) {
                    slider.value = index.toString();
                }
                const globalWordIndex = this.getGlobalWordIndexForItem(this.currentActiveIndex) + index;
                this.globalWordIndex = globalWordIndex;
                this.onItemWordSliderChange(index);
                return false;
            }, true);
        });
        console.log(` Made ${words.length} words clickable for item ${this.currentActiveIndex}`);
    }
    scrollToActiveItem(index) {
        if (!_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_6__.ValidUtils.isBrowser())
            return;
        const items = document.querySelectorAll('.translation-item');
        if (items[index]) {
            items[index].scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }
    }
    getGlobalWordIndexForItem(translationsItemIndex) {
        if (!this.translations || !this.allTranslations)
            return 0;
        // translations  allTranslations  
        const targetItem = this.translations[translationsItemIndex];
        if (!targetItem)
            return 0;
        const allTranslationsItemIndex = this.allTranslations.findIndex(item => item.startMs === targetItem.startMs &&
            item.endMs === targetItem.endMs &&
            item.type === targetItem.type);
        if (allTranslationsItemIndex === -1)
            return 0;
        // allTranslations      
        let globalIndex = 0;
        for (let i = 0; i < allTranslationsItemIndex; i++) {
            if (this.allTranslations[i] && this.allTranslations[i].type === 'en') {
                globalIndex += this.allTranslations[i].text.split(/\s+/).length;
            }
        }
        return globalIndex;
    }
    onItemWordSliderChange(wordIndex) {
        if (!_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_6__.ValidUtils.isBrowser() || this.currentActiveIndex < 0 || !this.translations)
            return;
        const item = this.translations[this.currentActiveIndex];
        if (!item || item.type !== 'en')
            return;
        const words = item.text.split(/\s+/);
        if (wordIndex < 0 || wordIndex >= words.length) {
            this.updateItemWordHighlighting(-1);
            return;
        }
        const word = words[wordIndex];
        console.log(` Word slider: ${wordIndex} - "${word}"`);
        this.updateItemWordHighlighting(wordIndex);
        this.scrollToDictionaryWordByText(word);
        if (this.soundEnabled) {
            this.speakWord(word);
        }
    }
    updateItemWordHighlighting(wordIndex) {
        if (!_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_6__.ValidUtils.isBrowser() || this.currentActiveIndex < 0)
            return;
        const items = document.querySelectorAll('.translation-item');
        const activeItem = items[this.currentActiveIndex];
        if (!activeItem)
            return;
        const wordElements = activeItem.querySelectorAll('.clickable-word');
        wordElements.forEach((wordElement, index) => {
            if (index === wordIndex) {
                wordElement.classList.add('highlighted');
            }
            else {
                wordElement.classList.remove('highlighted');
            }
        });
    }
    formatTime(seconds) {
        const mins = Math.floor(seconds / 60);
        const secs = Math.floor(seconds % 60);
        return `${mins}:${secs.toString().padStart(2, '0')}`;
    }
    formatTimeMs(milliseconds) {
        const seconds = milliseconds / 1000;
        return this.formatTime(seconds);
    }
    onTranslationItemClick(index, startMs, endMs, event) {
        console.log(' onTranslationItemClick called with index:', index, 'startMs:', startMs, 'endMs:', endMs);
        if (event) {
            const target = event.target;
            if (target && target.classList.contains('clickable-word')) {
                console.log(' Click on word detected - ignoring item click');
                return;
            }
        }
        console.log(` Translation item clicked: ${index} at ${startMs}ms - ${endMs}ms`);
        this.stopCuePlayCheck();
        this.userManuallySelected = true;
        this.lastManualSelectionTime = Date.now();
        if (this.autoPlayEnabled) {
            this.autoPlayEnabled = false;
            console.log(' Auto play disabled - user manually selected item');
        }
        this.currentActiveIndex = index;
        this.updateActiveItemStyling();
        this.updateGlobalSliderPosition(index);
        if (this.youtubePlayer && this.youtubePlayerReady) {
            const startSeconds = startMs / 1000;
            const endSeconds = endMs / 1000;
            this.youtubePlayer.seekTo(startSeconds, true);
            setTimeout(() => {
                if (this.youtubePlayer && this.youtubePlayerReady) {
                    this.youtubePlayer.playVideo();
                    console.log(` Playing segment: ${startSeconds}s - ${endSeconds}s`);
                    // setTimeout(() => {
                    this.startCuePlayCheck(endSeconds);
                    // }, 100);
                }
            }, 100);
        }
        if (this.translations && this.translations[index] && this.translations[index].type === 'en') {
            this.setScript(this.translations[index].text);
            this.updateItemWordSliderRange();
            this.makeActiveItemWordsClickable();
        }
        console.log(' Manual selection mode - auto-selection disabled until auto play is enabled');
    }
    onItemTimeClick(event, text) {
        event.stopPropagation();
        console.log(` Time clicked, playing: "${text.substring(0, 50)}..."`);
        if (this.soundEnabled) {
            this.speakScript(text);
        }
        else {
            console.log(' Sound is disabled');
        }
    }
    updateGlobalSliderPosition(itemIndex) {
        const globalIndex = this.getGlobalWordIndexForItem(itemIndex);
        this.globalWordIndex = globalIndex;
        console.log(` Updated global slider to position ${globalIndex} for item ${itemIndex}`);
    }
    toggleSound() {
        this.soundEnabled = !this.soundEnabled;
        if (!this.soundEnabled && _dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_6__.ValidUtils.isBrowser()) {
            this.stopSpeech();
        }
    }
    toggleTranslation() {
        this.showTranslation = !this.showTranslation;
        console.log(` Translation: ${this.showTranslation ? 'shown' : 'hidden'}`);
    }
    toggleKoreanTranslation() {
        this.showKoreanTranslation = !this.showKoreanTranslation;
        console.log(` Korean translation: ${this.showKoreanTranslation ? 'shown' : 'hidden'}`);
        //      
        let currentStartMs = -1;
        let currentEndMs = -1;
        if (this.currentActiveIndex >= 0 && this.translations && this.translations[this.currentActiveIndex]) {
            currentStartMs = this.translations[this.currentActiveIndex].startMs;
            currentEndMs = this.translations[this.currentActiveIndex].endMs;
        }
        //    
        this.filterTranslations();
        //       
        if (currentStartMs >= 0 && this.translations) {
            //     
            const newIndex = this.translations.findIndex(item => item.type === 'en' && item.startMs === currentStartMs && item.endMs === currentEndMs);
            if (newIndex >= 0) {
                this.currentActiveIndex = newIndex;
                // DOM     
                setTimeout(() => {
                    this.updateActiveItemStyling();
                    this.scrollToActiveItem(newIndex);
                    this.makeActiveItemWordsClickable();
                }, 50);
            }
        }
    }
    filterTranslations() {
        if (!this.allTranslations)
            return;
        if (this.showKoreanTranslation) {
            //   :   
            this.translations = this.allTranslations;
        }
        else {
            //   :  
            this.translations = this.allTranslations.filter(item => item.type === 'en');
        }
        console.log(` Filtered translations: ${this.translations.length} items (Korean: ${this.showKoreanTranslation ? 'included' : 'excluded'})`);
    }
    toggleAutoPlay() {
        this.autoPlayEnabled = !this.autoPlayEnabled;
        console.log(` Auto play: ${this.autoPlayEnabled ? 'enabled' : 'disabled'}`);
        if (this.autoPlayEnabled) {
            this.userManuallySelected = false;
            console.log(' Auto play enabled - auto-selection re-enabled');
            if (this.youtubePlayer && this.youtubePlayerReady) {
                try {
                    if (this.currentActiveIndex >= 0 && this.translations) {
                        const currentItem = this.translations[this.currentActiveIndex];
                        if (currentItem) {
                            this.youtubePlayer.seekTo(currentItem.startMs / 1000, true);
                            console.log(` Seeking to current item at ${currentItem.startMs / 1000}s`);
                        }
                    }
                    const playerState = this.youtubePlayer.getPlayerState();
                    if (playerState === 2 || playerState === 5 || playerState === -1 || playerState === 0) {
                        this.youtubePlayer.playVideo();
                        console.log(' Auto play enabled - started playing from current position');
                    }
                }
                catch (error) {
                    console.log(' Could not start playback:', error);
                }
            }
        }
    }
    toggleHideWords() {
        this.hideWordsEnabled = !this.hideWordsEnabled;
        console.log(` Hide words: ${this.hideWordsEnabled ? 'enabled' : 'disabled'}`);
        if (this.currentActiveIndex < 0) {
            console.warn(' No active item - cannot hide words');
            this.hideWordsEnabled = false;
            return;
        }
        if (this.hideWordsEnabled) {
            this.generateHiddenWordIndices();
        }
        else {
            this.hiddenWordIndices.clear();
        }
        this.makeActiveItemWordsClickable();
    }
    generateHiddenWordIndices() {
        if (!this.translations || this.currentActiveIndex < 0)
            return;
        this.hiddenWordIndices.clear();
        const item = this.translations[this.currentActiveIndex];
        if (!item || item.type !== 'en')
            return;
        const words = item.text.split(/\s+/);
        const totalWords = words.length;
        const wordsToHide = Math.floor(totalWords * 0.3);
        const availableIndices = Array.from({ length: totalWords }, (_, i) => i);
        for (let i = 0; i < wordsToHide; i++) {
            const randomIndex = Math.floor(Math.random() * availableIndices.length);
            const wordIndex = availableIndices[randomIndex];
            this.hiddenWordIndices.add(wordIndex);
            availableIndices.splice(randomIndex, 1);
        }
        console.log(` Hiding ${wordsToHide} out of ${totalWords} words:`, Array.from(this.hiddenWordIndices));
    }
    previousWord() {
        if (this.globalWordIndex <= 0) {
            console.log(' Already at first word');
            return;
        }
        // allWords buildGlobalWordIndex    
        const newIndex = this.globalWordIndex - 1;
        console.log(` Moving to previous word: ${newIndex} (English only)`);
        this.onGlobalWordSliderChange(newIndex);
    }
    nextWord() {
        if (this.globalWordIndex >= this.maxGlobalWordIndex) {
            console.log(' Already at last word');
            return;
        }
        // allWords buildGlobalWordIndex    
        const newIndex = this.globalWordIndex + 1;
        console.log(` Moving to next word: ${newIndex} (English only)`);
        this.onGlobalWordSliderChange(newIndex);
    }
    previousCue() {
        if (!this.translations || this.currentActiveIndex <= 0)
            return;
        //    
        let newIndex = this.currentActiveIndex - 1;
        while (newIndex >= 0 && this.translations[newIndex].type !== 'en') {
            newIndex--;
        }
        if (newIndex < 0)
            return; //    
        const newItem = this.translations[newIndex];
        //   
        this.scrollToActiveItem(newIndex);
        this.onTranslationItemClick(newIndex, newItem.startMs, newItem.endMs);
    }
    nextCue() {
        if (!this.translations || this.currentActiveIndex >= this.translations.length - 1)
            return;
        //    
        let newIndex = this.currentActiveIndex + 1;
        while (newIndex < this.translations.length && this.translations[newIndex].type !== 'en') {
            newIndex++;
        }
        if (newIndex >= this.translations.length)
            return; //    
        const newItem = this.translations[newIndex];
        //   
        this.scrollToActiveItem(newIndex);
        this.onTranslationItemClick(newIndex, newItem.startMs, newItem.endMs);
    }
    onGlobalWordSliderChange(index) {
        this.globalWordIndex = index;
        console.log(` Global word slider: ${index} / ${this.maxGlobalWordIndex}`);
        if (this.autoPlayEnabled) {
            this.autoPlayEnabled = false;
            console.log(' Auto play disabled - user moved slider');
        }
        if (index < 0 || index >= this.allWords.length) {
            return;
        }
        // wordToItemMap allTranslations   
        const allTranslationsItemIndex = this.wordToItemMap.get(index);
        if (allTranslationsItemIndex === undefined)
            return;
        // allTranslations  translations  
        const translationsItemIndex = this.convertAllTranslationsIndexToTranslationsIndex(allTranslationsItemIndex);
        if (translationsItemIndex === -1)
            return;
        if (translationsItemIndex !== this.currentActiveIndex) {
            this.currentActiveIndex = translationsItemIndex;
            this.updateActiveItemStyling();
            if (this.translations && this.translations[translationsItemIndex] && this.translations[translationsItemIndex].type === 'en') {
                this.setScript(this.translations[translationsItemIndex].text);
                this.updateItemWordSliderRange();
                this.makeActiveItemWordsClickable();
            }
            this.scrollToActiveItem(translationsItemIndex);
        }
        if (this.youtubePlayer && this.youtubePlayerReady && this.allTranslations && this.allTranslations[allTranslationsItemIndex]) {
            try {
                const item = this.allTranslations[allTranslationsItemIndex];
                this.youtubePlayer.seekTo(item.startMs / 1000, true);
                this.youtubePlayer.pauseVideo();
                console.log(` Seeked YouTube to item ${allTranslationsItemIndex} at ${item.startMs / 1000}s and paused`);
            }
            catch (error) {
                console.error('Failed to seek YouTube:', error);
            }
        }
        const localWordIndex = this.getLocalWordIndex(index);
        this.highlightGlobalWord(index, localWordIndex);
        const word = this.allWords[index];
        if (word) {
            this.scrollToDictionaryWordByText(word);
            if (this.soundEnabled) {
                this.speakWord(word);
            }
        }
    }
    convertAllTranslationsIndexToTranslationsIndex(allTranslationsIndex) {
        if (!this.allTranslations || !this.translations)
            return -1;
        // allTranslations   
        const targetItem = this.allTranslations[allTranslationsIndex];
        if (!targetItem)
            return -1;
        // translations    (startMs endMs )
        const translationsIndex = this.translations.findIndex(item => item.startMs === targetItem.startMs &&
            item.endMs === targetItem.endMs &&
            item.type === targetItem.type);
        return translationsIndex;
    }
    getLocalWordIndex(globalIndex) {
        const allTranslationsItemIndex = this.wordToItemMap.get(globalIndex);
        if (allTranslationsItemIndex === undefined)
            return -1;
        // allTranslations     
        let wordsBefore = 0;
        for (let i = 0; i < allTranslationsItemIndex; i++) {
            if (this.allTranslations && this.allTranslations[i] && this.allTranslations[i].type === 'en') {
                wordsBefore += this.allTranslations[i].text.split(/\s+/).length;
            }
        }
        return globalIndex - wordsBefore;
    }
    highlightGlobalWord(globalIndex, localIndex) {
        if (!_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_6__.ValidUtils.isBrowser())
            return;
        const allWords = document.querySelectorAll('.clickable-word');
        allWords.forEach(word => word.classList.remove('highlighted'));
        const allTranslationsItemIndex = this.wordToItemMap.get(globalIndex);
        if (allTranslationsItemIndex === undefined)
            return;
        // allTranslations  translations  
        const translationsItemIndex = this.convertAllTranslationsIndexToTranslationsIndex(allTranslationsItemIndex);
        if (translationsItemIndex === -1)
            return;
        const items = document.querySelectorAll('.translation-item');
        const targetItem = items[translationsItemIndex];
        if (!targetItem)
            return;
        const wordElements = targetItem.querySelectorAll('.clickable-word');
        if (wordElements[localIndex]) {
            wordElements[localIndex].classList.add('highlighted');
            wordElements[localIndex].scrollIntoView({
                behavior: 'smooth',
                block: 'center'
            });
        }
    }
    replayCurrentCue() {
        if (!this.translations || this.currentActiveIndex < 0)
            return;
        const currentItem = this.translations[this.currentActiveIndex];
        this.onTranslationItemClick(this.currentActiveIndex, currentItem.startMs, currentItem.endMs);
    }
    speakWord(word) {
        if (!this.soundEnabled)
            return;
        this.voiceService.speakWord(word);
    }
    stopSpeech() {
        const { wasPlayingScript, wasPlayingWord } = this.voiceService.stopSpeech();
        this.isPlayingScript = false;
        this.isPlayingWord = false;
        if (wasPlayingScript) {
            this.stopRangeAnimation();
        }
        if (wasPlayingScript && !wasPlayingWord) {
            setTimeout(() => {
                const slider = document.querySelector('.word-slider');
                const playing = this.voiceService.isPlaying();
                if (slider && !playing.script && !playing.word) {
                    slider.value = '-1';
                    console.log(` Manual script stop - reset to initial state`);
                }
            }, 100);
        }
    }
    stopRangeAnimation() {
        if (this.wordHighlightInterval) {
            clearInterval(this.wordHighlightInterval);
            this.wordHighlightInterval = undefined;
        }
    }
    speakScript(scriptText) {
        if (!this.soundEnabled)
            return;
        this.stopSpeech();
        this.isPlayingScript = true;
        const slider = document.querySelector('.word-slider');
        if (slider) {
            slider.value = '0';
        }
        this.voiceService.speakScript(scriptText, () => {
            this.isPlayingScript = true;
        }, () => {
            this.isPlayingScript = false;
            this.stopRangeAnimation();
        }, () => {
            this.isPlayingScript = false;
            this.stopRangeAnimation();
        });
    }
    onEntryTitleClick(element, event) {
        event.preventDefault();
        event.stopPropagation();
        if (this.soundEnabled && element) {
            const text = element.innerText || element.textContent;
            if (text) {
                this.speakWord(text);
            }
        }
    }
    onExampleClick(element, event) {
        event.preventDefault();
        event.stopPropagation();
        if (this.soundEnabled && element) {
            const text = element.innerText || element.textContent;
            if (text) {
                this.speakWord(text);
            }
        }
    }
    onDictionaryItemClick(dictionary, event) {
        event.preventDefault();
        event.stopPropagation();
        if (this.soundEnabled && dictionary.items && dictionary.items.length > 0) {
            const firstItem = dictionary.items[0];
            if (firstItem && firstItem.entry) {
                this.speakWord(firstItem.entry);
            }
        }
    }
    resetDictionaryScroll() {
        if (!_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_6__.ValidUtils.isBrowser())
            return;
        requestAnimationFrame(() => {
            const dictionarySection = document.querySelector('.dictionary-section');
            if (dictionarySection) {
                dictionarySection.scrollTop = 0;
                console.log(' Dictionary section scrolled to top');
            }
        });
    }
    scrollToDictionaryWordByText(word) {
        if (!_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_6__.ValidUtils.isBrowser() || !this.dictionaries)
            return;
        const cleanWord = word.replace(/[,.":!?;[\]\-]/g, '').toLowerCase();
        if (!cleanWord)
            return;
        const dictionaryIndex = this.dictionaries.findIndex(dict => dict && dict.originalWord === cleanWord);
        if (dictionaryIndex >= 0) {
            setTimeout(() => {
                const dictionaryItems = document.querySelectorAll('.dictionary-item');
                if (dictionaryItems[dictionaryIndex]) {
                    const targetElement = dictionaryItems[dictionaryIndex];
                    const isMobile = window.innerWidth <= 768;
                    targetElement.scrollIntoView({
                        behavior: 'smooth',
                        block: isMobile ? 'start' : 'center',
                        inline: 'nearest'
                    });
                    targetElement.classList.add('highlighted-dictionary');
                    setTimeout(() => {
                        targetElement.classList.remove('highlighted-dictionary');
                    }, 2000);
                }
            }, 100);
        }
    }
    toggleFavorite(word, meaning) {
        if (!word || !this.addToFavorites || !this.removeFavorite || !this.isWordFavorite) {
            console.warn('Favorite functions not available or word is empty');
            return;
        }
        const isFavorite = this.isWordFavorite(word);
        if (isFavorite) {
            this.removeFavorite(word);
        }
        else {
            this.addToFavorites(word, meaning);
        }
    }
    checkWordFavorite(word) {
        if (!word || !this.isWordFavorite) {
            return false;
        }
        return this.isWordFavorite(word);
    }
    async setScript(script) {
        const startTime = performance.now();
        console.log(' setScript started');
        try {
            this.isLoadingDictionaries = false;
            const rawWords = script.split(/\s+/);
            const uniqueWords = new Set();
            const punctuationRegex = /[,.":!?;[\]\-]/g;
            for (let i = 0; i < rawWords.length; i++) {
                const word = rawWords[i];
                if (word) {
                    const cleanWord = word.replace(punctuationRegex, '').toLowerCase();
                    if (cleanWord) {
                        uniqueWords.add(cleanWord);
                    }
                }
            }
            const cleanWords = Array.from(uniqueWords);
            const cleaningTime = performance.now();
            console.log(` Word cleaning time: ${(cleaningTime - startTime).toFixed(2)}ms (${cleanWords.length} unique words from ${rawWords.length} total)`);
            // DictionaryService   
            const fetchStart = performance.now();
            const dictionaries = [];
            (await this.dictionaryService.getWords(cleanWords)).forEach((word, index) => {
                dictionaries.push(word);
                if (index > 0 && Math.random() < 0.3) {
                    dictionaries.push(null);
                }
            });
            this.dictionaries = dictionaries;
            const fetchTime = performance.now();
            console.log(` DictionaryService fetch time: ${(fetchTime - fetchStart).toFixed(2)}ms (${cleanWords.length} unique words)`);
            console.log(` Cache size: ${this.dictionaryService.getCacheSize()} items`);
            //      
            this.resetDictionaryScroll();
            const finalTime = performance.now();
            console.log(` Total setScript time: ${(finalTime - startTime).toFixed(2)}ms`);
        }
        catch (error) {
            console.error('Failed to load dictionaries:', error);
        }
        finally {
            this.isLoadingDictionaries = false;
        }
    }
    startYouTubeTimeMonitoring() {
        if (!this.youtubePlayer || !this.youtubePlayerReady) {
            return;
        }
        console.log(' Started YouTube time monitoring (every 200ms)');
        this.youtubeTimeMonitoringInterval = setInterval(() => {
            if (this.youtubePlayer && this.youtubePlayerReady) {
                try {
                    const playerState = this.youtubePlayer.getPlayerState();
                    if (playerState === 1) {
                        const currentTime = this.youtubePlayer.getCurrentTime();
                        this.updateScriptSelectionByTime(currentTime);
                    }
                }
                catch (error) {
                    // Ignore errors
                }
            }
        }, 5);
        if (this.youtubeTimeMonitoringInterval)
            this.intervals.push(this.youtubeTimeMonitoringInterval);
    }
    updateScriptSelectionByTime(currentTime) {
        // console.log(` YouTube time: ${currentTime.toFixed(2)}s`);
        if (this.userManuallySelected) {
            console.log(' Skipping auto-selection - user manually selected');
            return;
        }
        if (this.playButtonClicked) {
            console.log(' Skipping auto-selection - play button is active');
            return;
        }
        if (currentTime < 1)
            return;
        try {
            const playerState = this.youtubePlayer?.getPlayerState();
            if (playerState !== 1 && playerState !== 2) {
                console.log(` YouTube not playing (state: ${playerState})`);
                return;
            }
        }
        catch (error) {
            return;
        }
        if (this.translations) {
            const currentTimeMs = currentTime * 1000;
            const adjustedTimeMs = currentTimeMs + 500; // 200ms   
            //      
            const matchingIndices = [];
            let lastEnglishIndex = -1; //    
            for (let i = 0; i < this.translations.length; i++) {
                const item = this.translations[i];
                if (item.type === 'en' && adjustedTimeMs >= item.startMs && adjustedTimeMs < item.endMs) {
                    matchingIndices.push(i);
                    lastEnglishIndex = i;
                }
            }
            //    ,   
            const lastMatchingIndex = lastEnglishIndex >= 0 ? lastEnglishIndex :
                (matchingIndices.length > 0 ? matchingIndices[matchingIndices.length - 1] : -1);
            const selectionChanged = lastMatchingIndex !== this.currentActiveIndex;
            if (!this.autoPlayEnabled && selectionChanged) {
                if (this.currentActiveIndex >= 0) {
                    if (lastMatchingIndex < 0 || lastMatchingIndex !== this.currentActiveIndex) {
                        console.log(` Auto play disabled - pausing (current: ${this.currentActiveIndex}, new: ${lastMatchingIndex})`);
                        if (this.youtubePlayer && this.youtubePlayerReady) {
                            try {
                                this.youtubePlayer.pauseVideo();
                            }
                            catch (error) {
                                // Ignore
                            }
                        }
                        return;
                    }
                }
            }
            if (matchingIndices.length > 0) {
                //    
                this.updateActiveItemStyling(matchingIndices);
                if (selectionChanged && lastMatchingIndex >= 0) {
                    this.currentActiveIndex = lastMatchingIndex;
                    this.scrollToActiveItem(lastMatchingIndex);
                    const item = this.translations[lastMatchingIndex];
                    if (item.type === 'en') {
                        this.setScript(item.text);
                    }
                    this.updateItemWordSliderRange();
                    // Hide words      
                    if (this.hideWordsEnabled) {
                        this.generateHiddenWordIndices();
                    }
                    // DOM      
                    requestAnimationFrame(() => {
                        this.makeActiveItemWordsClickable();
                    });
                    this.updateGlobalSliderPosition(lastMatchingIndex);
                    console.log(` Auto-selected ${matchingIndices.length} overlapping items, primary: ${lastMatchingIndex} at ${currentTime.toFixed(1)}s`);
                }
            }
            else if (this.currentActiveIndex >= 0) {
                //      
                this.updateActiveItemStyling([]);
            }
        }
    }
    startCuePlayCheck(endTime) {
        this.stopCuePlayCheck();
        console.log(` Started checking for cue end at ${endTime.toFixed(3)}s`);
        this.cuePlayCheckInterval = setInterval(() => {
            if (!this.youtubePlayer || !this.youtubePlayerReady) {
                this.stopCuePlayCheck();
                return;
            }
            console.log('vvvvvvvvvvv?');
            try {
                const currentTime = this.youtubePlayer.getCurrentTime();
                if (currentTime >= endTime - 0.5) {
                    console.log(` Checking: ${currentTime.toFixed(3)}s / ${endTime.toFixed(3)}s`);
                }
                if (currentTime >= endTime - 0.1) {
                    this.youtubePlayer.pauseVideo();
                    console.log(` Paused at cue end: ${currentTime.toFixed(3)}s (target: ${endTime.toFixed(3)}s)`);
                    this.stopCuePlayCheck();
                }
            }
            catch (error) {
                console.log(' Cue play check error:', error);
            }
        }, 5);
        if (this.cuePlayCheckInterval)
            this.intervals.push(this.cuePlayCheckInterval);
    }
    stopCuePlayCheck() {
        if (this.cuePlayCheckInterval) {
            clearInterval(this.cuePlayCheckInterval);
            this.cuePlayCheckInterval = undefined;
        }
    }
    createYouTubeEmbed() {
        if (!_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_6__.ValidUtils.isBrowser() || !this.currentItem?.link) {
            console.warn(' Cannot create YouTube embed: browser check or link missing');
            return;
        }
        const container = document.getElementById('youtube-player-container');
        if (!container) {
            console.warn(' YouTube container not found, retrying...');
            setTimeout(() => this.createYouTubeEmbed(), 200);
            return;
        }
        const videoId = this.extractYouTubeVideoId(this.currentItem.link);
        if (!videoId) {
            console.error(' Could not extract YouTube video ID from:', this.currentItem.link);
            return;
        }
        console.log(' Creating YouTube player for video:', videoId);
        const initPlayer = () => {
            if (typeof window.YT !== 'undefined' && window.YT.Player) {
                this.createYouTubePlayer(videoId);
            }
            else {
                console.log(' YouTube API not ready, waiting...');
                setTimeout(initPlayer, 200);
            }
        };
        if (typeof window.YT !== 'undefined') {
            if (window.YT.loaded === 1) {
                console.log(' YouTube API already loaded');
                this.createYouTubePlayer(videoId);
            }
            else {
                console.log(' YouTube API loading, setting callback...');
                window.onYouTubeIframeAPIReady = () => {
                    console.log(' YouTube API ready callback triggered');
                    this.createYouTubePlayer(videoId);
                };
            }
        }
        else {
            console.log(' YouTube API not found, waiting for it to load...');
            initPlayer();
        }
    }
    createYouTubePlayer(videoId) {
        const container = document.getElementById('youtube-player-container');
        if (!container) {
            console.error(' YouTube player container not found during creation');
            return;
        }
        container.innerHTML = '';
        const playerDiv = document.createElement('div');
        playerDiv.id = 'youtube-player-' + Date.now();
        container.appendChild(playerDiv);
        try {
            this.youtubePlayer = new window.YT.Player(playerDiv.id, {
                height: '100%',
                width: '100%',
                videoId: videoId,
                playerVars: {
                    autoplay: 0,
                    controls: 1,
                    disablekb: 0,
                    enablejsapi: 1,
                    fs: 1,
                    iv_load_policy: 3,
                    modestbranding: 1,
                    playsinline: 1,
                    rel: 0,
                    showinfo: 0,
                    cc_load_policy: 0
                },
                events: {
                    onReady: (event) => {
                        console.log(' YouTube player ready successfully!');
                        this.youtubePlayerReady = true;
                        this.startYouTubeTimeMonitoring();
                    },
                    onStateChange: (event) => {
                        console.log(' YouTube player state changed:', event.data);
                        this.handleYouTubeStateChange(event.data);
                    },
                    onError: (event) => {
                        console.error(' YouTube player error:', event.data);
                    }
                }
            });
            console.log(' YouTube player instance created:', this.youtubePlayer);
        }
        catch (error) {
            console.error(' Failed to create YouTube player:', error);
        }
    }
    handleYouTubeStateChange(state) {
        // YouTube Player States:
        // -1 (unstarted)
        // 0 (ended)
        // 1 (playing)
        // 2 (paused)
        // 3 (buffering)
        // 5 (video cued)
        if (state === 1) {
            //  
            if (!this.autoPlayEnabled && !this.userManuallySelected) {
                //       
                this.autoPlayEnabled = true;
                console.log(' YouTube player started - auto play enabled');
            }
        }
        else if (state === 2) {
            // 
            if (this.autoPlayEnabled && !this.userManuallySelected) {
                //       
                this.autoPlayEnabled = false;
                console.log(' YouTube player paused - auto play disabled');
            }
        }
    }
    extractYouTubeVideoId(url) {
        console.log(' Extracting video ID from URL:', url);
        const patterns = [
            /(?:youtube\.com\/watch\?v=|youtu\.be\/|youtube\.com\/embed\/)([^&\n?#]+)/,
            /youtube\.com\/v\/([^&\n?#]+)/,
            /youtube\.com\/watch\?.*v=([^&\n?#]+)/,
            /^([a-zA-Z0-9_-]{11})$/
        ];
        for (const pattern of patterns) {
            const match = url.match(pattern);
            if (match && match[1]) {
                const videoId = match[1];
                console.log(' Extracted video ID:', videoId);
                return videoId;
            }
        }
        console.error(' Could not extract video ID from URL:', url);
        return null;
    }
    onDrThisUnBind() {
        super.onDrThisUnBind();
        this.onDestroy();
    }
    onDestroy() {
        console.log(' onDestroy called - cleaning up resources');
        // Stop all intervals
        this.stopCuePlayCheck();
        this.stopRangeAnimation();
        if (this.youtubeTimeMonitoringInterval) {
            clearInterval(this.youtubeTimeMonitoringInterval);
            this.youtubeTimeMonitoringInterval = undefined;
            console.log(' Cleared YouTube time monitoring interval');
        }
        // Clear all tracked intervals
        this.intervals.forEach(intervalId => {
            clearInterval(intervalId);
        });
        this.intervals = [];
        console.log(' Cleared all tracked intervals');
        // Clear all tracked timeouts
        this.timeouts.forEach(timeoutId => {
            clearTimeout(timeoutId);
        });
        this.timeouts = [];
        console.log(' Cleared all tracked timeouts');
        // Clear specific timeout
        if (this.scrollTimeout) {
            clearTimeout(this.scrollTimeout);
            this.scrollTimeout = undefined;
        }
        // Stop speech
        this.stopSpeech();
        this.isPlayingScript = false;
        this.isPlayingWord = false;
        // Destroy YouTube player
        if (this.youtubePlayer) {
            try {
                this.youtubePlayer.destroy();
                console.log(' YouTube player destroyed');
            }
            catch (error) {
                console.warn(' Error destroying YouTube player:', error);
            }
            this.youtubePlayer = undefined;
        }
        this.youtubePlayerReady = false;
        console.log(' Cleanup completed');
        super.onDestroy();
    }
};
PlayerRouteComponent = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    (0,_dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_4__.Sim)({
        scope: _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_4__.Lifecycle.Transient
    }),
    (0,_dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_1__.Component)({
        template: _player_route_component_html__WEBPACK_IMPORTED_MODULE_2__["default"],
        styles: _player_route_component_css__WEBPACK_IMPORTED_MODULE_3__["default"]
    }),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_5__.ApiService !== "undefined" && _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_5__.ApiService) === "function" ? _a : Object, typeof (_b = typeof _src_service_english_VideoItemService__WEBPACK_IMPORTED_MODULE_8__.VideoItemService !== "undefined" && _src_service_english_VideoItemService__WEBPACK_IMPORTED_MODULE_8__.VideoItemService) === "function" ? _b : Object, typeof (_c = typeof _src_service_VoiceService__WEBPACK_IMPORTED_MODULE_9__.VoiceService !== "undefined" && _src_service_VoiceService__WEBPACK_IMPORTED_MODULE_9__.VoiceService) === "function" ? _c : Object, typeof (_d = typeof _src_service_english_AutoTranslationService__WEBPACK_IMPORTED_MODULE_10__.AutoTranslationService !== "undefined" && _src_service_english_AutoTranslationService__WEBPACK_IMPORTED_MODULE_10__.AutoTranslationService) === "function" ? _d : Object, typeof (_e = typeof _src_service_english_DictionaryService__WEBPACK_IMPORTED_MODULE_11__.DictionaryService !== "undefined" && _src_service_english_DictionaryService__WEBPACK_IMPORTED_MODULE_11__.DictionaryService) === "function" ? _e : Object])
], PlayerRouteComponent);



/***/ }),

/***/ "./src/pages/finance/chart/chart.route.component.css":
/*!***********************************************************!*\
  !*** ./src/pages/finance/chart/chart.route.component.css ***!
  \***********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (".chart-header {\n  padding: 10px;\n  background-color: #f5f5f5;\n  border-bottom: 1px solid #ddd;\n  flex-shrink: 0;\n}\n\n.chart-header h2 {\n  margin: 0 0 10px 0;\n  font-size: 20px;\n  color: #333;\n}\n\n@media (min-width: 768px) {\n  .chart-header h2 {\n    font-size: 24px;\n  }\n}\n\n.chart-controls {\n  display: flex;\n  flex-wrap: nowrap;\n  gap: 10px;\n  align-items: center;\n  padding: 8px;\n  background-color: #fff;\n  border: 1px solid #e0e0e0;\n  border-radius: 8px;\n  overflow-x: auto;\n  overflow-y: hidden;\n  white-space: nowrap;\n  -webkit-overflow-scrolling: touch;\n}\n\n@media (min-width: 768px) {\n  .chart-controls {\n    gap: 15px;\n    padding: 10px;\n  }\n}\n\n/*   */\n.chart-controls::-webkit-scrollbar {\n  display: none;\n}\n\n/* Firefox   */\n.chart-controls {\n  scrollbar-width: none;\n}\n\n.chart-controls label {\n  display: inline-flex;\n  align-items: center;\n  gap: 4px;\n  padding: 4px 8px;\n  background-color: #f9f9f9;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  cursor: pointer;\n  font-size: 12px;\n  color: #333;\n  transition: all 0.2s ease;\n  user-select: none;\n  flex-shrink: 0;\n}\n\n@media (min-width: 768px) {\n  .chart-controls label {\n    gap: 6px;\n    padding: 6px 12px;\n    font-size: 14px;\n  }\n}\n\n.chart-controls label:hover {\n  background-color: #e8f4f8;\n  border-color: #4a90e2;\n}\n\n.chart-controls input[type=\"checkbox\"],\n.chart-controls input[type=\"radio\"] {\n  cursor: pointer;\n  margin: 0;\n}\n\n.chart-controls input[type=\"checkbox\"]:checked + span,\n.chart-controls input[type=\"radio\"]:checked + span {\n  font-weight: 600;\n  color: #4a90e2;\n}\n\n.radio-group {\n  display: inline-flex;\n  flex-wrap: nowrap;\n  gap: 6px;\n  padding: 6px;\n  background-color: #fafafa;\n  border: 1px solid #e0e0e0;\n  border-radius: 6px;\n  flex-shrink: 0;\n}\n\n@media (min-width: 768px) {\n  .radio-group {\n    gap: 8px;\n    padding: 8px;\n  }\n}\n\n.radio-group label {\n  padding: 4px 8px;\n  font-size: 11px;\n  background-color: #fff;\n}\n\n@media (min-width: 768px) {\n  .radio-group label {\n    padding: 5px 10px;\n    font-size: 13px;\n  }\n}\n\n.radio-group label:has(input:checked) {\n  background-color: #4a90e2;\n  color: #fff;\n  border-color: #4a90e2;\n}\n\n.radio-group label:has(input:checked):hover {\n  background-color: #357abd;\n  border-color: #357abd;\n}\n\n.chart-wrap {\n  width: 100%;\n  height: calc(100vh - 55px);\n  display: flex;\n  flex-direction: column;\n  overflow: hidden;\n}\n\n.chart-container {\n  width: 100%;\n  flex: 1;\n  min-height: 0;\n  box-sizing: border-box;\n  position: relative;\n  overflow: hidden;\n}\n\n#chart-canvas {\n  width: 100%;\n  height: 100%;\n  display: block;\n  background-color: #ffffff;\n  box-sizing: border-box;\n}\n");

/***/ }),

/***/ "./src/pages/finance/chart/chart.route.component.html":
/*!************************************************************!*\
  !*** ./src/pages/finance/chart/chart.route.component.html ***!
  \************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("<div class=\"chart-wrap\">\n  <section class=\"chart-header\">\n  <!--  <h2 dr-if=\"@this@.currentItem\">${@this@.currentItem.label}$</h2>-->\n    <div class=\"chart-controls\">\n      <label for=\"toggle-events\" id=\"toggle-events-label\">\n        <input type=\"checkbox\" id=\"toggle-events\" checked />\n        \n      </label>\n      <label for=\"toggle-candles\" id=\"toggle-candles-label\">\n        <input type=\"checkbox\" id=\"toggle-candles\" />\n        \n      </label>\n      <label for=\"toggle-show-points\" id=\"toggle-show-points-label\">\n        <input type=\"checkbox\" id=\"toggle-show-points\" />\n        \n      </label>\n      <label for=\"toggle-show-average\" id=\"toggle-show-average-label\">\n        <input type=\"checkbox\" id=\"toggle-show-average\" />\n        \n      </label>\n      <label for=\"toggle-show-ma5\" id=\"toggle-show-ma5-label\">\n        <input type=\"checkbox\" id=\"toggle-show-ma5\" />\n        MA5\n      </label>\n      <label for=\"toggle-show-ma10\" id=\"toggle-show-ma10-label\">\n        <input type=\"checkbox\" id=\"toggle-show-ma10\" />\n        MA10\n      </label>\n      <label for=\"toggle-show-ma20\" id=\"toggle-show-ma20-label\">\n        <input type=\"checkbox\" id=\"toggle-show-ma20\" />\n        MA20\n      </label>\n      <label for=\"toggle-show-ma50\" id=\"toggle-show-ma50-label\">\n        <input type=\"checkbox\" id=\"toggle-show-ma50\" />\n        MA50\n      </label>\n      <label for=\"toggle-show-ma100\" id=\"toggle-show-ma100-label\">\n        <input type=\"checkbox\" id=\"toggle-show-ma100\" />\n        MA100\n      </label>\n      <span class=\"radio-group\">\n        <label><input type=\"radio\" name=\"normalize-mode\" value=\"none\" /> </label>\n        <label><input type=\"radio\" name=\"normalize-mode\" value=\"rangeNormalize\" /> </label>\n        <label><input type=\"radio\" name=\"normalize-mode\" value=\"normalize\" checked /> </label>\n      </span>\n  <!--    <label for=\"toggle-daily-group\" id=\"toggle-daily-group-label\">-->\n  <!--      <input type=\"checkbox\" id=\"toggle-daily-group\" />-->\n  <!--      -->\n  <!--    </label>-->\n      <label for=\"toggle-hide-lines\" id=\"toggle-hide-lines-label\">\n        <input type=\"checkbox\" id=\"toggle-hide-lines\" />\n        \n      </label>\n      <label for=\"toggle-show-grid\" id=\"toggle-show-grid-label\">\n        <input type=\"checkbox\" id=\"toggle-show-grid\" />\n        \n      </label>\n      <span class=\"radio-group\">\n        <label><input type=\"radio\" name=\"theme-mode\" value=\"light\" /> </label>\n        <label><input type=\"radio\" name=\"theme-mode\" value=\"dark\" /> </label>\n        <label><input type=\"radio\" name=\"theme-mode\" value=\"auto\" checked /> </label>\n      </span>\n      <span class=\"radio-group\">\n        <label><input type=\"radio\" name=\"line-mode\" value=\"line\" /> </label>\n        <label><input type=\"radio\" name=\"line-mode\" value=\"line-smooth\" checked /> </label>\n        <label><input type=\"radio\" name=\"line-mode\" value=\"line-smooth-open\" /> </label>\n        <label><input type=\"radio\" name=\"line-mode\" value=\"line-smooth-high\" /> </label>\n        <label><input type=\"radio\" name=\"line-mode\" value=\"line-smooth-low\" /> </label>\n        <label><input type=\"radio\" name=\"line-mode\" value=\"line-smooth-middle\" /> </label>\n        <label><input type=\"radio\" name=\"line-mode\" value=\"step-to\" /> (to)</label>\n        <label><input type=\"radio\" name=\"line-mode\" value=\"step-from\" /> (from)</label>\n        <label><input type=\"radio\" name=\"line-mode\" value=\"step-center\" /> (center)</label>\n      </span>\n\n    </div>\n  </section>\n  <section class=\"chart-container\">\n    <canvas id=\"chart-canvas\"></canvas>\n  </section>\n</div>");

/***/ }),

/***/ "./src/pages/finance/chart/chart.route.component.ts":
/*!**********************************************************!*\
  !*** ./src/pages/finance/chart/chart.route.component.ts ***!
  \**********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   ChartRouteComponent: () => (/* binding */ ChartRouteComponent)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/simple-boot-front/decorators/Component */ "../../packages/@dooboostore/simple-boot-front/src/decorators/Component.ts");
/* harmony import */ var _chart_route_component_html__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chart.route.component.html */ "./src/pages/finance/chart/chart.route.component.html");
/* harmony import */ var _chart_route_component_css__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./chart.route.component.css */ "./src/pages/finance/chart/chart.route.component.css");
/* harmony import */ var _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @dooboostore/simple-boot/fetch/ApiService */ "../../packages/@dooboostore/simple-boot/src/fetch/ApiService.ts");
/* harmony import */ var _dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @dooboostore/core-web/valid/ValidUtils */ "../../packages/@dooboostore/core-web/src/valid/ValidUtils.ts");
/* harmony import */ var _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @dooboostore/dom-render/components/ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _src_service_english_FinanceService__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @src/service/english/FinanceService */ "./src/service/english/FinanceService.ts");
/* harmony import */ var _dooboostore_lib_web_canvas_chart_OverlayStockChart__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @dooboostore/lib-web/canvas/chart/OverlayStockChart */ "../../packages/@dooboostore/lib-web/src/canvas/chart/OverlayStockChart.ts");
/* harmony import */ var _dooboostore_dom_render_routers_Router__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @dooboostore/dom-render/routers/Router */ "../../packages/@dooboostore/dom-render/src/routers/Router.ts");
var _a, _b, _c, _d;











let ChartRouteComponent = class ChartRouteComponent extends _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_7__.ComponentBase {
    apiService;
    router;
    financeService;
    name;
    currentItem;
    chart;
    chartDataMap;
    eventDataMap;
    groupByDay = false;
    listenersSetup = false;
    chartWrapElement;
    constructor(apiService, router, financeService) {
        super();
        this.apiService = apiService;
        this.router = router;
        this.financeService = financeService;
        // console.log('------', router);
    }
    onCreateRender(param) {
    }
    async onRawSetRendered(rawSet, otherData) {
        await super.onRawSetRendered(rawSet, otherData);
    }
    async onRouting(r) {
        this.name = undefined;
        this.currentItem = undefined;
        this.chartDataMap = undefined;
        this.eventDataMap = undefined;
        this.name = decodeURIComponent(r.routerModule.pathData?.name ?? '');
        if (_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_6__.ValidUtils.isBrowser() && this.name) {
            // Load finance item
            this.currentItem = await this.financeService.item(this.name);
            if (this.currentItem) {
                // Load chart data for all symbols
                this.chartDataMap = new Map();
                for (const symbol of this.currentItem.symbols) {
                    try {
                        const chartData = await this.financeService.chart(symbol, []);
                        if (chartData) {
                            this.chartDataMap.set(symbol, chartData);
                        }
                        else {
                            console.warn(` No chart data found for ${symbol}`);
                        }
                    }
                    catch (error) {
                        console.error(` Failed to load chart data for ${symbol}:`, error);
                    }
                }
                // Load event data for all events
                if (this.currentItem.events && this.currentItem.events.length > 0) {
                    this.eventDataMap = new Map();
                    for (const eventName of this.currentItem.events) {
                        try {
                            const eventData = await this.financeService.events(eventName);
                            if (eventData && eventData.length > 0) {
                                this.eventDataMap.set(eventName, eventData);
                            }
                            else {
                                console.warn(` No event data found for ${eventName}`);
                            }
                        }
                        catch (error) {
                            console.error(` Failed to load event data for ${eventName}:`, error);
                        }
                    }
                }
                setTimeout(() => {
                    this.chartRender();
                }, 1);
            }
        }
    }
    async onInitRender(param, rawSet) {
        await super.onInitRender(param, rawSet);
    }
    async chartRender() {
        if (!this.currentItem || !this.chartDataMap) {
            console.warn('No current item or chart data found');
            return;
        }
        if (this.chartDataMap.size === 0) {
            console.warn('No chart data loaded');
            return;
        }
        // chartWrap canvas 
        if (!this.chartWrapElement) {
            console.warn('Chart wrap element not ready');
            return;
        }
        const chartCanvas = this.chartWrapElement.querySelector('#chart-canvas');
        if (!chartCanvas) {
            console.warn('Canvas element not found');
            return;
        }
        try {
            // Destroy existing chart before creating new one
            if (this.chart) {
                this.chart.destroy();
                this.chart = undefined;
            }
            // Convert chart data to OverlayStockChart format
            const dataMap = new Map();
            this.chartDataMap.forEach((chartData, symbol) => {
                const convertedData = this.convertChartData(chartData, this.groupByDay);
                dataMap.set(symbol, {
                    data: convertedData
                });
            });
            // Convert event data to OverlayStockChart format
            const commonEvents = { x: [] };
            if (this.eventDataMap && this.eventDataMap.size > 0) {
                this.eventDataMap.forEach((events) => {
                    events.forEach((event) => {
                        commonEvents.x.push({
                            x: new Date(event.x).getTime(),
                            label: event.label,
                            color: '#FF6600'
                        });
                    });
                });
            }
            // Calculate initial range based on event timestamps only
            let initialRangeMin = undefined;
            let initialRangeMax = undefined;
            //    
            const eventTimestamps = [];
            if (commonEvents.x && commonEvents.x.length > 0) {
                commonEvents.x.forEach((event) => {
                    if (event.x) {
                        eventTimestamps.push(event.x);
                    }
                });
            }
            //     ( 10  )
            if (eventTimestamps.length > 0) {
                const minTime = Math.min(...eventTimestamps);
                const maxTime = Math.max(...eventTimestamps);
                const tenDays = 10 * 24 * 60 * 60 * 1000; // 10 ()
                //  10  
                initialRangeMin = minTime - tenDays;
                initialRangeMax = maxTime + tenDays;
            }
            // Get theme mode from radio buttons
            const themeModeRadio = document.querySelector('input[name="theme-mode"]:checked');
            const themeMode = themeModeRadio?.value ?? 'auto';
            //      (  )
            const availableChartKeys = ['price', 'volume'];
            //         
            const firstSymbolData = dataMap.values().next().value;
            if (firstSymbolData && firstSymbolData.data) {
                if (firstSymbolData.data.obv && firstSymbolData.data.obv.datas.length > 0) {
                    availableChartKeys.push('obv');
                }
                if (firstSymbolData.data.atr && firstSymbolData.data.atr.datas.length > 0) {
                    availableChartKeys.push('atr');
                }
                if (firstSymbolData.data.rsi && firstSymbolData.data.rsi.datas.length > 0) {
                    availableChartKeys.push('rsi');
                }
                if (firstSymbolData.data.adx && firstSymbolData.data.adx.datas.length > 0) {
                    availableChartKeys.push('adx');
                }
                if (firstSymbolData.data.vo && firstSymbolData.data.vo.datas.length > 0) {
                    availableChartKeys.push('vo');
                }
                if (firstSymbolData.data.mfi && firstSymbolData.data.mfi.datas.length > 0) {
                    availableChartKeys.push('mfi');
                }
            }
            console.log('------', dataMap);
            // Create chart
            this.chart = new _dooboostore_lib_web_canvas_chart_OverlayStockChart__WEBPACK_IMPORTED_MODULE_9__.OverlayStockChart(chartCanvas, dataMap, {
                commonEvents,
                initialState: {
                    normalize: 'normalize', // :   
                    lineMode: 'line-smooth',
                    showEvents: true, //  true
                    visibleTickers: new Set(this.currentItem.symbols),
                    enabledTickers: new Set(this.currentItem.symbols),
                    visibleChartKeys: availableChartKeys
                },
                config: {
                    theme: themeMode,
                    // showZoomButtons: true,
                    lineWidth: 1,
                    paddingLeft: 50,
                    paddingRight: 30,
                    //  X   (  10,   undefined  )
                    xMin: initialRangeMin !== undefined ? initialRangeMin : undefined,
                    xMax: initialRangeMax !== undefined ? initialRangeMax : undefined,
                    //   Y  
                    yMin: (chartKey) => {
                        if (chartKey === 'rsi' || chartKey === 'mfi')
                            return 0;
                        return undefined;
                    },
                    yMax: (chartKey) => {
                        if (chartKey === 'rsi' || chartKey === 'mfi')
                            return 100;
                        return undefined;
                    },
                    // hideLegend: true,
                    // hideXAxisLabels: true,
                    // hideYAxisLabels: true,
                    xLabelCount: 3,
                    yLabelCount: 3,
                    xFormat: (xValue, index, total) => {
                        const date = new Date(xValue);
                        const year = date.getFullYear();
                        const month = String(date.getMonth() + 1).padStart(2, '0');
                        const day = String(date.getDate()).padStart(2, '0');
                        return `${year}-${month}-${day}`;
                    },
                    // xFormat: (xValue: number, index: number, total: number) => {
                    //   if (index !== 0 && index !== total - 1 && index % Math.ceil(total / 2) !== 0) {
                    //     return '';
                    //   }
                    //   const date = new Date(xValue);
                    //   const year = date.getFullYear();
                    //   const month = String(date.getMonth() + 1).padStart(2, '0');
                    //   const day = String(date.getDate()).padStart(2, '0');
                    //   return `${year}-${month}-${day}`;
                    // },
                    // yFormat: (yValue: number, index: number, total: number) => {
                    //   if (index !== 0 && index !== total - 1 && index % Math.ceil(total / 2) !== 0) {
                    //     return '';
                    //   }
                    //   return yValue.toLocaleString(undefined, { maximumFractionDigits: 2 });
                    // }
                }
            });
            // Render chart
            this.chart.render();
        }
        catch (error) {
            console.error('Failed to render chart:', error);
        }
    }
    convertChartData(chartData, groupByDay = false) {
        const quotes = chartData.quotes || [];
        if (groupByDay) {
            // Group quotes by date (YYYY-MM-DD)
            const groupedByDate = new Map();
            quotes.forEach((quote) => {
                const date = new Date(quote.date);
                const dateKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
                if (!groupedByDate.has(dateKey)) {
                    groupedByDate.set(dateKey, []);
                }
                groupedByDate.get(dateKey).push(quote);
            });
            // Aggregate each day's data
            const aggregatedQuotes = [];
            groupedByDate.forEach((dayQuotes) => {
                const firstQuote = dayQuotes[0];
                const lastQuote = dayQuotes[dayQuotes.length - 1];
                const open = firstQuote.open;
                const close = lastQuote.close;
                const high = Math.max(...dayQuotes.map(q => q.high));
                const low = Math.min(...dayQuotes.map(q => q.low));
                const volume = dayQuotes.reduce((sum, q) => sum + q.volume, 0);
                //     (  )
                const obv = lastQuote.obv;
                const atr = lastQuote.atr;
                const rsi = lastQuote.rsi;
                const adx = lastQuote.adx;
                const vo = lastQuote.vo;
                const mfi = lastQuote.mfi;
                aggregatedQuotes.push({
                    date: firstQuote.date,
                    open,
                    high,
                    low,
                    close,
                    volume,
                    adjclose: lastQuote.adjclose,
                    obv,
                    atr,
                    rsi,
                    adx,
                    vo,
                    mfi
                });
            });
            // Sort by date
            aggregatedQuotes.sort((a, b) => new Date(a.date).getTime() - new Date(b.date).getTime());
            const price = aggregatedQuotes.map((quote) => ({
                x: new Date(quote.date).getTime(),
                yOpen: quote.open,
                yHigh: quote.high,
                yLow: quote.low,
                y: quote.close
            }));
            const volume = aggregatedQuotes.map((quote) => ({
                x: new Date(quote.date).getTime(),
                y: quote.volume
            }));
            const result = {
                price: {
                    datas: price
                },
                volume: {
                    datas: volume
                }
            };
            // OBV   (  )
            const obvData = aggregatedQuotes
                .filter(q => q.obv !== undefined)
                .map((quote) => ({
                x: new Date(quote.date).getTime(),
                y: quote.obv
            }));
            if (obvData.length > 0) {
                result.obv = {
                    datas: obvData
                };
            }
            // ATR   (  )
            const atrData = aggregatedQuotes
                .filter(q => q.atr !== undefined)
                .map((quote) => ({
                x: new Date(quote.date).getTime(),
                y: quote.atr
            }));
            if (atrData.length > 0) {
                result.atr = {
                    datas: atrData
                };
            }
            // RSI   (  )
            const rsiData = aggregatedQuotes
                .filter(q => q.rsi !== undefined)
                .map((quote) => ({
                x: new Date(quote.date).getTime(),
                y: quote.rsi
            }));
            if (rsiData.length > 0) {
                result.rsi = {
                    datas: rsiData
                };
            }
            // ADX   (  )
            const adxData = aggregatedQuotes
                .filter(q => q.adx !== undefined)
                .map((quote) => ({
                x: new Date(quote.date).getTime(),
                y: quote.adx
            }));
            if (adxData.length > 0) {
                result.adx = {
                    datas: adxData
                };
            }
            // VO   (  )
            const voData = aggregatedQuotes
                .filter(q => q.vo !== undefined)
                .map((quote) => ({
                x: new Date(quote.date).getTime(),
                y: quote.vo
            }));
            if (voData.length > 0) {
                result.vo = {
                    datas: voData
                };
            }
            // MFI   (  )
            const mfiData = aggregatedQuotes
                .filter(q => q.mfi !== undefined)
                .map((quote) => ({
                x: new Date(quote.date).getTime(),
                y: quote.mfi
            }));
            if (mfiData.length > 0) {
                result.mfi = {
                    datas: mfiData
                };
            }
            return result;
        }
        else {
            // Original conversion without grouping
            const price = quotes.map((quote) => ({
                x: new Date(quote.date).getTime(),
                yOpen: quote.open,
                yHigh: quote.high,
                yLow: quote.low,
                y: quote.close
            }));
            const volume = quotes.map((quote) => ({
                x: new Date(quote.date).getTime(),
                y: quote.volume
            }));
            const result = {
                price: {
                    datas: price
                },
                volume: {
                    datas: volume
                }
            };
            // OBV   (  )
            const obvData = quotes
                .filter(q => q.obv !== undefined)
                .map((quote) => ({
                x: new Date(quote.date).getTime(),
                y: quote.obv
            }));
            if (obvData.length > 0) {
                result.obv = {
                    datas: obvData
                };
            }
            // ATR   (  )
            const atrData = quotes
                .filter(q => q.atr !== undefined)
                .map((quote) => ({
                x: new Date(quote.date).getTime(),
                y: quote.atr
            }));
            if (atrData.length > 0) {
                result.atr = {
                    datas: atrData
                };
            }
            // RSI   (  )
            const rsiData = quotes
                .filter(q => q.rsi !== undefined)
                .map((quote) => ({
                x: new Date(quote.date).getTime(),
                y: quote.rsi
            }));
            if (rsiData.length > 0) {
                result.rsi = {
                    datas: rsiData
                };
            }
            // ADX   (  )
            const adxData = quotes
                .filter(q => q.adx !== undefined)
                .map((quote) => ({
                x: new Date(quote.date).getTime(),
                y: quote.adx
            }));
            if (adxData.length > 0) {
                result.adx = {
                    datas: adxData
                };
            }
            // VO   (  )
            const voData = quotes
                .filter(q => q.vo !== undefined)
                .map((quote) => ({
                x: new Date(quote.date).getTime(),
                y: quote.vo
            }));
            if (voData.length > 0) {
                result.vo = {
                    datas: voData
                };
            }
            // MFI   (  )
            const mfiData = quotes
                .filter(q => q.mfi !== undefined)
                .map((quote) => ({
                x: new Date(quote.date).getTime(),
                y: quote.mfi
            }));
            if (mfiData.length > 0) {
                result.mfi = {
                    datas: mfiData
                };
            }
            return result;
        }
    }
    chartWrap(el) {
        if (!_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_6__.ValidUtils.isBrowser()) {
            return;
        }
        //  
        this.chartWrapElement = el;
        //    
        if (this.listenersSetup) {
            return;
        }
        this.listenersSetup = true;
        // ResizeObserver    
        const resizeObserver = new ResizeObserver(() => {
            //   
            if (this.chart) {
                this.chart.render();
            }
        });
        resizeObserver.observe(el);
        // Checkbox controls
        const toggleDailyGroup = el.querySelector('#toggle-daily-group');
        const toggleHideLines = el.querySelector('#toggle-hide-lines');
        const toggleShowGrid = el.querySelector('#toggle-show-grid');
        const toggleShowPoints = el.querySelector('#toggle-show-points');
        const toggleShowAverage = el.querySelector('#toggle-show-average');
        const toggleShowMA5 = el.querySelector('#toggle-show-ma5');
        const toggleShowMA10 = el.querySelector('#toggle-show-ma10');
        const toggleShowMA20 = el.querySelector('#toggle-show-ma20');
        const toggleShowMA50 = el.querySelector('#toggle-show-ma50');
        const toggleShowMA100 = el.querySelector('#toggle-show-ma100');
        const toggleEvents = el.querySelector('#toggle-events');
        const toggleCandles = el.querySelector('#toggle-candles');
        // Radio controls
        const lineModeRadios = el.querySelectorAll('input[name="line-mode"]');
        const normalizeModeRadios = el.querySelectorAll('input[name="normalize-mode"]');
        const themeModeRadios = el.querySelectorAll('input[name="theme-mode"]');
        if (toggleDailyGroup) {
            toggleDailyGroup.addEventListener('change', (e) => {
                const checked = e.target.checked;
                this.groupByDay = checked;
                setTimeout(() => {
                    this.chartRender();
                }, 10);
            });
        }
        if (toggleHideLines) {
            toggleHideLines.addEventListener('change', (e) => {
                const checked = e.target.checked;
                this.chart?.updateState({ hideLines: checked });
            });
        }
        if (toggleShowGrid) {
            toggleShowGrid.addEventListener('change', (e) => {
                const checked = e.target.checked;
                this.chart?.updateState({ showGrid: checked });
            });
        }
        if (toggleShowPoints) {
            toggleShowPoints.addEventListener('change', (e) => {
                const checked = e.target.checked;
                this.chart?.updateState({ showPoints: checked });
            });
        }
        //     ( )
        const updateMovingAverages = () => {
            if (!this.chart)
                return;
            console.log('[updateMovingAverages] called');
            console.log(' checked:', toggleShowAverage?.checked);
            console.log('MA5 checked:', toggleShowMA5?.checked);
            console.log('MA10 checked:', toggleShowMA10?.checked);
            console.log('MA20 checked:', toggleShowMA20?.checked);
            console.log('MA50 checked:', toggleShowMA50?.checked);
            console.log('MA100 checked:', toggleShowMA100?.checked);
            const movingAverages = [];
            //  ( )
            if (toggleShowAverage?.checked) {
                movingAverages.push({ type: 'average', label: '', visible: true });
            }
            //   (1 = 24 = 86400000 )
            const oneDayMs = 24 * 60 * 60 * 1000;
            //    xWidth  
            const tickerMovingAverageWidths = [];
            //    (  ) -   ON 
            const globalMovingAverages = [];
            if (toggleShowMA5?.checked) {
                if (toggleShowAverage?.checked) {
                    globalMovingAverages.push({ xWidth: 5 * oneDayMs, label: 'MA5' });
                }
                tickerMovingAverageWidths.push(5 * oneDayMs);
            }
            if (toggleShowMA10?.checked) {
                if (toggleShowAverage?.checked) {
                    globalMovingAverages.push({ xWidth: 10 * oneDayMs, label: 'MA10' });
                }
                tickerMovingAverageWidths.push(10 * oneDayMs);
            }
            if (toggleShowMA20?.checked) {
                if (toggleShowAverage?.checked) {
                    globalMovingAverages.push({ xWidth: 20 * oneDayMs, label: 'MA20' });
                }
                tickerMovingAverageWidths.push(20 * oneDayMs);
            }
            if (toggleShowMA50?.checked) {
                if (toggleShowAverage?.checked) {
                    globalMovingAverages.push({ xWidth: 50 * oneDayMs, label: 'MA50' });
                }
                tickerMovingAverageWidths.push(50 * oneDayMs);
            }
            if (toggleShowMA100?.checked) {
                if (toggleShowAverage?.checked) {
                    globalMovingAverages.push({ xWidth: 100 * oneDayMs, label: 'MA100' });
                }
                tickerMovingAverageWidths.push(100 * oneDayMs);
            }
            console.log('tickerMovingAverageWidths:', tickerMovingAverageWidths);
            console.log('globalMovingAverages:', globalMovingAverages);
            //     
            const totalLines = globalMovingAverages.length;
            globalMovingAverages.forEach((ma, index) => {
                //    (1.0),   (0.3)
                const opacity = totalLines === 1 ? 1.0 : 1.0 - (index / (totalLines - 1)) * 0.7;
                movingAverages.push({
                    type: 'moving',
                    xWidth: ma.xWidth,
                    label: ma.label,
                    visible: true,
                    opacity
                });
            });
            console.log('final movingAverages:', movingAverages);
            //    chartKey movingAverageXwidth 
            this.chart.updateTickerMovingAverages(tickerMovingAverageWidths);
            this.chart.updateState({ showAverage: movingAverages });
        };
        if (toggleShowAverage) {
            toggleShowAverage.addEventListener('change', updateMovingAverages);
        }
        if (toggleShowMA5) {
            toggleShowMA5.addEventListener('change', updateMovingAverages);
        }
        if (toggleShowMA10) {
            toggleShowMA10.addEventListener('change', updateMovingAverages);
        }
        if (toggleShowMA20) {
            toggleShowMA20.addEventListener('change', updateMovingAverages);
        }
        if (toggleShowMA50) {
            toggleShowMA50.addEventListener('change', updateMovingAverages);
        }
        if (toggleShowMA100) {
            toggleShowMA100.addEventListener('change', updateMovingAverages);
        }
        if (toggleEvents) {
            toggleEvents.addEventListener('change', (e) => {
                const checked = e.target.checked;
                this.chart?.updateState({ showEvents: checked });
            });
        }
        if (toggleCandles) {
            toggleCandles.addEventListener('change', (e) => {
                const checked = e.target.checked;
                this.chart?.updateState({ showCandles: checked });
            });
        }
        lineModeRadios.forEach((radio) => {
            radio.addEventListener('change', (e) => {
                const value = e.target.value;
                this.chart?.updateState({ lineMode: value });
            });
        });
        normalizeModeRadios.forEach((radio) => {
            radio.addEventListener('change', (e) => {
                const value = e.target.value;
                this.chart?.updateState({ normalize: value });
            });
        });
        themeModeRadios.forEach((radio) => {
            radio.addEventListener('change', (e) => {
                const value = e.target.value;
                if (!this.chart) {
                    console.warn('Chart not ready for theme change');
                    return;
                }
                //   
                const currentState = this.chart.getState();
                this.chart.destroy();
                this.chart = undefined;
                //  
                this.chartRender();
                //  
                if (this.chart) {
                    this.chart.updateState(currentState);
                }
            });
        });
    }
    onDrThisUnBind() {
        super.onDrThisUnBind();
        this.onDestroy();
    }
    onDestroy() {
        if (this.chart) {
            this.chart.destroy();
            this.chart = undefined;
        }
    }
};
(0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    (0,_dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_7__.query)('.chart-wrap'),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:type", Function),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_d = typeof HTMLElement !== "undefined" && HTMLElement) === "function" ? _d : Object]),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:returntype", void 0)
], ChartRouteComponent.prototype, "chartWrap", null);
ChartRouteComponent = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    (0,_dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_4__.Sim)({
        scope: _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_4__.Lifecycle.Transient
    }),
    (0,_dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_1__.Component)({
        template: _chart_route_component_html__WEBPACK_IMPORTED_MODULE_2__["default"],
        styles: _chart_route_component_css__WEBPACK_IMPORTED_MODULE_3__["default"]
    }),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_5__.ApiService !== "undefined" && _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_5__.ApiService) === "function" ? _a : Object, typeof (_b = typeof _dooboostore_dom_render_routers_Router__WEBPACK_IMPORTED_MODULE_10__.Router !== "undefined" && _dooboostore_dom_render_routers_Router__WEBPACK_IMPORTED_MODULE_10__.Router) === "function" ? _b : Object, typeof (_c = typeof _src_service_english_FinanceService__WEBPACK_IMPORTED_MODULE_8__.FinanceService !== "undefined" && _src_service_english_FinanceService__WEBPACK_IMPORTED_MODULE_8__.FinanceService) === "function" ? _c : Object])
], ChartRouteComponent);



/***/ }),

/***/ "./src/pages/finance/finance.route.component.css":
/*!*******************************************************!*\
  !*** ./src/pages/finance/finance.route.component.css ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("/* Content Sections */\n.content-section {\n  margin-bottom: 25px;\n}\n\n.section-title {\n  font-size: 18px;\n  font-weight: 600;\n  color: #2c3e50;\n  margin: 0 0 12px 20px;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.section-title i {\n  color: #3498db;\n  font-size: 16px;\n}\n\n.section-title .fa-youtube {\n  color: #ff0000;\n}\n\n.movie-grid {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n  gap: 20px;\n  padding: 0 20px 20px 20px;\n}\n\n.movie-card {\n  position: relative;\n  border-radius: 8px;\n  overflow: hidden;\n  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);\n  transition: transform 0.3s ease, box-shadow 0.3s ease;\n}\n\n.movie-poster-link {\n  display: block;\n  text-decoration: none;\n  color: inherit;\n}\n\n.movie-card:hover {\n  transform: translateY(-5px);\n  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);\n}\n\n.movie-card:hover .movie-title {\n  background: #f8f9fa;\n  color: #1976d2;\n  border-top-color: #2196f3;\n}\n\n.movie-poster {\n  position: relative;\n  width: 100%;\n  height: 0;\n  overflow: hidden;\n}\n\n/* Default movie poster ratio (2:3) */\n.movie-poster.movie {\n  padding-bottom: 150%;\n  /* 2:3 ratio (3/2 = 1.5 = 150%) - Movie poster ratio */\n}\n\n/* YouTube thumbnail ratio (16:9) */\n.movie-poster.youtube {\n  padding-bottom: 56.25%;\n  /* 16:9 ratio (9/16 = 0.5625 = 56.25%) - YouTube thumbnail ratio */\n}\n\n/* Fallback for items without type - use movie ratio */\n.movie-poster:not(.youtube):not(.movie) {\n  padding-bottom: 150%;\n  /* Default to movie poster ratio */\n}\n\n.movie-poster img {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  object-position: center;\n  display: block;\n}\n\n/* Enhanced title card below image */\n.movie-title {\n  margin: 0;\n  padding: 10px 8px;\n  font-size: 13px;\n  font-weight: 600;\n  line-height: 1.3;\n  color: #2c3e50;\n  text-align: center;\n  background: #ffffff;\n  border-top: 1px solid #dee2e6;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  line-clamp: 2;\n  -webkit-box-orient: vertical;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  transition: all 0.3s ease;\n  position: relative;\n  word-break: break-word;\n  hyphens: auto;\n}\n\n.movie-actions {\n  position: absolute;\n  top: 8px;\n  right: 8px;\n  display: flex;\n  justify-content: flex-end;\n}\n\n.external-link {\n  display: inline-flex;\n  align-items: center;\n  justify-content: center;\n  width: 32px;\n  height: 32px;\n  background: rgba(255, 255, 255, 0.2);\n  border-radius: 50%;\n  color: white;\n  text-decoration: none;\n  transition: background-color 0.3s ease;\n}\n\n.external-link:hover {\n  background: rgba(255, 255, 255, 0.3);\n}\n\n.external-link i {\n  font-size: 14px;\n}\n\n/* Responsive breakpoints */\n@media (max-width: 768px) {\n  .movie-grid {\n    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));\n    gap: 15px;\n    padding: 15px;\n  }\n\n  .movie-title {\n    font-size: 12px;\n    padding: 8px 6px;\n  }\n}\n\n@media (max-width: 480px) {\n  .movie-grid {\n    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));\n    gap: 10px;\n    padding: 10px;\n  }\n\n  .movie-overlay {\n    padding: 15px 10px 10px;\n  }\n\n  .movie-title {\n    font-size: 11px;\n    padding: 6px 4px;\n  }\n\n  .external-link {\n    width: 28px;\n    height: 28px;\n  }\n\n  .external-link i {\n    font-size: 12px;\n  }\n}");

/***/ }),

/***/ "./src/pages/finance/finance.route.component.html":
/*!********************************************************!*\
  !*** ./src/pages/finance/finance.route.component.html ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("<!-- YouTube Section -->\n<section class=\"content-section\" dr-if=\"@this@.items && @this@.items.length > 0\">\n    <h2 class=\"section-title\">\n      <i class=\"fa-solid fa-chart-line\"></i>\n        Finance Chart\n    </h2>\n    <div class=\"movie-grid\">\n        <div class=\"movie-card\" dr-for-of=\"@this@.items\" dr-option-item-variable-name=\"item\">\n            <dr-a dr-if=\"#item#\" href=\"${'/finance/' + #item#.symbol}$\" class=\"movie-poster-link\">\n                <div class=\"movie-poster youtube\">\n                    <img dr-attr=\"{src:  '/datas/finance/item/'+#item#.symbol+'.png', alt: #item#.name}\" />\n<!--                    <div class=\"movie-actions\" dr-if=\"#item#.link\">-->\n<!--                        <a dr-attr=\"{href: #item#.link}\" target=\"_blank\" rel=\"noopener noreferrer\"-->\n<!--                            class=\"external-link\">-->\n<!--                            <i class=\"fa-solid fa-link\"></i>-->\n<!--                        </a>-->\n<!--                    </div>-->\n                </div>\n                <h3 class=\"movie-title\">${#item#.label}$</h3>\n            </dr-a>\n            <iframe dr-if=\"!#item#\" src=\"https://lazycollect.com/assets/dooboostore/adfit/255x255.html\" style=\"width: 100%; height: 100%; overflow: hidden\" scrolling=\"false\" frameborder=\"0\"></iframe>\n        </div>\n    </div>\n</section>\n\n");

/***/ }),

/***/ "./src/pages/finance/finance.route.component.ts":
/*!******************************************************!*\
  !*** ./src/pages/finance/finance.route.component.ts ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FinanceRouteComponent: () => (/* binding */ FinanceRouteComponent)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/simple-boot-front/decorators/Component */ "../../packages/@dooboostore/simple-boot-front/src/decorators/Component.ts");
/* harmony import */ var _finance_route_component_html__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./finance.route.component.html */ "./src/pages/finance/finance.route.component.html");
/* harmony import */ var _finance_route_component_css__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./finance.route.component.css */ "./src/pages/finance/finance.route.component.css");
/* harmony import */ var _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @dooboostore/core-web/valid/ValidUtils */ "../../packages/@dooboostore/core-web/src/valid/ValidUtils.ts");
/* harmony import */ var _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @dooboostore/dom-render/components/ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _src_service_english_FinanceService__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @src/service/english/FinanceService */ "./src/service/english/FinanceService.ts");
var _a;








let FinanceRouteComponent = class FinanceRouteComponent extends _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_6__.ComponentBase {
    financeService;
    name = 'english-route';
    items = undefined;
    constructor(financeService) {
        super();
        this.financeService = financeService;
    }
    async onRawSetRendered(rawSet, otherData) {
        await super.onRawSetRendered(rawSet, otherData);
    }
    //
    async onRouting(r) {
        await new Promise((r, j) => setTimeout(r, 0));
        // this.items = [{},{}]
    }
    async onInitRender(param, rawSet) {
        await super.onInitRender(param, rawSet);
        this.name = 'english-route' + Date.now();
        if (_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_5__.ValidUtils.isBrowser()) {
            const items = [];
            (await this.financeService.items()).forEach((it, index) => {
                items.push(it);
                if (index > 0 && Math.random() < 0.2) {
                    items.push(null);
                }
            });
            this.items = items;
            console.log('-------->', this.name, this.items);
        }
    }
    async add() {
    }
    onDestroy() {
        super.onDestroy();
    }
};
FinanceRouteComponent = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_4__.Sim,
    (0,_dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_1__.Component)({
        template: _finance_route_component_html__WEBPACK_IMPORTED_MODULE_2__["default"],
        styles: _finance_route_component_css__WEBPACK_IMPORTED_MODULE_3__["default"]
    }),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _src_service_english_FinanceService__WEBPACK_IMPORTED_MODULE_7__.FinanceService !== "undefined" && _src_service_english_FinanceService__WEBPACK_IMPORTED_MODULE_7__.FinanceService) === "function" ? _a : Object])
], FinanceRouteComponent);



/***/ }),

/***/ "./src/pages/finance/finance.router.component.css":
/*!********************************************************!*\
  !*** ./src/pages/finance/finance.router.component.css ***!
  \********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("/* Fixed Header */\n.english-header {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  z-index: 1000;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  color: white;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n}\n\n.header-content {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.75rem 1.5rem;\n  max-width: 1200px;\n  margin: 0 auto;\n}\n\n.header-left {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  flex: 1;\n  min-width: 0; /* Allow shrinking */\n}\n\n.header-title {\n  font-size: 1.1rem;\n  font-weight: 500;\n  margin: 0;\n}\n\n/* Home Button - Always at the left edge */\n.home-btn {\n  background: rgba(255, 255, 255, 0.1);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  color: white;\n  cursor: pointer;\n  padding: 0.5rem;\n  transition: all 0.3s ease;\n  font-size: 1.1rem;\n  min-width: 40px;\n  height: 40px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-shrink: 0; /* Don't shrink */\n}\n\n.home-btn:hover {\n  background: rgba(255, 255, 255, 0.2);\n  transform: translateY(-1px);\n}\n\n/* Current Item Info - Horizontal layout with image */\n.current-item-info {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  background: rgba(255, 255, 255, 0.1);\n  padding: 0.4rem 0.8rem;\n  border-radius: 8px;\n  min-width: 0; /* Allow shrinking */\n  max-width: 400px; /* Limit max width */\n}\n\n.item-image {\n  width: 32px;\n  height: 32px;\n  border-radius: 4px;\n  object-fit: cover;\n  flex-shrink: 0; /* Don't shrink image */\n  border: 1px solid rgba(255, 255, 255, 0.2);\n}\n\n.item-details {\n  display: flex;\n  flex-direction: column;\n  gap: 0.1rem;\n  min-width: 0; /* Allow shrinking */\n  flex: 1;\n}\n\n.item-name {\n  font-weight: 500;\n  font-size: 0.9rem;\n  color: white;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis; /* Add ... for long names */\n}\n\n.item-type {\n  font-size: 0.75rem;\n  opacity: 0.8;\n  color: rgba(255, 255, 255, 0.8);\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n}\n\n.user-menu {\n  display: flex;\n  gap: 0.3rem;\n  align-items: center;\n}\n\n.menu-btn {\n  display: flex;\n  align-items: center;\n  gap: 0.4rem;\n  padding: 0.4rem 0.8rem;\n  background: rgba(255, 255, 255, 0.1);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  color: white;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  font-size: 0.8rem;\n}\n\n.menu-btn:hover {\n  background: rgba(255, 255, 255, 0.2);\n  transform: translateY(-1px);\n}\n\n.favorites-count {\n  background: #ff4757;\n  color: white;\n  border-radius: 50%;\n  padding: 0.15rem 0.4rem;\n  font-size: 0.7rem;\n  min-width: 1.2rem;\n  text-align: center;\n}\n\n/* Favorites Panel */\n.favorites-panel {\n  position: absolute;\n  top: 100%;\n  right: 2rem;\n  width: 400px;\n  max-height: 500px;\n  background: white;\n  color: #333;\n  border-radius: 12px;\n  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);\n  overflow: hidden;\n  transform: translateY(-10px);\n  opacity: 0;\n  visibility: hidden;\n  transition: all 0.3s ease;\n}\n\n.favorites-panel.show {\n  transform: translateY(0);\n  opacity: 1;\n  visibility: visible;\n}\n\n.panel-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1rem 1.5rem;\n  background: #f8f9fa;\n  border-bottom: 1px solid #e9ecef;\n}\n\n.panel-header h3 {\n  margin: 0;\n  font-size: 1.1rem;\n  color: #495057;\n}\n\n.close-btn {\n  background: none;\n  border: none;\n  color: #6c757d;\n  cursor: pointer;\n  padding: 0.5rem;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n}\n\n.close-btn:hover {\n  background: #e9ecef;\n  color: #495057;\n}\n\n.favorites-content {\n  max-height: 400px;\n  overflow-y: auto;\n  padding: 1rem;\n}\n\n.empty-message {\n  text-align: center;\n  color: #6c757d;\n  padding: 2rem;\n  font-style: italic;\n}\n\n.favorite-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.75rem;\n  border-radius: 8px;\n  margin-bottom: 0.5rem;\n  background: #f8f9fa;\n  transition: all 0.2s ease;\n}\n\n.favorite-item:hover {\n  background: #e9ecef;\n}\n\n.word-info {\n  flex: 1;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border-radius: 4px;\n  padding: 0.25rem;\n  margin: -0.25rem;\n}\n\n.word-info:hover {\n  background-color: rgba(33, 150, 243, 0.05);\n}\n\n.word-text {\n  font-weight: 600;\n  color: #495057;\n  display: block;\n  margin-bottom: 0.25rem;\n}\n\n.clickable-word {\n  cursor: pointer;\n  transition: all 0.2s ease;\n  border-radius: 3px;\n  padding: 2px 4px;\n  margin: -2px -4px;\n}\n\n.clickable-word:hover {\n  background-color: #e3f2fd;\n  color: #1976d2;\n}\n\n.word-meaning {\n  font-size: 0.9rem;\n  color: #6c757d;\n}\n\n.remove-btn {\n  background: none;\n  border: none;\n  color: #dc3545;\n  cursor: pointer;\n  padding: 0.5rem;\n  border-radius: 4px;\n  transition: all 0.2s ease;\n}\n\n.remove-btn:hover {\n  background: rgba(220, 53, 69, 0.1);\n}\n\n/* Main Content */\n.english-main {\n  margin-top: 60px; /* Header height + some spacing */\n  min-height: calc(100vh - 60px);\n}\n\n/* Player page - no margin (both PC and mobile) */\n.english-main:has(.player-container) {\n  margin-top: 0;\n  height: 100vh; /*  100vh, min-height  */\n  overflow: hidden; /*    */\n}\n\n/* Mobile Responsive */\n@media (max-width: 768px) {\n  .header-content {\n    padding: 0.6rem 1rem;\n  }\n  \n  .header-left {\n    gap: 0.5rem;\n  }\n  \n  .header-title {\n    font-size: 1rem;\n  }\n  \n  .home-btn {\n    min-width: 36px;\n    height: 36px;\n    font-size: 1rem;\n  }\n  \n  .current-item-info {\n    padding: 0.3rem 0.6rem;\n    gap: 0.5rem;\n    max-width: 250px; /* Smaller max width on mobile */\n  }\n  \n  .item-image {\n    width: 28px;\n    height: 28px;\n  }\n  \n  .item-name {\n    font-size: 0.8rem;\n  }\n  \n  .item-type {\n    display: none; /* Hide type on mobile to save space */\n  }\n  \n  /* Hide current item info in landscape mode */\n  @media (max-height: 500px) and (orientation: landscape) {\n    .current-item-info {\n      display: none;\n    }\n    \n    .header-content {\n      padding: 0.4rem 1rem; /*    */\n    }\n    \n    .home-btn {\n      min-width: 32px;\n      height: 32px;\n    }\n  }\n  \n  .menu-btn span {\n    display: none;\n  }\n  \n  .menu-btn {\n    padding: 0.4rem;\n    min-width: 36px;\n    justify-content: center;\n  }\n  \n  .favorites-panel {\n    right: 1rem;\n    left: 1rem;\n    width: auto;\n  }\n  \n  .english-main {\n    margin-top: 50px;\n  }\n}");

/***/ }),

/***/ "./src/pages/finance/finance.router.component.html":
/*!*********************************************************!*\
  !*** ./src/pages/finance/finance.router.component.html ***!
  \*********************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("<!-- Fixed Header -->\n<header class=\"english-header\">\n    <div class=\"header-content\">\n        <div class=\"header-left\">\n            <!-- Show home button when in sub-route (always at the left edge) -->\n            <dr-a href=\"/finance/\" class=\"home-btn\" dr-if=\"@this@.isInSubRoute\" title=\" \">\n                <i class=\"fas fa-home\"></i>\n            </dr-a>\n            \n            <!-- Show title when on main page -->\n            <h1 class=\"header-title\" dr-if=\"!@this@.isInSubRoute\">Finance</h1>\n            \n            <!-- Show current item info when in sub-route -->\n            <div class=\"current-item-info\" dr-if=\"@this@.currentItem\">\n                <img class=\"item-image\" dr-attr=\"{src: '/datas/finance/item/'+@this@.currentItem.symbol +'.png'}\" alt=\"Item image\">\n                <div class=\"item-details\">\n                    <span class=\"item-name\">${@this@.currentItem.label}$</span>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"user-menu\">\n            <div>\n                <img alt=\"Hits\" src=\"https://hits.sh/hits.sh/dooboostore.github.io_finance.svg?style=plastic&amp;\">\n            </div>\n        </div>\n    </div>\n\n</header>\n\n<main class=\"english-main\">\n    <dr-router-outlet createArguments=\"${@this@.getChildArguments()}$\"></dr-router-outlet>\n</main>");

/***/ }),

/***/ "./src/pages/finance/finance.router.component.ts":
/*!*******************************************************!*\
  !*** ./src/pages/finance/finance.router.component.ts ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FinanceRouterComponent: () => (/* binding */ FinanceRouterComponent)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_simple_boot_decorators_route_Router__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/route/Router */ "../../packages/@dooboostore/simple-boot/src/decorators/route/Router.ts");
/* harmony import */ var _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/simple-boot-front/decorators/Component */ "../../packages/@dooboostore/simple-boot-front/src/decorators/Component.ts");
/* harmony import */ var _finance_router_component_html__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./finance.router.component.html */ "./src/pages/finance/finance.router.component.html");
/* harmony import */ var _finance_router_component_css__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./finance.router.component.css */ "./src/pages/finance/finance.router.component.css");
/* harmony import */ var _dooboostore_simple_boot_front_component_ComponentRouterBase__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @dooboostore/simple-boot-front/component/ComponentRouterBase */ "../../packages/@dooboostore/simple-boot-front/src/component/ComponentRouterBase.ts");
/* harmony import */ var _finance_route_component__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./finance.route.component */ "./src/pages/finance/finance.route.component.ts");
/* harmony import */ var _dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @dooboostore/core-web/valid/ValidUtils */ "../../packages/@dooboostore/core-web/src/valid/ValidUtils.ts");
/* harmony import */ var _dooboostore_simple_boot_front_option_SimFrontOption__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @dooboostore/simple-boot-front/option/SimFrontOption */ "../../packages/@dooboostore/simple-boot-front/src/option/SimFrontOption.ts");
/* harmony import */ var _src_service_VoiceService__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @src/service/VoiceService */ "./src/service/VoiceService.ts");
/* harmony import */ var _back_end_environments_environment__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @back-end/environments/environment */ "./back-end/environments/environment.ts");
/* harmony import */ var _src_pages_finance_chart_chart_route_component__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @src/pages/finance/chart/chart.route.component */ "./src/pages/finance/chart/chart.route.component.ts");
/* harmony import */ var _src_service_english_FinanceService__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @src/service/english/FinanceService */ "./src/service/english/FinanceService.ts");
var _a, _b, _c;














let FinanceRouterComponent = class FinanceRouterComponent extends _dooboostore_simple_boot_front_component_ComponentRouterBase__WEBPACK_IMPORTED_MODULE_6__.ComponentRouterBase {
    config;
    financeService;
    voiceService;
    favoriteWords = [];
    showFavorites = false;
    // Current item info
    currentItemName;
    currentItem;
    // items?: Item[];
    isInSubRoute = false; // Track if we're in a sub-route
    name = 'zzz';
    constructor(config, financeService, voiceService) {
        super({ sameRouteNoApply: true });
        this.config = config;
        this.financeService = financeService;
        this.voiceService = voiceService;
    }
    onCreateRenderData(data) {
        super.onCreateRenderData(data);
        console.log('english.router.component onCreateRenderData-------');
    }
    onCreateRender(...param) {
        console.log('english.router.component onCreateRender-------');
    }
    async onInitRender(param, rawSet) {
        await super.onInitRender(param, rawSet);
        this.name = new Date().toISOString();
        console.log('english.router.component onInitRender-------');
        // Initialize speech synthesis voices
        this.initializeSpeechSynthesis();
    }
    async onRouting(r) {
        await super.onRouting(r);
        this.currentItemName = decodeURIComponent(r.routerModule.pathData?.name ?? '');
        this.currentItem = this.currentItemName ? await this.financeService.item(this.currentItemName) : undefined;
        if (this.config?.window) {
            const doc = this.config.window.document;
            const setMetaByProperty = (property, content) => {
                const d = doc.querySelector(`meta[property="${property}"]`);
                doc.querySelector(`meta[property="${property}"]`)?.setAttribute('content', content);
            };
            const setMetaByName = (name, content) => {
                doc.querySelector(`meta[name="${name}"]`)?.setAttribute('content', content);
            };
            const setLink = (rel, href) => {
                doc.querySelector(`link[rel="${rel}"]`)?.setAttribute('href', href);
            };
            const setTitle = (title) => {
                doc.title = title;
            };
            let pageTitle = 'Finance Chart';
            let pageDescription = 'Finance Chart and Data Visualization';
            let pageUrl = _back_end_environments_environment__WEBPACK_IMPORTED_MODULE_11__.environment.host + this.config.window.window.location.pathname;
            let pageImage = 'assets/images/dooboostore.png';
            if (this.currentItem) {
                // Page-specific SEO content
                pageTitle = this.currentItem.label;
                pageDescription = this.currentItem.label;
                pageImage = `/datas/finance/item/${this.currentItem.symbol}.png`;
                // Set Title, Description, Canonical URL
            }
            console.log('Setting SEO tags:', { pageTitle, pageDescription, pageUrl, pageImage });
            setTitle(pageTitle);
            setMetaByName('description', pageDescription);
            setLink('canonical', pageUrl);
            // Set Open Graph (OG) tags for social sharing
            setMetaByProperty('og:title', pageTitle);
            setMetaByProperty('og:description', pageDescription);
            setMetaByProperty('og:image', pageImage);
            setMetaByProperty('og:url', pageUrl);
            setMetaByProperty('og:type', 'website');
        }
        if (_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_8__.ValidUtils.isBrowser()) {
            // Get current item name from route
            // console.log('------->', r, this.currentItemName);
            // Check if we're in a sub-route (has name parameter)
            this.isInSubRoute = !!this.currentItemName;
        }
    }
    onCreatedThisChild(child, data) {
        super.onCreatedThisChild(child, data);
    }
    onCreatedThisChildDebounce(childrenSet) {
        super.onCreatedThisChildDebounce(childrenSet);
    }
    onDrThisUnBind() {
        super.onDrThisUnBind();
        this.onDestroyRender();
    }
    onDestroyRender(data) {
        super.onDestroyRender(data);
    }
    onCreatedOutletDebounce(a) {
        // Prism.highlightAll()   
    }
    initializeSpeechSynthesis() {
        // VoiceService handles initialization automatically
        console.log(' Voice service initialized in router');
    }
};
FinanceRouterComponent = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_2__.Sim,
    (0,_dooboostore_simple_boot_decorators_route_Router__WEBPACK_IMPORTED_MODULE_1__.Router)({
        path: '/finance',
        route: {
            '': '/',
            '/': _finance_route_component__WEBPACK_IMPORTED_MODULE_7__.FinanceRouteComponent,
            '/{name}': _src_pages_finance_chart_chart_route_component__WEBPACK_IMPORTED_MODULE_12__.ChartRouteComponent,
            '/{name}/': _src_pages_finance_chart_chart_route_component__WEBPACK_IMPORTED_MODULE_12__.ChartRouteComponent
        },
        routers: []
    }),
    (0,_dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_3__.Component)({
        template: _finance_router_component_html__WEBPACK_IMPORTED_MODULE_4__["default"],
        styles: _finance_router_component_css__WEBPACK_IMPORTED_MODULE_5__["default"]
    }),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _dooboostore_simple_boot_front_option_SimFrontOption__WEBPACK_IMPORTED_MODULE_9__.SimFrontOption !== "undefined" && _dooboostore_simple_boot_front_option_SimFrontOption__WEBPACK_IMPORTED_MODULE_9__.SimFrontOption) === "function" ? _a : Object, typeof (_b = typeof _src_service_english_FinanceService__WEBPACK_IMPORTED_MODULE_13__.FinanceService !== "undefined" && _src_service_english_FinanceService__WEBPACK_IMPORTED_MODULE_13__.FinanceService) === "function" ? _b : Object, typeof (_c = typeof _src_service_VoiceService__WEBPACK_IMPORTED_MODULE_10__.VoiceService !== "undefined" && _src_service_VoiceService__WEBPACK_IMPORTED_MODULE_10__.VoiceService) === "function" ? _c : Object])
], FinanceRouterComponent);



/***/ }),

/***/ "./src/pages/index.route.component.css":
/*!*********************************************!*\
  !*** ./src/pages/index.route.component.css ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("");

/***/ }),

/***/ "./src/pages/index.route.component.html":
/*!**********************************************!*\
  !*** ./src/pages/index.route.component.html ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("<dr-a href=\"/\" >home</dr-a>\n<dr-a href=\"/english\">english</dr-a>\n<dr-a href=\"/finance\">finance</dr-a>\n<dr-a href=\"/youtube-persona\">youtube-persona</dr-a>");

/***/ }),

/***/ "./src/pages/index.route.component.ts":
/*!********************************************!*\
  !*** ./src/pages/index.route.component.ts ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   IndexRouteComponent: () => (/* binding */ IndexRouteComponent)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/simple-boot-front/decorators/Component */ "../../packages/@dooboostore/simple-boot-front/src/decorators/Component.ts");
/* harmony import */ var _index_route_component_html__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./index.route.component.html */ "./src/pages/index.route.component.html");
/* harmony import */ var _index_route_component_css__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./index.route.component.css */ "./src/pages/index.route.component.css");
/* harmony import */ var _dooboostore_dom_render_operators_Appender__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @dooboostore/dom-render/operators/Appender */ "../../packages/@dooboostore/dom-render/src/operators/Appender.ts");
/* harmony import */ var _dooboostore_simple_boot_front_component_ComponentBase__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @dooboostore/simple-boot-front/component/ComponentBase */ "../../packages/@dooboostore/simple-boot-front/src/component/ComponentBase.ts");







let IndexRouteComponent = class IndexRouteComponent extends _dooboostore_simple_boot_front_component_ComponentBase__WEBPACK_IMPORTED_MODULE_6__.ComponentBase {
    fetchAppender = new _dooboostore_dom_render_operators_Appender__WEBPACK_IMPORTED_MODULE_5__.Appender();
    sw = true;
    constructor() {
        super();
    }
    onCreatedThisChildDebounce(childrenSet) {
        super.onCreatedThisChildDebounce(childrenSet);
        // console.log('vvvvvvvv');
    }
    async onRouting(r) {
        await super.onRouting(r);
        // console.log('index route onRouting??', r);
    }
};
IndexRouteComponent = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    (0,_dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__.Sim)({
        scope: _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__.Lifecycle.Transient,
    }),
    (0,_dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_2__.Component)({
        template: _index_route_component_html__WEBPACK_IMPORTED_MODULE_3__["default"],
        styles: _index_route_component_css__WEBPACK_IMPORTED_MODULE_4__["default"],
    }),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [])
], IndexRouteComponent);



/***/ }),

/***/ "./src/pages/index.router.component.css":
/*!**********************************************!*\
  !*** ./src/pages/index.router.component.css ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("");

/***/ }),

/***/ "./src/pages/index.router.component.html":
/*!***********************************************!*\
  !*** ./src/pages/index.router.component.html ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("<main>\n    <dr-router-outlet></dr-router-outlet>\n</main>");

/***/ }),

/***/ "./src/pages/index.router.component.ts":
/*!*********************************************!*\
  !*** ./src/pages/index.router.component.ts ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   IndexRouterComponent: () => (/* binding */ IndexRouterComponent)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_simple_boot_decorators_route_Router__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/route/Router */ "../../packages/@dooboostore/simple-boot/src/decorators/route/Router.ts");
/* harmony import */ var _dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/simple-boot-front/decorators/Component */ "../../packages/@dooboostore/simple-boot-front/src/decorators/Component.ts");
/* harmony import */ var _index_route_component__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./index.route.component */ "./src/pages/index.route.component.ts");
/* harmony import */ var _dooboostore_simple_boot_front_component_ComponentRouterBase__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @dooboostore/simple-boot-front/component/ComponentRouterBase */ "../../packages/@dooboostore/simple-boot-front/src/component/ComponentRouterBase.ts");
/* harmony import */ var _index_router_component_html__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./index.router.component.html */ "./src/pages/index.router.component.html");
/* harmony import */ var _index_router_component_css__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./index.router.component.css */ "./src/pages/index.router.component.css");
/* harmony import */ var _dooboostore_dom_render_components_index__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @dooboostore/dom-render/components/index */ "../../packages/@dooboostore/dom-render/src/components/index.ts");
/* harmony import */ var _src_component__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @src/component */ "./src/component/index.ts");
/* harmony import */ var _dooboostore_dom_render_routers_Router__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @dooboostore/dom-render/routers/Router */ "../../packages/@dooboostore/dom-render/src/routers/Router.ts");
/* harmony import */ var _src_pages_english_english_router_component__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @src/pages/english/english.router.component */ "./src/pages/english/english.router.component.ts");
/* harmony import */ var _src_pages_finance_finance_router_component__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @src/pages/finance/finance.router.component */ "./src/pages/finance/finance.router.component.ts");
/* harmony import */ var _src_pages_youtube_persona_youtube_persona_router_component__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @src/pages/youtube-persona/youtube-persona.router.component */ "./src/pages/youtube-persona/youtube-persona.router.component.ts");
var _a;














let IndexRouterComponent = class IndexRouterComponent extends _dooboostore_simple_boot_front_component_ComponentRouterBase__WEBPACK_IMPORTED_MODULE_5__.ComponentRouterBase {
    router;
    name = 'index-router';
    constructor(router) {
        super({ sameRouteNoApply: true });
        this.router = router;
    }
    async onInitRender(param, rawSet) {
        await super.onInitRender(param, rawSet);
        this.name = 'index-router' + Date.now();
    }
    test() { }
};
IndexRouterComponent = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__.Sim,
    (0,_dooboostore_simple_boot_decorators_route_Router__WEBPACK_IMPORTED_MODULE_2__.Router)({
        path: "",
        route: {
            "/": _index_route_component__WEBPACK_IMPORTED_MODULE_4__.IndexRouteComponent,
        },
        routers: [_src_pages_english_english_router_component__WEBPACK_IMPORTED_MODULE_11__.EnglishRouterComponent, _src_pages_finance_finance_router_component__WEBPACK_IMPORTED_MODULE_12__.FinanceRouterComponent, _src_pages_youtube_persona_youtube_persona_router_component__WEBPACK_IMPORTED_MODULE_13__.YoutubePersonaRouterComponent],
    }),
    (0,_dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_3__.Component)({
        template: _index_router_component_html__WEBPACK_IMPORTED_MODULE_6__["default"],
        styles: _index_router_component_css__WEBPACK_IMPORTED_MODULE_7__["default"],
        using: [_dooboostore_dom_render_components_index__WEBPACK_IMPORTED_MODULE_8__.drComponent, _src_component__WEBPACK_IMPORTED_MODULE_9__["default"]],
    }),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _dooboostore_dom_render_routers_Router__WEBPACK_IMPORTED_MODULE_10__.Router !== "undefined" && _dooboostore_dom_render_routers_Router__WEBPACK_IMPORTED_MODULE_10__.Router) === "function" ? _a : Object])
], IndexRouterComponent);



/***/ }),

/***/ "./src/pages/youtube-persona/detail/youtube-persona-detail.route.component.css":
/*!*************************************************************************************!*\
  !*** ./src/pages/youtube-persona/detail/youtube-persona-detail.route.component.css ***!
  \*************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (".content-section {\n    padding: 2rem;\n    max-width: 1400px;\n    margin: 0 auto;\n}\n\n.header {\n    margin-bottom: 2rem;\n}\n\n.back-link {\n    display: inline-flex;\n    align-items: center;\n    gap: 0.5rem;\n    color: #666;\n    text-decoration: none;\n    margin-bottom: 1rem;\n    font-size: 0.95rem;\n    transition: color 0.2s;\n}\n\n.back-link:hover {\n    color: #ff0000;\n}\n\n.section-title {\n    font-size: 2rem;\n    color: #333;\n    margin: 0;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.persona-emoji {\n    font-size: 2.5rem;\n    line-height: 1;\n}\n\n.video-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));\n    gap: 1.5rem;\n}\n\n.video-card {\n    background: #fff;\n    border-radius: 12px;\n    overflow: hidden;\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n    transition: transform 0.2s, box-shadow 0.2s;\n}\n\n.video-card:hover {\n    transform: translateY(-4px);\n    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);\n}\n\n.video-link {\n    display: block;\n    text-decoration: none;\n    color: inherit;\n}\n\n.video-thumbnail {\n    position: relative;\n    width: 100%;\n    padding-top: 56.25%; /* 16:9 aspect ratio */\n    background: #000;\n    overflow: hidden;\n}\n\n.video-thumbnail img {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n}\n\n.play-overlay {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    width: 68px;\n    height: 48px;\n    background: rgba(255, 0, 0, 0.9);\n    border-radius: 12px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    opacity: 0;\n    transition: opacity 0.2s;\n}\n\n.video-card:hover .play-overlay {\n    opacity: 1;\n}\n\n.play-overlay i {\n    color: #fff;\n    font-size: 2rem;\n}\n\n.video-info {\n    padding: 1rem;\n}\n\n.video-title {\n    font-size: 1rem;\n    font-weight: 600;\n    margin: 0 0 0.75rem 0;\n    color: #222;\n    line-height: 1.4;\n    display: -webkit-box;\n    -webkit-line-clamp: 2;\n    -webkit-box-orient: vertical;\n    overflow: hidden;\n}\n\n.channel-info {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n    margin-bottom: 0.5rem;\n}\n\n.channel-avatar {\n    width: 24px;\n    height: 24px;\n    border-radius: 50%;\n    object-fit: cover;\n}\n\n.channel-name {\n    font-size: 0.875rem;\n    color: #606060;\n}\n\n.video-meta {\n    font-size: 0.875rem;\n    color: #606060;\n    margin-bottom: 0.5rem;\n}\n\n.video-description {\n    font-size: 0.875rem;\n    color: #606060;\n    line-height: 1.4;\n    margin: 0;\n    display: -webkit-box;\n    -webkit-line-clamp: 2;\n    -webkit-box-orient: vertical;\n    overflow: hidden;\n}\n\n.loading,\n.empty {\n    text-align: center;\n    padding: 4rem;\n    font-size: 1.25rem;\n    color: #666;\n}\n\n@media (max-width: 768px) {\n    .video-grid {\n        grid-template-columns: 1fr;\n        gap: 1rem;\n    }\n    \n    .content-section {\n        padding: 1rem;\n    }\n    \n    .section-title {\n        font-size: 1.5rem;\n    }\n}\n\n/* Dark mode */\n@media (prefers-color-scheme: dark) {\n    .back-link {\n        color: #b0b0b0;\n    }\n    \n    .back-link:hover {\n        color: #ff5555;\n    }\n    \n    .section-title {\n        color: #e0e0e0;\n    }\n    \n    .video-card {\n        background: #2a2a2a;\n        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);\n    }\n    \n    .video-card:hover {\n        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);\n    }\n    \n    .video-title {\n        color: #e0e0e0;\n    }\n    \n    .channel-name {\n        color: #b0b0b0;\n    }\n    \n    .video-meta {\n        color: #b0b0b0;\n    }\n    \n    .video-description {\n        color: #b0b0b0;\n    }\n    \n    .loading,\n    .empty {\n        color: #b0b0b0;\n    }\n}\n");

/***/ }),

/***/ "./src/pages/youtube-persona/detail/youtube-persona-detail.route.component.html":
/*!**************************************************************************************!*\
  !*** ./src/pages/youtube-persona/detail/youtube-persona-detail.route.component.html ***!
  \**************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("<section class=\"content-section\">\n<!--    <div class=\"header\">-->\n<!--&lt;!&ndash;        <dr-a href=\"/youtube-persona\" class=\"back-link\">&ndash;&gt;-->\n<!--&lt;!&ndash;            <i class=\"fa-solid fa-arrow-left\"></i> Back to Personas&ndash;&gt;-->\n<!--&lt;!&ndash;        </dr-a>&ndash;&gt;-->\n<!--        <h2 class=\"section-title\">-->\n<!--            <span class=\"persona-emoji\" dr-if=\"@this@.persona && @this@.persona.categoryEmojis && @this@.persona.categoryEmojis.length > 0\">${@this@.persona.categoryEmojis[0]}$</span>-->\n<!--            ${@this@.personaName}$-->\n<!--        </h2>-->\n<!--    </div>-->\n\n    <div class=\"video-grid\" dr-if=\"@this@.videos && @this@.videos.length > 0\">\n        <div class=\"video-card\" dr-for-of=\"@this@.videos\" dr-option-item-variable-name=\"video\">\n            <a dr-attr=\"{href: #video#.url}\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"video-link\">\n                <div class=\"video-thumbnail\">\n                    <img dr-attr=\"{src: #video#.thumbnail, alt: #video#.title}\" />\n                    <div class=\"play-overlay\">\n                        <i class=\"fa-brands fa-youtube\"></i>\n                    </div>\n                </div>\n                <div class=\"video-info\">\n                    <h3 class=\"video-title\">${#video#.title}$</h3>\n                    <div class=\"channel-info\">\n                        <img dr-if=\"#video#.channelThumbnail\" dr-attr=\"{src: #video#.channelThumbnail, alt: #video#.channel}\" class=\"channel-avatar\" />\n                        <span class=\"channel-name\">${#video#.channel}$</span>\n                    </div>\n                    <div class=\"video-meta\">\n                        <span dr-if=\"#video#.viewCount\">${#video#.viewCount}$</span>\n                        <span dr-if=\"#video#.viewCount && #video#.publishedTime\">  </span>\n                        <span dr-if=\"#video#.publishedTime\">${#video#.publishedTime}$</span>\n                    </div>\n                    <p class=\"video-description\" dr-if=\"#video#.description\">${#video#.description}$</p>\n                </div>\n            </a>\n        </div>\n    </div>\n\n    <div class=\"loading\" dr-if=\"!@this@.videos\">\n        Loading videos...\n    </div>\n\n    <div class=\"empty\" dr-if=\"@this@.videos && @this@.videos.length === 0\">\n        No videos found for this persona.\n    </div>\n</section>\n");

/***/ }),

/***/ "./src/pages/youtube-persona/detail/youtube-persona-detail.route.component.ts":
/*!************************************************************************************!*\
  !*** ./src/pages/youtube-persona/detail/youtube-persona-detail.route.component.ts ***!
  \************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   YoutubePersonaDetailRouteComponent: () => (/* binding */ YoutubePersonaDetailRouteComponent)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/simple-boot-front/decorators/Component */ "../../packages/@dooboostore/simple-boot-front/src/decorators/Component.ts");
/* harmony import */ var _youtube_persona_detail_route_component_html__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./youtube-persona-detail.route.component.html */ "./src/pages/youtube-persona/detail/youtube-persona-detail.route.component.html");
/* harmony import */ var _youtube_persona_detail_route_component_css__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./youtube-persona-detail.route.component.css */ "./src/pages/youtube-persona/detail/youtube-persona-detail.route.component.css");
/* harmony import */ var _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @dooboostore/core-web/valid/ValidUtils */ "../../packages/@dooboostore/core-web/src/valid/ValidUtils.ts");
/* harmony import */ var _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @dooboostore/dom-render/components/ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _src_service_youtube_persona_YoutubePersonaService__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @src/service/youtube-persona/YoutubePersonaService */ "./src/service/youtube-persona/YoutubePersonaService.ts");
var _a;








let YoutubePersonaDetailRouteComponent = class YoutubePersonaDetailRouteComponent extends _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_6__.ComponentBase {
    youtubePersonaService;
    personaName;
    persona;
    videos = undefined;
    constructor(youtubePersonaService) {
        super();
        this.youtubePersonaService = youtubePersonaService;
    }
    async onRouting(r) {
        this.personaName = decodeURIComponent(r.routerModule.pathData?.name ?? '');
        if (_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_5__.ValidUtils.isBrowser() && this.personaName) {
            try {
                this.persona = await this.youtubePersonaService.persona(this.personaName);
                this.videos = await this.youtubePersonaService.videos(this.personaName);
            }
            catch (error) {
                console.error('Failed to load videos:', error);
                this.videos = [];
            }
        }
    }
    async onInitRender(param, rawSet) {
        await super.onInitRender(param, rawSet);
    }
    onDestroy() {
        super.onDestroy();
    }
};
YoutubePersonaDetailRouteComponent = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    (0,_dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_4__.Sim)({ scope: _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_4__.Lifecycle.Transient }),
    (0,_dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_1__.Component)({
        template: _youtube_persona_detail_route_component_html__WEBPACK_IMPORTED_MODULE_2__["default"],
        styles: _youtube_persona_detail_route_component_css__WEBPACK_IMPORTED_MODULE_3__["default"]
    }),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _src_service_youtube_persona_YoutubePersonaService__WEBPACK_IMPORTED_MODULE_7__.YoutubePersonaService !== "undefined" && _src_service_youtube_persona_YoutubePersonaService__WEBPACK_IMPORTED_MODULE_7__.YoutubePersonaService) === "function" ? _a : Object])
], YoutubePersonaDetailRouteComponent);



/***/ }),

/***/ "./src/pages/youtube-persona/youtube-persona.route.component.css":
/*!***********************************************************************!*\
  !*** ./src/pages/youtube-persona/youtube-persona.route.component.css ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (".content-section {\n    padding: 2rem;\n    max-width: 1400px;\n    margin: 0 auto;\n}\n\n.section-title {\n    font-size: 2rem;\n    margin-bottom: 2rem;\n    color: #333;\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n}\n\n.section-title i {\n    color: #ff0000;\n}\n\n.persona-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));\n    gap: 2rem;\n}\n\n.persona-card {\n    background: #fff;\n    border-radius: 12px;\n    overflow: hidden;\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n    transition: transform 0.2s, box-shadow 0.2s;\n}\n\n.persona-card:hover {\n    transform: translateY(-4px);\n    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.15);\n}\n\n.persona-link {\n    display: block;\n    text-decoration: none;\n    color: inherit;\n    padding: 1.5rem;\n}\n\n.persona-emojis {\n    display: flex;\n    justify-content: center;\n    gap: 0.5rem;\n    margin-bottom: 1rem;\n    font-size: 2.5rem;\n}\n\n.emoji {\n    animation: float 3s ease-in-out infinite;\n}\n\n.emoji:nth-child(2) {\n    animation-delay: 0.5s;\n}\n\n.emoji:nth-child(3) {\n    animation-delay: 1s;\n}\n\n.emoji:nth-child(4) {\n    animation-delay: 1.5s;\n}\n\n.emoji:nth-child(5) {\n    animation-delay: 2s;\n}\n\n@keyframes float {\n    0%, 100% {\n        transform: translateY(0);\n    }\n    50% {\n        transform: translateY(-10px);\n    }\n}\n\n.persona-title {\n    font-size: 1.25rem;\n    font-weight: 600;\n    margin-bottom: 1rem;\n    text-align: center;\n    color: #222;\n}\n\n.persona-keywords {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 0.5rem;\n    justify-content: center;\n}\n\n.keyword {\n    background: #f0f0f0;\n    padding: 0.25rem 0.75rem;\n    border-radius: 12px;\n    font-size: 0.85rem;\n    color: #666;\n}\n\n.loading {\n    text-align: center;\n    padding: 4rem;\n    font-size: 1.25rem;\n    color: #666;\n}\n\n/* Dark mode */\n@media (prefers-color-scheme: dark) {\n    .section-title {\n        color: #e0e0e0;\n    }\n    \n    .persona-card {\n        background: #2a2a2a;\n        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);\n    }\n    \n    .persona-card:hover {\n        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.4);\n    }\n    \n    .persona-title {\n        color: #e0e0e0;\n    }\n    \n    .keyword {\n        background: #3a3a3a;\n        color: #b0b0b0;\n    }\n    \n    .loading {\n        color: #b0b0b0;\n    }\n}\n\n@media (max-width: 768px) {\n    .persona-grid {\n        grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n        gap: 1rem;\n    }\n    \n    .content-section {\n        padding: 1rem;\n    }\n}\n");

/***/ }),

/***/ "./src/pages/youtube-persona/youtube-persona.route.component.html":
/*!************************************************************************!*\
  !*** ./src/pages/youtube-persona/youtube-persona.route.component.html ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("<section class=\"content-section\" dr-if=\"@this@.personas && @this@.personas.length > 0\">\n    <h2 class=\"section-title\">\n        <i class=\"fa-brands fa-youtube\"></i>\n        YouTube Personas\n    </h2>\n    <div class=\"persona-grid\">\n        <div class=\"persona-card\" dr-for-of=\"@this@.personas\" dr-option-item-variable-name=\"persona\">\n            <dr-a href=\"${'/youtube-persona/' + encodeURIComponent(#persona#.persona)}$\" class=\"persona-link\">\n                <div class=\"persona-emojis\">\n                    <span dr-for-of=\"#persona#.categoryEmojis\" dr-option-item-variable-name=\"emoji\" class=\"emoji\">${#emoji#}$</span>\n                </div>\n                <h3 class=\"persona-title\">${#persona#.persona}$</h3>\n                <div class=\"persona-keywords\">\n                    <span dr-for-of=\"#persona#.keywords\" dr-option-item-variable-name=\"keyword\" class=\"keyword\">${#keyword#}$</span>\n                </div>\n            </dr-a>\n        </div>\n    </div>\n</section>\n\n<section class=\"content-section\" dr-if=\"!@this@.personas || @this@.personas.length === 0\">\n    <div class=\"loading\">Loading personas...</div>\n</section>\n");

/***/ }),

/***/ "./src/pages/youtube-persona/youtube-persona.route.component.ts":
/*!**********************************************************************!*\
  !*** ./src/pages/youtube-persona/youtube-persona.route.component.ts ***!
  \**********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   YoutubePersonaRouteComponent: () => (/* binding */ YoutubePersonaRouteComponent)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/simple-boot-front/decorators/Component */ "../../packages/@dooboostore/simple-boot-front/src/decorators/Component.ts");
/* harmony import */ var _youtube_persona_route_component_html__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./youtube-persona.route.component.html */ "./src/pages/youtube-persona/youtube-persona.route.component.html");
/* harmony import */ var _youtube_persona_route_component_css__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./youtube-persona.route.component.css */ "./src/pages/youtube-persona/youtube-persona.route.component.css");
/* harmony import */ var _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @dooboostore/core-web/valid/ValidUtils */ "../../packages/@dooboostore/core-web/src/valid/ValidUtils.ts");
/* harmony import */ var _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @dooboostore/dom-render/components/ComponentBase */ "../../packages/@dooboostore/dom-render/src/components/ComponentBase.ts");
/* harmony import */ var _src_service_youtube_persona_YoutubePersonaService__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @src/service/youtube-persona/YoutubePersonaService */ "./src/service/youtube-persona/YoutubePersonaService.ts");
var _a;








let YoutubePersonaRouteComponent = class YoutubePersonaRouteComponent extends _dooboostore_dom_render_components_ComponentBase__WEBPACK_IMPORTED_MODULE_6__.ComponentBase {
    youtubePersonaService;
    personas = undefined;
    constructor(youtubePersonaService) {
        super();
        this.youtubePersonaService = youtubePersonaService;
    }
    async onRouting(r) {
        await new Promise((r, j) => setTimeout(r, 0));
    }
    async onInitRender(param, rawSet) {
        await super.onInitRender(param, rawSet);
        if (_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_5__.ValidUtils.isBrowser()) {
            try {
                this.personas = await this.youtubePersonaService.personas();
            }
            catch (error) {
                console.error('Failed to load personas:', error);
                this.personas = [];
            }
        }
    }
    onDestroy() {
        super.onDestroy();
    }
};
YoutubePersonaRouteComponent = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_4__.Sim,
    (0,_dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_1__.Component)({
        template: _youtube_persona_route_component_html__WEBPACK_IMPORTED_MODULE_2__["default"],
        styles: _youtube_persona_route_component_css__WEBPACK_IMPORTED_MODULE_3__["default"]
    }),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _src_service_youtube_persona_YoutubePersonaService__WEBPACK_IMPORTED_MODULE_7__.YoutubePersonaService !== "undefined" && _src_service_youtube_persona_YoutubePersonaService__WEBPACK_IMPORTED_MODULE_7__.YoutubePersonaService) === "function" ? _a : Object])
], YoutubePersonaRouteComponent);



/***/ }),

/***/ "./src/pages/youtube-persona/youtube-persona.router.component.css":
/*!************************************************************************!*\
  !*** ./src/pages/youtube-persona/youtube-persona.router.component.css ***!
  \************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("/* Fixed Header */\n.english-header {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  z-index: 1000;\n  background: linear-gradient(135deg, #ff0000 0%, #cc0000 100%);\n  color: white;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);\n}\n\n.header-content {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 0.75rem 1.5rem;\n  max-width: 1200px;\n  margin: 0 auto;\n}\n\n.header-left {\n  display: flex;\n  align-items: center;\n  gap: 1rem;\n  flex: 1;\n  min-width: 0;\n}\n\n.header-title {\n  font-size: 1.1rem;\n  font-weight: 500;\n  margin: 0;\n}\n\n.home-btn {\n  background: rgba(255, 255, 255, 0.1);\n  border: 1px solid rgba(255, 255, 255, 0.2);\n  border-radius: 6px;\n  color: white;\n  cursor: pointer;\n  padding: 0.5rem;\n  transition: all 0.3s ease;\n  font-size: 1.1rem;\n  min-width: 40px;\n  height: 40px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-shrink: 0;\n  text-decoration: none;\n}\n\n.home-btn:hover {\n  background: rgba(255, 255, 255, 0.2);\n  transform: translateY(-1px);\n}\n\n.current-item-info {\n  display: flex;\n  align-items: center;\n  gap: 0.75rem;\n  background: rgba(255, 255, 255, 0.1);\n  padding: 0.4rem 0.8rem;\n  border-radius: 8px;\n  min-width: 0;\n  max-width: 400px;\n}\n\n.item-details {\n  display: flex;\n  flex-direction: column;\n  gap: 0.1rem;\n  min-width: 0;\n  flex: 1;\n}\n\n.item-name {\n  font-weight: 500;\n  font-size: 0.9rem;\n  color: white;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: flex;\n  align-items: center;\n  gap: 0.3rem;\n}\n\n.persona-emoji {\n  font-size: 1.2rem;\n  line-height: 1;\n  flex-shrink: 0;\n}\n\n.user-menu {\n  display: flex;\n  gap: 0.3rem;\n  align-items: center;\n}\n\n/* Main Content */\n.english-main {\n  margin-top: 60px;\n  min-height: calc(100vh - 60px);\n  background-color: #ffffff;\n}\n\n/* Dark mode */\n@media (prefers-color-scheme: dark) {\n  .english-main {\n    background-color: #1a1a1a;\n  }\n}\n\n/* Mobile Responsive */\n@media (max-width: 768px) {\n  .header-content {\n    padding: 0.6rem 1rem;\n  }\n  \n  .header-left {\n    gap: 0.5rem;\n  }\n  \n  .header-title {\n    font-size: 1rem;\n  }\n  \n  .home-btn {\n    min-width: 36px;\n    height: 36px;\n    font-size: 1rem;\n  }\n  \n  .current-item-info {\n    padding: 0.3rem 0.6rem;\n    gap: 0.5rem;\n    max-width: 250px;\n  }\n  \n  .item-name {\n    font-size: 0.8rem;\n  }\n  \n  .english-main {\n    margin-top: 50px;\n  }\n}\n\n");

/***/ }),

/***/ "./src/pages/youtube-persona/youtube-persona.router.component.html":
/*!*************************************************************************!*\
  !*** ./src/pages/youtube-persona/youtube-persona.router.component.html ***!
  \*************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ("<!-- Fixed Header -->\n<header class=\"english-header\">\n    <div class=\"header-content\">\n        <div class=\"header-left\">\n            <!-- Show home button when in sub-route (always at the left edge) -->\n            <dr-a href=\"/youtube-persona/\" class=\"home-btn\" dr-if=\"@this@.isInSubRoute\" title=\" \">\n                <i class=\"fas fa-home\"></i>\n            </dr-a>\n            \n            <!-- Show title when on main page -->\n            <h1 class=\"header-title\" dr-if=\"!@this@.isInSubRoute\">YouTube Persona</h1>\n            \n            <!-- Show current persona name when in sub-route -->\n            <div class=\"current-item-info\" dr-if=\"@this@.currentPersonaName\">\n                <div class=\"item-details\">\n                    <span class=\"item-name\">\n                        <span class=\"persona-emoji\" dr-if=\"@this@.currentPersona && @this@.currentPersona.categoryEmojis && @this@.currentPersona.categoryEmojis.length > 0\">${@this@.currentPersona.categoryEmojis[0]}$</span>\n                        ${@this@.currentPersonaName}$\n                    </span>\n                </div>\n            </div>\n        </div>\n\n        <div class=\"user-menu\">\n            <div>\n                <img alt=\"Hits\" src=\"https://hits.sh/hits.sh/dooboostore.github.io_youtube-persona.svg?style=plastic&amp;\">\n            </div>\n        </div>\n    </div>\n</header>\n\n<main class=\"english-main\">\n    <dr-router-outlet></dr-router-outlet>\n</main>\n");

/***/ }),

/***/ "./src/pages/youtube-persona/youtube-persona.router.component.ts":
/*!***********************************************************************!*\
  !*** ./src/pages/youtube-persona/youtube-persona.router.component.ts ***!
  \***********************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   YoutubePersonaRouterComponent: () => (/* binding */ YoutubePersonaRouterComponent)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_simple_boot_decorators_route_Router__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/route/Router */ "../../packages/@dooboostore/simple-boot/src/decorators/route/Router.ts");
/* harmony import */ var _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @dooboostore/simple-boot-front/decorators/Component */ "../../packages/@dooboostore/simple-boot-front/src/decorators/Component.ts");
/* harmony import */ var _youtube_persona_router_component_html__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./youtube-persona.router.component.html */ "./src/pages/youtube-persona/youtube-persona.router.component.html");
/* harmony import */ var _youtube_persona_router_component_css__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./youtube-persona.router.component.css */ "./src/pages/youtube-persona/youtube-persona.router.component.css");
/* harmony import */ var _dooboostore_simple_boot_front_component_ComponentRouterBase__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @dooboostore/simple-boot-front/component/ComponentRouterBase */ "../../packages/@dooboostore/simple-boot-front/src/component/ComponentRouterBase.ts");
/* harmony import */ var _youtube_persona_route_component__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./youtube-persona.route.component */ "./src/pages/youtube-persona/youtube-persona.route.component.ts");
/* harmony import */ var _detail_youtube_persona_detail_route_component__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./detail/youtube-persona-detail.route.component */ "./src/pages/youtube-persona/detail/youtube-persona-detail.route.component.ts");
/* harmony import */ var _dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @dooboostore/core-web/valid/ValidUtils */ "../../packages/@dooboostore/core-web/src/valid/ValidUtils.ts");
/* harmony import */ var _dooboostore_simple_boot_front_option_SimFrontOption__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @dooboostore/simple-boot-front/option/SimFrontOption */ "../../packages/@dooboostore/simple-boot-front/src/option/SimFrontOption.ts");
/* harmony import */ var _back_end_environments_environment__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @back-end/environments/environment */ "./back-end/environments/environment.ts");
/* harmony import */ var _src_service_youtube_persona_YoutubePersonaService__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @src/service/youtube-persona/YoutubePersonaService */ "./src/service/youtube-persona/YoutubePersonaService.ts");
var _a, _b;













let YoutubePersonaRouterComponent = class YoutubePersonaRouterComponent extends _dooboostore_simple_boot_front_component_ComponentRouterBase__WEBPACK_IMPORTED_MODULE_6__.ComponentRouterBase {
    config;
    youtubePersonaService;
    currentPersonaName;
    currentPersona;
    isInSubRoute = false;
    constructor(config, youtubePersonaService) {
        super({ sameRouteNoApply: true });
        this.config = config;
        this.youtubePersonaService = youtubePersonaService;
    }
    async onInitRender(param, rawSet) {
        await super.onInitRender(param, rawSet);
    }
    async onRouting(r) {
        await super.onRouting(r);
        this.currentPersonaName = decodeURIComponent(r.routerModule.pathData?.name ?? '');
        this.currentPersona = this.currentPersonaName ? await this.youtubePersonaService.persona(this.currentPersonaName) : undefined;
        if (this.config?.window) {
            const doc = this.config.window.document;
            const setMetaByProperty = (property, content) => {
                doc.querySelector(`meta[property="${property}"]`)?.setAttribute('content', content);
            };
            const setMetaByName = (name, content) => {
                doc.querySelector(`meta[name="${name}"]`)?.setAttribute('content', content);
            };
            const setLink = (rel, href) => {
                doc.querySelector(`link[rel="${rel}"]`)?.setAttribute('href', href);
            };
            const setTitle = (title) => {
                doc.title = title;
            };
            let pageTitle = '  ';
            let pageDescription = '       ';
            let pageUrl = _back_end_environments_environment__WEBPACK_IMPORTED_MODULE_11__.environment.host + this.config.window.window.location.pathname;
            let pageImage = '/datas/youtube-persona/img.png';
            if (this.currentPersona) {
                pageTitle = `${this.currentPersona.persona} -  `;
                pageDescription = `${this.currentPersona.categoryEmojis[0] ?? ''} ${this.currentPersona.persona}   `;
            }
            setTitle(pageTitle);
            setMetaByName('description', pageDescription);
            setLink('canonical', pageUrl);
            setMetaByProperty('og:title', pageTitle);
            setMetaByProperty('og:description', pageDescription);
            setMetaByProperty('og:image', pageImage);
            setMetaByProperty('og:url', pageUrl);
            setMetaByProperty('og:type', 'website');
        }
        if (_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_9__.ValidUtils.isBrowser()) {
            this.isInSubRoute = !!this.currentPersonaName;
        }
    }
};
YoutubePersonaRouterComponent = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    (0,_dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_2__.Sim)({ scope: _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_2__.Lifecycle.Transient }),
    (0,_dooboostore_simple_boot_decorators_route_Router__WEBPACK_IMPORTED_MODULE_1__.Router)({
        path: '/youtube-persona',
        route: {
            '': '/',
            '/': _youtube_persona_route_component__WEBPACK_IMPORTED_MODULE_7__.YoutubePersonaRouteComponent,
            '/{name}': _detail_youtube_persona_detail_route_component__WEBPACK_IMPORTED_MODULE_8__.YoutubePersonaDetailRouteComponent,
            '/{name}/': _detail_youtube_persona_detail_route_component__WEBPACK_IMPORTED_MODULE_8__.YoutubePersonaDetailRouteComponent
        },
        routers: []
    }),
    (0,_dooboostore_simple_boot_front_decorators_Component__WEBPACK_IMPORTED_MODULE_3__.Component)({
        template: _youtube_persona_router_component_html__WEBPACK_IMPORTED_MODULE_4__["default"],
        styles: _youtube_persona_router_component_css__WEBPACK_IMPORTED_MODULE_5__["default"]
    }),
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _dooboostore_simple_boot_front_option_SimFrontOption__WEBPACK_IMPORTED_MODULE_10__.SimFrontOption !== "undefined" && _dooboostore_simple_boot_front_option_SimFrontOption__WEBPACK_IMPORTED_MODULE_10__.SimFrontOption) === "function" ? _a : Object, typeof (_b = typeof _src_service_youtube_persona_YoutubePersonaService__WEBPACK_IMPORTED_MODULE_12__.YoutubePersonaService !== "undefined" && _src_service_youtube_persona_YoutubePersonaService__WEBPACK_IMPORTED_MODULE_12__.YoutubePersonaService) === "function" ? _b : Object])
], YoutubePersonaRouterComponent);



/***/ }),

/***/ "./src/service/CodeFetchService.ts":
/*!*****************************************!*\
  !*** ./src/service/CodeFetchService.ts ***!
  \*****************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   CodeFetchService: () => (/* binding */ CodeFetchService)
/* harmony export */ });
var CodeFetchService;
(function (CodeFetchService) {
    CodeFetchService.SYMBOL = Symbol.for("CodeFetchService");
})(CodeFetchService || (CodeFetchService = {}));


/***/ }),

/***/ "./src/service/VoiceService.ts":
/*!*************************************!*\
  !*** ./src/service/VoiceService.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   VoiceService: () => (/* binding */ VoiceService)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/core-web/valid/ValidUtils */ "../../packages/@dooboostore/core-web/src/valid/ValidUtils.ts");



let VoiceService = class VoiceService {
    isPlayingWord = false;
    isPlayingScript = false;
    selectedVoice = null;
    constructor() {
        this.initializeVoices();
    }
    initializeVoices() {
        if (!_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_2__.ValidUtils.isBrowser() || !('speechSynthesis' in window)) {
            console.warn('Speech Synthesis not available');
            return;
        }
        const loadVoices = () => {
            const voices = speechSynthesis.getVoices();
            if (voices.length > 0) {
                this.selectedVoice = this.selectBestEnglishVoice(voices);
                const englishVoices = voices.filter(v => v.lang.startsWith('en'));
                console.log('Available English voices:');
                englishVoices.forEach(voice => {
                    console.log(`- ${voice.name} (${voice.lang}) ${voice.localService ? '[Local]' : '[Remote]'}`);
                });
                if (this.selectedVoice) {
                    console.log(` Selected voice: ${this.selectedVoice.name}`);
                }
            }
        };
        loadVoices();
        speechSynthesis.onvoiceschanged = loadVoices;
    }
    isValidVoice(voice) {
        if (!voice)
            return false;
        // Safari : voice   
        try {
            // voice     
            return typeof voice.name === 'string' &&
                typeof voice.lang === 'string' &&
                voice instanceof SpeechSynthesisVoice;
        }
        catch (error) {
            console.warn('Invalid voice object:', error);
            return false;
        }
    }
    selectBestEnglishVoice(voices) {
        if (!voices || voices.length === 0)
            return null;
        const voicePriorities = [
            'Samantha', 'Alex', 'Victoria', 'Daniel',
            'Google US English', 'Google UK English Female', 'Google UK English Male',
            'Microsoft Zira Desktop', 'Microsoft David Desktop', 'Microsoft Mark', 'Microsoft Hazel Desktop',
            'Chrome OS US English', 'Microsoft Edge',
            'English'
        ];
        for (const voiceName of voicePriorities) {
            const voice = voices.find(v => v.name.includes(voiceName) && v.lang.startsWith('en'));
            if (voice && this.isValidVoice(voice)) {
                console.log('Selected voice:', voice.name);
                return voice;
            }
        }
        const localEnglishVoice = voices.find(v => v.lang.startsWith('en') && v.localService);
        if (localEnglishVoice && this.isValidVoice(localEnglishVoice)) {
            console.log('Selected local voice:', localEnglishVoice.name);
            return localEnglishVoice;
        }
        const anyEnglishVoice = voices.find(v => v.lang.startsWith('en'));
        if (anyEnglishVoice && this.isValidVoice(anyEnglishVoice)) {
            console.log('Selected fallback voice:', anyEnglishVoice.name);
            return anyEnglishVoice;
        }
        return null;
    }
    speakWord(word, onEnd) {
        if (!_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_2__.ValidUtils.isBrowser() || !('speechSynthesis' in window)) {
            console.warn('Speech Synthesis not supported');
            return;
        }
        // Only cancel if we're playing individual words, not scripts
        if (this.isPlayingWord && !this.isPlayingScript) {
            speechSynthesis.cancel();
            this.isPlayingWord = false;
        }
        const cleanWord = word.replace(/[,.":!?;]/g, '').trim();
        if (!cleanWord)
            return;
        const utterance = new SpeechSynthesisUtterance(cleanWord);
        utterance.lang = 'en-US';
        utterance.rate = 0.9;
        utterance.pitch = 1.0;
        utterance.volume = 0.9;
        // Safari : voice  SpeechSynthesisVoice  
        if (this.selectedVoice && this.isValidVoice(this.selectedVoice)) {
            try {
                utterance.voice = this.selectedVoice;
            }
            catch (error) {
                console.warn('Failed to set voice, using default:', error);
            }
        }
        this.isPlayingWord = true;
        utterance.onstart = () => {
            this.isPlayingWord = true;
        };
        utterance.onend = () => {
            this.isPlayingWord = false;
            console.log(` Word TTS completed: ${cleanWord}`);
            if (onEnd)
                onEnd();
        };
        utterance.onerror = (event) => {
            console.error('Speech synthesis error:', event.error);
            this.isPlayingWord = false;
        };
        speechSynthesis.speak(utterance);
    }
    speakScript(text, onStart, onEnd, onError) {
        if (!_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_2__.ValidUtils.isBrowser() || !('speechSynthesis' in window)) {
            console.warn('Speech Synthesis not supported');
            return;
        }
        this.stopSpeech();
        const cleanText = text.replace(/[""]/g, '"').trim();
        if (!cleanText)
            return;
        const utterance = new SpeechSynthesisUtterance(cleanText);
        utterance.lang = 'en-US';
        utterance.rate = 0.85;
        utterance.pitch = 1.0;
        utterance.volume = 0.9;
        // Safari : voice  SpeechSynthesisVoice  
        if (this.selectedVoice && this.isValidVoice(this.selectedVoice)) {
            try {
                utterance.voice = this.selectedVoice;
            }
            catch (error) {
                console.warn('Failed to set voice, using default:', error);
            }
        }
        this.isPlayingScript = true;
        utterance.onstart = () => {
            this.isPlayingScript = true;
            if (onStart)
                onStart();
        };
        utterance.onend = () => {
            this.isPlayingScript = false;
            if (onEnd)
                onEnd();
        };
        utterance.onerror = (event) => {
            console.error('Speech synthesis error:', event.error);
            this.isPlayingScript = false;
            if (onError)
                onError();
        };
        speechSynthesis.speak(utterance);
    }
    stopSpeech() {
        if (_dooboostore_core_web_valid_ValidUtils__WEBPACK_IMPORTED_MODULE_2__.ValidUtils.isBrowser() && 'speechSynthesis' in window) {
            speechSynthesis.cancel();
        }
        const wasPlayingScript = this.isPlayingScript;
        const wasPlayingWord = this.isPlayingWord;
        this.isPlayingScript = false;
        this.isPlayingWord = false;
        return { wasPlayingScript, wasPlayingWord };
    }
    isPlaying() {
        return {
            script: this.isPlayingScript,
            word: this.isPlayingWord
        };
    }
};
VoiceService = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__.Sim,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [])
], VoiceService);



/***/ }),

/***/ "./src/service/english/AutoTranslationService.ts":
/*!*******************************************************!*\
  !*** ./src/service/english/AutoTranslationService.ts ***!
  \*******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AutoTranslationService: () => (/* binding */ AutoTranslationService)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/simple-boot/fetch/ApiService */ "../../packages/@dooboostore/simple-boot/src/fetch/ApiService.ts");
var _a;



let AutoTranslationService = class AutoTranslationService {
    apiService;
    constructor(apiService) {
        this.apiService = apiService;
    }
    async getEnglishTranslation(name) {
        return await this.apiService.get({
            target: `/datas/english/auto-translation/${name}.en.json`
        });
    }
    async getKoreanTranslation(name) {
        return await this.apiService.get({
            target: `/datas/english/auto-translation/${name}.ko.json`
        });
    }
    //      
    extractSegmentsWithTime(event) {
        if (!event.segs || event.segs.length === 0)
            return [];
        const eventStartMs = event.tStartMs;
        const eventDurationMs = event.dDurationMs || 1000; //  1
        const segments = [];
        for (const seg of event.segs) {
            if (!seg.utf8)
                continue;
            const segStartMs = eventStartMs + (seg.tOffsetMs || 0);
            // acAsrConf  dDurationMs 
            const duration = seg.acAsrConf === undefined ? eventDurationMs : (seg.acAsrConf || 500);
            const segEndMs = segStartMs + duration;
            segments.push({
                startMs: segStartMs,
                endMs: segEndMs,
                text: seg.utf8
            });
        }
        return segments;
    }
    calculateEventTiming(event) {
        const segments = this.extractSegmentsWithTime(event);
        if (segments.length === 0) {
            const eventStartMs = event.tStartMs;
            return { startMs: eventStartMs, endMs: eventStartMs + 1000 };
        }
        //     
        const startMs = segments[0].startMs;
        //    
        const endMs = segments[segments.length - 1].endMs;
        return { startMs, endMs };
    }
    extractTextFromEvent(event) {
        const segments = this.extractSegmentsWithTime(event);
        return segments.map(seg => seg.text).join('').trim();
    }
    extractTextsFromEvents(data, startMs, endMs) {
        const matchingTexts = [];
        for (const event of data.events) {
            const segments = this.extractSegmentsWithTime(event);
            for (const seg of segments) {
                //       ( )
                if (seg.startMs <= endMs && seg.endMs >= startMs) {
                    matchingTexts.push(seg.text);
                }
            }
        }
        return matchingTexts.join('').trim();
    }
    async getEnglishTranslationScript(name) {
        const enData = await this.getEnglishTranslation(name);
        const items = [];
        for (const enEvent of enData.events) {
            if (!enEvent.segs || enEvent.segs.length === 0)
                continue;
            const { startMs, endMs } = this.calculateEventTiming(enEvent);
            const enText = this.extractTextFromEvent(enEvent);
            if (!enText)
                continue;
            items.push({
                startMs,
                endMs,
                text: enText,
            });
        }
        return items;
    }
    async getKoreanTranslationScript(name) {
        const koData = await this.getKoreanTranslation(name);
        const items = [];
        for (const koEvent of koData.events) {
            if (!koEvent.segs || koEvent.segs.length === 0)
                continue;
            const { startMs, endMs } = this.calculateEventTiming(koEvent);
            const koText = this.extractTextFromEvent(koEvent);
            if (!koText)
                continue;
            items.push({
                startMs,
                endMs,
                text: koText,
            });
        }
        return items;
    }
    async getTranslationScript(name) {
        try {
            //     
            const [enItems, koItems] = await Promise.all([
                this.getEnglishTranslationScript(name),
                this.getKoreanTranslationScript(name).catch(() => [])
            ]);
            const items = [];
            //   
            for (const enItem of enItems) {
                // endMs startMs    
                const startMs = enItem.startMs;
                const endMs = enItem.endMs < enItem.startMs ? enItem.startMs + 1000 : enItem.endMs;
                items.push({
                    type: 'en',
                    text: enItem.text,
                    startMs,
                    endMs
                });
            }
            //   
            for (const koItem of koItems) {
                // endMs startMs    
                const startMs = koItem.startMs;
                const endMs = koItem.endMs < koItem.startMs ? koItem.startMs + 1000 : koItem.endMs;
                items.push({
                    type: 'ko',
                    text: koItem.text,
                    startMs,
                    endMs
                });
            }
            //  :
            // 1. startMs  
            // 2. startMs  type  ( 'en' )
            // 3. type  endMs  
            items.sort((a, b) => {
                // 1: startMs 
                if (a.startMs !== b.startMs) {
                    return a.startMs - b.startMs;
                }
                // 2: type  ( )
                if (a.type !== b.type) {
                    return a.type === 'en' ? -1 : 1;
                }
                // 3: endMs 
                return a.endMs - b.endMs;
            });
            return items;
        }
        catch (error) {
            console.error('Failed to load translation script:', error);
            //     
            const enItems = await this.getEnglishTranslationScript(name);
            return enItems.map(item => {
                const startMs = item.startMs;
                const endMs = item.endMs < item.startMs ? item.startMs + 1000 : item.endMs;
                return {
                    type: 'en',
                    text: item.text,
                    startMs,
                    endMs
                };
            });
        }
    }
};
AutoTranslationService = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__.Sim,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_2__.ApiService !== "undefined" && _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_2__.ApiService) === "function" ? _a : Object])
], AutoTranslationService);



/***/ }),

/***/ "./src/service/english/DictionaryService.ts":
/*!**************************************************!*\
  !*** ./src/service/english/DictionaryService.ts ***!
  \**************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   DictionaryService: () => (/* binding */ DictionaryService)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/simple-boot/fetch/ApiService */ "../../packages/@dooboostore/simple-boot/src/fetch/ApiService.ts");
var _a;



let DictionaryService = class DictionaryService {
    apiService;
    dictionaryCache = new Map();
    constructor(apiService) {
        this.apiService = apiService;
    }
    async getWord(word) {
        //   
        if (this.dictionaryCache.has(word)) {
            return this.dictionaryCache.get(word);
        }
        try {
            const dictionary = await this.apiService.get({
                target: `/datas/english/dictionary/${word}.json`
            });
            //     
            if (dictionary && dictionary.items && dictionary.items.length > 0) {
                const dictWithOriginal = { ...dictionary, originalWord: word };
                this.dictionaryCache.set(word, dictWithOriginal);
                return dictWithOriginal;
            }
            else {
                //    placeholder 
                const placeholder = this.createPlaceholder(word);
                this.dictionaryCache.set(word, placeholder);
                return placeholder;
            }
        }
        catch (error) {
            //    placeholder 
            const placeholder = this.createPlaceholder(word);
            this.dictionaryCache.set(word, placeholder);
            return placeholder;
        }
    }
    async getWords(words) {
        const results = [];
        const wordsToFetch = [];
        //      
        for (const word of words) {
            if (this.dictionaryCache.has(word)) {
                results.push(this.dictionaryCache.get(word));
            }
            else {
                wordsToFetch.push(word);
                results.push(this.createPlaceholder(word)); //  placeholder
            }
        }
        //  
        if (wordsToFetch.length > 0) {
            const batchSize = 10;
            const batches = [];
            for (let i = 0; i < wordsToFetch.length; i += batchSize) {
                batches.push(wordsToFetch.slice(i, i + batchSize));
            }
            for (const batch of batches) {
                const promises = batch.map(word => this.getWord(word));
                await Promise.allSettled(promises);
            }
            //  
            for (let i = 0; i < words.length; i++) {
                const word = words[i];
                if (this.dictionaryCache.has(word)) {
                    results[i] = this.dictionaryCache.get(word);
                }
            }
        }
        return results;
    }
    createPlaceholder(word) {
        return {
            items: [{
                    entry: word,
                    matchType: 'original',
                    phoneticSigns: [],
                    pos: [{
                            type: 'word',
                            meanings: [{
                                    meaning: `Original word: ${word}`,
                                    examples: [],
                                    originalMeaning: word
                                }]
                        }],
                    source: 'original',
                    url: '',
                    mUrl: '',
                    expDicTypeForm: '',
                    locale: 'en',
                    gdid: ''
                }],
            examples: [],
            isWordType: true,
            originalWord: word
        };
    }
    clearCache() {
        this.dictionaryCache.clear();
    }
    getCacheSize() {
        return this.dictionaryCache.size;
    }
};
DictionaryService = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__.Sim,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_2__.ApiService !== "undefined" && _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_2__.ApiService) === "function" ? _a : Object])
], DictionaryService);



/***/ }),

/***/ "./src/service/english/FinanceService.ts":
/*!***********************************************!*\
  !*** ./src/service/english/FinanceService.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   FinanceService: () => (/* binding */ FinanceService)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/simple-boot/fetch/ApiService */ "../../packages/@dooboostore/simple-boot/src/fetch/ApiService.ts");
/* harmony import */ var _back_end_environments_environment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @back-end/environments/environment */ "./back-end/environments/environment.ts");
var _a;




let FinanceService = class FinanceService {
    apiService;
    constructor(apiService) {
        this.apiService = apiService;
    }
    async items() {
        return await this.apiService.get({
            target: new URL(`${_back_end_environments_environment__WEBPACK_IMPORTED_MODULE_3__.environment.host}/datas/finance/items.json`)
        }).then(it => it.reverse());
    }
    async item(symbol) {
        const items = await this.items();
        return items.find(item => item.symbol === symbol);
    }
    async chart(symbol, indicators = ['obv', 'atr', 'rsi', 'adx', 'vo', 'mfi']) {
        const chartData = await this.apiService.get({
            target: new URL(`${_back_end_environments_environment__WEBPACK_IMPORTED_MODULE_3__.environment.host}/datas/finance/chart/${symbol}.json`)
        });
        if (!chartData || !chartData.quotes || chartData.quotes.length === 0) {
            return chartData;
        }
        const indicatorCounts = {};
        // OBV (On-Balance Volume) 
        if (indicators.includes('obv')) {
            let obvValue = 0;
            chartData.quotes.forEach((quote, index) => {
                if (index === 0) {
                    obvValue = quote.volume;
                }
                else {
                    const prevClose = chartData.quotes[index - 1].close;
                    if (quote.close > prevClose) {
                        obvValue += quote.volume;
                    }
                    else if (quote.close < prevClose) {
                        obvValue -= quote.volume;
                    }
                }
                quote.obv = obvValue;
            });
            indicatorCounts['OBV'] = chartData.quotes.filter(q => q.obv !== undefined).length;
        }
        // ATR (Average True Range)  - 14 
        if (indicators.includes('atr')) {
            const atrPeriod = 14;
            const trValues = [];
            for (let i = 0; i < chartData.quotes.length; i++) {
                if (i === 0) {
                    const tr = chartData.quotes[i].high - chartData.quotes[i].low;
                    trValues.push(tr);
                }
                else {
                    const high = chartData.quotes[i].high;
                    const low = chartData.quotes[i].low;
                    const prevClose = chartData.quotes[i - 1].close;
                    const tr = Math.max(high - low, Math.abs(high - prevClose), Math.abs(low - prevClose));
                    trValues.push(tr);
                    if (i >= atrPeriod) {
                        if (i === atrPeriod) {
                            const sum = trValues.slice(0, atrPeriod).reduce((acc, val) => acc + val, 0);
                            chartData.quotes[i].atr = sum / atrPeriod;
                        }
                        else {
                            const prevATR = chartData.quotes[i - 1].atr;
                            chartData.quotes[i].atr = ((prevATR * (atrPeriod - 1)) + tr) / atrPeriod;
                        }
                    }
                }
            }
            indicatorCounts['ATR'] = chartData.quotes.filter(q => q.atr !== undefined).length;
        }
        // RSI (Relative Strength Index)  - 14 
        if (indicators.includes('rsi')) {
            const rsiPeriod = 14;
            for (let i = rsiPeriod; i < chartData.quotes.length; i++) {
                let gains = 0;
                let losses = 0;
                for (let j = i - rsiPeriod + 1; j <= i; j++) {
                    const change = chartData.quotes[j].close - chartData.quotes[j - 1].close;
                    if (change > 0)
                        gains += change;
                    else
                        losses += Math.abs(change);
                }
                const avgGain = gains / rsiPeriod;
                const avgLoss = losses / rsiPeriod;
                if (avgLoss === 0) {
                    chartData.quotes[i].rsi = 100;
                }
                else {
                    const rs = avgGain / avgLoss;
                    chartData.quotes[i].rsi = 100 - (100 / (1 + rs));
                }
            }
            indicatorCounts['RSI'] = chartData.quotes.filter(q => q.rsi !== undefined).length;
        }
        // ADX (Average Directional Index)  - 14 
        if (indicators.includes('adx')) {
            const adxPeriod = 14;
            const plusDM = [];
            const minusDM = [];
            for (let i = 1; i < chartData.quotes.length; i++) {
                const highDiff = chartData.quotes[i].high - chartData.quotes[i - 1].high;
                const lowDiff = chartData.quotes[i - 1].low - chartData.quotes[i].low;
                plusDM.push(highDiff > lowDiff && highDiff > 0 ? highDiff : 0);
                minusDM.push(lowDiff > highDiff && lowDiff > 0 ? lowDiff : 0);
            }
            const plusDI = [];
            const minusDI = [];
            for (let i = adxPeriod - 1; i < plusDM.length; i++) {
                const sumPlusDM = plusDM.slice(i - adxPeriod + 1, i + 1).reduce((a, b) => a + b, 0);
                const sumMinusDM = minusDM.slice(i - adxPeriod + 1, i + 1).reduce((a, b) => a + b, 0);
                const quoteIndex = i + 1;
                const atrValue = chartData.quotes[quoteIndex].atr;
                if (atrValue) {
                    plusDI.push((sumPlusDM / atrValue) * 100);
                    minusDI.push((sumMinusDM / atrValue) * 100);
                }
            }
            const dx = [];
            for (let i = 0; i < plusDI.length; i++) {
                const diSum = plusDI[i] + minusDI[i];
                const diDiff = Math.abs(plusDI[i] - minusDI[i]);
                dx.push(diSum > 0 ? (diDiff / diSum) * 100 : 0);
            }
            for (let i = adxPeriod - 1; i < dx.length; i++) {
                const adxValue = dx.slice(i - adxPeriod + 1, i + 1).reduce((a, b) => a + b, 0) / adxPeriod;
                const quoteIndex = adxPeriod + adxPeriod - 1 + (i - adxPeriod + 1);
                if (quoteIndex < chartData.quotes.length) {
                    chartData.quotes[quoteIndex].adx = adxValue;
                }
            }
            indicatorCounts['ADX'] = chartData.quotes.filter(q => q.adx !== undefined).length;
        }
        // VO (Volume Oscillator)  - 5/10 
        if (indicators.includes('vo')) {
            const shortPeriod = 5;
            const longPeriod = 10;
            for (let i = longPeriod - 1; i < chartData.quotes.length; i++) {
                const shortVolumes = chartData.quotes.slice(i - shortPeriod + 1, i + 1).map(q => q.volume);
                const longVolumes = chartData.quotes.slice(i - longPeriod + 1, i + 1).map(q => q.volume);
                const shortAvg = shortVolumes.reduce((a, b) => a + b, 0) / shortPeriod;
                const longAvg = longVolumes.reduce((a, b) => a + b, 0) / longPeriod;
                // VO = ((Short MA - Long MA) / Long MA) * 100
                chartData.quotes[i].vo = ((shortAvg - longAvg) / longAvg) * 100;
            }
            indicatorCounts['VO'] = chartData.quotes.filter(q => q.vo !== undefined).length;
        }
        // MFI (Money Flow Index)  - 14 
        if (indicators.includes('mfi')) {
            const mfiPeriod = 14;
            // Typical Price Money Flow 
            const typicalPrices = [];
            const moneyFlows = [];
            for (let i = 0; i < chartData.quotes.length; i++) {
                const tp = (chartData.quotes[i].high + chartData.quotes[i].low + chartData.quotes[i].close) / 3;
                typicalPrices.push(tp);
                moneyFlows.push(tp * chartData.quotes[i].volume);
            }
            for (let i = mfiPeriod; i < chartData.quotes.length; i++) {
                let positiveFlow = 0;
                let negativeFlow = 0;
                for (let j = i - mfiPeriod + 1; j <= i; j++) {
                    if (typicalPrices[j] > typicalPrices[j - 1]) {
                        positiveFlow += moneyFlows[j];
                    }
                    else if (typicalPrices[j] < typicalPrices[j - 1]) {
                        negativeFlow += moneyFlows[j];
                    }
                }
                if (negativeFlow === 0) {
                    chartData.quotes[i].mfi = 100;
                }
                else {
                    const moneyFlowRatio = positiveFlow / negativeFlow;
                    chartData.quotes[i].mfi = 100 - (100 / (1 + moneyFlowRatio));
                }
            }
            indicatorCounts['MFI'] = chartData.quotes.filter(q => q.mfi !== undefined).length;
        }
        console.log(` Indicators calculated for ${chartData.quotes.length} quotes`);
        Object.entries(indicatorCounts).forEach(([name, count]) => {
            console.log(`  - ${name}: ${count} values`);
        });
        return chartData;
    }
    async events(symbol) {
        return await this.apiService.get({
            target: new URL(`${_back_end_environments_environment__WEBPACK_IMPORTED_MODULE_3__.environment.host}/datas/finance/event/${symbol}.json`)
        });
    }
};
FinanceService = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__.Sim,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_2__.ApiService !== "undefined" && _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_2__.ApiService) === "function" ? _a : Object])
], FinanceService);



/***/ }),

/***/ "./src/service/english/VideoItemService.ts":
/*!*************************************************!*\
  !*** ./src/service/english/VideoItemService.ts ***!
  \*************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   VideoItemService: () => (/* binding */ VideoItemService)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/simple-boot/fetch/ApiService */ "../../packages/@dooboostore/simple-boot/src/fetch/ApiService.ts");
/* harmony import */ var _back_end_environments_environment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @back-end/environments/environment */ "./back-end/environments/environment.ts");
var _a;




let VideoItemService = class VideoItemService {
    apiService;
    constructor(apiService) {
        this.apiService = apiService;
    }
    async items() {
        return await this.apiService.get({
            target: new URL(`${_back_end_environments_environment__WEBPACK_IMPORTED_MODULE_3__.environment.host}/datas/english/items.json`)
        }).then(it => it.reverse());
    }
    async item(name) {
        const items = await this.items();
        return items.find(item => item.name === name);
    }
};
VideoItemService = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__.Sim,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_2__.ApiService !== "undefined" && _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_2__.ApiService) === "function" ? _a : Object])
], VideoItemService);



/***/ }),

/***/ "./src/service/youtube-persona/YoutubePersonaService.ts":
/*!**************************************************************!*\
  !*** ./src/service/youtube-persona/YoutubePersonaService.ts ***!
  \**************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   YoutubePersonaService: () => (/* binding */ YoutubePersonaService)
/* harmony export */ });
/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! tslib */ "../../node_modules/.pnpm/tslib@2.8.1/node_modules/tslib/tslib.es6.mjs");
/* harmony import */ var _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @dooboostore/simple-boot/decorators/SimDecorator */ "../../packages/@dooboostore/simple-boot/src/decorators/SimDecorator.ts");
/* harmony import */ var _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @dooboostore/simple-boot/fetch/ApiService */ "../../packages/@dooboostore/simple-boot/src/fetch/ApiService.ts");
/* harmony import */ var _back_end_environments_environment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @back-end/environments/environment */ "./back-end/environments/environment.ts");
var _a;




let YoutubePersonaService = class YoutubePersonaService {
    apiService;
    constructor(apiService) {
        this.apiService = apiService;
    }
    async personas() {
        return await this.apiService.get({
            target: new URL(`${_back_end_environments_environment__WEBPACK_IMPORTED_MODULE_3__.environment.host}/datas/youtube-persona/items.json`)
        });
    }
    async persona(personaName) {
        const personas = await this.personas();
        return personas.find(p => p.persona === personaName);
    }
    async videos(personaName) {
        const fileName = personaName.replace(/[<>:"/\\|?*]/g, '_').substring(0, 50);
        return await this.apiService.get({
            target: new URL(`${_back_end_environments_environment__WEBPACK_IMPORTED_MODULE_3__.environment.host}/datas/youtube-persona/personas/${fileName}.json`)
        });
    }
};
YoutubePersonaService = (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__decorate)([
    _dooboostore_simple_boot_decorators_SimDecorator__WEBPACK_IMPORTED_MODULE_1__.Sim,
    (0,tslib__WEBPACK_IMPORTED_MODULE_0__.__metadata)("design:paramtypes", [typeof (_a = typeof _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_2__.ApiService !== "undefined" && _dooboostore_simple_boot_fetch_ApiService__WEBPACK_IMPORTED_MODULE_2__.ApiService) === "function" ? _a : Object])
], YoutubePersonaService);



/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/global */
/******/ 	(() => {
/******/ 		__webpack_require__.g = (function() {
/******/ 			if (typeof globalThis === 'object') return globalThis;
/******/ 			try {
/******/ 				return this || new Function('return this')();
/******/ 			} catch (e) {
/******/ 				if (typeof window === 'object') return window;
/******/ 			}
/******/ 		})();
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry needs to be wrapped in an IIFE because it needs to be in strict mode.
(() => {
"use strict";
/*!****************************!*\
  !*** ./front-end/index.ts ***!
  \****************************/
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var reflect_metadata__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! reflect-metadata */ "../../node_modules/.pnpm/reflect-metadata@0.2.2/node_modules/reflect-metadata/Reflect.js");
/* harmony import */ var reflect_metadata__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(reflect_metadata__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _src_bootfactory__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @src/bootfactory */ "./src/bootfactory.ts");
/* harmony import */ var _service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./service */ "./front-end/service/index.ts");

// console.log('----------', require.resolve("reflect-metadata"));
// console.log('---', Object.keys(require.cache).filter(p => p.includes("reflect-metadata")));
// if (!(Reflect as any).__MY_MARK__) {
//   (Reflect as any).__MY_MARK__ = Math.random();
// }
//
// console.log("Reflect mark:", (Reflect as any).__MY_MARK__);


const using = [..._service__WEBPACK_IMPORTED_MODULE_2__.services];
_src_bootfactory__WEBPACK_IMPORTED_MODULE_1__["default"].create((0,_src_bootfactory__WEBPACK_IMPORTED_MODULE_1__.MakeSimFrontOption)(window), using).then(it => {
    it.run();
});

})();

/******/ })()
;
//# sourceMappingURL=bundle.js.map